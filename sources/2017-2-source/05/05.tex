
%\begin{center}
%{\footnotesize
%\begin{tabular}{lcr}
%$\issueyear$   & ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА  &  Том\,13.\,\,Вып.\,$\issuenum$ \\
%\multicolumn{3}{c}{ПРИКЛАДНАЯ МАТЕМАТИКА.
%ИНФОРМАТИКА. ПРОЦЕССЫ УПРАВЛЕНИЯ}\\
%\end{tabular}
%\end{center}
%}
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,13.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.2cm} \noindent {\large ПРОЦЕССЫ УПРАВЛЕНИЯ}
\vspace{1.0cm}

\noindent{\footnotesize УДК 519.85 + 51-74}

\vskip2.5mm

\noindent{\it А.~Ю.~Крылатов}

\vskip2.5mm

\noindent{\bf ОПТИМАЛЬНЫЕ СТРАТЕГИИ УПРАВЛЕНИЯ ПРОПУСКНОЙ \\
СПОСОБНОСТЬЮ МАРШРУТОВ ТРАНСПОРТНОЙ СЕТИ}

\efootnote{

\vspace{-3mm}\parindent=7mm


%{\copyright} Н. А. Валиотти, 2014

{\it Крылатов Александр Юрьевич} --- кандидат
физико-математических наук, доцент;\\ a.krylatov@ spbu.ru




\vskip 1.5mm

\textit{Krylatov Alexander Yurievich}  --- PhD of physical and
mathematical sciences, associate professor; a.krylatov@spbu.ru



\vskip 1.5mm

{\copyright} Санкт-Петербургский государственный университет,
\issueyear%\\
%$^{*}$ Работа выполнена при финансовой поддержке
%Санкт-Петербургского государственного университета (грант
%№~9.38.673.2013).
}

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp09 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum05 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp09 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum05}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

\noindentСанкт-Петербургский государственный университет,
Российская Федерация, \\ 199034, Санкт-Петербург, Университетская
наб., 7--9



\vskip3mm

\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}

\item Рассматривается задача определения оптимальных изменений пропускной
способности маршрутов транспортной сети. Обследуемая транспортная
сеть представлена графом с~одной парой исток---сток и~$n$
альтернативными (непересекающимися) маршрутами. Задача поиска
оптимальной стратегии изменения пропускной способности
транспортной сети формулируется в~виде задачи двухуровневой
оптимизации. Верхним уровнем моделируется процесс принятия решения
администрацией города, обладающей технической возможностью
воздействовать на~пропускную способность улично-дорожной сети
(ремонт, модернизация, строительство новых участков и~т. п.).
Предполагается, что администрация будет минимизировать общее время
движения транспортных потоков по~сети. Нижним уровнем моделируется
поведение участников движения, реагирующих на~изменения дорожной
инфраструктуры. Считается, что каждый водитель стремится
минимизировать свое личное время движения из~района отправления
в~район прибытия. Для исследуемой сети оптимальное решение найдено
в явном виде. Разработан методологический инструмент  поддержки
принятия решений в~области планирования инфраструктурных изменений
улично-дорожной сети города. Библиогр. 8~назв. Ил.~1.

{\it Ключевые слова}: двухуровневая оптимизация, условная
нелинейная оптимизация, конкурентное равновесие Вардропа,
оптимизация топологии сети, пропускная способность сети.

\end{list}

}

%\newpage
\vskip1.0mm

\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}

\noindent{\it  A.~Yu.~Krylatov}

\vskip2mm\noindent{\bf OPTIMAL STRATEGIES FOR ROAD \\
NETWORK'S CAPACITY ALLOCATION}

\vskip1.5mm



{\footnotesize

\noindent St.~Petersburg State University, 7--9, Universitetskaya
nab., St.~Petersburg,\\ 199034, Russian Federation

\vskip1.5mm


\item The problem of allocating the capacity of a road network is considered.
The network is presented by a digraph with one source---sink pair
and $n$ alternative (not intersecting) routes. To arrive at the
optimal strategy for a road network's capacity allocation, a
bi-level optimization program is formulated. The upper level is a
modeling decision made by the city administration entrusted with
making constructive changes to the road network. The
administration seeks to minimize the overall travel time on the
network. The lower level is modeling the behavior of network's
users, who react to any constructive changes. Each driver tends to
minimize his/her own travel time from origin to destination. The
optimal solution is obtained explicitly for the studied network. A
methodological tool for decision-making support in road network
sphere is then developed. Refs~8. Fig.~1.

\textit{Keywords}: bi-level optimization, constrained nonlinear
optimization, user  equilibrium of Wardrop, network design
problem, capacity allocation.


}

\end{list}

\vskip 2.5mm



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\indent {\bf 1. Введение.} Методология решения задач управления
транспортными потоками и~построения оптимальной транспортной
инфраструктуры разработана довольно хорошо. В~настоящее время
существует класс задач, связанных с~разработкой комплексных схем
организации дорожного движения [1], который носит общее название
UTNDP (urban transportation network design problem)~--- задачи
построения городской транспортной сети [2]. UTNDP~--- это задачи,
которые имеют дело со~всей иерар\-хией принятия решений в~области
транспортного планирования и~включают стратегические, тактические
и операционные решения. Стратегические решения~--- долгосрочные
решения, обусловленные инфраструктурой транспортных сетей, куда
входят транзитные и~внутренние сети; тактические~--- с~эффективным
ис\-поль\-зо\-ва\-нием ресурсов существующих городских
транспортных сетей; операционные~--- краткосрочные решения,
связанные с~управлением транспортными потоками, нахождением матриц
корреспонденций (информация об основных пунктах отправления
и~пунктах прибытия транспорта) или составлением расписаний.

С математической точки зрения, задача оптимального управления
пропускной способностью транспортной сети представляет собой
задачу двухуровневой оптимизации. Верхним уровнем моделируется
процесс принятия решения администрацией города, обладающей
технической возможностью воздействовать на~пропускную способность
улично-дорожной сети (ремонт, модернизация, строительство новых
участков и~т. п.). Предполагается, что администрация будет
минимизировать общее время движения транспортных потоков по~сети.
Нижним уровнем моделируется поведение участников движения,
реагирующих на~изменения дорожной инфраструктуры. Полагается, что
каждый водитель стремится минимизировать свое личное время
движения из~района отправления в~район прибытия. В~результате
на~нижнем уровне возникает конфликтная ситуация. При этом целевой
функционал верхнего уровня соот\-вет\-ст\-вует второму принципу
Вардропа, а~целевой функционал нижнего~--- первому [3].

Принципы Вардропа были сформулированы в~1952 г. и~заключались
в~том, что любая транспортная система по~прошествии некоторого
времени приходит в~равновесное состояние. Согласно первому
принципу, <<время передвижения по~всем используемым маршрутам
одинаково для всех участников движения и~меньше времени, которое
потратит любой участник движения, изменив свой маршрут>>,
а~согласно второму, <<среднее время передвижения является
минимальным>>. Таким образом, применяя второй принцип Вардропа,
администрация действительно может добиться поставленной цели, в~то
время как конкурентная маршрутизация нижнего уровня хорошо
описывается первым принципом. Впервые математическую формулировку
этих принципов предложил Бекманн [4]. Впоследствии данная
математическая модель стала классической [5] и~сейчас является
одним из~ключевых методологических инструментов в~теории
транспортных потоков [6, 7].

Настоящая работа ориентирована на~развитие методологических
инструментов, позволяющих поддерживать процессы принятия решений
в~области управления улично-дорожной сетью крупных городов.
Отметим, что задачи двухуровневой оптимизации крайне сложны,
с~точки зрения выявления направления поиска оптимального решения.
Связано это прежде всего с~тем, что реакция нижнего уровня
на~изменения параметров верхнего уровня представляет собой
отображение, относительно которого в~общем случае нельзя
гарантировать даже непрерывность. Более того, зачастую такие
отображения не~являются инъективными. В~настоящей работе будет
изучена модель достаточно простой и~наглядной линейной сети
из~параллельных маршрутов (не имеющих общих дуг). Вид сети
позволит получить решение задачи в~явном виде, что, в~свою
очередь, даcт возможность сделать конкретные методологические
выводы о~том, каким образом следует подходить к~вопросам
модернизации улично-дорожных сетей городов, страдающих от
транспортных заторов.

Статья построена следующим образом. Общей постановке
математической задачи оптимального управления пропускной
способностью транспортной сети посвящен п. 2. В~п. 3 исследована
линейная сеть из~параллельных маршрутов, выявлены оптимальные
стратегии изменения пропускной способности транспортной сети,
приводящие к~минимизации общего времени движения транспортных
потоков, при условии, что каждый участник движения стремится
минимизировать свое личное время движения. В~п.~4 приведены
методологические рекомендации по~управлению улично-дорожной сетью
городов, основанные на~полученных теоретических результатах.
В~п.~5 даны основные выводы по~работе.

\indent {\bf 2. Транспортная сеть произвольной топологии.} Будем
считать, что транспортная сеть представлена ориентированным
связным графом $G=(N,A)$. Введем обозначения: $N$~--- множество
последовательно пронумерованных узлов графа $G$; $A$~--- множество
последовательно пронумерованных дуг графа $G$; $W$~--- множество
пар узлов графа $G$ (районов отправления---прибытия), $w \in W$;
$K_{w}$~--- множество маршрутов между парой $w \in W$; $x_a$~---
транспортный поток по~дуге $a \in A$, $x = (\ldots, x_a, \ldots)$;
$c_a$~--- пропускная способность дуги $a \in A$, $c= (\ldots, c_a,
\ldots)$; $f_k^{w}$~--- транспортный поток по~маршруту $k \in
K_{w}$; $F^{w}$~--- совокупный транспортный спрос между парой $w
\in W$; $t_a (x_a, c_a)$~--- время передвижения (задержка) по~дуге
$a \in A$ с~пропускной способностью $c_a$ потока $x_a$;
$\delta_{a,k}^{w}$~--- индикатор: $\delta_{a,k}^{w} =
\left\{\begin{array}{ll}
1, \quad \mbox{если дуга } a \in A \mbox{ <<входит>> в~маршрут } k \in K_{w} , \\
0, \quad \mbox{в противном случае}. \end{array}\right.$

В таком случае задача оптимального управления пропускной
способностью транспортной сети, представленной в~виде графа $G$,
может быть сформулирована как следующая двухуровневая задача
условной оптимизации:

\begin{equation} \label{f1}
T (x^*, c^*) = \min_c \sum_{a \in A} t_a(x_a, c_a) x_a
\end{equation}
при ограничениях
\begin{equation} \label{f2}
\sum_{a \in A} \left( c_a - \mathfrak{c}_a \right) \leq C,
\end{equation}
\begin{equation} \label{f3}
c_a \geq \mathfrak{c}_a \quad \forall a \in A,
\end{equation}
и условии, что транспортные потоки распределяются согласно первому
принципу Вардропа:

\begin{equation} \label{f4}
x^* = \arg \min_x \sum_{a \in A} \int\limits_0^{x_a} t_a(u, c_a)du
\end{equation}
при
\begin{equation} \label{f5}
\sum_{k \in K_{w}} f_k^{w} = F^{w} \quad \forall w \in W,
\end{equation}

\begin{equation} \label{f6}
f_k^{w} \geq 0 \quad \forall k \in K_{w}, \enspace w \in W,
\end{equation}

\noindent и~условии
\begin{equation} \label{f7}
x_a = \sum_{w \in W} \sum_{k \in K_{w}} f_k^{w} \delta_{a,k}^{w}
\quad \forall a \in A.
\end{equation}

Рассмотрим оптимизационную задачу верхнего уровня. Согласно
ограничению (\ref{f3}), пропускная способность каждого маршрута
может быть увеличена при условии, что изначальная пропускная
способность равна $\mathfrak{c}_i$, $i=\overline{1,n}$.
Ограничение (\ref{f2}) говорит о~том, что администрация может
увеличить совокупную пропускную способность улично-дорожной сети
на величину $C$. Такое ограничение может быть связано, например,
с~объемом инвестиций, которые администрация готова вложить
в~реконструкцию транспортной сети. Целевой функционал (\ref{f1})
минимизирует общее время движения потоков по~улично-дорожной сети.
При этом администрация может управлять только пропускными
способностями дорог, а~значит минимизация на~верхнем уровне
возможна только по~$c$. Реакция участников движения
на~инфраструктурные изменения описывается оптимизационной задачей
(\ref{f4})--(\ref{f7}). Математически (\ref{f4})--(\ref{f7})
представляет собой некое отображение $\Phi$ : $c \to x$. Доказано,
что решением задачи (\ref{f4})--(\ref{f7}) является $x^*$,
удовлетворяющий первому принципу Вардропа [4, 5].

К сожалению, в~общем случае нет никакой возможности функционально
выразить $x$ через $c$ и~подставить полученное выражение
в~(\ref{f1}). Более того, в~п. 1 было отмечено, что относительно
отображения $\Phi$, в~принципе, нельзя сказать ничего конкретного.
Таким образом, качественный анализ поведения целевой функции
верхнего уровня (\ref{f1}) в~зависимости от изменения вектора $c$
в общем случае провести невозможно из-за отсутствия возможности
изучить свойства отображения $\Phi$. Другими словами, нельзя
получить качественную оценку того, как конкретно будет реагировать
$x$ на~изменения $c$. Однако в~частном случае такой анализ
осуществить можно. Речь идет о~сети из~параллельных маршрутов
с~линейными функциями задержки. Рассмотрим этот класс сетей более
подробно.

\indent {\bf 3. Транспортная сеть из~параллельных маршрутов.}
Опишем сеть, представленную ориентированным графом, состоящим
из~двух узлов (исток, сток) и~$n$ непересекающихся дуг
(маршрутов). Будем называть ее {\it сетью из~параллельных
маршрутов}. Совокупный поток между истоком и~стоком будем
обозначать через $F$, а~распределение $F$ по~дугам~--- $f_i \geq
0$, $i = \overline{1,n}$: $\sum_{i=1}^n f_i = F$, $f = (f_1,
\ldots, f_n)$. Время перемещения потока из~истока в~сток по~дуге
будем описывать линейной функ\-цией $t_i (f_i, c_i) = t_i^0 \left(
1 + \frac{f_i}{c_i} \right)$, где $t_i^0$~--- время свободного
движения по~маршруту $i$, $c_i$~--- пропускная способность $i$-го
маршрута, $i=\overline{1,n}$, $c=(c_1, \ldots, c_n)$.

Задача поиска оптимальной стратегии управления пропускной
способностью транспортной сети (\ref{f1})--(\ref{f7}) для сети
из~параллельных маршрутов примет вид
\begin{equation} \label{fg1}
T (f^*, c^*) = \min_c \sum_{i=1}^n t_i(f_i, c_i) f_i
\end{equation}
при ограничениях
\begin{equation} \label{fg2}
\sum_{i=1}^n ( c_i - \mathfrak{c}_i ) \leq C,
\end{equation}
\begin{equation} \label{fg3}
c_i \geq \mathfrak{c}_i \quad \forall i=\overline{1,n},
\end{equation}
и условии, что транспортные потоки распределяются согласно первому
принципу Вардропа:

\begin{equation} \label{fg4}
f^* = \arg \min_f \sum_{i=1}^n \int\limits_0^{f_i} t_i(u, c_i)du
\end{equation}
при
\begin{equation} \label{fg5}
\sum_{i=1}^n f_i = F,
\end{equation}

\begin{equation} \label{fg6}
f_i \geq 0 \quad \forall i=\overline{1,n},
\end{equation}
где $\mathfrak{c}_i$~--- изначальная пропускная способность
маршрута $i$, $i=\overline{1,n}$, а~$C$~--- совокупная пропускная
способность сети, которой можно добиться.

Справедлива следующая теорема.

{\bf Теорема.} {\it Рассмотрим загруженную линейную сеть
из~параллельных маршрутов, для которой выполняется}
\begin{equation} \label{ff2}
F \geq \sum_{i=1}^{n} \left( \mathfrak{c}_i + C \right) \Bigg (
\frac{\max_{j=\overline{1,n}} t_{j}^0}{t_i^0} - 1 \Bigg).
\end{equation}
{\it Пусть $I_0$ и~$I$~--- подмножества индексов маршрутов, такие
что $I_0 \cap I = \emptyset$ и~$I_0 \cup I = \{1, \ldots, n \}$,
для которых выполняется}
\begin{equation} \nonumber
\begin{array}{ll}
t_{i_1}^0 = t_{i_2}^0 ~\quad \forall \thinspace i_1, i_2 \in I_0,\\
\\
t_{i_1}^0 < t_{i_2}^0 ~\quad \forall  \thinspace i_1 \in I_0, i_2
\in I.
\end{array}
\end{equation}
{\it Решением двухуровневой оптимизационной задачи поиска
оптимальных изменений пропускных способностей используемых
параллельных маршрутов} (\ref{fg1})--(\ref{fg6}) {\it является
такая пара векторов $(f^*, c^*)$, что}
\begin{equation} \nonumber
c_i^* \left\{
\begin{array}{ll}
> \mathfrak{c}_i, & \mbox{если } i \in I_0, \\
= \mathfrak{c}_i, & \mbox{если } i \in I,
\end{array}
\right.
\end{equation}
{\it и}
\begin{equation} \label{fg8}
\sum_{i \in I_0} ( c_i^* - \mathfrak{c}_i ) = C,
\end{equation}
{\it а~вектор $f^*$ получается из} (\ref{fg4})--(\ref{fg6}) {\it
при подстановке $c^*$.}

%\begin{proof}
Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о.\; В работе [8] показано,
что выполнение условия (\ref{ff2}) при моделировании времени
перемещения потока по~дуге линейной BPR-функцией $t_i (f_i, c_i) =
t_i^0 \left(1 + \frac{f_i}{c_i} \right)$ гарантирует следующее
распределение потока $F$ по~маршрутам:
\begin{equation} \label{ff1}
f_i^* = \frac {c_i}{t_i^0} \frac {F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} - c_i, \quad
i=\overline{1,n}.
\end{equation}
Содержательно, условие (\ref{ff2}) гарантирует то, что все
маршруты линейной сети из~параллельных маршрутов используются (нет
неиспользуемых маршрутов с~нулевым потоком). Другими словами, сеть
является загруженной. Более того, согласно (\ref{ff2}), сеть будет
оставаться загруженной, даже если пропускную способность каждого
маршрута увеличить на~величину $C$.\newpage

При линейной BPR-функции задержки задача (\ref{fg1}) примет вид
\begin{equation} \label{ff3}
T (f, c) = \sum_{i=1}^n t_i^0 \left(1 + \frac{f_i}{c_i} \right)
f_i.
\end{equation}
Подставим (\ref{ff1}) в~(\ref{ff3}):
\begin{equation} \nonumber
T (f, c) = T \left( f(c), c \right) = \sum_{i=1}^n  \frac{F +
\sum_{s=1}^{n} c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot
\left[ \frac {c_i}{t_i^0} \frac {F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} - c_i \right]
\end{equation}
или
\begin{equation} \nonumber
T \left( f(c), c \right) = \frac{F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot \sum_{i=1}^n  \left[
\frac {c_i}{t_i^0} \frac {F + \sum_{s=1}^{n} c_s}{\sum_{s=1}^{n}
\frac {c_s}{t_s^0}} - c_i \right],
\end{equation}
что после раскрытия скобок приводит к~выражению
\begin{equation} \nonumber
T \left( f(c), c \right) = \frac{F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot \sum_{i=1}^n  \frac
{c_i}{t_i^0} \cdot \frac {F + \sum_{s=1}^{n} c_s}{\sum_{s=1}^{n}
\frac {c_s}{t_s^0}} - \frac{F + \sum_{s=1}^{n} c_s}{\sum_{s=1}^{n}
\frac {c_s}{t_s^0}} \cdot \sum_{i=1}^n c_i
\end{equation}
и сокращению дроби в~первом слагаемом:
\begin{equation} \nonumber
T \left( f(c), c \right) = \frac{F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot \left[ F +
\sum_{s=1}^{n} c_s \right] - \frac{F + \sum_{s=1}^{n}
c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot \sum_{i=1}^n c_i
\end{equation}
или
\begin{equation} \nonumber
T \left( f(c), c \right) = \frac{\left[ F + \sum_{s=1}^{n} c_s
\right]^2}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} - \frac{F +
\sum_{s=1}^{n} c_s}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \cdot
\sum_{i=1}^n c_i.
\end{equation}
Теперь, если раскрыть полный квадрат в~числителе первого
слагаемого и~перемножить сомножители второго слагаемого,
то~\begin{equation} \nonumber T \left( f(c), c \right) = \frac{
F^2 + 2 \cdot F \cdot \sum_{s=1}^{n} c_s + \left[ \sum_{s=1}^{n}
c_s \right]^2}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} - \frac{F \cdot
\sum_{i=1}^n c_i + \left[ \sum_{s=1}^{n} c_s
\right]^2}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}},
\end{equation}
что окончательно приводит к~\begin{equation} \nonumber T \left(
f(c), c \right) = \frac{ F^2 + F \cdot \sum_{s=1}^{n} c_s
}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} ,
\end{equation}
или в~более компактной форме:
\begin{equation} \nonumber
T \left( f(c), c \right) = F \cdot \frac{ F + \sum_{s=1}^{n} c_s
}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}}.
\end{equation}

Таким образом, приходим к~следующей задаче условной оптимизации:
\begin{equation} \label{ff4}
T \left( f(c^*), c^* \right) = \min_c \enspace F \cdot \frac{ F +
\sum_{s=1}^{n} c_s }{\sum_{s=1}^{n} \frac {c_s}{t_s^0}}
\end{equation}
при ограничениях
\begin{equation} \label{ff5}
\sum_{i=1}^n (c_i - \mathfrak{c}_i ) \leq C,
\end{equation}
\begin{equation} \label{ff6}
c_i \geq \mathfrak{c}_i \quad \forall i=\overline{1,n}.
\end{equation}
Выпишем лагранжиан задачи (\ref{ff4})--(\ref{ff6}):\newpage
\begin{equation} \nonumber
L = F \cdot \frac{ F + \sum_{s=1}^{n} c_s }{\sum_{s=1}^{n} \frac
{c_s}{t_s^0}} + \omega \left[ \sum_{i=1}^n (c_i - \mathfrak{c}_i)
- C \right] + \sum_{i=1}^n \eta_i (\mathfrak{c}_i - c_i),
\end{equation}
где $\omega \geq 0$ и~$\eta_i \geq 0$, $i=\overline{1,n}$,~---
множители Лагранжа. Продифференцируем лагранжиан по~$c_i$:
\begin{equation}\nonumber
\frac{\partial L}{\partial c_i} = F \cdot \frac{\partial
}{\partial c_i} \left( \frac{ F + \sum_{s=1}^{n} c_s
}{\sum_{s=1}^{n} \frac {c_s}{t_s^0}} \right) + \omega - \eta_i,
\end{equation}
и приравняем полученное выражение к~нулю:
\begin{equation}\nonumber
F \cdot \frac{ \sum_{s=1}^{n} \frac {c_s}{t_s^0} - \left[ F +
\sum_{s=1}^{n} c_s \right] \cdot \frac{1}{t_i^0}}{\left[
\sum_{s=1}^{n} \frac {c_s}{t_s^0} \right]^2 } + \omega - \eta_i =
0.
\end{equation}
Согласно условию дополняющей нежесткости, для условий в~виде
неравенств (\ref{ff6}) имеет место $c_i \cdot \eta_i = 0$ для всех
$i=\overline{1,n}$. Таким образом, если $\eta_i > 0$, то~$c_i =
\mathfrak{c}_i$. Если $c_i > \mathfrak{c}_i$, то~$\eta_i = 0$.
Приходим к~системе условий
\begin{equation} \label{ff7}
F \cdot \frac{ \left[ F + \sum_{s=1}^{n} c_s \right] \cdot
\frac{1}{t_i^0} - \sum_{s=1}^{n} \frac {c_s}{t_s^0}}{\left[
\sum_{s=1}^{n} \frac {c_s}{t_s^0} \right]^2 } \left\{
\begin{array}{ll}
= \omega & \mbox{при } c_i > \mathfrak{c}_i, \\
\leq \omega & \mbox{при } c_i = \mathfrak{c}_i,
\end{array} \right. \quad \forall i=\overline{1,n}.
\end{equation}
В то~же время для (\ref{ff5}) также должно выполняться условие
дополняющей нежесткости~$\omega \cdot \left[ \sum_{i=1}^n (c_i -
\mathfrak{c}_i) - C \right] = 0$. Таким образом, получаем два
варианта. Пусть $\sum_{i=1}^n (c_i - \mathfrak{c}_i) < C$
и~в~таком случае $\omega = 0$, что приводит (\ref{ff7}) к~виду
\begin{equation} \label{ff8}
F \cdot \frac{ \left[ F + \sum_{s=1}^{n} c_s \right] \cdot
\frac{1}{t_i^0} - \sum_{s=1}^{n} \frac {c_s}{t_s^0}}{\left[
\sum_{s=1}^{n} \frac {c_s}{t_s^0} \right]^2 } \left\{
\begin{array}{ll}
= 0  & \mbox{при } c_i > \mathfrak{c}_i, \\
\leq 0 & \mbox{при } c_i = \mathfrak{c}_i,
\end{array} \right. \quad \forall i=\overline{1,n}.
\end{equation}
Предположим, что существуют индексы $i$, для которых $c_i >
\mathfrak{c}_i$. Без умаления общности будем считать, что это $r$
первых индексов среди $\{ 1, \ldots, n\}$. В~таком случае имеем
$c_i > \mathfrak{c}_i$ для $i=\overline{1,r}$, что в~силу условия
(\ref{ff8}) приводит к~системе
\begin{equation} \nonumber
\left\{
\begin{array}{c}
\left[ F + c_1 + \ldots + c_r \right] \cdot \frac{1}{t_1^0} = \frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0}, \\
\vdots \\
\left[ F + c_1 + \ldots + c_r \right] \cdot \frac{1}{t_r^0} = \frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0}, \\
\end{array} \right.
\end{equation}
которая может быть совместной только при $t_1^0 = \ldots = t_r^0$.
Однако, если $t_1^0 = \ldots = t_r^0$, то~$F$ должно равняться
нулю. Таким образом, в~рамках заданных условий задачи оптимальное
решение $c^*$ необходимо искать на~границе, задаваемой условием
(\ref{ff5}), т.~е.~$\sum_{i=1}^n (c_i^* - \mathfrak{c}_i) = C$,
а~значит $\omega^* > 0$.

Имея в~виду, что $\omega > 0$, рассмотрим (\ref{ff7}).
Предположим, что существуют индексы $i$, для которых $c_i >
\mathfrak{c}_i$. Без умаления общности будем считать, что это $r$
первых индексов среди $\{ 1, \ldots, n\}$. В~таком случае $c_i >
\mathfrak{c}_i$ для $i=\overline{1,r}$, что в~силу условия
(\ref{ff8}) приводит к~системе
\begin{equation} \nonumber
\left\{
\begin{array}{c}
\left[ F + c_1 + \ldots + c_r \right] \cdot \frac{1}{t_1^0} = \frac{\omega}{F} \cdot \left[\frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0} \right]^2 + \left[\frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0} \right],\\
\vdots \\
\left[ F + c_1 + \ldots + c_r \right] \cdot \frac{1}{t_r^0} = \frac{\omega}{F} \cdot \left[\frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0} \right]^2 + \left[\frac {c_1}{t_1^0} + \ldots + \frac {c_r}{t_r^0} \right], \\
\end{array} \right.
\end{equation}
которая может быть совместной только при $t_1^0 = \ldots = t_r^0$.
Если $t_1^0 = \ldots = t_r^0$, то~получаем
\begin{equation} \nonumber
F = \frac{\omega}{t_1^0 \cdot F} \cdot \left[c_1 + \ldots + c_r
\right]^2,
\end{equation}
при этом $\sum_{i=1}^r c_i = C + \sum_{i=1}^r \mathfrak{c}_i$,
а~значит,
\begin{equation} \nonumber
\omega = t_1^0 \left(\frac{F}{C + \sum_{i=1}^r
\mathfrak{c}_i}\right)^2.
\end{equation}

При этом, согласно (\ref{ff7}), маршруты $i=\overline{1,r}$, для
которых выполняется $c_i > \mathfrak{c}_i$, обладают тем
свойством, что $t_i^0 < t_j^0$, где $j=\overline{r+1,n}$. В~самом
деле, для любого маршрута $j=\overline{r+1,n}$, согласно
(\ref{ff7}), имеем
\begin{equation} \nonumber
F \cdot \frac{ \left[ F + \sum_{s=1}^{n} c_s \right] \cdot
\frac{1}{t_i^0} - \sum_{s=1}^{n} \frac {c_s}{t_s^0}}{\left[
\sum_{s=1}^{n} \frac {c_s}{t_s^0} \right]^2 } = \omega > F \cdot
\frac{ \left[ F + \sum_{s=1}^{n} c_s \right] \cdot \frac{1}{t_j^0}
- \sum_{s=1}^{n} \frac {c_s}{t_s^0}}{\left[ \sum_{s=1}^{n} \frac
{c_s}{t_s^0} \right]^2 },
\end{equation}
что выполняется только при $t_i^0 < t_j^0$. \hfill\square
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\bf Следствие.} {\it Если $|I_0| = 1$, то~решение двухуровневой
оптимизационной задачи} (\ref{fg1})--(\ref{fg6}) {\it единственно.
Если $|I_0| > 1$, то~существует бесконечно много вариантов
изменения пропускной способности маршрутов $c^*$, которым
соответствует один и~тот же вектор $f^*$. При этом любая пара
таких $(f^*, c^*)$ доставляет минимум функции $(\ref{fg1})$ при
ограничениях} (\ref{fg2}), (\ref{fg3}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\begin{proof}
Д\,о\,к\,а\,з\,а\,т\,е\,л\,ь\,с\,т\,в\,о.\, Согласно (\ref{ff1}),
оптимальному вектору $c^*$ соответствуют следующие ненулевые
потоки:
\begin{equation} \label{s1}
f_i^* = \frac{c_i^*}{t_i^0} \frac{F + \sum_{s=1}^{n}
c_s^*}{\sum_{s=1}^{n} \frac{c_s^*}{t_s^0}} - c_i^*, \quad
i=\overline{1,n}.
\end{equation}
При этом в соответствии с теоремой (\ref{s1}) примет вид
\begin{equation} \nonumber
f_i^* = \frac{c_i^*}{t_i^0} \frac{F + \sum_{s \in \{1,\ldots,n\}
\setminus I_0} c_s^* + \sum_{s \in I_0} c_s^*}{\sum_{s \in
\{1,\ldots,n\} \setminus I_0} \frac{c_s^*}{t_s^0} + \sum_{s \in
I_0} \frac{c_s^*}{t_s^0}} - c_i^*,
\end{equation}
что, согласно (\ref{fg8}), приводит к~\begin{equation} \nonumber
f_i^* = \frac{c_i^*}{t_i^0} \frac{F + \sum_{s \in \{1,\ldots,n\}
\setminus I_0} c_s^* + C + \sum_{s \in I_0}
\mathfrak{c}_s}{\sum_{s \in \{1,\ldots,n\} \setminus I_0}
\frac{c_s^*}{t_s^0} + \frac{C + \sum_{s \in I_0}
\mathfrak{c}_s}{t_j^0}} - c_i^*,
\end{equation}
где $j \in I_0$. Таким образом, видно, что изменение значений
$c_i^*$ из~множества $i \in I_0$ при выполнении (\ref{fg8})
не~ведeт к~изменению распределения потока $f^*$. \hfill\square
%\newpage
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\indent {\bf 4. Подготовка управленческих решений в~области
изменения пропускной способности транспортной сети.} Содержательно
доказанная в~п. 3 теорема говорит о~том, что при планировании
ремонтных работ по~увеличению пропускных способностей параллельных
маршрутов между парами районов отправления---прибытия
администрация в~первую очередь должна ориентироваться
на~увеличение пропускной способности кратчайших маршрутов. Именно
это ведет к~минимизации общего времени движения потоков
по~транспортной сети. Строительство объездных дорог или сквозных
коридоров имеет смысл, только когда уже нет возможностей увеличить
пропускную способность существующих улиц или если они создают
дополнительные короткие маршруты (по длине или по~времени).
Подтверждение этим\linebreak\newpage\noindent теоретическим
выводам можно наблюдать на~примере Западного Скоростного Диаметра
(ЗСД), запущенного в~эксплуатацию в~Санкт-Петербурге. ЗСД есть
наглядный пример эффективного, с~точки зрения предложенной теории,
управления пропускной способностью улично-дорожной сети, так как
создает дополнительный короткий маршрут между районами
отправления---прибытия <<Север---Юг>>.

В логике полученных в~данной работе результатов наиболее
эффективным способом увеличения пропускной способности
улично-дорожной сети является увеличение пропускной способности
наиболее коротких маршрутов между районами отправления---прибытия.
В~таком случае одним из~наиболее реальных в~условиях ограниченных
инфраструктурных мощностей города способов увеличения пропускной
способности будет запрет парковать автотранспортные средства
на~протяжении всего кратчайшего пути следования. Другими словами,
необходимо выделить кратчайшие маршруты следования
на~улично-дорожной сети между ключевыми районами
отправления---прибытия и~запретить парковаться вдоль всего
маршрута, а не~отдельных улиц. На рисунке представлена иллюстрация
данного подхода на~примере улично-дорожной сети Санкт-Петербурга.
Выделены 7 экспериментальных пар райо\-нов отправления---прибытия
(с периферий города~--- в~центр): (\textbf{1}, \textbf{8}),
(\textbf{2}, \textbf{8}), (\textbf{3}, \textbf{8}), (\textbf{4},
\textbf{8}), (\textbf{5}, \textbf{8}), (\textbf{6}, \textbf{8}),
(\textbf{7}, \textbf{8}). Кратчайшие маршруты между парами районов
отправления---прибытия выделены жирным. С~точки зрения полученных
теоретических результатов следует в~первую очередь сосредоточиться
на увеличении пропускной способности именно этих маршрутов.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%fig1



\begin{figure}[h!]
\centering{ \vskip 3mm \includegraphics[scale=1]{05/fig1}

\vskip 3mm {\small  Улично-дорожная сеть Санкт-Петербурга}  }
\end{figure}



%\begin{figure}[h]
%\begin{center}
%\includegraphics[width=0.85\linewidth]{routes.eps}
%%\includegraphics[width=0.8\textwidth,natwidth=460,natheight=460]{routes}%
%
%{Улично-дорожная сеть Санкт-Петербурга}
%\end{center}
%\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\indent {\bf 5. Заключение.} В~данной работе была рассмотрена
задача нахождения оптимальной стратегии управления топологией
транспортной сети в~виде задачи двухуровневой оптимизации. Верхний
уровень моделировал процесс принятия решения администрацией при
планировании изменений улично-дорожной сети. Предполагалось, что
администрация стремится минимизировать общее время движения
транспортных потоков. Целевая функция была основана на~втором
принципе Вардропа. Нижний уровень моделировал процесс
распределения транспортных потоков в~зависимости от
инфраструктурных изменений, проводимых администрацией. Считалось,
что каждый участник движения стремится минимизировать свое личное
время движения в~условиях конкурентной маршрутизации транспортных
потоков. Соответствующая задача условной оптимизации базировалась
на первом принципе Вардропа. Получено ее решение для сети
из~параллельных маршрутов при линейной BPR-функции задержки
и~равновесном по~Вардропу распределении транспортных потоков
города в~явном виде. На основе этих теоретических результатов
можно разработать методологические инструменты принятия решений
в~области управления улично-дорожной сетью крупных городов. Их
можно учесть при решении инфраструктурных проблем транспортных
сетей большой размерности.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{05/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{05/ref-s}

%%%%%N DOI в~ссылке!!!!!!!!!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize



\vskip 3mm

%\thispagestyle{empty}



\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %


\noindent Статья рекомендована к~печати проф. Л. А. Петросяном.

\vskip 1mm

\noindent Статья поступила в~редакцию 19 января 2016~г.

\vskip 1mm

\noindent Статья принята к~печати 11 апреля 2017~г.


}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\vskip 5mm

%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak \vskip 3mm

%{\it Балонин Николай Алексеевич}~-- доктор технических наук,
%профессор; e-mail: korbendfs@mail.ru

%{\it Сергеев Михаил Борисович}~-- доктор технических наук,
%профессор,  директор; e-mail: mbse@mail.ru

%\vskip 2mm

%\emph{Balonin Nikolaj Alekseevich}~-- doctor of technical
%sciences, professor; e-mail: korbendfs@mail.ru


%\emph{Sergeev Mikhail Borisovich}~-- doctor of technical sciences,
%director; e-mail: mbse@mail.ru


%}


%\thispagestyle{empty}
