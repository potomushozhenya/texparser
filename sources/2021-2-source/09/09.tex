
\noindent{\small УДК 517.977.1  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\
MSC 93C10, 93C35

}

\vskip3mm

\noindent{\bf Метод преобразования сложных систем автоматического управления\\ к~интегрируемой форме %$^{*}$%
 }

\vskip3mm

\noindent{\it А.~М.~Камачкин, Д.~К.~Потапов, В.~В.~Евстафьева %$^{2}$%
%, И.~О. Фамилия%$^{1,4}$%
}

\efootnote{
%%
%\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Исследование выполнено при финансовой%
%поддержке Российского научного фонда (проект №~19-11-00223).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize



\noindent%
%$^1$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:} \textit{Камачкин А.~М., Потапов Д.~К., Евстафьева В.~В.} Метод преобразования сложных систем автоматического управления
к интегрируемой форме~// Вестник Санкт-Пе\-тер\-бург\-ского университета.
Прикладная математика. Информатика. Процессы управления.
\issueyear. Т.~17. Вып.~\issuenum.
С.~\pageref{p9}--\pageref{p9e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum09

\vskip3mm

{\leftskip=7mm\noindentРассматриваемый класс систем автоматического управления описывается многомерной системой обыкновенных дифференциальных уравнений, правая часть которой аддитивно состоит из линейной части и~произведения матрицы управления на вектор, представленный суммой вектора управления и~вектора внешнего возмущения. Вектор управления задается нелинейной функцией, зависящей от произведения матрицы обратной связи и~вектора текущих координат системы. Решается задача конструирования матрицы неособого преобразования, которое матрицу линейной части системы приводит к~жордановой нормальной форме или к~первой естественной нормальной форме. Переменные величины, входящие в~преобразование, позволяют варьировать параметры настройки системы, к~которым относят параметры матрицы управления и~матрицы обратной связи, и~приводить систему к~интегрируемой форме. Под последней понимаем такую форму, при которой система может быть проинтегрирована в~конечном виде или сведена к~совокупности подсистем более низких порядков, при этом сумма порядков подсистем равна порядку исходной системы. Особое внимание уделено случаям, когда матрица линейной части имеет комплексно сопряженные собственные числа, в~том числе кратные.\\[1mm]
\textit{Ключевые слова}: система автоматического управления, многомерная нелинейная динамическая система, неособое преобразование, жорданова нормальная форма матрицы, первая естественная нормальная форма матрицы, интегрируемая форма системы.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\bf  1. Введение.}
По мере развития инженерной практики создания систем автоматического регулирования возрастали проблемы теории автоматического управления,
связанные с~вопросами определения динамического поведения таких систем. Естественным образом появилась идея использовать канонические преобразования
для линейных частей многомерных систем. Впервые такое преобразование предложил в~1951~г. А.~И.~Лурье~[1], что
послужило стимулом исследований на эту тему (см., например,~[2]). Первый итог этих усилий подвел А.~М.~Летов~[3]. Однако
оставались нерешенными многие вопросы, работа над которыми привела к~разработке новых подходов и~созданию метода редукции пространства параметров~[4] и~метода сечений пространства
параметров~[5, 6]. Цель данных подходов заключается в~декомпозиции многомерной системы на
подсистемы меньшей размерности, которые могут быть проинтегрированы в~конечном виде или, по крайней мере, изучены до конца.
В таких подходах используют алгебраические методы, которые основываются на приведении матрицы линейной части системы к~жордановой форме, когда
эта матрица имеет, как правило, вещественные различные собственные числа, или собственным числам матрицы отвечает ящик Жордана низкой
размерности. Анализ публикаций иностранных ученых (см.~[7]) показал, что они работали в~тех же направлениях и~использовали такие же алгебраические
методы, но избегали рассмотрения случаев, когда собственные числа комплексно сопряженные.
В настоящей работе устранен данный пробел для одного класса систем автоматического управления и~охарактеризованы случаи комплексно сопряженных
собственных чисел, в~том числе кратных.

{\bf  2. Постановка задачи.}
Математическая модель системы автоматического управления описывается системой обыкновенных дифференциальных уравнений
\begin{equation}
\dot x(t)=Ax(t)+B(N(y(t))+\psi(t)),\quad
y(t)=Cx(t)
\label{f1}
\end{equation}
с начальным условием~$x(0)=x_0$.
Здесь $A$, $B$ и~$C$~--- вещественные матрицы размерностей $n\times n$, $n\times m$ и~$m\times n$ соответственно; $x(t)$, $\dot x(t)$ и~$y(t)$~---
векторы переменных размерностей $n\times 1$, $n\times 1$ и~$m\times 1$ соответственно, причем $n\geq m$; $\psi(t)$~--- вектор внешнего возмущающего воздействия
размерности $m\times 1$. Нелинейная часть системы~(\ref{f1})~--- это вектор управления $u=N(y(t))$, т.~е. вектор $N(y(t))$ нелинейных функций размерности~$m\times 1$.
Считаем, что элементы матрицы~$A$ определены, т.~е. матрица~$A$ описы\-вает инерционные свойства объекта, а~элементы матриц~$B$ и~$C$ являются
параметрами настройки и~могут изменяться в~задаваемых диапазонах для придания системе тре\-буемых свойств.

При исследовании систем вида~(\ref{f1}) важно хотя бы для некоторых сочетаний элементов матриц~$A$, $B$ и~$C$ иметь достоверные сведения о
динамическом поведении объекта, характеризуемого системой~(\ref{f1}). Такое поведение описывается решением системы~(\ref{f1}), но получить в
аналитическом виде такое решение, как правило, не удает\-ся. Численный анализ также непрост и~при определенных условиях может приводить к~недостоверным результатам.
Действительно, динамика линейной части системы~(\ref{f1}) определяется постоянной матрицей~$A$, но даже в~системе $\dot x(t)=Ax(t)$ могут
существовать почти периодические колебания, если у матрицы~$A$ есть несколько чисто мнимых собственных чисел, среди которых и
несоизмеримые~[8]. Кроме того, в~правую часть системы~(\ref{f1}) аддитивно входит нелинейная функция $N(y(t))$, которая может быть
неоднозначной~[9] и~в~фазовом пространстве иметь поверхности переключения. Желательно, чтобы поверхности были поверхностями
без контакта~[10], что не всегда выполнимо, поскольку на выход нелинейного элемента действует внешнее возмущающее воздействие.
Все эти особенности делают численный анализ сложным и~требуют дополнительных исследований.

Ставится задача построения неособого преобразования системы~(\ref{f1}), чтобы ее решение можно было получить аналитически для наиболее
широкого множества параметров, входящих в~матрицы~$B$ и~$C$ как элементы. Преобразование будем искать алгебраическими методами. Пусть
матрица~$A$ имеет комплексные собственные числа, в~том числе кратные. Считаем, что такой подход облегчает в~том числе и~численный анализ
систем вида~(\ref{f1}), поскольку применим для изучения робастности системы~(\ref{f1}). Действительно, нам становятся
известны множества элементов матриц~$B$ и~$C$, при которых динамика системы полностью обозримая. Дополнения этих множеств могут
быть предметом дальнейшего численного исследования. Если принимать во внимание декомпозицию системы~[7, 11--13],
то подсистемы низких порядков, как правило, позволяют охарактеризовать динамику систем полностью~[14--24].

{\bf 3. Преобразование системы.}
Известно, что неособым преобразованием $x(t)=Tz(t)$ исходная система~(\ref{f1}) приводится к~эквивалентной системе относительно $z(t)$, т.~е.
\begin{equation}
\dot z(t)=A_Tz(t)+B_T(N(y(t))+\psi(t)),\quad
y(t)=C_Tz(t)
\label{f2}
\end{equation}
с начальным условием $z(0)=T^{-1}x_0$, в~которой $A_T=T^{-1}AT$, $B_T=T^{-1}B$, $C_T=CT$.

Неособая матрица $T$ канонического преобразования, приводящего матрицу~$A$ к~первой естественной нормальной или
жордановой форме, определяется неоднозначно~[25].
Если приравнять к~нулю конкретные элементы матриц $B_T$ и~$C_T$, то можно получить расщепление системы~(\ref{f2}) на
подсистемы низкой размерности, каждая из которых допускает аналитическое исследование. Матрицы $B_T$ и~$C_T$
зависят от матрицы~$T$, поэтому можно подобрать~$T$ таким образом, чтобы
преобразование приводило систему~(\ref{f1}) к~системе~(\ref{f2}) с~наперед заданными свойствами. Пусть
$T=SQ$, где $S$~--- некоторая неособая матрица такая, что $S^{-1}AS=A_T$, а~$Q$~--- матрица, элементы которой являются параметрами.
Матрица~$Q$ задает неоднозначность выбора матрицы~$T$, должна быть невырожденной и~удовлетворять
равенству $A_TQ=QA_T$ (см.~[13]).
Итак,~$Q$ может быть любой невырожденной матрицей, перестановочной с~матрицей~$A_T$. Элементы матрицы~$Q$
можно использовать как переменные множители в~элементах матриц~$B_T$ и~$C_T$, при этом
сохраняется условие~$\det Q\neq 0$.

Таким образом, задача состоит в~том, чтобы построить матрицы~$Q$ и~$Q^{-1}$ так, чтобы воспользоваться
преимуществами приведения к~системе~(\ref{f2}) с~матрицами $A_T=A_j$ или $A_T=A_n$, в~которой
$A_j$~--- матрица в~жордановой форме, $A_n$~--- матрица в~первой естественной нормальной форме.
В первом случае~$T=SQ$, во втором случае $T=SQ_n$,
где $S$ и~$Q_n$~--- невырожденные матрицы такие, что $S^{-1}AS=A_n$ и~$Q^{-1}_nA_nQ_n=A_n$.
Для того чтобы различать эти случаи, если $A_T=A_j$, будем обозначать $M=SQ$ (т.~е.~$T=M$), где $S$ состоит из
собственных и~дополнительных векторов матрицы~$A$. Кроме того, $B_T=\overline{B_M}=Q^{-1}S^{-1}B=Q^{-1}B_M$ и~$C_T=\overline{C_M}=CSQ=C_MQ$.

{\bf 4. Случай жордановой нормальной формы.}
Пусть матрица $A$ имеет $q$ пар комплексно сопряженных собственных чисел и, следовательно, $n-2q$ вещественных
собственных чисел. Тогда полученная из нее матрица $A_j$ блочно-диагональная:
$$
\left({\begin{matrix}A_{jC}  &\displaystyle 0\cr
0  &\displaystyle A_{jR}\cr
\end{matrix}}\right).
$$
Перестановочная с~ней матрица $Q$ также будет блочно-диагональной:
$$
\left({\begin{matrix}Q_C  &\displaystyle 0\cr
0  &\displaystyle Q_R\cr
\end{matrix}}\right).
$$
При этом матрица $Q_C$ будет перестановочной с~матрицей~$A_{jC}$, а~матрица $Q_R$~--- с~матрицей~$A_{jR}$.

Рассмотрим матрицу $A_{jC}$, четный порядок которой~$2q$.
На главной диагонали такой матрицы расположены~$q$ блоков
второго порядка вида
$\left({\begin{matrix}\mu  &\displaystyle -\gamma\cr
\gamma  &\displaystyle \mu\cr
\end{matrix}}\right)$,
соот\-ветст\-вую\-щих комплексно сопряженным собственным числам $\mu\pm i\gamma$. Кроме того, если среди чисел
$\mu\pm i\gamma$ есть кратные, например кратности $\rho$, то порядок соот\-ветст\-вую\-щей им подматрицы матрицы $A_{jC}$
$2\rho\times 2\rho$, на ее главной диагонали стоят указанные блоки второго порядка, а~над нею~---
блоки второго порядка
вида~$I_2=
\left({\begin{matrix}1  &\displaystyle 0\cr
0  &\displaystyle 1\cr
\end{matrix}}\right)$.
Выясним, как строятся матрицы~$Q$ и~$Q^{-1}$.

Рассмотрим матрицу
$$
A_{jC}=
\left({\begin{matrix}\Theta_1  &\displaystyle 0 &\displaystyle \dots &\displaystyle 0\cr
0  &\displaystyle \Theta_2 &\displaystyle \dots &\displaystyle 0\cr
\dots  &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots\cr
0  &\displaystyle 0 &\displaystyle \dots &\displaystyle \Theta_k\cr
\end{matrix}}\right),
$$
где~$\Theta_i$~--- блочные матрицы порядка~$r_i$, а~$\sum\limits_{i=1}^k r_i$~--- число пар комплексно сопряженных чисел с~учетом кратности
этих пар. Тогда матрица
$$
Q_C=
\left({\begin{matrix}Q_1  &\displaystyle 0 &\displaystyle \dots &\displaystyle 0\cr
0  &\displaystyle Q_2 &\displaystyle \dots &\displaystyle 0\cr
\dots  &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots\cr
0  &\displaystyle 0 &\displaystyle \dots &\displaystyle Q_k\cr
\end{matrix}}\right),
$$
здесь матрицы~$Q_i$ также являются блочными матрицами размерности блоков $\Theta_i$ ($i=\overline{1,k}$).
Блоки~$\Theta_i$ могут быть двух типов.

К первому типу отнесем блок
\begin{equation}
\Theta_i=
\left({\begin{matrix}\mu_j  &\displaystyle -\gamma_j\cr
\gamma_j  &\displaystyle \mu_j\cr
\end{matrix}}\right),
\label{f6}
\end{equation}
соответствующий некратной паре собственных чисел $\mu_j\pm i\gamma_j$. Тогда~$\Theta_i$ отвечает блок
$Q_i=
\left({\begin{matrix}q_{11}  &\displaystyle q_{12}\cr
q_{21}  &\displaystyle q_{22}\cr
\end{matrix}}\right)$,
удовлетворяющий равенству~$\Theta_iQ_i=Q_i\Theta_i$.
Очевидно, можно положить, что $q_{11}=q_{22}=\nu$, $q_{12}=-\xi$, $q_{21}=\xi$, где~$\nu$ и~$\xi$~--- произвольные вещественные числа
такие, что $\nu^2+\xi^2\neq 0$. Тогда матрица
\begin{equation}
Q_i=
\left({\begin{matrix}\nu  &\displaystyle -\xi\cr
\xi  &\displaystyle \nu\cr
\end{matrix}}\right)
\label{f8}
\end{equation}
коммутативна с~блоком $\Theta_i$ и матрица
\begin{equation}
Q_i^{-1}=\dfrac{1}{\nu^2+\xi^2}
\left({\begin{matrix}\nu  &\displaystyle \xi\cr
-\xi  &\displaystyle \nu\cr
\end{matrix}}\right).
\label{f9}
\end{equation}
На параметры $\nu$ и~$\xi$ не накладываются дополнительные ограничения, кроме $\nu^2+$\linebreak $\xi^2\neq 0$. Для блока~$\Theta_i$
первого типа найдены матрицы $Q_i$ и~$Q_i^{-1}$.

Блоки второго типа имеют вид
\begin{equation}
\Theta_i=
\left({\begin{matrix}\Phi  &\displaystyle I_2 &\displaystyle 0 &\displaystyle \dots &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle \Phi &\displaystyle I_2 &\displaystyle \dots &\displaystyle 0 &\displaystyle 0\cr
\dots  &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots\cr
0 &\displaystyle 0 &\displaystyle 0 &\displaystyle \dots &\displaystyle \Phi &\displaystyle I_2\cr
0 &\displaystyle 0 &\displaystyle 0 &\displaystyle \dots &\displaystyle 0 &\displaystyle \Phi\cr
\end{matrix}}\right).
\label{f10}
\end{equation}
Здесь
$\Phi=
\left({\begin{matrix}\mu_j  &\displaystyle -\gamma_j\cr
\gamma_j  &\displaystyle \mu_j\cr
\end{matrix}}\right)$,
где $j$~--- номер соответствующей кратной пары собственных чисел~$\mu_j\pm i\gamma_j$. При этом, если кратность данной пары равна~$\rho$,
то размерность матрицы~$\Theta_i$ есть~$2\rho\times 2\rho$. Для восстановления блоков матрицы $Q_C$, соответствующих блочным матрицам $\Theta_i$
вида~(\ref{f10}), поставим матрицу вида $I_\Phi+H$, в~которой
$I_\Phi$~--- блочно-диагональная матрица с~блоками~$I_2$ на главной диагонали,
$H$~--- блочная матрица с~наддиагональю, состоящей из единичных матриц второго порядка, а~все остальные блоки~--- нулевые, т.~е.
$$
H=
\left({\begin{matrix}0  &\displaystyle I_2 &\displaystyle 0 &\displaystyle \dots &\displaystyle 0\cr
0  &\displaystyle 0 &\displaystyle I_2 &\displaystyle \dots &\displaystyle 0\cr
\dots  &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots &\displaystyle \dots\cr
0 &\displaystyle 0 &\displaystyle 0 &\displaystyle \dots  &\displaystyle I_2\cr
0 &\displaystyle 0 &\displaystyle 0 &\displaystyle \dots &\displaystyle 0\cr
\end{matrix}}\right).
$$
Тогда блок $Q_i$ имеет вид
\begin{equation}
Q_i=\alpha_0I_\Phi+\alpha_1H+\alpha_2H^2+\dots +\alpha_{\rho-1}H^{\rho-1},
\label{f13}
\end{equation}
где $\alpha_0$, $\alpha_1$, $\alpha_2$, $\dots,$ $ \alpha_{\rho-1}$~--- ненулевые параметры. Коммутативность матриц $\Theta_i$ и~$Q_i$ при их
умножении не вызывает сомнений. Следовательно, матрицы $A_{jC}$ и~$Q_C$ (с блоками~(\ref{f6}) и~(\ref{f10})) коммутируют
между собой.

Обратная матрица~$Q_i^{-1}$ находится из равенства $Q_iQ_i^{-1}=I$ ($I$~--- единичная матрица соответствующего порядка):
\begin{equation}
Q_i^{-1}=\beta_0I_\Phi+\beta_1H+\dots +\beta_{\rho-1}H^{\rho-1},
\label{f14}
\end{equation}
а коэффициенты $\beta_0$, $\beta_1$, $\dots,$ $ \beta_{\rho-1}$ выражаются через выбранные значения параметров
$\alpha_0$, $\alpha_1$, $\dots,$ $\alpha_{\rho-1}$.

Рассмотрим примеры с~преобразованием~$T=SQ$, где~$Q$~--- параметрическая матрица.

{\bf Пример 1.} Матрица
$$
A=
\left({\begin{matrix}-3  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle -2 &\displaystyle 2\cr
0  &\displaystyle -1 &\displaystyle 0\cr
\end{matrix}}\right)
$$
имеет собственные числа $\lambda_1=-3$, $\lambda_{2,3}=-1\pm i$. Тогда
$$
A_j=
\left({\begin{matrix}-3  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle -1 &\displaystyle -1\cr
0  &\displaystyle 1 &\displaystyle -1\cr
\end{matrix}}\right)
$$
и $A_j=S^{-1}AS$. Обозначим
$A_j^0=
\left({\begin{matrix}-1  &\displaystyle -1\cr
1 &\displaystyle -1\cr
\end{matrix}}\right)$.
Из равенства $SA_j=AS$ получаем матрицу
$$
S=
\left({\begin{matrix}1  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle 0 &\displaystyle 2\cr
0  &\displaystyle 1 &\displaystyle 1\cr
\end{matrix}}\right),
$$
откуда имеем, что
$$
S^{-1}=
\left({\begin{matrix}1  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle -1/2 &\displaystyle 1\cr
0  &\displaystyle 1/2 &\displaystyle 0\cr
\end{matrix}}\right).
$$
В рассматриваемом примере есть только одна пара комплексно сопряженных собственных чисел, поэтому конструкция матрицы~$Q$, перестановочной с
матрицей~$A_j$, предстанет в виде~$\left({\begin{matrix}\alpha  &\displaystyle 0\cr
0  &\displaystyle \alpha_0I_2\cr
\end{matrix}}\right)$,
где $\alpha\neq 0$, $\alpha_0\neq 0$, блок $\alpha_0I_2$ отвечает матрице~$A_j^0$. Тогда
$$
Q^{-1}=
\left({\begin{matrix}1/\alpha  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle 1/\alpha_0 &\displaystyle 0\cr
0  &\displaystyle 0 &\displaystyle 1/\alpha_0\cr
\end{matrix}}\right).
$$
Далее применим второй способ получения~$Q$, т.~е.
$$
Q=
\left({\begin{matrix}\alpha  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle \nu &\displaystyle -\xi\cr
0  &\displaystyle \xi &\displaystyle \nu\cr
\end{matrix}}\right),
$$
где $\nu$, $\xi$~--- произвольные вещественные числа такие, что $\nu^2+\xi^2\neq 0$. Матрица
$Q_0=
\left({\begin{matrix}\nu &\displaystyle -\xi\cr
\xi &\displaystyle \nu\cr
\end{matrix}}\right)$
коммутирует с~матрицей $A_j^0$ и
$Q_0^{-1}=\dfrac{1}{\nu^2+\xi^2}
\left({\begin{matrix}\nu &\displaystyle \xi\cr
-\xi &\displaystyle \nu\cr
\end{matrix}}\right)$.
Пусть матрица $B$ имеет элементы $b_{ij}$ ($i=\overline{1,3}$, $j=1,2$).
Тогда
$$
B_M=S^{-1}B=
\left({\begin{matrix}b_{11} &\displaystyle b_{12}\cr
-b_{21}/2+b_{31} &\displaystyle -b_{22}/2+b_{32}\cr
b_{21}/2 &\displaystyle b_{22}/2\cr
\end{matrix}}\right),
$$
$$
\overline{B_M}=Q^{-1}B_M=
$$
$$
=\left({\begin{matrix}b_{11}/\alpha &\displaystyle b_{12}/\alpha\cr
\dfrac{1}{\nu^2+\xi^2}(\nu(-b_{21}/2+b_{31})+\xi b_{21}/2) &\displaystyle \frac{1}{\nu^2+\xi^2}(\nu(-b_{22}/2+b_{32})+\xi b_{22}/2)\cr
\dfrac{1}{\nu^2+\xi^2}(-\xi(-b_{21}/2+b_{31})+\nu b_{21}/2) &\displaystyle \frac{1}{\nu^2+\xi^2}(-\xi(-b_{22}/2+b_{32})+\nu b_{22}/2)\cr
\end{matrix}}\right)=
$$
$$
=\left({\begin{matrix}b_{11}/\alpha &\displaystyle b_{12}/\alpha\cr
\dfrac{1}{\nu^2+\xi^2}((\xi-\nu)b_{21}/2+\nu b_{31}) &\displaystyle \frac{1}{\nu^2+\xi^2}((\xi-\nu)b_{22}/2+\nu b_{32})\cr
\dfrac{1}{\nu^2+\xi^2}((\xi+\nu)b_{21}/2-\xi b_{31}) &\displaystyle \frac{1}{\nu^2+\xi^2}((\xi+\nu)b_{22}/2-\xi b_{32})\cr
\end{matrix}}\right).
$$
Рассмотрим
$$
C_M=CS=
\left({\begin{matrix}c_{11}  &\displaystyle c_{12} &\displaystyle c_{13}\cr
c_{21}  &\displaystyle c_{22} &\displaystyle c_{23}\cr
\end{matrix}}\right)
\left({\begin{matrix}1  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle 0 &\displaystyle 2\cr
0  &\displaystyle 1 &\displaystyle 1\cr
\end{matrix}}\right)=
\left({\begin{matrix}c_{11}  &\displaystyle c_{13} &\displaystyle 2c_{12}+c_{13}\cr
c_{21}  &\displaystyle c_{23} &\displaystyle 2c_{22}+c_{23}\cr
\end{matrix}}\right).
$$
Затем имеем
$$
\overline{C_M}=C_MQ=\left({\begin{matrix}c_{11}  &\displaystyle c_{13} &\displaystyle 2c_{12}+c_{13}\cr
c_{21}  &\displaystyle c_{23} &\displaystyle 2c_{22}+c_{23}\cr
\end{matrix}}\right)
\left({\begin{matrix}\alpha  &\displaystyle 0 &\displaystyle 0\cr
0  &\displaystyle \nu &\displaystyle -\xi\cr
0  &\displaystyle \xi &\displaystyle \nu\cr
\end{matrix}}\right)=
$$
$$
=\left({\begin{matrix}\alpha c_{11}  &\displaystyle \nu c_{13}+\xi(2c_{12}+c_{13}) &\displaystyle -\xi c_{13}+\nu (2c_{12}+c_{13})\cr
\alpha c_{21}  &\displaystyle \nu c_{23}+\xi(2c_{22}+c_{23}) &\displaystyle -\xi c_{23}+\nu(2c_{22}+c_{23})\cr
\end{matrix}}\right).
$$
Пусть
$$
B_M=\left({\begin{matrix}1  &\displaystyle 1\cr
0  &\displaystyle 0\cr
0  &\displaystyle 0\cr
\end{matrix}}\right).
$$
Тогда $b_{11}=b_{12}=1$, $b_{21}=b_{22}=b_{31}=b_{32}=0$. Если $\overline{B_M}=B_M$, то
$b_{11}=b_{12}=\alpha$, а~остальные элементы нулевые. Пусть теперь
$$
B_M=\left({\begin{matrix}1  &\displaystyle 1\cr
1  &\displaystyle 0\cr
0  &\displaystyle 1\cr
\end{matrix}}\right),
$$
тогда $b_{11}=b_{12}=1$, $b_{21}=0$, $b_{22}=2$, $b_{31}=b_{32}=1$. Если~$\overline{B_M}=B_M$, то получаем элементы
\begin{equation}
b_{11}=\alpha,\; b_{12}=\alpha,\; b_{21}=2\xi,\; b_{22}=2\nu,\; b_{31}=\xi+\nu,\; b_{32}=\nu-\xi,
\label{f15}
\end{equation}
где $\xi$, $\nu$~--- произвольные вещественные числа такие, что $\xi^2+\nu^2\neq 0$. Параметры $\xi$ и~$\nu$ существенно расширяют выбор
элементов матрицы~$B$. Перейдем к~выбору матрицы~$C$ по матрицам $C_M$ и~$\overline{C_M}$. Пусть
$C_M=\left({\begin{matrix}1  &\displaystyle 0 &\displaystyle 0\cr
1  &\displaystyle 0 &\displaystyle 0\cr
\end{matrix}}\right)$.
Тогда $c_{11}=1$, $c_{12}=0$, $c_{13}=0$, $c_{21}=1$, $c_{22}=0$ и~$c_{23}=0$.
Положим теперь, что~$\overline{C_M}=C_M$. Тогда набор  составляют элементы
\begin{equation}
c_{11}=\alpha^{-1},\; c_{12}=0,\; c_{13}=0,\; c_{21}=\alpha^{-1},\; c_{22}=0,\; c_{23}=0.
\label{f16}
\end{equation}
После введения параметрической матрицы $Q$ стало возможным получение заданной~$\overline{C_M}$ с~использованием параметра~$\alpha$. При этом наборы элементов~(\ref{f15})
и (\ref{f16}) матриц $B$ и~$C$ по выбору значений параметров $\alpha$, $\nu$ и~$\xi$ должны быть согласованы.

{\bf Пример 2.} Пусть матрица $A$ размерности $4\times 4$ имеет две одинаковые пары комплексно сопряженных собственных
чисел вида $\mu\pm i\gamma$. Тогда существует неособая матрица~$S$ такая, что
\begin{equation}
A_j=A_{jC}=S^{-1}AS=
\left({\begin{matrix}\mu  &\displaystyle -\gamma &\displaystyle 1 &\displaystyle 0\cr
\gamma  &\displaystyle \mu &\displaystyle 0 &\displaystyle 1\cr
0  &\displaystyle 0 &\displaystyle \mu &\displaystyle -\gamma\cr
0  &\displaystyle 0 &\displaystyle \gamma &\displaystyle \mu\cr
\end{matrix}}\right).
\label{f17}
\end{equation}

Рассмотрим два способа введения параметров в~преобразование системы. В первом матрица~(\ref{f17}) относится ко второму типу матриц~$\Theta_i$,
поэтому в~качестве~$Q_i$ выбираем матрицу по формуле~(\ref{f13}). Поскольку~$\rho=2$, имеем матрицу
\begin{equation}
Q_i=\alpha_0 \left({\begin{matrix}I_2  &\displaystyle 0\cr
0  &\displaystyle I_2\cr
\end{matrix}}\right)+\alpha_1 \left({\begin{matrix}0  &\displaystyle I_2\cr
0  &\displaystyle 0\cr
\end{matrix}}\right)
\label{f18}
\end{equation}
с параметрами $\alpha_0$, $\alpha_1$ такими, что $\alpha_0\neq 0$ и~$\alpha_1\neq 0$. Согласно~(\ref{f14}), получаем
$
Q_i^{-1}=\beta_0 \left({\begin{matrix}I_2  &\displaystyle 0\cr
0  &\displaystyle I_2\cr
\end{matrix}}\right)+\beta_1 \left({\begin{matrix}0  &\displaystyle I_2\cr
0  &\displaystyle 0\cr
\end{matrix}}\right)$.
Коэффициенты $\beta_0$ и~$\beta_1$ находим из равенства $Q_iQ_i^{-1}=I$, в~котором~$I$~--- единичная матрица размерности~$4\times 4$. Так,
$\beta_0=1/\alpha_0$ и~$\beta_1=-\alpha_1/\alpha_0^2$. При таком выборе $Q_i$ имеем параметры $\alpha_0$ и~$\alpha_1$.

Рассмотрим второй способ. Пусть
$A_{jC}=\left({\begin{matrix}\Phi  &\displaystyle I_2\cr
0  &\displaystyle \Phi\cr
\end{matrix}}\right)$.
Выберем матрицу
$Q=\left({\begin{matrix}q_{11}  &\displaystyle q_{12}\cr
q_{21}  &\displaystyle q_{22}\cr
\end{matrix}}\right)$
так, чтобы она коммутировала с~матрицей~$\Phi$. Как $Q$ можно выбрать матрицу
$\left({\begin{matrix}\nu  &\displaystyle -\xi\cr
\xi  &\displaystyle \nu\cr
\end{matrix}}\right)$,
где $\nu$ и~$\xi$~--- произвольные вещественные числа, удовлетворяющие условию $\nu^2+\xi^2\neq 0$. Итак, сначала поступаем так же, как в~случае,
когда~$\Theta_i=\Phi$. Затем получаем в~блочном виде~$Q_i=\left({\begin{matrix}Q  &\displaystyle I_2\cr
0  &\displaystyle Q\cr
\end{matrix}}\right)$.
Тогда матрица $Q_i$ зависит от параметров $\nu$ и~$\xi$. При этом матрица
\begin{equation}
Q_i^{-1}=\left({\begin{matrix}Q^{-1}  &\displaystyle \Lambda\cr
0  &\displaystyle Q^{-1}\cr
\end{matrix}}\right),
\label{f20}
\end{equation}
здесь
\begin{equation}
Q^{-1}=\dfrac{1}{\nu^2+\xi^2}\left({\begin{matrix}\nu  &\displaystyle \xi\cr
-\xi  &\displaystyle \nu\cr
\end{matrix}}\right),\quad
\Lambda=\frac{1}{(\nu^2+\xi^2)^2}\left({\begin{matrix}\xi^2-\nu^2  &\displaystyle -2\nu\xi\cr
2\nu\xi  &\displaystyle \xi^2-\nu^2\cr
\end{matrix}}\right).
\label{f21}
\end{equation}
В матрице $Q_i$ элементы двух блоков зависят от $\nu$ и~$\xi$, а~в~соответствующей ей обратной матрице $Q_i^{-1}$,
согласно~(\ref{f20}) и~(\ref{f21}), элементы трех блоков зависят от $\nu$ и~$\xi$.
Покажем, как меняются матрицы $B$ и~$C$ после приведения матрицы $A$
к виду~(\ref{f17}). Имеем неособую матрицу~$S$ размерности $4\times 4$. Для простоты выкладок рассмотрим
матрицу $B$ размерности $4\times 1$ и~матрицу $C$ размерности $1\times 4$. Если $T=M=SQ$, то
$B_T=\overline{B_M}=Q^{-1}S^{-1}B=Q^{-1}B_M$. Если матрица $S$ известна, то нетрудно найти матрицу~$S^{-1}$.
Тогда вектор
\begin{equation}
B_M=S^{-1}B.
\label{f22}
\end{equation}
Если элементы вектора $B$~--- это параметры настройки, т.~е. их можно менять в~определенных диапазонах, то, задав желаемый после преобразования
исходной системы вектор $B_M$, получаем линейную систему уравнений~(\ref{f22}) относительно элементов вектора~$B$. Покажем, как расширяет
возможности введение параметрической матрицы~$Q$.
В системе~(\ref{f22}) обозначим $B_M=(b_1^M,b_2^M,b_3^M,b_4^M)^*$, где~$*$~--- символ операции траспонирования.
Возьмем сначала матрицу~$Q_i$ типа~(\ref{f18}). Имеем матрицу
$$
Q_i^{-1}=\left({\begin{matrix}\dfrac1\alpha_0  &\displaystyle 0 &\displaystyle -\dfrac{\alpha_1}{\alpha_0^2} &\displaystyle 0\cr
0  &\displaystyle \dfrac1\alpha_0 &\displaystyle 0 &\displaystyle -\dfrac{\alpha_1}{\alpha_0^2}\cr
0  &\displaystyle 0 &\displaystyle \dfrac1\alpha_0 &\displaystyle 0\cr
0  &\displaystyle 0 &\displaystyle 0 &\displaystyle \dfrac1\alpha_0\cr
\end{matrix}}\right),
$$
откуда
\begin{equation}
\overline{B_M}=Q_i^{-1}B_M=\left({\begin{matrix}\alpha_0^{-1} b_1^M-\alpha_1\alpha_0^{-2}b_3^M\cr
\alpha_0^{-1} b_2^M-\alpha_1\alpha_0^{-2}b_4^M\cr
\alpha_0^{-1} b_3^M\cr
\alpha_0^{-1} b_4^M\cr
\end{matrix}}\right).
\label{f24}
\end{equation}
Допустим, необходимо получить $B_T=(0,0,1,0)^*$ и~$C_T=(0,0,0,1)$. Тогда при $\mu=0$ исходная система с
матрицей~(\ref{f17}) интегрируется в~конечном виде, т.~е. $B_T=B_M$ или $B_T=\overline{B_M}$. Если $B_T=B_M$, то~(\ref{f22})~---
это система четырех уравнений
\begin{equation}
b_1^M=0,\; b_2^M=0,\; b_3^M=1,\; b_4^M=0
\label{f25}
\end{equation}
и с~матрицей~$S^{-1}$. Если $B_T=\overline{B_M}$, то вместо системы~(\ref{f25}) в~силу~(\ref{f24}) находим систему
\begin{equation}
\left\{
\begin{array}{l}
\alpha_0^{-1}b_1^M-\alpha_1\alpha_0^{-2}b_3^M=0,\\[6pt]
\alpha_0^{-1}b_2^M-\alpha_1\alpha_0^{-2}b_4^M=0,\\[6pt]
\alpha_0^{-1}b_3^M=1,\\[6pt]
\alpha_0^{-1}b_4^M=0,
\end{array}
\right.
\label{f26}
\end{equation}
где $\alpha_0$, $\alpha_1$~--- произвольные вещественные числа, отличные от нуля. Система~(\ref{f26}) приводится к~виду
\begin{equation}
b_1^M=\alpha_1,\; b_2^M=0,\; b_3^M=\alpha_0,\; b_4^M=0.
\label{f27}
\end{equation}
Очевидно, что система~(\ref{f27}) за счет параметров $\alpha_0$, $\alpha_1$ имеет расширенное множество решений относительно элементов вектора~$B$ по сравнению с~системой~(\ref{f25}).

Если решение системы~(\ref{f27}) не подходит, то можно воспользоваться вторым способом построения~$Q_i$.
Согласно~(\ref{f20}) и~(\ref{f21}), имеем
$$
Q_i^{-1}=\frac{1}{\nu^2+\xi^2}\left({\begin{matrix}\nu  &\displaystyle \xi &\displaystyle \frac{\xi^2-\nu^2}{\nu^2+\xi^2} &\displaystyle \frac{-2\nu\xi}{\nu^2+\xi^2}\cr
-\xi  &\displaystyle \nu &\displaystyle \frac{2\nu\xi}{\nu^2+\xi^2} &\displaystyle \frac{\xi^2-\nu^2}{\nu^2+\xi^2}\cr
0  &\displaystyle 0 &\displaystyle \nu &\displaystyle \xi\cr
0  &\displaystyle 0 &\displaystyle -\xi &\displaystyle \nu\cr
\end{matrix}}\right).
$$
Полагаем~$\overline{B_M}$, как в~системе~(\ref{f26}). Тогда приходим к~системе
\begin{equation}
\left\{
\begin{array}{l}
\nu b_1^M+\xi b_2^M+\dfrac{\xi^2-\nu^2}{\xi^2+\nu^2}b_3^M-\dfrac{2\nu\xi}{\xi^2+\nu^2}b_4^M=0,\\[6pt]
-\xi b_1^M+\nu b_2^M+\dfrac{2\nu\xi}{\xi^2+\nu^2}b_3^M+\dfrac{\xi^2-\nu^2}{\xi^2+\nu^2}b_4^M=0,\\[6pt]
\nu b_3^M+\xi b_4^M=\xi^2+\nu^2,\\[6pt]
-\xi b_3^M+\nu b_4^M=0,
\end{array}
\right.
\label{f29}
\end{equation}
в которой параметры $\xi$ и~$\nu$ связаны условием $\xi^2+\nu^2\neq 0$.

Упростим систему~(\ref{f29}). Из третьего и~четвертого ее уравнений
получаем, что $b_3^M=\nu$ и~$b_4^M=\xi$. Подставляем их в~первое и~второе уравнения, тогда $b_1^M=1$ и
$b_2^M=0$. Следовательно, теперь вместо~(\ref{f25}) имеем относительно элементов вектора~$B$ систему
\begin{equation}
b_1^M=1,\; b_2^M=0,\; b_3^M=\nu,\; b_4^M=\xi
\label{f30}
\end{equation}
при условии $\xi^2+\nu^2\neq 0$. Далее
\begin{equation}
C_T=C_M=CM=CS,\quad C_T=\overline{C_M}=CSQ=C_MQ.
\label{f31}
\end{equation}
Матрица $S$ известна, поэтому будем считать, что в~первом уравнении~(\ref{f31}) $C_M=(c_1^M,c_2^M,c_3^M,c_4^M)$.
Требуется выбрать вектор $C_T=(0,0,0,1)$.
Если $C_T=C_M$, то получаем систему линейных уравнений с~матрицей~$S$ относительно элементов вектора~$C$. Тогда элементы 
\begin{equation}
c_1^M=0,\; c_2^M=0,\; c_3^M=0,\; c_4^M=1.
\label{f32}
\end{equation}

После введения параметрической матрицы $Q_i$ типа~(\ref{f18}) получаем
$$\overline{C_M}=(\alpha_0 c_1^M,\alpha_0 c_2^M,\alpha_1 c_1^M+\alpha_0 c_3^M,\alpha_1 c_2^M+\alpha_0 c_4^M),$$
откуда находим, что
\begin{equation}
c_1^M=0,\; c_2^M=0,\; c_3^M=0,\; c_4^M=\alpha_0^{-1},
\label{f33}
\end{equation}
где $\alpha_0$~--- произвольное вещественное число, отличное от нуля. Система~(\ref{f33}) имеет\linebreak расширенное множество решений по сравнению с
множеством решений системы~(\ref{f32}). Применим второй способ введения матрицы~$Q_i$. Тогда
$Q_i=\left({\begin{matrix}Q  &\displaystyle I_2\cr
0  &\displaystyle Q\cr
\end{matrix}}\right)$ при
$Q=\left({\begin{matrix}\nu  &\displaystyle -\xi\cr
\xi  &\displaystyle \nu\cr
\end{matrix}}\right)$.
Имеем
$$\overline{C_M}=(\nu c_1^M+\xi c_2^M,-\xi c_1^M+\nu c_2^M,c_1^M+\nu c_3^M+\xi c_4^M,c_2^M-\xi c_3^M+\nu c_4^M),$$
откуда получаем
\begin{equation}
c_1^M=0,\; c_2^M=0,\; c_3^M=-\frac{\xi}{\xi^2+\nu^2},\; c_4^M=\frac{\nu}{\xi^2+\nu^2},
\label{f34}
\end{equation}
здесь $\xi$ и~$\nu$~--- произвольные вещественные числа такие, что $\xi^2+\nu^2\neq 0$.

Учитывая, что матрицы $A$, $B$ и~$C$ преобразуются одновременно, найденные элементы вектора $B$ должны удовлетворять
системам~(\ref{f25}) и~(\ref{f32}). Если вводим параметрическую матрицу, то при введении первым способом элементы вектора~$B$ должны
удовлетворять системам~(\ref{f27}) и~(\ref{f33}), а~при введении вторым способом~--- системам~(\ref{f30}) и~(\ref{f34}), чему и~способствуют
параметры в~обоих способах введения параметрических матриц~$Q_i$.

Сформулируем предлагаемое правило построения параметрической матрицы~$Q$.

{\bf Предложение 1.} {\it Если матрица~$A$ с~комплексно сопряженными собственными числами преобразованием с~неособой матрицей~$S$ приводится
к жордановой нормальной форме~$A_{jC}$, то матрица параметрического неособого преобразования имеет вид~$T=SQ$, где~$Q$~--- блочно-диагональная
матрица с~блоками~$Q_i$, элементы которой удовлетворяют условию~$\det Q\neq 0$. При этом диагональному блоку~$\Theta_i$ вида~$(\ref{f6})$
матрицы~$A_{jC}$, отвечающему комплексно сопряженному числу $\mu\pm i\gamma$, соответст\-вует блок~$Q_i$ вида~$(\ref{f8})$ с~обратной
матрицей~$(\ref{f9})$. Если комплексно сопряженное собственное число кратное, то диагональному блоку~$\Theta_i$ вида~$(\ref{f10})$
матрицы~$A_{jC}$ соответствует блок~$Q_i$ вида~$(\ref{f13})$ с~обратной матрицей~$(\ref{f14})$. В обоих случаях выполняется условие
$\Theta_i Q_i=Q_i\Theta_i$. Для блоков~$\Theta_i$ вида~$(\ref{f10})$ можно использовать второй способ построения блоков~$Q_i$, когда
на главной диагонали матрицы~$Q_i$ стоят блоки~$(\ref{f8})$, а~над главной диагональю~--- блоки~$I_2$.}

{\bf 5. Случай первой естественной нормальной формы.}
Достаточные условия приведения матрицы~$A$ к~подобной ей квазидиагональной матричной форме известны (см.~[25]). При этом
матрица~$A$ размерности $n\times n$ подобна матрице
\begin{equation}
L={\rm diag}(A_{n_1},A_{n_2},\dots,A_{n_k}),
\label{f35}
\end{equation}
где матричные блоки~$A_{n_l}$ ($l=\overline{1,k}$) имеют размерности $n_l\times n_l$, причем $\sum\limits_{l=1}^k n_l=n$.
Каждая~$A_{n_l}$~--- это сопровождающая матрица инвариантного многочлена со старшей степенью $n_l$ и~коэффициентом единица при
старшей степени. Имеются в~виду инвариантные многочлены матрицы $I_\lambda-A$ ($\lambda$~--- числовой параметр), при этом сумма их степеней
равна~$n$.

Пусть матрица~$A$ такая, что существует невырожденная матрица~$T$ преобразования $x(t)=Tz(t)$, приводящего матрицу~$A$ к~виду
$L=T^{-1}AT$. Здесь $L$~--- первая естественная нормальная форма~(\ref{f35}). Известно, что матрица~$T$ выбирается неоднозначно.
Действительно, пусть $T=SQ$, где $S$ и~$Q$~--- невырожденные матрицы такие, что $S^{-1}AS=L$, а~$Q$~--- матрица,
определяемая из равенства
\begin{equation}
LQ=QL.
\label{f36}
\end{equation}
Матрица $Q$ задает неоднозначность выбора матрицы~$T$. Матрица $L$ блочно-диаго\-нальная. Потому
$Q={\rm diag}(Q_{n_1},Q_{n_2},\dots,Q_{n_k})$,
где $\sum_{l=1}^k n_l=n$. Следовательно, из~(\ref{f36}) имеем равенство
\begin{equation}
A_{n_l}Q_{n_l}=Q_{n_l}A_{n_l}.
\label{f38}
\end{equation}
В дальнейшем индекс~$l$ опускаем.
Обозначим через~$P_n$ множество невырожденных матриц~$Q_n$, удовлетворяющих равенству~(\ref{f38}).
Очевидно, что такие~$Q_n$ образуют группу относительно операции перемножения этих матриц, т.~е. $P_n$~--- группа автоморфизмов матрицы~$A_n$.
Установим конструкцию матрицы~$Q_n$ в~зависимости от ее порядка~$n$.

Пусть
$A_2=\left({\begin{matrix}0  &\displaystyle -a_2\cr
1  &\displaystyle -a_1\cr
\end{matrix}}\right)$, где~$A_2$~---
сопровождающая матрица для многочлена~$f(\lambda)=\lambda^2+a_1\lambda+a_2$. Тогда матрицу~$Q_2=
\left({\begin{matrix}x_1  &\displaystyle x_2\cr
y_1  &\displaystyle y_2\cr
\end{matrix}}\right)$
ищем из равенства~(\ref{f38}). Получаем
$Q_2=\left({\begin{matrix}a_1x+y &\displaystyle -a_2x\cr
x  &\displaystyle y\cr
\end{matrix}}\right)$,
где $x$ и~$y$~--- числовые параметры, удовлетворяющие условию $a_1xy+y^2+a_2x^2\neq 0$ (т.~е. $\det Q_2\neq 0$), при котором определяется~$Q_2^{-1}$.

Далее, пусть $n=3$, $f(\lambda)=\lambda^3+a_1\lambda^2+a_2\lambda+a_3$ и~матрица
$$
A_3=\left({\begin{matrix}0  &\displaystyle 0 &\displaystyle -a_3\cr
1  &\displaystyle 0 &\displaystyle -a_2\cr
0  &\displaystyle 1 &\displaystyle -a_1\cr
\end{matrix}}\right).
$$
Тогда матрицу
$$
Q_3=\left({\begin{matrix}x_1  &\displaystyle x_2 &\displaystyle x_3\cr
y_1  &\displaystyle y_2 &\displaystyle y_3\cr
z_1 &\displaystyle z_2 &\displaystyle z_3\cr
\end{matrix}}\right)
$$
ищем из равенства~(\ref{f38}). Получим систему девяти линейных однородных уравнений с~девятью неизвестными $x_i$, $y_i$, $z_i$ ($i=\overline{1,3}$).
Из ее рассмотрения можно сделать следующие выводы. Если $a_3^2(1+a_2+a_3)\neq 0$, то группа автоморфизмов~$P_3$
матрицы~$A_3$ состоит из матриц $Q_3=xI$, где $x$~--- ненулевой параметр. Если $a_3^2(1+a_2+a_3)=0$, то при $a_3=0$ имеем
трехпараметрическую матрицу
$$
Q_3=\left({\begin{matrix}a_2x+a_1y+z  &\displaystyle 0 &\displaystyle 0\cr
a_1x+y  &\displaystyle a_1y+z &\displaystyle -a_2y\cr
x &\displaystyle y &\displaystyle z\cr
\end{matrix}}\right),
$$
в которой $x$, $y$, $z$~--- параметры, удовлетворяющие условию
$(a_2x+a_1y+z)(a_2y^2+a_1yz+z^2)\neq 0$.
Если $a_3=-1$, $a_2=0$, то получаем матрицу~$Q_3$, зависящую от двух параметров.

Отметим, что общей формулы для вычисления матриц~$Q_n$ не существует. Однако, чтобы показать, как можно использовать матрицу~$Q_n$ в~случае,
когда матрица~$A_n$ имеет хотя бы две пары комплексно сопряженных собственных чисел, перейдем к~рассмотрению случая~$n=4$.

Пусть $f(\lambda)=\lambda^4+a_1\lambda^3+a_2\lambda^2+a_3\lambda+a_4$. Тогда для матрицы
$$
A_4=\left({\begin{matrix}0  &\displaystyle 0 &\displaystyle 0 &\displaystyle -a_4\cr
1  &\displaystyle 0 &\displaystyle 0 &\displaystyle -a_3\cr
0  &\displaystyle 1 &\displaystyle 0 &\displaystyle -a_2\cr
0  &\displaystyle 0 &\displaystyle 1 &\displaystyle -a_1\cr
\end{matrix}}\right)
$$
из равенства~(\ref{f38}) находим группу~$P_4$, т.~е. семейство матриц~$Q_4$.
Для матрицы
$$
Q_4=\left({\begin{matrix}x_1  &\displaystyle x_2 &\displaystyle x_3 &\displaystyle x_4\cr
y_1  &\displaystyle y_2 &\displaystyle y_3 &\displaystyle y_4\cr
z_1  &\displaystyle z_2 &\displaystyle z_3 &\displaystyle z_4\cr
t_1  &\displaystyle t_2 &\displaystyle t_3 &\displaystyle t_4\cr
\end{matrix}}\right)
$$
должно выполняться равенство
\begin{equation}
A_4Q_4=Q_4A_4.
\label{f39}
\end{equation}
Умножив~$A_4$ на ~$Q_4$, получаем матрицу размерности $4\times 4$, элементы которой зависят от элементов матриц~$A_4$ и~$Q_4$.
Аналогично делаем для матрицы~$Q_4A_4$. Перенесем элементы матрицы~$Q_4A_4$ в~левую часть равенства~(\ref{f39}) на соответствующие места в~матрице~$A_4Q_4$. Тогда слева будем иметь матрицу из разностей элементов матриц~$A_4Q_4$ и~$Q_4A_4$, т.~е.
\begin{equation}
A_4Q_4-Q_4A_4,
\label{f40}
\end{equation}
а справа~--- нулевую матрицу. Каждый элемент матрицы~(\ref{f40}) определяет левую часть одного из уравнений однородной системы уравнений для
определения $16$ неизвестных $x_1$, $x_2$, $x_3$, $x_4$, $y_1$, $y_2$, $y_3$, $y_4$, $z_1$, $z_2$, $z_3$, $z_4$, $t_1$, $t_2$, $t_3$ и~$t_4$.
Если уравнения выписать построчно в~указанном порядке неизвестных, то построим матрицу коэффициентов этой системы размерности $16\times 16$.
Сами коэффициенты~--- это либо нули, либо один из коэффициентов многочлена~$f(\lambda)$. Применяя обратный ход метода Гаусса, приведем матрицу
с помощью элементарных преобразований к~аналогу трапецевидной формы так, что в~ее первых четырех строках все элементы нули, кроме элементов с
индексами~$(3,14)$ и~$(4,14)$, первый из них равен~$-a_2a_3$, а~второй~--- $a_1a_2a_3$. Из вида этой матрицы следует, что ее ранг равен~$12$
или~$13$. Потому при~$a_1a_2a_3\neq 0$ или при~$a_1=0$ и~$a_2a_3\neq 0$ группа~$P_4$ будет трехпараметрической, а~при~$a_2=0$ или~$a_3=0$
она будет четырехпараметрической. Пусть, например, $a_1a_2a_3\neq 0$ и~соответственно $a_2a_3\neq 0$, тогда~$t_2=0$,
так как~$t_2$ соответствует четырнадцатому столбцу матрицы~(\ref{f40}). Это означает, что в~четырех первых строках матрицы все элементы нули и
все элементы четырнадцатого столбца также равны нулю. Убирая в~такой матрице нулевые строки и~нулевой столбец, построим систему с~матрицей
размерности~$12\times 15$. Пола\-гаем теперь $t_1=x$, $t_3=y$, $t_4=z$, где $x$, $y$, $z$~--- ненулевые параметры. Тогда
получаем, что $x_1=a_3x+a_1y+z$ из первого уравнения преобразованной системы, $x_2=-a_4x$ из второго, $x_3=0$ из третьего, $x_4=-a_4y$ из четвертого,
$y_1=a_2x+y$ из пятого, $y_2=a_1y+z$ из шестого, $y_3=-a_4x$ из седьмого, $y_4=-a_3y$ из восьмого, $z_1=a_1x$ из девятого,
$z_2=y$ из десятого, $z_3=a_1y+z$ из одиннадцатого, $z_4=-a_4x-a_2y$ из двенадцатого. Подставим эти решения в~матрицу~$Q_4$:
\begin{equation}
Q_4=\left({\begin{matrix}a_3x+a_1y+z  &\displaystyle -a_4x &\displaystyle 0 &\displaystyle -a_4y\cr
a_2x+y  &\displaystyle a_1y+z &\displaystyle -a_4x &\displaystyle -a_3y\cr
a_1x  &\displaystyle y &\displaystyle a_1y+z &\displaystyle -a_4x-a_2y\cr
x  &\displaystyle 0 &\displaystyle y &\displaystyle z\cr
\end{matrix}}\right),
\label{f42}
\end{equation}
в которой параметры~$x$, $y$, $z\in\mathbb R \backslash \{0\}$ такие, что $\det Q_4\neq 0$. Тогда матрица~$Q_4^{-1}$ легко находится из
матрицы~(\ref{f42}). Если $a_1=0$ и~$a_2a_3\neq 0$, то получим другую трехпараметрическую матрицу~$Q_4$.
Если $a_2=0$ или $a_3=0$, то группа~$P_4$ четырехпараметрическая. Аналогичное утверждение справедливо, если~$a_2=a_3=0$.

На примерах построения матриц~$Q_2$, $Q_3$ и~$Q_4$ видно, что общей формулы их определения в~зависимости от~$n$ не существует,
так как вид этих матриц существенно зависит от величин~$a_1$, $a_2$, $a_3$, $a_4$. Однако, используя формулу~(\ref{f38}), процесс построения
групп автомофизмов~$P_n$ может быть продолжен для $n\geq 5$. Опираясь на приведенный скалярный многочлен
$f(\lambda)=\lambda^n+a_1\lambda^{n-1}+\dots +a_n$, строим для него сопровождающую матрицу. При этом надо иметь в~виду, что если матрицы~$A$ и~$A_0$
имеют одинаковые характеристические многочлены, то они приводятся к~виду~$L$ не обязательно одним и~тем же преобразованием.

Отметим, что в~приложениях системы автоматического управления с~матрицей~$A=A_n$ встречаются достаточно часто. Например, если выход
одномерной системы $n$-го~по\-ряд\-ка с~управлением~$u$ в~правой части является взвешенной суммой производных текущих переменных до порядка~$m$
включительно и~$n>m$, то пос\-ле соответствующей замены переменных приходим к~системе вида
$\dot x=A_nx+B_Tu$, $y=(C_T,x)$, где~$B_T$ и~$C_T$~--- преобразованные векторы.

{\bf Пример 3.} Пусть матрица~$A$ размерности $4\times 4$ имеет две пары комплексно сопряженных корней $\mu\pm i\gamma=-1\pm i$
(в отличие от примера~2 здесь заданы конкретные собственные числа матрицы~$A$). Тогда
$f(\lambda)=\lambda^4+4\lambda^3+8\lambda^2+8\lambda+4$. Пусть неособая матрица~$S_L$ приводит матрицу~$A$ к~виду~$A_4$, т.~е.
$S_L^{-1}AS_L=A_4$, где
$$
A_4=\left({\begin{matrix}0  &\displaystyle 0 &\displaystyle 0 &\displaystyle -4\cr
1  &\displaystyle 0 &\displaystyle 0 &\displaystyle -8\cr
0  &\displaystyle 1 &\displaystyle 0 &\displaystyle -8\cr
0  &\displaystyle 0 &\displaystyle 1 &\displaystyle -4\cr
\end{matrix}}\right).
$$
Воспользуемся формулами из примера~2. Если~$S_L$ известна, а~вектор~$C_T$ задан (т.~е. $C_T=(0,0,0,1)$, как в~примере~2), то
$C_T=CS_L=C_L$, если не используем параметрическую матрицу~$Q_4$, иначе $C_T=\overline{C_L}=CS_LQ_4=C_LQ_4$, где матрица~$Q_4$
строится по формуле~(\ref{f42}), т.~е.
$$
Q_4=\left({\begin{matrix}8x+4y+z  &\displaystyle -4x &\displaystyle 0 &\displaystyle -4y\cr
8x+y  &\displaystyle 4y+z &\displaystyle -4x &\displaystyle -8y\cr
4x  &\displaystyle y &\displaystyle 4y+z &\displaystyle -4x-8y\cr
x  &\displaystyle 0 &\displaystyle y &\displaystyle z\cr
\end{matrix}}\right),
$$
$\det Q_4\neq 0$.
Обозначим $C_L=(c_1^L,c_2^L,c_3^L,c_4^L)$. Задан вектор $\overline{C_L}=(0,0,0,1)$. Далее получаем для нахождения
$c_1^L$, $c_2^L$, $c_3^L$, $c_4^L$ систему
\begin{equation}
\left\{
\begin{array}{l}
c_1^L(8x+4y+z)+c_2^L(8x+y)+c_3^L4x+c_4^Lx=0,\\[6pt]
c_1^L(-4x)+c_2^L(4y+z)+c_3^Ly=0,\\[6pt]
c_2^L(-4x)+c_3^L(4y+z)+c_4^Ly=0,\\[6pt]
c_1^L(-4y)+c_2^L(-8y)+c_3^L(-4x-8y)+c_4^Lz=1
\end{array}
\right.
\label{f43}
\end{equation}
при условиях, что~$x$, $y$, $z\in\mathbb R \backslash \{0\}$ и~$\det Q_4\neq 0$. Решение~$c_k^L$ ($k=\overline{1,4}$)~--- это рациональные функции от
параметров $x$, $y$ и~$z$. Нахождение~$Q_4$ является более трудоемкой задачей, чем параметрической матрицы в~случае приведения к
жордановой форме. Если не подходит система решений вида~(\ref{f34}), то можно обратиться к~решению системы~(\ref{f43}).

Сформулируем правило построения параметрического преобразования.

{\bf Предложение 2.} {\it Пусть матрица~$A$ линейной части системы~$(\ref{f1})$ преобразова\-нием с~неособой матрицей~$S$ приводится
к первой естественной нормальной форме~$L$ вида~$(\ref{f35})$ с~матричными блоками~$A_{n_l}$. Тогда матрица параметрического неособого
преобразования~$T=SQ$, где~$Q$~--- блочно-диагональная матрица с~блоками~$Q_{n_l}$, элементы которой удовлетворяют условию $\det Q\neq 0$.
При этом диагональному блоку~$A_{n_l}$ соответствует блок~$Q_{n_l}$, выбираемый из равенства~$A_{n_l}Q_{n_l}=Q_{n_l}A_{n_l}$.
Это уравнение для определения элементов матрицы~$Q_{n_l}$, которые зависят от элементов матрицы~$A_{n_l}$ и~значений параметров,
выбираемых из условия~$\det Q_{n_l}\neq 0$.}

{\bf 6. Заключение.}
Хорошо известно~[7, 26, 27], что задача приведения системы вида~(\ref{f1}) к~совокупности подсистем
меньшей размерности или к~интегрируемому виду представляет собой часто неразрешимую задачу. Для расширения множества систем
вида~(\ref{f1}), если это возможно, предложен метод введения в~преобразование системы множителя в~виде параметрической матрицы
с определенными условиями, которая позволяет за счет выбора величин ее параметров расширить множество
значений хотя бы части параметров настройки исходной системы. На примерах показано, что такая задача решается
даже в~тех случаях, когда матрица исходной линейной части системы имеет комплексно сопряженные, в~том числе кратные,
собственные числа.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{09/lit-ra}

%\newpage
\input{09/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %
%
%}
