
\noindent{\small УДК 51-76  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\
MSC 62P12

}

\vskip2%3
mm

\noindent{\bf Теоретические основы вероятностно-статистического прогнозирования \\ неблагоприятных агрометеоусловий$^{*}$%
 }

\vskip1.8%3
mm

\noindent{\it В.~П.~Якушев$^1$, В.~М.~Буре$^{1,2}$, О.~А.~Митрофанова$^{1,2}$, Е.~П.~Митрофанов$^{1,2}$%
%, И.~О. Фамилия%$^{1,4}$%
}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Исследование выполнено при финансовой поддержке Российской Федерации (соглашение с~Министерством науки и~высшего образования  № 075-15-2020-805 от 2 октября 2020 г.).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip1.8%3
mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent%
$^1$~%
Агрофизический научно-исследовательский институт, Российская Федерация,

\noindent%
\hskip2.45mm%
195220, Санкт-Петербург, Гражданский пр., 14



\noindent%
$^2$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip1.8%3
mm

{\small \noindent \textbf{Для цитирования:} \textit{Якушев В.~П., Буре В.~М., Митрофанова О.~А., Митрофанов Е.~П.} Теоретические основы вероятностно-статистического прогнозирования неблагоприятных агрометеоусловий~// Вестник Санкт-Пе\-тер\-бург\-ского университета.
Прикладная математика. Информатика. Процессы управления.
\issueyear. Т.~17. Вып.~\issuenum.
С.~\pageref{p7}--\pageref{p7e}. \\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum07

\vskip1.8%3
mm

{\leftskip=7mm\noindentКаждая модель прогнозирования неблагоприятных агрометеоусловий на основе анализа одномерных временных рядов эффективна для определенного круга исходной информации. Кроме того, значения исходных наблюдений могут существенно различаться для каждого случая, потому повсеместное применение одного метода для анализа произвольной информации может привести к~существенным неточностям. Таким образом, возникает проблема выбора метода прогнозирования для исходного набора агрометеорологических данных. В связи с~этим предложен универсальный адаптивный вероятностно-статистический подход к~прогнозированию неблагоприятных агрометеоусловий, позволяющий решить проблему выбора модели. Представлены результаты первого этапа научно-исследовательской работы: приведен краткий обзор современного со\-стоя\-ния исследований в~этом направлении, разработаны теоретические основы прогнозирования неблагоприятных агрометеоусловий по возможному наступлению засухи и~заморозков, включая задачу формирования исходной информации, характеристику базовых моделей прогнозирования, а~также непосредственно описание предлагаемого подхода относительно общей структуры интеллектуальной системы, на основе которой может быть разработан и~автоматизирован соответствующий алгоритм.\\[1mm]
\textit{Ключевые слова}: одномерные временные ряды, прогнозирование, засухи, заморозки, агрометеорологические опасные явления, интеллектуальная система.

}

}

\vskip2.5%4
mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\bfseries  1. Введение.}
В последние десятилетия существенное значение при производстве растениеводческой продукции приобретает задача оценки рисков возникновения неблагоприятных агрометеоусловий, оказывающих влияние на потери урожая. Согласно отчету Межправительственной группы экспертов по изменению климата (Intergovernmental Panel on Climate Change, IPCC) 2012 года наблюдается тенденция к~увеличению среднесуточных температур, а~также экстремальных явлений, таких как засухи, наводнения, заморозки и~др., в~глобальном масштабе [1]. Изучение климатических изменений в~России также указывает на значительный рост числа опасных гидрометеорологических явлений (ОЯ), в~числе которых и~агрометеорологические, причем более 70\,\% приходится на теплый период года (апрель\,---\,октябрь) [2].

В классических подходах к~идентификации таких явлений как засуха и~заморозки для анализа используются традиционные метеорологические данные (температура воздуха, количество осадков, влажность воздуха и~др.) [3]. Исследователями за последние десятилетия предложено множество различных индексов, учитывающих широкий круг параметров и~позволяющих определять и~осуществлять мониторинг засух и~заморозков [4, 5]. Одним из современных и~активно развивающихся направлений мониторинга засух и~заморозков является применение данных дистанционного зондирования [6, 7].

Вероятностно-статистические подходы к~прогнозированию неблагоприятных агро\-ме\-тео\-ро\-ло\-ги\-чес\-ких явлений сводятся главным образом к~анализу одномерных временных рядов. Так, например, в~работе [8] использован метод многомерных сплайнов адаптивной регрессии для анализа минимальных ночных температур, чтобы спрогнозировать влияние текущих и~будущих рисков заморозков, в~[9]~--- байесовский подход к~анализу комбинированного временного ряда (сформированного из нескольких климатических показателей) для прогнозирования заморозков в~юго-восточной Австралии. Все более перспективными для анализа одномерных временных рядов становятся нейросетевые подходы [10]. Однако следует отметить, что комплексное сравнение вероятностно-статистических подходов к~анализу временных рядов отсутствует.

Цель этой работы~--- разработка теоретических основ единого подхода к~вероятно-\\стно-статистическому прогнозированию неблагоприятных агрометеоусловий по возможному наступлению засух и~заморозков.


 { \bfseries  2. Методика исследования.}
С учетом непредсказуемого природного характера исходных климатических параметров целесообразно представлять данные для анализа в~виде одномерного временного ряда, например временного ряда некоторого специальным образом рассчитываемого индекса, который отражает степень опасности возникновения некоторого ОЯ. Следует отметить, что на агрометеорологические ОЯ оказывает влияние множество факторов, что добавляет неопределенность в~прогнозирование и~соответственно снижает эффективность применения строгих алгоритмов анализа данных.

\textbf{\emph{Формирование исходного одномерного временного ряда.}} Задача прогнозирования неблагоприятных агрометеоусловий, обусловленных сложными непредсказуемыми климатическими параметрами (и не только климатическими), относится к~направлению интеллектуального анализа данных, в~котором в~качестве первого этапа решения целесообразно провести подготовку и~предварительную обработку исходной информации.

Как уже отмечалось, ОЯ зависят от многих сложных факторов, однако степень влияния каждого из них и~связь между ними будут различными для каждого региона. В связи с~этим возникает актуальность проведения нового исследования, связанного с~формированием исходного одномерного временного ряда, представляющего значения некоторого индекса, на основе множества факторов для каждого региона России отдельно, что выходит за рамки рассматриваемой задачи. Поэтому были использованы упрощенные ряды: одномерный временной ряд минимальной температуры воздуха~--- для прогноза заморозков и~количества осадков~--- для прогноза засух:
  \begin{equation*}
  y(t_0), y(t_1),\, \ldots\, , y(t_{n-1}),          \end{equation*}
где каждому значению исследуемого параметра $y$ соответствует определенный момент времени $t_i$.

В задачах, связанных с~агрометеорологической информацией, рассматриваются величины исследуемого показателя через равные промежутки времени (час, сутки и~т.~п.), поэтому временной ряд удобно записать в~следующем виде:%\pagebreak

 \begin{equation*}
  y(0), y(1), \, \ldots\, , y(t-1).          \end{equation*}

После установления основных факторов, взаимосвязанных с~ОЯ в~данном ре\-гио\-не, целесообразно искусственно сформировать одномерный временной ряд, представляющий некоторый индекс, информативный в~отношении возникновения некоторого ОЯ, а~также получить его значения. Критерии определения засухи/заморозков также могут отличаться для каждой местности. Традиционно заморозки выявляют при появлении отрицательной температуры при положительных среднесуточных ее значениях [2], но есть исследования, в~которых заморозки приурочены уже к~температуре 2\,°С [11]. В работе [12] в~качестве главного критерия засухи выделено значение количества осадков менее 50\,\% нормы, однако очевидно, что для идентификации засух необходимо учитывать региональные особенности климата, а~также изучаемую культуру (например, существуют сорта, более устойчивые к~засухе).

\textbf{\emph{Основные методы прогнозирования одномерного временного ряда.}} Основой служит набор базовых регрессионных методов прогнозирования одномерных временных рядов, наиболее используемых и~изученных при анализе неблагоприятных агро\-ме\-тео\-ро\-ло\-ги\-чес\-ких условий, а~также несколько актуальных и~перспективных нейросетевых моделей:
\\ \indent -- Naive (наивная);
\\ \indent -- AR (авторегрессионная);
\\ \indent -- MA (скользящего среднего);
\\ \indent -- ARMA (авторегрессии --- скользящего среднего);
\\ \indent -- ARIMA (авторегрессия проинтегрированного скользящего среднего);
\\ \indent -- SES (экспоненциальное сглаживание);
\\ \indent -- ARCH (авторегрессионная условная гетероскедастичность);
\\ \indent -- GARCH (обобщенная авторегрессионная условная гетероскедастичность);
\\ \indent -- MLP (многослойный перцептрон, нейросетевой подход);
\\ \indent -- CNN (сверточная нейронная сеть).

\textbf{\emph{Теоретические основы вероятностно-статистического прогнозирования неблагоприятных агрометеоусловий.}} Как уже было отмечено выше, каждая модель прогнозирования неблагоприятных агрометеоусловий, построенная при помощи анализа одномерных временных рядов, эффективна для определенного круга исходной информации, причем однозначно выделить области применения моделей невозможно. Кроме того, в~задачах прогнозирования агрометеорологических ОЯ значения наблюдений в~исходных временных рядах (сформированных на основе некоторых факторов влияния для конкретной сельскохозяйственной территории или региона) могут существенно различаться. Соответственно применение какого-то конкретного метода для анализа произвольной информации может привести к~существенным неточностям, т.~е. для каждого исходного одномерного временного ряда существует проблема выбора метода прогнозирования. В связи с~этим необходимо разработать теоретические основы универсального адаптивного вероятностно-статистического подхода к~прогнозированию неблагоприятных агрометеоусловий по возможному наступлению засух и~заморозков, позволяющего решить проблему выбора модели.

С учетом проведенного исследования проблематики и~выявления слабых мест современного состояния в~подходах к~прогнозированию засух и~заморозков предлагается решить данную задачу с~использованием интеллектуальной системы анализа одномерных временных рядов. Тогда решение задачи делится на два основных этапа:
\\ \indent -- предварительный анализ и~корректировка исходных данных;
\\ \indent -- непосредственно выбор оптимального метода прогнозирования в~зависимости от полученных результатов анализа.

В целом задача сводится к~поиску лучшей альтернативы из множества реализаций прогнозирования. На рис. 1 представлен общий упрощенный алгоритм пред\-ла\-гае\-мого вероятностно-статистического подхода к~прогнозированию засух и~заморозков.


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{07/fig1}

\vskip 2mm {\small{\it Рис. 1.} Общий алгоритм универсального вероятностно-статистического подхода к~прогнозированию неблагоприятных агрометеоусловий } }
\end{figure}



%\begin{figure}[h!]
%\center {\includegraphics[width=1\textwidth]{1.pdf}}
%\caption {\centering.~Общий алгоритм универсального%
%вероятностно-статистического подхода ~~ к~прогнозированию %
%неблагоприятных агрометеоусловий }
%\label{fig1}
%\end{figure}

Расшифровку общей схемы алгоритма можно представить следующим образом.
\\ \indent {\it Блок 1}.
\\ \indent --~Ввод данных. На вход пользователь загружает файл, содержащий исходные данные в~табулированном табличном виде, представляющие собой одномерный ряд или несколько рядов (для расчета гидротермического коэффициента (ГТК)) архивной метеоинформации (допустимые форматы файла: .txt, .dat, .csv). Кроме того, пользователь выбирает, какой вариант он загрузил: количество осадков, метеоданные для расчета ГТК, влагозапас почвы для случая засухи, минимальные температуры для случая заморозков. Помимо них пользователь может выбрать свой вариант (произвольный сформированный им одномерный ряд), однако тогда не будут учитываться критерии обнаружения ОЯ в~прогнозе из базы знаний. Также в~этом блоке указывается период осуществления прогнозирования (долгосрочность).
\\ \indent --~Предварительный анализ. Осуществляется проверка исходного ряда на ста\-цио\-нар\-ность. В случае ее отсутствия используются не все базовые методы прогнозирования.
\\ \indent --~Тренировочная выборка. Отдельно сохраняются 70\,\% первых наблюдений исходного ряда для последующего применения в~нейросетевых подходах.
\\ \indent --~Тестовая выборка. Отдельно сохраняются 30\,\% последних наблюдений исходного ряда для последующего применения в~нейросетевых подходах.
\\ \indent {\it Блок 2}.
\\ \indent --~База знаний. С привлечением эксперта (или экспертов) формируется база знаний, где хранится полный перечень базовых методов прогнозирования одномерных временных рядов, а~также критерии обнаружения ОЯ в~прогнозе исходя из загруженной исходной информации. Также с~привлечением эксперта может быть сформирован собственный пользовательский исходный ряд, например региональный индекс засухи.
\\ %\indent

\newpage
{\it Блок 3}.
\\ \indent --~Прогнозирование с~помощью базовой модели. На данном этапе осуществляются вызов метода из базы знаний и~передача исходной информации.
\\ \indent --~Расчет точности прогноза, сохранение результатов. На языке программирования R автоматизирован процесс расчета точности модели. Основан он на традиционном подходе: сначала из исходной выборки выбрасывается одно наблюдение, прогнозируется с~помощью этой модели и~сравнивается с~фактическим значением с~использованием абсолютных отклонений, далее процесс повторяется на других наблюдениях. В результате рассчитывается точность модели в~процентах. После этого все результаты сохраняются в~общий файл также в~табулированном табличном виде: спрогнозированный ряд, порядковый номер модели, точность в~процентах.
\\ \indent --~Условный оператор. В случае, если достигнут последний метод из базы знаний, то осуществляется переход на следующий шаг, иначе происходит возврат к~прогнозированию следующим базовым методом.
\\ \indent --~Выбор наилучшего прогноза. На данном этапе сравниваются все сохраненные значения точности базовых моделей, выбирается прогноз с~максимальной точностью вычислений. В следующий блок подается информация из общего сохраненного файла, соответствующая наилучшему прогнозу.
\\ \indent {\it Блок 4}.
\\ \indent --~Принятие решений. На основе имеющейся базы знаний выбирается нужный критерий обнаружения ОЯ и~проводится анализ спрогнозированной информации. Таким образом, в~выходном ряду устанавливаются даты возможного наступления ОЯ с~определением показателя вероятности: 1 соответствует высокой вероятности, 0.5~--- средней.
\\ \indent {\it Блок 5}.
\\ \indent --~Вывод результатов. Пользователю возвращается файл с~табулированной табличной информацией, где записаны следующие данные:
\\ \indent --~ряд спрогнозированных значений за заданный период;
\\ \indent --~даты, соответствующие прогнозным значениям;
\\ \indent --~полученная точность расчетов в~процентах;
\\ \indent --~название выбранного базового метода прогнозирования;
\\ \indent --~даты возможного наступления ОЯ.

В результате будет получен наиболее оптимальный прогноз исходного временного ряда.

\textbf{\emph{Вычислительный эксперимент.}} Для примера был сформирован одномерный временной ряд минимальных суточных температур в~градусах за период 1 января 2018~г.~--- 20 февраля 2021 г., полученных на метеостанции <<Белогорка>>, расположенной в~Ленинградской обл. (на основе архива данных, предоставленного сайтом rp5.ru). Все вычисления проводились с~помощью языка программирования R, применялись такие пакеты как ``forecast'', ``knitr'', ``rugarch'' и~др. Исходный ряд состоял из 1147~наблюдений (рис. 2), в~ходе предварительной обработки данные разбивались на две части: тренировочную и~тестовую. В качестве тестового набора был выделен ряд из 150 последних наблюдений, моделирование и~прогноз осуществлялись на основе тренировочной части. Для простоты были использованы 8 традиционных регрессионных моделей прогнозирования (Naive, SNaive, AR, MA, ARIMA, SES, ARCH, GARCH).


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{07/fig2}

\vskip 1mm {\small{\it Рис. 2.} Исходный временной ряд из 1147 наблюдений } }
\end{figure}




%\begin{figure}[h!]
%\center {\includegraphics[width=1\textwidth]{2.pdf}}
%\caption {\centering.~Исходный временной ряд из 1147 наблюдений }
%\label{fig2}
%\end{figure}

В качестве основных показателей оценки точности построений были выбраны следующие параметры: среднеквадратичная ошибка (RMSE~--- Root mean square error) и~средний модуль отклонения (MAE~--- mean absolute error). Основные результаты построений представлены в~табл. 1, оценка точности проводилась для тестово\-го набора. Из нее видно, что наибольшая точность построения достигнута в~случае\linebreak использования модели SNaive.

\begin{table}[h!]
\begin{center}
{\small

{\it Таблица 1.} {\bf  Результаты оценки точности построений\\ для временного ряда из 1147 наблюдений}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{|p{2.4cm}|c|c|}
\hline
  & \multicolumn{2}{c|}{Показатели оценки точности построений} \\
\cline{2-3}
 \raisebox{1.5ex}[0cm][0cm]{\centerline {Модели}}
& RMSE & MAE  \\
\hline
 Naive & 11.21 & 8.03 \\
\hline
SNaive & 10.22 & 7.37 \\
\hline
AR & 10.75 & 7.53 \\
\hline
MA & 10.77 & 7.56 \\
\hline
ARIMA & 10.72 & 7.49 \\
\hline
SES & 13.26 & 10.14 \\
\hline
ARCH & 10.57 & 7.4 \\
\hline
GARCH & 10.94 & 7.74 \\
\hline
\end{tabular}

}
\end{center}\vspace{-5mm}
\end{table}
%\vskip 2mm

Кроме того, те же расчеты были осуществлены для выборки последних 173 наблюдений исходного ряда, для тестового набора были взяты 13 значений минимальных суточных температур. В табл. 2 приведены результаты построений, из которых следует, что для такого набора данных наилучшей точностью обладает модель SES.

\begin{table}[h!]
\begin{center}
{\small

{\it Таблица 2.} {\bf  Результаты оценки точности построений\\ для временного ряда из 173 наблюдений}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{|p{2.4cm}|c|c|}
\hline
 & \multicolumn{2}{c|}{Показатели оценки точности построений} \\
\cline{2-3}
 \raisebox{1.5ex}[0cm][0cm]{\centerline {Модели}}
& RMSE & MAE  \\
\hline
 Naive & 8.59 & 7.08 \\
\hline
SNaive & 31.4 & 30.65 \\
\hline
AR & 14.38 & 12.35 \\
\hline
MA & 27.72 & 20.27 \\
\hline
ARIMA & 14.33 & 12.3 \\
\hline
SES & 8.48 & 7.03 \\
\hline
ARCH & 10.8 & 8.18 \\
\hline
GARCH & 10.14 & 7.6 \\
\hline
\end{tabular}

}
\end{center}\vspace{-5mm}
\end{table}
%\vskip 2mm




{ \bfseries  3. Заключение.}
Безусловно, теоретические основы вероятностно-ста\-тис\-ти\-чес\-кого прогнозирования могут быть дополнены базовыми методами анализа и~критериями сравнения результатов построений после проведения вычислительных экспериментов. Кроме того, для автоматизации алгоритма целесообразно применять возможности языка программирования R, все рассмотренные методы в~данной работе широко представлены в~составе его пакетов, к~тому же существуют пакеты для создания удобных приложений. Этот инструмент статистического анализа неоднократно был успешно использован при решении задач точного земледелия [13, 14].

Принципиальная схема прогнозирования неблагоприятных агрометеоусловий, прогнозирования ОЯ должна включать несколько этапов:
\\ \indent 1)	формирование одного или нескольких специальных индексов, информативных в~отношении возникновения ОЯ, с~учетом географических и~климатических особенностей региона, определение значений индексов, соответствующих высоким рискам возникновения ОЯ, получение одномерных временных рядов значений индексов для данного региона;
\\ \indent 2)	применение алгоритма универсального вероятностно-статистического подхода к~прогнозированию значений каждого из индексов;
\\ \indent 3)	агрегирование прогнозов возникновения ОЯ, полученных по каждому временному ряду.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{07/lit-ra}

%\newpage
\input{07/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
