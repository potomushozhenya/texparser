
\noindent{\small УДК 519.6  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}\\
MSC 65K10

}

\vskip2mm

\noindent{\bf Обработка радионуклидных изображений с~использованием\\ дискретных систем%$^{*}$%
 }

\vskip2.5mm

\noindent{\it Е.~Д.~Котина,~Е.~Б.~Леонова,~В.~А.~Плоских%$\,^1$%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
%\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Работа выполнена при
%финансовой поддержке Российского научного фонда (проект №
%?). (The work was jointly supported by a grant
%from the Russian Science Foundation (Project N ?))\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum10 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum10}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

\noindent%
%$^1$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9


}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:} \textit{Котина Е. Д.,
Леонова Е. Б.,  Плоских В. А.} Обработка ра\-дио\-нук\-лид\-ных
изображений с~использованием дискретных систем~// Вестник
Санкт-Петербургского университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~15.
Вып.~\issuenum.
С.~\pageref{p10}--\pageref{p10e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum10

\vskip3mm

{\leftskip=7mm\noindentРассматривается задача цифровой обработки
последовательностей изображений с~использованием дискретных
систем. Предлагается математическая модель дискретной оптимизации
при решении задачи построения поля перемещений для
последовательностей изображений. Данная модель отражает дискретный
характер получения последовательности изображений (кадров),
а~также в~ней заложена возможность учитывать изменение яркости
вдоль траекторий системы. Разработан оптимизационный алгоритм
построения поля перемещений, основанный на исследовании
интегрального функционала на ансамбле траекторий дискретной
системы. Приведены аналитический вид вариации функционала
и~представление градиента функционала, что позволяет использовать
направленные методы оптимизации для поиска искомых параметров.
Данный алгоритм может применяться для обработки различных цифровых
изображений, в~частности для радионуклидных. Рассмотрена
реализация
предложенного метода на примере радионуклидных изображений.\\[1mm]
\textit{Ключевые слова}: дискретные системы, вариация функционала,
оптимизация,  обработка изображений,  радионуклидные изображения.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{Введение.} Развитие методов обработки и~анализа
изображений является в~на\-стоя\-щее время актуальной задачей, так
как эти методы применяются в~самых различных информационных
и~технических системах, а~также в~современной диагностической
медицине.

Существует большое количество методов и~алгоритмов обработки
изображений, отвечающих разным целям: восстановление изображений,
улучшение их качества, распознавание и~классификация [1, 2],
определение движения на изображениях, построение контуров объектов
на них и~т. д. Для радионуклидных изображений важны все
перечисленные виды обработки, в~частности анализ изображений,
основанный на построении поля скоростей или поля перемещений [3].
Обработка радионуклидных изображений рассматривалась в~работах
[4--8]. Несмотря на большое количество методов обработки
изображений, остается актуальной задача разработки новых подходов,
принимающих во внимание дискретный характер данных, позволяющих
одновременно обрабатывать всю последовательность изображений,
учитывающих изменение яркости изображений вдоль траекторий
движения.

Построение поля скоростей (поля перемещений) было проведено
многими авторами в~различных постановках [9--14]. Наиболее
известная постановка задачи с~использованием понятия оптического
потока предполагает постоянство функции плотности распределения
(яркости) вдоль траекторий изучаемой системы [9]. Также вместо
предположения о~постоянстве яркости иногда рассматривают
предположение о~постоянстве ее градиента, гессиана или лапласиана
[14]. В~этой постановке строятся функционалы качества, в~которые
также дополнительно включаются требования гладкости для искомого
поля скоростей [9, 12, 14]. Минимизация построенных функционалов
сводится к~решению соответствующих уравнений Эйлера---Лагранжа
численными методами. Эти уравнения могут быть сведены
к~разреженным линейным системам большого порядка, которые решаются
блочными итерационными методами [15]. Другой широко используемый
метод для определения оптического потока для\linebreak
последовательности изображений  --- метод Лукаса---Канаде [13, 14,
16]. Он пред\-полагает, что неизвестный вектор оптического потока
(поле скоростей) постоянен в~некоторой окрестности и~оптимизирует
некоторую локальную функцию энергии. Был сделан подробный обзор
локальных и~глобальных методов и~предложена их комбинация [17].

В настоящей статье разработана модель дискретной оптимизации при
решении задач построения поля перемещений для последовательностей
изображений. Оптимизационный алгоритм определения поля перемещений
строится на основе вариации интегрального функционала в~задачах
управления ансамблями (пучками) траекторий, представленных
в~работах [18--20]. Предполагается также, что яркость (плотность)
вдоль траекторий может изменяться.


\textbf{Постановка задачи.}  Рассмотрим дискретную систему вида
\begin{equation} \label{eq1} %Формула 1
y\left(k+1
\right)=F\left(k,y\left(k\right),u\left(k\right)\right),
\hspace{0.15cm}k=0,...,N-1,
\end{equation}
с начальным условием $y\left(0\right)=y_{0},
\hspace{0.15cm}y_{0}\in M_{0}CR^{m}$.

В системе (1) $y\left(k\right)$~--- \textit{m}-мерный вектор
состояния, характеризующий изменение координат точек изображения
в~последовательности кадров, $u\left(k\right)$~---
\textit{r}-мерный вектор параметров,
$F\left(k,y\left(k\right),u\left(k\right)\right)$~--- $m$-мерная
векторная функция такая, что при каждом
$k\in\lbrace0,1,...,N-1\rbrace$ она определена и~непрерывна на
множестве  $\Omega _{y}\times U\left(k\right)$ по всем~своим
аргументам $(y\left(k\right),u\left(k\right))$   вместе с~частными
производными по этим переменным и~вторыми частными производными.
Здесь $\Omega _{y}$~--- это некоторая область в~$R^{m}$,
а~$U\left(k\right), \hspace{0.15cm}k=0,1,...,N-1$,~--- компактные
множества в~$R^{r}$. При этом предполагаем, что якобиан $J
_{k}=J\left(k,y\left(k\right),u\left(k\right)\right)=\vert\frac{\partial
F\left(k,y\left(k\right),u\left(k\right)\right)}{\partial
y\left(k\right)}\vert$ отличен от нуля при всех изменениях
$k,y\left(k\right),u\left(k\right)$.

Полагаем, что система (1) описывает перемещение (изменение
координат) точек изображения исследуемого объекта
в~последовательности кадров. Под полем перемещений будем понимать
множество векторов перемещений, построенных в~точках изображения.

Обозначим $\rho = \rho\left(k\right) =
\rho\left(k,y\left(k\right)\right)$ яркость изображения на
\textit{k}-м шаге (или функцию плотности распределения
радиофармпрепарата в~случае радионуклидного изображения [7, 8]).

Положим, что начальное состояние системы (1) описывается
компактным в~$R^{m}$ множеством  $M_{0}$ ненулевой меры
с~плотностью распределения (яркостью) $\rho _{0}
=\rho_{0}\left(y_{0}\right)=\rho\left(0,y_{0}\right)$.
Последовательность векторов $\lbrace
u\left(0\right),u\left(1\right),...,u\left(N\right)\rbrace$
обозначим как $u$. Последовательность векторов $\lbrace
y\left(0\right),y\left(1\right),...,y\left(N\right)\rbrace$ будем
называть траекторией движения и~обозначать через
$y=y\left(y_{0},u\right)$. Тогда с~помощью $y\left(k\right) =
y\left(k,y_{0},u\right)$ обозначим состояние траектории на
\textit{k}-м шаге.

Ансамблем траекторий будем называть множество траекторий
$y\left(y_{0},u\right)$, которые соответствуют заданному
\textit{u} и~различным начальным состояниям $y_{0}\in M_{0}$.

Через $M_{k,u}$ обозначим сечение пучка траекторий на \textit{k}-м
шаге, т.~е. множество
\[M_{k,u}=\lbrace y\left(k\right):y\left(k\right) = y\left(k,y_{0},u\left(k\right)\right),y_{0}\in M_{0}\rbrace.\]

Функция $\rho\left(k,y\left(k\right)\right)$ при каждом
$k\in\lbrace 0,1,...,N\rbrace$ определена и~непрерывна на
множестве $M_{k,u}$ по $y\left(k\right)$ вместе с~частными
производными. Далее также будем использовать обозначение
$y_{k}=y\left(k\right)$.

Будем полагать, что вдоль траекторий системы (1) изменение яркости
(плотности) $\rho\left(k,y_{k}\right)$ происходит в~соответствии
с~уравнением переноса [18--20]

\begin{equation} \label{eq2}
\rho\left(k+1,y\left(k+1\right)\right)=J_{k}
^{-1}\rho\left(k,y_{k}\right), \hspace{0.15cm}k=0,...,N-1,
\end{equation}
с начальным условием
$\rho\left(0,y_{0}\right)=\rho_{0}\left(y_{0}\right)$.

Система уравнений (1), (2) представляет собой модель получения
кадров изображения с~учетом изменения яркости вдоль траекторий
движения.

Сформулируем оптимизационную задачу. С~этой целью введем
функционал качества следующего вида:

\begin{equation} \label{eq3}
I\left(u\right)=\sum\limits_{k=1}^{N-1} \int\limits_{M_{k,u}}
\varphi_{k}\left(y_{k},\rho\left(k,y_{k}\right),u_{k}\right)dy_{k}
+ \int\limits_{M_{N,u}}
g\left(y_{N},\rho\left(N,y_{N}\right)\right)dy_{N},
\end{equation}
здесь
$\varphi_{k}=\varphi_{k}\left(y_{k},\rho\left(k,y_{k}\right),u_{k}\right),
\hspace{0.15cm}k = 1,...,N-1$,
и~$g=g\left(y_{N},\rho\left(N,y_{N}\right)\right)$ --- непрерывно
дифференцируемые функции своих аргументов, $y_{k}$ --- переменная
интегрирования по множеству $M_{k,u}, \hspace{0.15cm}k=1,...,N$.

Будем рассматривать совместно уравнения (1) и~(2)
с~соответствующими начальными условиями. Для системы (1), (2)
необходимо найти такое допустимое  \textit{u}, чтобы
минимизировать функционал качества (3). Под допустимыми
управлениями будем понимать управления, удовлетворяющие условиям
\[\parallel u\left(k\right)\parallel\le m^{2}, \hspace{0.15cm}k=0,1,...N-1, \hspace{0.15cm}m\in R^{1}.\]

\textbf{Вариация функционала.} Используя методику исследования
функционалов вида (3), приведенную в~работах [18--20], вариацию
этого функционала можно представить таким образом:
\[\delta I=\sum\limits_{k=0}^{N-1}\int\limits_{M_{k,u}}\bigg (J\left(k\right)p^{T}\left(k+1\right)\frac{\partial F\left(k\right)}{\partial u\left(k\right)}+J_{k}\xi^{T}\left(k+1\right)\rho\left(k\right)\frac{\partial J^{-1}\left(k\right)}{\partial u\left(k\right)}\hspace{0.15cm}+\]
\begin{equation} \label{eq4}
+ \hspace{0.15cm}q\left(k+1\right)\frac{\partial
J\left(k\right)}{\partial
u\left(k\right)}+\frac{\partial\varphi\left(k\right)}{\partial
u\left(k\right)}\bigg)dy_{k}\Delta u\left(k\right),
\end{equation}
где $p\left(k\right),\xi\left(k\right),q\left(k\right)$~---
вспомогательные функции
\[p^{T}\left(N\right)=\left(\frac{\partial g\left(y_{N},\rho_{N}\right)}{\partial y\left(N\right)}\right), \hspace{0.15cm}\xi^{T}\left(N\right)=\left(\frac{\partial g\left(y_{N}, \rho_{N}\right)}{\partial \rho\left(N\right)}\right), \hspace{0.15cm}q\left(N\right)=g\left(y_{N},\rho_{N}\right),\]
\[p^{T}\left(k\right)=J\left(k\right)p^{T}\left(k+1\right)\frac{\partial F\left(k\right)}{\partial y\left(k\right)}+J_{k}\xi^{T}\left(k+1\right)\rho\left(k\right)\frac{\partial J^{-1}\left(k\right)}{\partial y\left(k\right)}~+\]
\begin{equation} \label{eq5}
+\hspace{0.15cm}q\left(k+1\right)\frac{\partial
J\left(k\right)}{\partial
u\left(k\right)}+\frac{\partial\varphi\left(k\right)}{\partial
u\left(k\right)},
\end{equation}
\[\xi\left(k\right)=\xi\left(k+1\right)+\frac{\partial\varphi\left(k\right)}{\partial\rho\left(k\right)},\]
\[q\left(k\right)=J\left(k\right)q\left(k+1\right)+\varphi\left(k\right), \hspace{0.15cm}k=1,...,N-1.\]

Благодаря представлению (4) вариации функционала (3), имеем
возможность использовать различные направленные методы
оптимизации.

\textbf{Оптимизационный алгоритм.} Уравнение (2) описывает
изменение плотности (яркости) вдоль траекторий в~математической
модели (1), (2). При этом из динамического радионуклидного
исследования известна плотность распределения радиофармпрепарата
на каждом кадре [8], обозначим ее
$\bar\rho\left(k,y\left(k\right)\right)$,  $k=0,...,N$, причем
$\bar\rho\left(0,y\left(0\right)\right)=\rho_{0}\left(y_{0}\right).$
Необходимо восстановить функцию
$F\left(k,y\left(k\right),u\left(k\right)\right)$, в~которой
неизвестным считаем вектор параметров $u\left(k\right)$.

Рассмотрим частный случай функционала (3)
\begin{equation} \label{eq6}
I\left(u\right)=\sum\limits_{k=1}^{N}\int\limits_{M_{k,u}}\left(\rho\left(k,y_{k}\right)-\bar\rho\left(k,y_{k}\right)\right)^{2}dy_{k}.
\end{equation}

Таким образом, минимизируя функционал (6), найдем вектор
параметров $u\left(k\right)$, а~следовательно, сможем построить
поле перемещений в~соответствии с~уравне\-нием~(1).

При обработке изображений вид функции
$F=F\left(k,y\left(k\right),u\left(k\right)\right)$ в~системе (1),
(2) неизвестен. Поэтому функцию  \textit{F} можно считать
функцией, представленной отрезком некоторого ряда, например ряда
Тейлора. В~частности, на первом этапе построения поля перемещений
можно рассматривать функцию \textit{F} как линейную
вектор-функцию.

Для простоты изложения опишем только один шаг процесса $N=1$,
т.~е. два последовательных кадра, тогда система (1) примет вид
\begin{equation} \label{eq7}
y\left(1\right)=F\left(0,y\left(0\right),u\left(0\right)\right).
\end{equation}

\noindentОбозначим, что в~(7) $y\left(0\right)=y,
u\left(0\right)=u$, а~$F\left(0,y,u\right)=F\left(y,u\right)$.

Рассмотрим случай, когда $F\left(y,u\right)=Ay+B$, где
$y=\left(\begin{array}{ccc}y^{1}\\y^{2}\end{array}\right)$ ---
2-мерный вектор, а~ \textit{A} --- матрица размерности $2\times
2$,
$A=\left(\begin{array}{ccc}\textrm{cos}u_{1}&\textrm{sin}u_{1}\\
-\textrm{sin}u_{1}&\textrm{cos}u_{1}\end{array}\right)$ и~вектор
$B=\left(\begin{array}{ccc}u_{2}\\u_{3}\end{array}\right)$, т.~е.
предположим, что в~результате преобразования возможны только сдвиг
и поворот. В~этом случае вектор искомых параметров
$u=\left(u_{1},u_{2},u_{3}\right)$.

Вариация функционала  в~данном случае записывается следующим
образом:
\begin{equation} \label{eq8}
\delta
I\left(u\right)=\int\limits_{M_{0}}p^{T}\left(1\right)\frac{\partial
F\left(y,u\right)}{\partial u}dy\Delta u,
\end{equation}
где $p^{T}\left(1\right)=\frac{\partial g\left(1\right)}{\partial
y\left(1\right)},\frac{\partial F\left(y,u\right)}{\partial
u}=\left(\begin{array}{rcc}y^{2}\textrm{cos}u_{1}-y^{1}\textrm{sin}u_{1}&1&0\\-y^{1}\textrm{cos}u_{1}-y^{2}\textrm{sin}u_{1}&0&1\end{array}\right).$

\vskip 2mmОбозначим компоненты вектора $p\left(1\right)$:
\[\left(p_{1},p_{2}\right)=p^{T}\left(1\right).\]
\pagebreak

Запишем градиент функционала так:
\[\frac{\partial I}{\partial u_{1}}=\int\limits_{M_{0}}p_{1}\left(y^{2}\textrm{cos}u_{1}-y^{1}\textrm{sin}u_{1}\right)-p_{2}\left(y^{1}\textrm{cos}u_{1}+y^{2}\textrm{sin}u_{1}\right)dy,\]
\begin{equation} \label{eq9}
\frac{\partial I}{\partial u_{2}}=\int\limits_{M_{0}}p_{1}dy,
\end{equation}
\[\frac{\partial I}{\partial u_{3}}=\int\limits_{M_{0}}p_{2}dy.\]

\noindentНа основе этого выражения можно строить направленные
методы оптимизации.

Для реализации алгоритма введем дискретизацию по пространственным
координатам. Рассмотрим функцию
$\rho\left(k,y\left(k\right)\right)$, при фиксированном
\textit{k}\, $\rho\left(y\right)=\rho\left(y^{1},y^{2}\right)$
будет функцией двух пространственных переменных $y^{1}$ и~$y^{2}$.
Будем изучать ее на ограниченной прямоугольной области
изображения. Введем фиксированную сетку точек с~приращением шага
$\Delta_{1}$, равным ширине одного пикселя вдоль оси $y^{1}$,
и~с~приращением шага $\Delta_{2}$, равным высоте одного пикселя
вдоль оси $y^{2}$. Размерность сетки ($N_{1}$ по оси  $y^{1}$
и~$N_{2}$ по оси $y^{2}$) определяется размером описываемого
изображения с~учетом шага дискретизации в~один пиксель. Решения
будут находиться в~узлах этой двумерной сетки, таким образом, нам
будут известны значения яркости (плотности распределения) для
каждого пикселя изображения
$\rho\left(n_{1}\Delta_{1},n_{2}\Delta_{2}\right)=\rho\left(y^{1},y^{2}\right)\vert_{y^{1}=n_{1}\Delta_{1},y^{2}=n_{2}\Delta_{2}}$,
где $n_{1}\in N_{1}\in Z, n_{2}\in N_{2}\in Z$. Функция
$\rho\left(n_{1}\Delta_{1},n_{2}\Delta_{2}\right)$ --- функция
двух дискретных переменных.

Построим итерационный алгоритм определения векторов перемещений,
ото\-бра\-жаю\-щий последовательность действий для нахождения
вектора неизвестных параметров   и~определения перемещений.
Предположим, что начальное состояние системы (1), (2) задано,
т.~е. задано множество $M_{0}$ и~начальное распределение яркости
(плотности) $\rho_{0}$. Также заданы функции
$\bar\rho\left(k,y\left(k\right)\right)$, $k=0,...,N$. Алгоритм
состоит  из следующих основных шагов:
%\begin{spacing}{0}
%\begin{enumerate}[itemindent=1em]
%\begin{enumitem}
%\begin{spacing}{0cm}
%\begin{enumerate}[wide, labelwidth=!, labelindent=19pt]%[itemindent = 1.5cm leftmargin=0cm]
%\setlength{\itemsep}{0pt}


1)\,\,определение начального приближения для вектора неизвестных
параметров~$u^{0}$. Начало процесса  $i=0$;

2)\,\,начало \textit{i}-й итерации алгоритма;

3)\,\,расчет интегрального функционала $I\left(u^{i}\right)$ по
формуле (6);

4)\,\,вычисление вспомогательных функций по (5). Для
рассматриваемого случая это компоненты вектора
$p^{T}\left(1\right)=\left(p_{1},p_{2}\right)$. Для их определения
находим значения частных производных $\frac{\partial\rho}{\partial
y^{1}}$, $\frac{\partial\rho}{\partial y^{2}}$ в~узлах сетки
с~использованием оператора Со\-бе\-ля~[21];

5)\,\,определение градиента интегрального функционала по
уравнениям (9);

6)\,\,вычисление $u^{i+1}$ методом градиентного спуска
$u^{i+1}=u^{i+1}\left(\alpha\right)=u^{i}-\alpha\times
\textrm{grad}I\left(u^{i}\right)$, где $\alpha$ --- параметр
оптимизации;

7)\,\,проверка условий остановки алгоритма: достижение требуемой
точности или заданного числа итераций: $\vert
I\left(u^{i+1}\right) - I\left(u^{i}\right)\vert<\varepsilon$ или
$i=K$, где $K$ --- заданное число итераций;

8)\,\,в~случае невыполнения условий шага 7 $i = i+1$ и~возвращение
на шаг 2;

9)\,\,построение векторов перемещений. Определив вектор $u$
и~правую часть системы (1), можно рассчитать векторы перемещений.
%\end{enumerate}
%\end{spacing}
%\end{spacing}

%\begin{figure}[H]
%\center{\includegraphics[width=100mm, keepaspectratio]{Pict_1}}
%\caption{Блок-схема алгоритма} \label{Pict_1:image}
%\end{figure}


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{10/fig1}
\vskip 2mm \caption{Блок-схема алгоритма }\label{Pict_1:image}
\end{figure}


Блок-схема алгоритма определения поля перемещений представлена на
рис. 1.

\textbf{Обработка радионуклидных изображений.} Радионуклидные
изображения получают при проведении диагностических исследований
с~использованием радиоактивных изотопов, которые позволяют при
введении их в~индикаторных количествах в~организм изучать
состояние органов и~систем организма в~норме и~патологии.
Радионуклидные исследования осуществляются с~помощью гамма-камер,
гамма-томографов, позитронно-эмиссионных томографов. Эта
аппаратура дает возможность регистрации распределения во времени
и~пространстве радиоактивных препаратов и~представления данной
информации в~виде цифровых величин или кадровой последовательности
на экране компьютера. Цифровая обработка полученных изображений
является важной частью диагностического процесса. Представленный
в~работе алгоритм был реализован в~среде Matlab и~протестирован на
ряде динамических исследований.

Рассмотрим тестовые радионуклидные изображения, полученные при
динамическом сканировании~[8]. На рис. ~2 представлена
последовательность радионуклидных изображений, на которых
визуализируется  подвижная область интереса и~по\-строен\-ные для
изучаемой области для каждой из пар последовательных изображений
вектора перемещений.

%{\center{а \makebox[14em]{ } б}}
%\begin{figure}[h!]
%\center{\includegraphics[width=110mm, keepaspectratio]{Pict_2}}
%\caption{Последовательность кадров (а) и~поле перемещений,
%построенное для области интереса (б)} \label{Pict_2:image}
%\end{figure}


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{10/fig2}
\vskip 2mm \caption{Последовательность кадров ({\it а}) и~поле
перемещений, }\label{Pict_2:image} \centering \vspace{0.5mm}
\small{построенное для области интереса ({\it б}) }
\end{figure}


На рис. 3 приведен результат определения поля перемещений для
последовательности радионуклидных изображений желудка. Необходимо
найти смещение этого органа для коррекции положения контура данной
области интереса.

%\begin{figure}[h!]
%\center{\includegraphics[width=120mm, keepaspectratio]{Pict_3}}
%а \makebox[14em]{ } б
%\caption{Последовательность изображений (а) и~поле перемещений (б)
%для соответствующих пар последовательных изображений}
%\label{Pict_3:image}
%\end{figure}


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{10/fig3}
\vskip 2mm \caption{Последовательность изображений ({\it а})
и~поле перемещений ({\it б}) }\label{Pict_3:image} \centering
\vspace{0.5mm} \small{для соответствующих пар последовательных
изображений }
\end{figure}


Также для апробации работы алгоритма были изучены радионуклидные
изображения, полученные при динамическом исследовании печени. На
рассматриваемых кадрах область интереса (печень) смещается от
кадра к~кадру. Такое смещение было определено алгоритмом, на рис.
4 представлены векторы перемещений, построенные в~точках контура
печени.

%\begin{figure}[h!]
%\center{\includegraphics[width=100mm, keepaspectratio]{Pict_4}}
%\caption{Результаты определения векторов перемещения области
%интереса. \\ а~– кадры; б – построенные векторы перемещений на
%соответствующих кадрах} \label{Pict_4:image}
%\end{figure}


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{10/fig4}
\vspace{2mm} \caption{Результаты определения векторов перемещения
области интереса }\label{Pict_4:image} \vspace{0.5mm} \centering
\footnotesize{ {\it а}~--- кадры; {\it б} --- построенные векторы
перемещений на соответствующих кадрах. }
\end{figure}


Полученные результаты могут быть использованы при анализе
радионуклидных изображений, а~также для коррекции контуров на
изображениях.

\textbf{Заключение.} В~настоящей работе предложена новая
математическая модель дискретной оптимизации, которая может
применяться для обработки изображений в~различных прикладных
задачах. Принимая во внимание, что информация поступает
в~дискретные моменты времени, для описания процесса получения
кадровой последовательности используются разностные уравнения.
Рассматривается функ\-цио\-нал качества общего вида, для которого
приводятся аналитическое выражение вариа\-ции, а~также частный
случай вида функционала для обработки последовательности
радионуклидных динамических кадров. В~статье представлен
разработанный и~реа\-ли\-зо\-ван\-ный оптимизационный алгоритм
обработки изображений. Установлено, что с~помощью предложенного
алгоритма определения векторов перемещений для последовательностей
изображений можно анализировать изображения и~корректировать
движение при радионуклидной диагностике. В~описанной модели также
заложена возможность учета изменения яркости (плотности) вдоль
траекторий движения рассматриваемой системы, что расширяет
возможности применения данного метода.

Приведены примеры обработки радионуклидных изображений, полученных
при динамическом режиме сканирования [6--8].

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{10/lit-ra}

%\newpage
\input{10/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %
%
}
