%
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,18.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ПРИКЛАДНАЯ МАТЕМАТИКА} \vspace{1.5cm}%1.8cm}

\noindent{\small УДК 519.216.5  %\hfill {\footnotesize %
%Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}%

\noindent MSC 65C05

}

\vskip2.5mm%3mm

\noindent{\bf Аппроксимация супремумных и инфимумных процессов\\ как стохастический подход к выполнению требований гомеостаза$^{*}$%
 }

\vskip2.0%2.5
mm

\noindent{\it Г. И. Белявский, Н. В. Данилова, Г. А. Угольницкий$%\,^1$%
%, И.~О. Фамилия%$\,^2$%

}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского научного фонда (проект №~17-19-01038).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum01 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum01}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent%
%$^1$~%
Южный федеральный университет, Российская Федерация,

\noindent%
%\hskip2.45mm%
344006, Ростов-на-Дону, ул. Большая Садовая, 105/42


%\noindent%
%$^1$~%
%Санкт-Петербургский государственный университет, Российская Федерация,
%
%\noindent%
%\hskip2.45mm%
%199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip2.5%3
mm

{\small \noindent \textbf{Для цитирования:} \textit{Белявский Г. И., Данилова Н. В., Угольницкий Г. А.} Аппроксимация супремумных и инфимумных процессов как стохастический подход к выполнению требований гомеостаза~// Вестник
Санкт-Пе\-тер\-бург\-ско\-го университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~18.
Вып.~\issuenum.
С.~\pageref{p1}--\pageref{p1e}. \\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum01

\vskip2.5%3
mm

{\leftskip=7mm\noindentРассматривается вычисление ограниченных функционалов на траекториях стационарного диффузионного процесса. Поскольку аналитического решения данной задачи, как правило, не существует, то необходимо использовать численные методы. Одно из воз\-можных направлений получения численного метода~--- это применение метода Монте-Карло (МК), который предполагает воспроизведение траектории случайного процесса с~последующим усреднением по траекториям. Для упрощения воспроизведения траекто\-рии используется преобразование Гирсанова. Основная цель данной работы~--- аппроксимация супремумного и инфимумного процессов, позволяющая более точно по сравнению с~классическим методом вычислить  математическое ожидание функции, зависящей от значений супремумного и инфимумного процессов на конце временного интервала.  Метод основывается на случайном разбиении интервала на оси времени моментами остановки~ --- пассажами винеровского процесса, аппроксимации плотности для замены меры и использовании метода МК при вычислении математического ожидания. Одно из приложений метода~--- задача удержания случайного процесса в заданной области, т. е. задача гомеостаза.\\[1mm]
\textit{Ключевые слова}: диффузия, метод Монте-Карло, преобразование Гирсанова, гомеостаз.

}

}

\vskip 3%4
mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\textbf{1. Введение.}} Рассматривается вычисление ограниченных функционалов на траекториях стационарного диффузионного процесса, подчиняющегося стохастическому дифференциальному уравнению $dX_t =f(X_t)dt+\varphi (X_t)dW_t$, где коэффициент $\varphi (x)>0$,  на конечном интервале $[0,T]$, с~начальным значением $X_{0}$ и коэффи\-циен\-тами, удовлетворяющими стандартным условиям, например глобальному условию Липшица $|f(x)-f(y)|+|\varphi (x)-\varphi (y)|\le L|x-y|$, которые гарантируют существование и единственность сильного решения дифференциального уравнения.
Решение уравнения обычно представляется следующим образом:

\begin{equation*}
X_{t}=X_{0}+\int\limits_{0}^{t}f(X_{s})ds+\int\limits_{0}^{t}\varphi(X_{s})dW_{s}.
\end{equation*}


%\makeatletter
%\renewcommand{\@oddfoot}{ {\footnotesize Вестник СПбГУ. Прикладная %математика. Информатика... 2022. Т. 18. Вып. 1} \hfil\thepage }
%\renewcommand{\@evenfoot}{\thepage \hfil {\footnotesize Вестник СПбГУ. %Прикладная математика. Информатика... 2022. Т. 18. Вып. 1} }
%\makeatother

\noindent Первый интеграл в этой формуле~--- потраекторный интеграл Лебега, второй~--- интеграл Ито по винеровскому процессу. Если задать на оси времени точки разбиения $t_{i}$ и применить формулу прямоугольников при вычислении интегралов, то приближенное решение в точках разбиения оси времени будет иметь вид
\begin{equation*}
X_{t_{i}}=X_{t_{i-1}}+f(X_{t_{i-1}})(t_{i}-t_{i-1})+\varphi(X_{t_{i-1}})\sqrt{t_{i}-t_{i-1}}\varepsilon_{i},
\end{equation*}
в котором $\varepsilon_{i}$~--- это последовательность независимых стандартных нормальных случайных величин.

Во многих приложениях необходимо на траекториях решения вычислять математическое ожидание $E\Psi \left(\bar{X}_{T},\underline{X}_{T} \right)$ для ограниченной функции $\Psi$. Процессы $\overline{X}$ и $\underline{X}$~--- супремумный и инфимумный процессы соответственно, т. е. $\overline{X}_{t}=\sup_{s\leq t} X_{s}, \underline{X}_{t}=\inf_{s\leq t} X_{s}$.

Пусть $X_{t}$~--- винеровский процесс и случайное время $\tau$ распределено по показательному закону распределения с параметром $\lambda$. Для супремумного процесса случайная величина $\overline{X}_{\tau}$  распределена по показательному закону распределения с параметром $\sqrt{2\lambda}$. Для инфимумного процесса случайная величина $\underline{X}_{\tau}$  также распределена по показательному закону, но на отрицательной полуоси с тем же параметром. Аналогичным свойством, но с другими законами распределения обладают все процессы Леви. Можно привести еще один факт, связанный с супремумным процессом,  свойственный винеровскому процессу, а именно, для произвольного $t$  справедливо равенство $P(\overline{X}_{t}\geq h)=2\left(1-\Phi\left(h / \sqrt{t} \right)\right)$.
Одно из приложений рассматриваемой задачи~--- вычисление цен барьерных опционов в финансовой математике, другое~--- удержание случайного процесса в полосе в течение определенного времени в связи с гомеостазом. Одна из постановок этой задачи рассматривается в настоящей статье.

Поскольку аналитического решения задачи вычисления математического ожидания $E\Psi \left(\bar{X}_{T},\underline{X}_{T} \right)$ для ограниченной функции $\Psi$, как правило, не существует, то необходимо использовать численные методы. Одно из возможных направлений получения численного метода~--- это применение метода Монте-Карло (МК) [1, 2], который предполагает воспроизведение траектории решения уравнения, вычисление $\Psi \left(\bar{X}_{T},\underline{X}_{T} \right)$ с~последующим усреднением по траекториям. Для упрощения воспроизведения решения используется преобразование Гирсанова  [3], связанное с~заменой меры при вычислении математического ожидания. Оно позволяет заменить исходное уравнение на два более простых уравнения:
\begin{equation}
 dX_t =\varphi (X_t)dB_t,\quad
 dZ_t =Z_t \frac{f(X_t)}{\varphi (X_t)} dB_t
\end{equation}
c заданным значением $X_{0}$ и $Z_{0} =1$.

При определении математического ожидания производится такая замена меры: \\$E^{W}\Psi (\bar{X}_{T},\underline{X}_{T})=E^{B} \left[Z_{T} \Psi (\bar{X}_{T},\underline{X}_{T} )\right]$. Мера $P^{B}$ такова, что относительно нее дифференциал процесса $B$, т.~е. $dB_t=\dfrac{f(X_t )}{\varphi (X_t)} dt+dW_t$, есть винеровский. Упрощение исходного уравнения с помощью преобразования Гирсанова возможно при условии $E^{B} Z_{T}=1$. Достаточным условием выполнения данного равенства является условие Новикова [4]:
\begin{equation*}
\displaystyle E\exp \left(\frac{1}{2} \int\limits_{0}^{T}\left(\frac{f\left(X_t \right)}{\varphi \left(X_t \right)} \right)^{2} dt \right)<\infty.
\end{equation*}
При этом решение второго уравнения есть равномерно интегрируемый мартингал, поэтому $E^{B} Z_{T}=1$. Очевидно, что условие Новикова выполняется, если функция  $f(x) / \varphi(x) $ ограниченная. Далее будем это предполагать.

Численные методы решения стохастического дифференциального уравнения предполагают воспроизведение траектории при помощи дискретного множества точек $\left\{X_{i}^{\delta} \colon  i=1,2,{\dots},n\right\}$, связанного с разбиением интервала $[0,T]$ на $n$~частей: $0=\tau_{0} <{\dots}<\tau_{n} =T$ с~$\delta =\max (\tau_{i} -\tau_{i-1})$, которые приближенно равны соответствую\-щим точкам $\left\{X_{i} \colon  i=1,2,{\dots},n\right\}$ на траектории решения дифференциального урав\-нения ($X_{i} =X_{\tau_{i}}$). Полное изложение численных методов решения стохастических дифференциальных уравнений можно найти в~монографии [5]. Они в~качестве \mbox{своих} прототипов имеют аналогичные методы решения обыкновенных дифференциальных уравнений, например метод Эйлера или метод Рунге~--- Кутта. При выполнении определенных условий относительно коэффициентов уравнения для численных методов гарантируется выполнение неравенства $E\left|X_{\tau_{i}} -X_{\tau_{i}}^{\delta} \right|\le C\delta^{\gamma}$, константа $C$ не зависит от $\delta$. Причем существует такое $\delta_{0}$, что данное неравенство выполняется для всех $0<\delta <\delta_{0}$, $0<\gamma <1$ (подробнее см.~[5]).  Авторам неизвестно доказательство аналогичного неравенства для супремумного и инфимумного процессов, связанных с~решением стохастического дифференциального уравнения.

Основная цель работы~--- аппроксимация супремумного и инфимумного процессов, позволяющая более точно по сравнению с~классическим методом вычислить  математическое ожидание $E\Psi (\bar{X}_{T},\underline{X}_{T})$.  Метод основывается на случайном разбиении интервала на оси времени моментами остановки~--- пассажами винеровского процесса, аппроксимации плотности замены меры $Z_{T}$~--- решения второго уравнения  и применении метода МК при расчете математического ожидания.

Случайное разбиение временного интервала с~помощью показательного закона распределения впервые было применено П.~Карром [6] при вычислении справедливой цены американского опциона put. Затем в дальнейшем оно очень часто учитывалось в~расчетах на моделях под управлением процессов Леви [7--9]. В~данной работе описывается другое случайное разбиение. В~работе [10] для этого внедряются пассажи диффузионного процесса.

Важное приложение метода~--- задача удержания случайного процесса в~заданной области, которое трактуется как поддержание гомеостаза. Если сложная динамическая  система удовлетворяет условию гомеостаза, то система развивается устойчиво на протяжении времени ее функционирования. Математическое описание гомеостаза (живучести) приведено в~[11]. Устойчивому управлению в~связи с~гомеостазом посвящена работа [12].

\indent{\textbf{2. Случайное разбиение и аппроксимация.}} Наиболее подходящей для предлагаемого метода является модель, в~которой локальная изменчивость~--- постоянная величина, т. е. $\varphi(x)=\sigma $. Поэтому дальнейшее изложение посвящено такому случаю с~сознательной потерей общности результата.

Произведем равномерное разбиение фазовой оси $OY=R$. Выберем основной параметр алгоритма равным~$h$.  Для данного $h$  шаг разбиения равен $h\sigma$,  и будем считать, что $X_0 \in \{i\sigma h,\, i=0,\pm 1 ,{\dots}\}$.  Произведем случайное разбиение интервала $[0,T]$. Зададим стохастический базис $\left\langle \Omega, F_t^B,P^B \right\rangle$, порождаемый винеровским процессом, в~котором $\Omega =C[0,T]$, $F_t^B =\sigma \left(B_s,s\in [0,t]\right)$. Далее построим разбиение интервала $[0,T]$ последовательностью моментов остановки относительно этого базиса, которая вычис\-ляет\-ся следующим образом: $\tau_{0}=0$, $\tau_i =\min\left\{s\ge \tau_{i-1} \colon  \left|B_{s} -B_{\tau_{i-1}}\right|=h\right\}$, $i=1,2,{\dots},n$. Из строго марковского свойства винеровского процесса следует, что $\tau_i =\tau_{i-1} +\nu_i$, где $\nu_i$~--- независимые случайные величины с~общим законом распределения, совпадающим с~законом распределения случайной величины $\nu =\min \left\{s\ge 0\colon |B_s|=h\right\}$.  Плотность распределения этого закона  имеет вид
\begin{equation}
p_{\nu}(t) = 2\sum_{k=0}^{\infty} (-1)^k \frac{h(1+2k)}{t} \varphi_t (h(1+2k)),
\end{equation}
здесь $\displaystyle \varphi_t(a)=\frac{1}{\sqrt{2\pi t}} e^{-\frac{a^{2}}{2t}}$ (см.~[13]). Отметим, что $E\nu =h^{2}$. Пусть  $n$~--- единственное целое решение двойного неравенства $nh^2 \le T\le (n+1)h^2$. Отсюда $0\le T-E\tau_n \le h^2$. Дисперсия $Dv=h^{4}$, поэтому $D\tau_n \le h^2T$.  Неравенство $E(\tau_n-T)^2 =D\tau_n +(T-E\tau_n)^2 \le h^2 (T+1)$ очевидно. Следовательно, при $h\to 0$  $\tau_n \to T$ в~метрике $L_2$. Поскольку $\tau_n$~--- это сумма независимых и одинаково распределенных случайных величин с~ограниченной дисперсией, то возможно применение центральной предельной теоремы в~ее простейшем варианте. Ее следствием является следующее неравенство: $|\tau_n -T|\le (1+k_{\alpha})h^2$, выполняющееся с~доверительной вероятностью $\alpha$, где $\displaystyle k_{\alpha} =\Phi^{-1} \left(\frac{1+\alpha}{2}\right)$,  $\Phi^{-1} (x)$~--- обратная функция Лапласа.

При постоянной изменчивости $\sigma$ уравнение $dX_t =\sigma dB_t$ имеет точное решение $X_t=\sigma B_t$. При случайном разбиении $\tau$ рассмотрим последовательность точек
\begin{equation}
  X_{\tau_i}^{\tau} = X_{\tau_{i-1}}^{\tau} +
\sigma B_{\nu_i}^{(i)}
\end{equation}
на траектории решения уравнения. В~(3) $B^{(i)}$ обозначает $i$-ю независимую копию винеровского процесса~$B$. Здесь применено строго марковское свойство винеровского процесса, поэтому важно, чтобы случайное разбиение производилось моментами остановки. Из определения  моментов остановки следует, что случайные величины $B_{\nu_i}^{(i)} \in \{-h,h\}$~--- независимые и одинаково распределенные  случайные величины с~вероятностями $\displaystyle P\left(B_{\nu_i}^{(i)} =-h\right)=P\left(B_{\nu_i}^{(i)} =h\right)=\frac{1}{2}$. Отсюда уравнение (3) можно представить следующим образом:
\begin{equation*}
  X_{\tau_i}^{\tau,\delta} =
  X_{\tau_{i-1}}^{\tau,\delta} +\sigma h\delta_i,
  \quad
  X_{\tau_0}^{\tau,\delta}=X_0,
\end{equation*}
где $\delta $~--- последовательность радемахеровских случайных величин. Для избранных разбиения и аппроксимации очевидно, что, во-первых, $X_{\tau_i}^{\tau,\delta} \in \{j\sigma h,\,$ $ j=0,\pm 1,\dots\}$,\linebreak если $X_0 \in \{j\sigma h,\, j=0,\pm 1,\dots\}$;  во-вторых, выполняются неравенства $X_{\tau_{i-1}}^{\tau,\delta} -\sigma h\le $ %
$\inf\limits_{[\tau_{i-1},\tau_i]}X_t$, $\sup\limits_{[\tau_{i-1},\tau_i]} X_t \le X_{\tau_{i-1}}^{\tau,\delta} +\sigma h$, причем одно из неравенств становится равенством, а другое~--- строгим неравенством в~зависимости от значения $\delta_i$.

Из данных неравенств вытекает утверждение 1.

\textbf{Утверждение 1.} Если $a\in \{i\sigma h,\, i=0,\pm 1,\dots\},\, b\in \{i\sigma h,\, i=0,\pm 1,\dots\}$, $X_0 \in \{i\sigma h,\, i=0,\pm 1,\dots\}$, $a<X_0<b$, то справедливо равенство индикаторов:
\begin{equation*}
  I_{\left\{(\bar{X}_{\tau_n} \ge b)\vee (\underline{X}_{\tau_n} \le a)\right\}} =I_{\left\{(\bar{X}_{\tau_n}^{\tau,\delta} \ge b)\vee (\underline{X}_{\tau_n}^{\tau,\delta} \le a)\right\}}.
\end{equation*}

Рассмотрим класс функций следующего вида:
\begin{equation*}
  \Psi (x,y)=\sum_{k=1}^m \psi_k I_{\left\{(x\ge b_{k})\vee (y\le a_k)\right\}}.
\end{equation*}

Набор чисел упорядочен таким образом: $a_n<a_{n-1}<{\dots}<a_1<b_1<b_2<{\dots}<b_n$, коэффициенты $\psi_i \ge 0$. Очевидно, что утверждение 1 распространяется на данный класс функций.

\textbf{Утверждение 2.}
Если $a_k \in \{i\sigma h,\, i=0,\pm 1,\dots\}$, $b_k \in \{i\sigma h,\, i=0,\pm 1,\dots\}$, $X_0 \in \{i\sigma h,\, i=0,\pm 1,{\dots}\}$, $a_1<X_0<b_1$, то справедливо равенство
\begin{equation*}
\Psi (\bar{X}_{\tau_n},\underline{X}_{\tau_n} )=\Psi (\bar{X}_{\tau_n}^{\tau,\delta},
\underline{X}_{\tau_n}^{\tau,\delta}).
\end{equation*}

Если $\Psi (x,y)=I_{\left\{(x\ge b)\vee (y\le a)\right\}}$, то  $E\Psi (\bar{X}_T,\underline{X}_T)$~--- вероятность выхода случайного процесса из полосы.

\textbf{Замечание 1.}
В~задаче о~гомеостазе коэффициенты $\psi_k$~--- приращение штрафа, а $E\Psi (\bar{X}_T, \underline{X}_T)$ --- средний штраф за выход из полосы.

Если остановимся на таком классе функций, то единственным источником ошибки при вычислении математического ожидания является преобразование Гирсанова. Для процесса плотности преобразования Гирсанова справедливо второе уравнение из~(1), которое с~учетом постоянства волатильности приобретает вид
\begin{equation*}
dZ_t = \frac{1}{\sigma} Z_t f(\sigma B_t)dB_t,
\end{equation*}
для  приближенного преобразования Гирсанова следует рассматривать последовательность дифференциальных уравнений $d\bar{Z}_t=\frac{1}{\sigma} \bar{Z}_t f(\sigma B_{\tau_{i-1}})dB_t$, $\tau_{i-1} \le t<\tau_i$ с~начальными значениями $\bar{Z}_{\tau_{i-1}}$, $i=1,{\dots},n$. Оценим разность между $\displaystyle Z_{\tau_n} \Psi (\bar{X}_{\tau_n},\underline{X}_{\tau_n})$ и $\bar{Z}_{\tau_n} \Psi (\bar{X}_{\tau_n}^{\delta,\tau},
\underline{X}_{\tau_n}^{\delta,\tau})$:
\begin{equation*}
\displaystyle Z_{\tau_n} \Psi (\bar{X}_{\tau_n},\underline{X}_{\tau_n})-
\bar{Z}_{\tau_n} \Psi (\bar{X}_{\tau_n}^{\delta,\tau},
\underline{X}_{\tau_n}^{\delta,\tau} ) = \left(\frac{Z_{\tau_n}}{\bar{Z}_{\tau_n}} -1\right)\bar{Z}_{\tau_n} \Psi \left(\bar{X}_{\tau_n}^{\delta,\tau}, \underline{X}_{\tau_n}^{\delta,\tau} \right)=
\end{equation*}
\begin{equation*}
=\left(\exp (\Delta (\tau_{0} =0,\tau_{1},{\dots},\tau_n))-1\right)\bar{Z}_{\tau_n} \Psi (\bar{X}_{\tau_n}^{\delta,\tau},
\underline{X}_{\tau_n}^{\delta,\tau}).
\end{equation*}
Для случайной величины
\begin{equation*}
\displaystyle \Delta (\tau_0=0,\tau_1,\dots,\tau_n )=-\frac{1}{2\sigma^2} \sum_{i=1}^n
\int\limits_{\tau_{i-1}}^{\tau_i}\left(f^2 (\sigma B_{s})-f^2 (\sigma B_{\tau_{i-1}})\right)ds\;+
\end{equation*}
\begin{equation*}
+\;\displaystyle\frac{1}{\sigma} \sum_{i=1}^n
\int\limits_{\tau_{i-1}}^{\tau_i}\left(f(\sigma B_{s} )-f(\sigma B_{\tau_{i-1}})\right)dB_s
\end{equation*}
справедлива оценка
$$\displaystyle |\Delta (\tau_{0} =0,\tau_1,\dots,\tau_n)|\le \frac{1}{\sigma} MLh\tau_n +\frac{1}{\sigma} \Biggl|\sum_{i=1}^n
\int\limits_{\tau_{i-1}}^{\tau_i}\left(f(\sigma B_s)-f(\sigma B_{\tau_{i-1}})\right)dB_s \Biggr| .$$
Здесь $M=\sup\limits_{x\in [a,b]} |f(x)|$, $L$~--- константа Липшица. Рассмотрим случайную величину $\displaystyle \sum_{i=1}^n
\int\limits_{\tau_{i-1}}^{\tau_i}
\left(f(\sigma B_{s})-f(\sigma B_{\tau_{i-1}})\right)dB_{s}$, которая является суммой независимых случайных величин с~нулевыми математическими ожиданиями и ограниченными дисперсиями:
\begin{equation*}
\displaystyle D\left[\int\limits_{\tau_{i-1}}^{\tau_i}
(f(\sigma B_{s})-f(\sigma B_{\tau_{i-1}}))dB_s  \right]\le L\sigma h^3.
\end{equation*}
Использование центральной предельной теоремы для суммы независимых случайных величин с~равномерно ограниченными дисперсиями приводит к~неравенству
\begin{equation}
\left|\Delta (\tau_{0} =0,\tau_1,\dots,\tau_n )\right|\le \frac{1}{\sigma} MLh\left(T+(1+k_{\alpha})h^2 \right)+k_{\beta} \sqrt{\frac{LhT}{\sigma}},
\end{equation}
коэффициент $k_{\beta}$ соответствует доверительной вероятности $\beta$ и вычисляется так же, как коэффициент $k_{\alpha}$. Неравенство (4) выполняется с~доверительной вероят\-ностью~$\alpha \beta$.

Таким образом, абсолютную величину ошибки, возникающей при вычислении математического ожидания, запишем в виде
\begin{gather*}
\left|E\left[Z_{\tau_n} \Psi
(\bar{X}_{\tau_n},\underline{X}_{\tau_n} )-\bar{Z}_{\tau_n} \Psi \left(\bar{X}_{\tau_n}^{\tau,\delta},
\underline{X}_{\tau_n}^{\tau,\delta} \right)\right]\right|\le\\\le E\left|Z_{\tau_n} \Psi (\bar{X}_{\tau_n},
\underline{X}_{\tau_n})-\bar{Z}_{\tau_n} \Psi (\bar{X}_{\tau_n}^{\tau,\delta},
\underline{X}_{\tau_n}^{\tau,\delta} )\right|\le \\
\le
E\left[\bigl|\exp (\Delta (\tau_{0} =0,\tau_{1}, {\dots},\tau_n ))-1 \bigr|\bar{Z}_{\tau_n} \Psi \left(\bar{X}_{\tau_n}^{\tau, \delta},
\underline{X}_{\tau_n}^{\tau, \delta} \right)\right]\le  \\
\le \frac{2|\Delta (.)|}{2-|\Delta (.)|} E\bar{Z}_{\tau_n} \Psi (\bar{X}_{\tau_n}^{\tau, \delta},\underline{X}_{\tau_n}^{\tau,\delta} )\le \frac{2\sum\limits_{i=1}^{m}\psi_i }{2-\varepsilon} \varepsilon
\end{gather*}
при следующем условии: $h$ выбрано таким образом, что $\displaystyle |\Delta(.)|\le \varepsilon <\frac{1}{2}$ с~доверительной вероятностью $\alpha \beta$.

Таким образом, доказано

\textbf{Утверждение 3} \textbf{(Гарантированная ошибка). }
Если функция $f(x)$ удовлетворяет условию Липшица и ограничена, то с~заданной доверительной вероятностью абсолютная величина ошибки при вычислении вероятности невыхода случайного процесса из полосы может быть меньше любого наперед заданного положительного числа за счет выбора основного параметра алгоритма~--- $h$.

\indent{\textbf{3. Генератор моментов остановки.}} Важным элементом алгоритма является генератор моментов остановки с~использованием плотности из $p_{\nu}(t)$ из (2). В~виде ряда можно получить и функцию распределения
\begin{equation*}
 F_{\nu} (t)=2\sum_{k=0}^{\infty}(-1)^{k} \left(1-\Phi \left(\frac{h(1+2k)}{\sqrt{t}} \right)\right),
\end{equation*}
в которой $\Phi(x)$~--- функция Лапласа. Универсальный метод генерации случайной величины с~известной  функцией распределения, как в~рассматриваемом случае, связан с~обращением функции распределения $\nu =F_{\nu}^{-1} (U)$, где $U$~--- равномерная на интервале $[0,1]$ случайная величина. Поскольку данный способ генерации потребует больших вычислительных затрат, то будем использовать более вычислительно эффективный метод~--- \textbf{acceptance-rejection sampling algorithm} (см., например, [14]). Метод заключается в~следующем. Исходная  плотность $f(x)$  приближается сверху более простой плотностью $g(x)$: $f(x)<Mg(x)$ с~константой $M>1$. Генерируются случайная величина~$X$ с~плотностью~$g(x)$ и равномерная на интервале $[0,1]$ случайная величина $U$. Если  $\displaystyle U<\frac{f(X)}{Mg(X)}$, то возвращаем $X$, иначе повторяем заново.

Для плотности из (2) справедливо неравенство $\displaystyle p_{\nu} (t)\le 2\frac{h}{t} \varphi_t(h)$. Функция распределения для плотности $\frac{h}{t} \varphi_t (h)$ имеет вид $\displaystyle F_{\nu} (t)=2\left(1-\Phi \left(\frac{h}{\sqrt{t}} \right)\right)$. Вероят\-ность выполнения  неравенства $\displaystyle P\left(U<\frac{f(X)}{Mg(X)} \right)=\frac{1}{M}$. Для данного случая $\displaystyle P\left(U<\frac{f(X)}{2g(X)} \right)=\frac{1}{2}$. Следовательно, чтобы получить момент остановки, необходимо сгенерировать два равномерно распределенных на интервале $[0,1]$ случайных числа~--- $U_1$ и $U_2$, вычислить случайную величину $\displaystyle X=\left(\frac{h}{\Phi^{-1} \left(1-\frac{U_2}{2} \right)}\right)^2$    и проверить неравенство $\displaystyle U_{1} <\frac{Xp_{\nu}(X)}{2h\psi_{X}(h)} $, при выполнении которого случайная величина $\nu=X$. Причeм среднее число повторений равно двум.

Эффективность этого метода иллюстрирует рис. 1. На нeм представлены  эмпирическая и реальная  плотности распределения случайной величины $\nu $~--- $p_{\nu} (t)$ из (2). Объем выборки равен 10 000.

\begin{figure}[h!]
\centering{
\includegraphics[scale=0.9]{01/fig1}

\vskip 2mm
{\small{\it Рис. 1.} Эмпирическая (сплошная линия) и реальная (точечная линия)\\ плотности закона распределения случайной величины $\nu$ } \\

\vskip 0.5mm {\footnotesize В~методе МК математическое ожидание заменяется выборочным средним. Выборка\\ в~данном случае состоит из независимых элементов $\left\{(\nu^i,\delta^j)\right\}$, $i=1,{\dots},N$, $j=1,{\dots},M$.\\} }
\end{figure}



%\begin{figure}[!ht]
%\centering
%\includegraphics[scale=0.25]{eps/Danilova_ris_1}
%\smallskip
%\caption {Эмпирическая (сплошная линия) и реальная (точечная линия) %плотности закона распределения случайной величины $\nu$.}
%\begin{center}
%\footnotesize
%На оси абсцисс расположены значения $t$, на оси ординат~-- значения %$p_{\nu}(t)$. В~методе МК математическое ожидание заменяется выборочным %средним. Выборка в~данном случае состоит из независимых элементов %$\left\{(\nu^i,\delta^j)\right\}$, $i=1,{\dots},N$, $j=1,{\dots},M$.
%\end{center}
%\end{figure}



Таким образом,
\begin{equation}
   EZ_{\tau_n}^{\tau,\delta} \Psi
   \left(
   \bar{X}_{\tau_n}^{\tau,\delta},
   \underline{X}_{\tau_n}^{\tau,\delta} \right)
   \approx \frac{1}{MN}
   \sum_{i=1}^{N}   \sum_{j=1}^{M}
   Z_{\tau_i^j}^{\tau^i,\delta^j} \Psi
   \left(
   \bar{X}_{\tau_n^i}^{\tau^i,\delta^j},
   \underline{X}_{\tau_n^i}^{\tau^i,\delta^j}
   \right).
\end{equation}

\indent{\textbf{4. Процесс Орнштейна\,---\,Уленбека и задача сохранения гомеостаза.}} Опишем управляемый марковский процесс
\begin{equation*}
dX_t =U\left(X_t \right)dt+\sigma dW_t
\end{equation*}
с~начальным значением $X_0=m$, $t\in [0,T]$, управление $U$~--- обратная связь по фазовой переменной.

Опишем линейный регулятор [15] следующего вида: $U(x)=-\alpha (x-m)$. Задача заключается в выборе наименьшего значения для $\alpha $, при котором средний штраф  за выход из полосы $|x-m|<\eta$, $t\le T$: $E\Psi \left(\bar{X}_T,\underline{X}_T \right)\le \gamma $. Очевидно, что данная задача эквивалентна задаче
\begin{equation}
\begin{array}{l}
  \min \alpha %\\
  dX_t =-\alpha X_t dt+\sigma dW_t,\ X_{0} =0, \\
  E\Psi (\bar{X}_T,\underline{X}_T)\le \gamma.
\end{array}
\end{equation}

Решением стохастического дифференциального уравнения из (6) служит процесс Орнштейна\,---\,Уленбека~--- нестационарный гауссовский процесс с~нулевым средним,  ковариационной функцией $ \displaystyle C(s,t,\alpha)=\frac{\sigma^{2} \exp (-\alpha (t+s))}{2\alpha}$ %\\
$\left[\exp (2\alpha \min (t,s))-1\right]$ и дисперсией $\displaystyle DX_t =\frac{\sigma^{2}}{2\alpha} [1-\exp (-2\alpha t)]$. Аналитического решения задачи не существует из-за сложного ограничения. Остаeтся выбор подходящего значения $\alpha$ из конечного множества значений. Для вычисления среднего можно использовать метод МК, альтернативой которому служит один из численных методов решения дифферен\-циаль\-ного уравнения в~частных производных. Для рассматриваемой задачи необходимо решить $m$ дифференциальных уравнений, каждое из которых имеет следующий вид:
\begin{equation*}
  \frac{\partial V}{\partial t} -
  \alpha x\frac{\partial V}{\partial x} +\frac{\sigma^{2}}{2} \frac{\partial^{2} V}{\partial x^{2}} =0
\end{equation*}
с~граничными условиями
\begin{equation}
 \begin{array}{l}
    V(t,b_k)=V (t,a_k)=\psi_k,\;0\le t<T, \\ V(T,x)=0,\ -a_k \le x\le b_k.
\end{array}
\end{equation}
Если $V_k^* (t,x)$~--- решение уравнения, то искомое математическое ожидание $\displaystyle E\Psi (\bar{X}_T,\underline{X}_T)=\sum_{k=1}^{m}V_{k}^{*}(0,0)$. Рисунок 2 иллюстрирует результаты вычислений для различных~$\alpha$. Точечная кривая получена методом МК, сплошная~--- результат решения дифференциального уравнения. В~этом примере $m=1$, $a=-b$, $\psi_1 =1$. Здесь оба численных метода демонстрируют хорошее совпадение для широкого диапазона значений управляющего параметра $\alpha$, который изменяется от $0{.}1$ до $7$ с~шагом $0{.}1$. Среднее различие приблизительно равнялось 0.006. Объeм вычислений в~обоих методах сопоставим.



\begin{figure}[h!]
\centering{
\includegraphics[scale=0.85]{01/fig2}

\vskip 2mm
{\small{\it Рис. 2.} Вероятность выхода процесса из полосы (исходные данные:\\ $b=0{.}1$, $h=0{.}1$, $n=100$, $\sigma =0{.}1$, $N=100$, $M=25$) }  }
\end{figure}




%\begin{figure}[!ht]
%\centering
%\includegraphics[scale=0.25]{eps/Danilova_ris_2}
%\smallskip
%\caption{Вероятность выхода процесса из полосы. Исходные данные: %$b=0{.}1$, $h=0{.}1$, $n=100$, $\sigma =0{.}1$, $N=100$, $M=25$.}
%\begin{center}
%\footnotesize
%На оси абсцисс расположены значения $\alpha$, на оси ординат~-- значения %вероятности выхода процесса из полосы.
%\end{center}
%\end{figure}


В~следующем примере вычислялся средний штраф. Число слагаемых в~этом примере равно двум, $a_2 =-2b$,\,  $a_1=-b$,\, $b_1=b$,\, $b_2=2b$,\, $\psi_1=\psi_2=1$. Результат пред\-ставлен на рис. 3. Кривая получена методом МК.



\begin{figure}[h!]
\centering{
\includegraphics[scale=0.87]{01/fig3}

\vskip 2mm
{\small{\it Рис. 3.} Изменение среднего штрафа в зависимости от $\alpha$ (исходные данные:\\  $b=0{.}1$, $h=0{.}1$, $n=100$, $\sigma =0{.}1$, $N=100$, $M=25$) }
 }
\end{figure}


%\begin{figure}[!ht]
%\centering
%\includegraphics[scale=0.25]{eps/Danilova_ris_3}
%\smallskip
%\caption{Изменение среднего штрафа в зависимости от $\alpha$. Исходные %данные:  $b=0{.}1$, $h=0{.}1$, $n=100$, $\sigma =0{.}1$, $N=100$, %$M=25$.
%}\label{bdg:fig:3}
%\begin{center}
%\footnotesize
%На оси абсцисс расположены значения $\alpha$, на оси ординат~-- значения %среднего штрафа за выход процесса из полосы.
%\end{center}
%\end{figure}

Среднее различие  между альтернативными вычислениями приблизительно равно 0.008. Погрешность при вычислении методом МК не изменяется, при численном решении двух дифференциальных уравнений с~последующим сложением двух результатов незначительно, но увеличивается, так как возрос штраф за счет добавле\-ния сла\-гае\-мого. С~ростом $\alpha$ разница уменьшается, поскольку вероятность выхода из~полосы стремится к~нулю, а это, в~свою очередь, инициирует стремление к~нулю штрафа. Объем вычислений в~методе МК при решении данной задачи не изменяет\-ся по сравнению с объeмом вычислений предыдущей задачи (добавляются несколько условных операторов). В~альтернативном методе объем вычислений увеличивается кратно.

Несколько слов об исходной задаче. На обоих графиках наблюдается монотонное стремление к~нулю штрафа с~ростом $\alpha$. Авторам не известно строгое доказательство этого факта для процесса Орнштейна\,---\,Уленбека. В~свою очередь, монотонное стремление к~нулю штрафа позволяет однозначно выбрать оптимальное значение для параметра.

\textbf{Замечание 2.}
В~связи с~неограниченностью коэффициента $\alpha x$ в~уравнении (7) требуется дополнительное разъяснение. Отметим, что функция $\alpha x$ ограничена на любом компакте. Рассмотрим интервал $[-A,A]$, момент остановки $\tau =\inf \{t\colon X_t \notin [-A,A]\}$ и остановленный процесс $X_t^{\tau}=X_{t\wedge \tau}$. Выбором~$A$ можно добиться того, что вероятность $P(\tau >1)$ будет близка к~единице.

\textbf{Замечание 3.}
Эксперименты проводились с различными значениями параметров модели и шагом разбиения. Поскольку результаты оказались сопоставимыми, то ограничимся одним из них, чтобы не увеличивать объем статьи.

\indent{\textbf{5. Сравнение с другими методами.}} Сравнение произведено с~классическим методом МК (в~приведенной таблице обозначается КМК), с~методом МК из~работы [10], в~котором также используются случайное разбиение и преобразование Винера\,---\,Хопфа (обозначается ВМК), и встроенным в~MAPLE численным методом решения дифференциального уравнения (ДУ). Сравнение производится по показателям, обозначающим строки таблицы.

%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Таблица.} {\bf Сравнение разных методов МК}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{|l|c|c|c|}
\hline
\multicolumn{1}{|c|}{Показатель} & КМК & ВМК & ДУ \\ \hline
Универсальность & $-$ & $-$ & $-$ \\ \hline
Оценка погрешности & $+$ & $+$ & $\pm$ \\ \hline
Вычислительная сложность & $-$ & $\pm$ & $+$ \\
\hline
\end{tabular}

}
\end{center}\vspace{-1mm}

{\footnotesize
П\,р\,и\,м\,е\,ч\,а\,н\,и\,е.\, Знак <<$+$>> означает преимущество представленного метода над альтернативным, знак <<$-$>>~--- альтернативного метода над представленным, знак <<$\pm$>>~--- сопоставимость этих методов. Знак <<$-$>> во всех столбцах первой строки таблицы означает, что предлагаемый метод предполагается использовать в моделях с постоянной локальной волатильностью. Для остальных методов этот факт не является принципиальным.\par}

\end{table}
%\vskip 2mm


 Прокомментируем знак <<$+$>> в~последней строке и последнем столбце. Основ\-ная\linebreak вычислительная сложность метода связана с~определением выборки. В~случаях, когда расчеты производятся для нескольких значений параметров модели, выборка генерируется один раз. Сама же формула (5) не требует больших вычислительных затрат. Для реализации одной итерации требуются выполнение 2$n$ сложений ($n$~--- число случайных точек разбиения), $m$ логических операций ($m$~--- число слагаемых штрафа), вычисление одной экспоненты. Число дифференциальных уравнений, которые необходимо решить, равно произведению числа слагаемых штрафа на число значений параметров модели.  Еще раз подчеркнем, что для описываемого класса задач в~КМК отсутствует какая-либо оценка погрешности, связанной с~аппроксимацией процессов максимума и минимума.

\indent{\textbf{6. Заключение.}} Предложен новый метод аппроксимации инфимумного и супремумного процессов  для диффузионного процесса. Аппроксимация пригодна для решения описываемого класса задач, относящихся к~гомеостазу. Получена оценка погрешности при вычислении среднего штрафа за выход процесса из полосы. Решена задача удержания процесса Орнштейна\,---\,Уленбека в~заданной полосе. Проведен ряд экспериментов, иллюстрирующих работу алгоритма. Удержание случайного процесса в полосе трактуется как стохастическое требование гомеостаза динамической системы, представляющего собой необходимое условие еe устойчивого развития.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{01/lit-ra}

%\newpage
\input{01/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
