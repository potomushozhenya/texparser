


\noindent{\small УДК 517.977  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}\\
MSC 49M25

}

\vskip3mm

\noindent{\bf Процедура регуляризации билинейных задач оптимального управления \\ на основе конечномерной модели$^{*}$%
 }

\vskip3mm

\noindent{\it А.~В.~Аргучинцев, В.~А.~Срочко%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Проект реализуется при финансовой поддержке Благотворительного фонда Владимира Потанина (грант ГСАД-0022/21).\par%
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum15} }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum15}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize



\noindent%
%$^2$~%
Иркутский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
664003, Иркутск, ул. К. Маркса, 1

%\noindent%
%%$^2$~%
%Санкт-Петербургский государственный университет, Российская
%Федерация,
%
%\noindent%
%%\hskip2.45mm%
%199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:}
\textit{Аргучинцев А.~В., Срочко В.~А.} Процедура регуляризации билинейных задач оптимального управления на основе конечномерной модели~//
Вестник Санкт-Пе\-тер\-бург\-ского университета. Прикладная
математика. Информатика. Процессы управления. \issueyear. Т.~18.
Вып.~\issuenum.
С.~\pageref{p15}--\pageref{p15e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum15

\vskip3mm

{\leftskip=7mm\noindentРассматривается задача оптимизации линейной управляемой системы обыкновенных дифференциальных уравнений на множестве кусочно-непрерывных скалярных управляющих воздействий с двусторонним ограничением. Целевой функционал содержит два слагаемых:  билинейная часть (управление, состояние) и квадрат управления с параметром, играющий роль регуляризующего члена. Приближенное решение задачи оптимального управления проводится на подмножестве кусочно-постоянных управлений с неравномерной сеткой возможных точек переключения. В результате предлагаемой параметризации проведена редукция к конечномерной задаче квадратичного программирования с параметром в целевой функции и простейшими ограничениями на независимые переменные. В случае строго выпуклой целевой функции конечномерная задача может быть решена за конечное число итераций методом особых точек. Для строго вогнутых целевых функций соответствующая задача решается простым или специализированным перебором. В общем случае получены условия на параметр и точки переключения, при которых целевая функция становится выпуклой или вогнутой. При этом соответствующие задачи математического программирования допускают глобальное решение за конечное число операций. Таким образом, предлагаемый подход позволяет аппроксимировать исходную невыпуклую вариационную задачу конечномерной моделью, допускающей глобальное решение за конечное число итераций.\\[1mm]
\textit{Ключевые слова}: линейная фазовая система, билинейно-квадратичный функционал, конечномерная модель, конечные итерационные методы, глобальное решение.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\bf 1. Введение.} Применение подходов математического программирования к решению задач оптимального управления имеет давнюю историю. Здесь можно выделить два основных направления.

Во-первых, динамические системы нередко изначально рассматриваются в дискретном варианте. Это связано с тем, что на практике информация о параметрах управляемого процесса часто поступает в дискретные моменты времени и управление процессом также реализуется дискретно. В свою очередь, для решения соответствующих задач оптимального управления используются подходы конечномерной оптимизации, принцип оптимальности Беллмана и вариационные условия оптимальности, изначально полученные для непрерывных систем [1--4].

Во-вторых, применение методов параметризации исходных непрерывных динамических систем сводит эти задачи к соответствующим задачам математического программирования. Дискретизация при этом может проводиться как по состоянию, так и по управлению процесса. Традиционно считается, что преобразования, приводящие к дискретизации, снижают качество итоговых результатов. Экстремальные решения конечномерных задач, удовлетворяющие тем или иным условиям экстремума, не приводят, вообще говоря, к экстремальным управлениям исходных вариационных задач. Классические рекомендации заключаются в уменьшении соответствующих параметров дискретизации (шага разностной сетки) и т. п.
(см. обзоры [5, 6]).

В последние годы намечается новый тренд в этой области в связи с появлением нестандартных методов дискретизации. В частности, достаточно эффективные методы программного и позиционного решений линейных задач оптимального управления связаны с дискретизацией (параметризацией) управления и переходом к специальным
задачам линейного программирования [7]. Обычно в рамках дискретного подхода предпочтение отдается схемам параметризации по управляющим функциям [8]. В настоящее время такие параметризации оформляются с помощью
линейных комбинаций некоторых опорных функций: полиномиальные сплайны, квадратичные экспоненты и т. д. [9--13].

В данной статье рассматривается задача оптимизации линейной системы на множестве кусочно-непрерывных управлений с двусторонним ограничением. Целевой функционал содержит билинейный фрагмент (управление, состояние) и квадрат управления с параметром (регуляризующий член). Билинейные задачи оптимального управления образуют актуальный класс невыпуклых структур, глобальное решение которых до сих пор носит проблематичный характер (см., например,  [14]). Это стимулирует альтернативные подходы и дальнейшие исследования для конструктивного преодоления возникающих проблем.

Приближенное решение задачи проводится на подмножестве кусочно-постоянных управлений с неравномерной сеткой возможных точек переключения. В результате такой параметризации получена в явной формулировке конечномерная задача квадратичного программирования с параметром в целевой функции и простейшими ограничениями на переменные
(гиперкуб). Найдены условия на параметр (оценки сверху и снизу) и точки переключения, при которых целевая функция становится выпуклой или вогнутой. При этом соответствующие задачи допускают глобальное решение за конечное число операций --- метод особых точек в случае выпуклой функции, перебор угловых точек гиперкуба --- вогнутой.

Таким образом, исходная невыпуклая вариационная задача при определенных условиях на параметр в функционале и точки переключения управления аппроксимируется конечномерной моделью, допускающей глобальное решение за конечное число итераций.

{\bf 2. Постановка задачи. Конечномерная аппроксимация.}
Рассматриваемая задача описывается следующими соотношениями ($u(t) \in \Re, x(t) \in \Re^n$):

\begin{equation*}
	\Phi(u)=\int\limits_{t_0}^{T}
	{(\langle a(t), x(t) \rangle u(t) + \gamma u^2(t)) dt} 	 \rightarrow \min,
\end{equation*}

\begin{equation} \label{P0}
\dot x=A(t)x+b(t)u, \; x(t_0)=x^0,
\end{equation}
	
\begin{equation*}	
	|u(t)| \leq 1, \; t \in [t_0, T].
\end{equation*}

\pagebreak
Отметим необходимые предположения:

$\bullet$\,\,функции $a(t), \; A(t), \; b(t)$ непрерывны на $[t_0, T]$; \par
$\bullet$\,\,множество допустимых управлений составляют скалярные кусочно-не\-пре\-рыв\-ные функции $u(t)$ с интервальным ограничением; \par
$\bullet$\,\,параметр $\gamma > 0$.

\noindent По поводу билинейной части функционала $\Phi(u)$ отметим следующее. Как известно [15], стандартный квадратичный функционал относительно фазовой траектории

\begin{equation*}	
	F(u) = \frac{1}{2}\langle x(T), Cx(T) \rangle + \frac{1}{2}\int\limits_{t_0}^{T}
	{\langle x(t), Q(t)x(t) \rangle dt}
\end{equation*}
на основе матричной функции Габасова $\Psi (t)$ с уравнением

\begin{equation*}	
	\dot \Psi = - A(t)^T \Psi - \Psi A(t) - Q(t), \; \; \Psi(T)=C
\end{equation*}
сводится к билинейному варианту

\begin{equation*}	
	F(u) = F(0) + \int\limits_{t_0}^{T}
	{\langle \Psi(t)b(t), x(t) \rangle u(t) dt},
\end{equation*}
который и представлен в задаче (\ref{P0}).

В общем случае задача (\ref{P0}), в силу билинейной части функционала $\Phi(u)$, невыпукла: принцип максимума не является для нее достаточным условием оптимальности. В результате возникает проблема гарантированного решения этой задачи в смысле нахождения глобального минимума.

Для частичного решения данной проблемы проведем конечномерную аппроксимацию задачи (\ref{P0}) на основе кусочно-постоянных управлений с заданным набором возможных точек переключения $t_i \in (t_0, T), \; i = 1, 2, \ldots , m-1$, упорядоченных по возрастанию: $t_i > t_{i-1}$. Положим $T=t_m$ и определим характеристические функции
для $j = 1, 2, \ldots , m$:
\begin{equation*}	
\chi_j(t) = \left\{
\begin{array}{l}
1, \; t \in (t_{j-1}, t_j], \\
0, \; t \notin (t_{j-1}, t_j]. \\
\end{array}
\right
\end{equation*}
Введем набор параметров $y=(y_1,y_2, \ldots ,y_m)$ с условием $|y_j| \leq 1, \; j= 1, 2, \ldots , m$. Сформируем допустимые управления
\begin{equation*}	
u(t,y) = \sum_{j=1}^{m} y_j \chi_j(t)
\end{equation*}
вместе с соответствующими фазовыми траекториями
\begin{equation*}	
x(t,y) = x(t,0) + \sum_{j=1}^{m} y_j x^j(t).
\end{equation*}	
Здесь для каждого $j$ вектор-функция $x^j(t)$ (опорная траектория) является решением задачи Коши
\begin{equation*}	
\dot x=A(t)x+b(t) \chi_j(t), \; x(t_0)=0.
\end{equation*}	
Отметим, что $x^j(t) \equiv 0, \; t \in [t_0, t_{j-1}], \; j = 2, 3, \ldots ,m$.

Получим явное выражение для целевого функционала $\Phi(u)$ на допустимом процессе $\{ u(t,y), x(t,y) \}$.
Выделим билинейную часть функционала:
$$
\varphi _1(y)= \int\limits_{t_0}^{T}
	{\langle a(t), x(t,y) \rangle u(t,y)dt}=
$$
$$
=\sum_{j=1}^{m} y_j \int\limits_{t_{j-1}}^{t_j} {\langle a(t), x(t,0) \rangle dt} +
\sum_{j=1}^{m}\sum_{k=1}^{m}y_j y_k \int\limits_{t_0}^{T}
	{\langle a(t), x^j(t) \rangle \chi_k(t)dt}.
$$
Уточним интеграл под знаком двойной суммы, учитывая, что
\begin{equation*}	
x^j(t) \equiv 0, \; \chi_k(t) \equiv 0, \; t \in [t_0,t_{j-1}], \; k < j.
\end{equation*}	
Тогда
\begin{equation*}	
 \int\limits_{t_0}^{T}
	{\langle a(t), x^j(t) \rangle \chi_k(t)dt} = \left\{
\begin{array}{l}
0, \; k < j, \\
\int\limits_{t_{k-1}}^{t_k}
	{\langle a(t), x^j(t) \rangle dt}, \; k \geq j. \\
\end{array}
\right
\end{equation*}

В результате имеем формулу
\begin{equation}\label{P01}
\varphi _1(y)= \sum_{j=1}^{m} y_j \int\limits_{t_{j-1}}^{t_j}
	{\langle a(t), x(t,0) \rangle dt} +
\sum_{j=1}^{m}\sum_{k=j}^{m}y_j y_k \int\limits_{t_{k-1}}^{t_k}
	{\langle a(t), x^j(t) \rangle dt}.
\end{equation}

Введем вектор $d \in \Re^m$ и матрицу $C \in \Re^{m \times m}$:
$$	
d_j = \int\limits_{t_{j-1}}^{t_j}
	{\langle a(t), x(t,0) \rangle dt}, \; j = 1,2, \ldots ,m; \;
$$
$$
c_{jk} = \left\{
\begin{array}{l}
0, \; k < j, \\
\int\limits_{t_{k-1}}^{t_k}
	{\langle a(t), x^j(t) \rangle dt}, \; k \geq j. \\
\end{array}
\right
$$	
Тогда формула (\ref{P01}) может быть записана в векторно-матричном виде
\begin{equation*}
\varphi _1(y) = \langle d, y \rangle + \langle y, Cy \rangle,
\end{equation*}	
где $C$~--- верхняя треугольная матрица.

Квадратичная часть функционала $\Phi(u)$ преобразуется достаточно просто:
\begin{equation*}
\varphi _2(y) = \gamma \int\limits_{t_0}^{T}{u^2(t,y)dt} =
\gamma \sum_{j=1}^{m} (t_j - t_{j-1})y_j^2= \gamma \langle y, Dy \rangle.
\end{equation*}	
Здесь $D$~--- ($m \times m$)-диагональная матрица с элементами $(t_j - t_{j-1}), \; j = 1,2, \ldots, m$.

В результате получаем итоговое выражение
\begin{equation*}
\varphi_{\gamma}(y) = \langle d, y \rangle + \langle y, (C + \gamma D)y \rangle.
\end{equation*}	
Это квадратичная функция с верхней треугольной матрицей $(C + \gamma D)$.\pagebreak

Таким образом, конечномерный вариант вариационной задачи (\ref{P0}) формулируется следующим образом:
\begin{equation}\label{P2}
\varphi_{\gamma}(y) \rightarrow \min, \; |y_j| \leq 1, \; j=1,2, \ldots ,m.
\end{equation}


{\bf 3. Анализ конечномерной модели.} Выделим случай одномерной задачи ($m=1$), когда аппроксимация проводится в классе управлений, являющихся константами:  $u(t)=y_1, \; t \in [t_0, T]$. Задача (\ref{P2}) приобретает вид
\begin{equation*}
\varphi_{\gamma}(y_1)=d_1y_1+[c_{11}+\gamma(T-t_0)]y_1^2 \rightarrow \min, \; |y_1| \leq 1,
\end{equation*}
с коэффициентами
\begin{equation*}
d_1 = \int\limits_{t_0}^{T}{\langle a(t), x(t,0) \rangle dt}, \;
c_{11}= \int\limits_{t_0}^{T}{\langle a(t), x^1(t) \rangle dt}
\end{equation*}
и траекториями
\begin{equation*}
x(t,0): \; \dot x=A(t)x, \; x(t_0)=x^0,
\end{equation*}	
\begin{equation*}
x^1(t): \; \dot x=A(t)x + b(t), \; x(t_0)=0.
\end{equation*}	
Эта задача решается элементарно в зависимости от знака коэффициента при $y_1^2$ и положения стационарной точки параболы относительно отрезка $[-1,1]$.

Рассмотрим благоприятные ситуации с точки зрения глобального решения общей задачи (\ref{P2}).

Пусть $\varphi_{\gamma}(y)$~--- строго выпуклая функция. Тогда квадратичная задача (\ref{P2}) ре\-шается за конечное число итераций методом особых точек [16].

Если $\varphi_{\gamma}(y)$~--- строго вогнутая функция, то задача (\ref{P2}) эквивалентна задаче минимизации той же целевой функции на множестве угловых точек гиперкуба:
\begin{equation*}
\varphi_{\gamma}(y) \rightarrow \min, \; y_j^2 = 1, \; j=1,2, \ldots ,m,
\end{equation*}
которая решается простым или специализированным перебором $2^m$ точек [17].

Поставим цель реализовать указанные варианты в общем случае за счет условий на параметр $\gamma$ и выбора точек переключений $\{t_i, \; i=1,2, \ldots, m-1\}$. Предварительно уточним выражение для целевой функции. Введем симметричную матрицу $S= 1/2 (C+C^T)$. Тогда $\langle y, Cy \rangle = \langle y, Sy \rangle$, что приводит к
<<правильному>> выражению
\begin{equation*}
\varphi_{\gamma}(y)=\langle d, y \rangle + \langle y, (S + \gamma D)y \rangle
\end{equation*}
с симметричной матрицей $S + \gamma D$.

Рассмотрим общий случай, когда матрица $S$ является знаконеопределенной, т.~е. ее спектр содержит как положительные, так и отрицательные собственные значения. Найдем условие на параметр $\gamma$ и элементы матрицы
$D$, которое обеспечивает положительную определенность матрицы $S+\gamma D$.

Будем использовать экстремальное свойство отношения Рэлея:
\begin{equation*}
\min\limits_{y\neq 0}\frac{\langle y, Ay \rangle}{\langle y, y \rangle}=\lambda_{\mathrm{min}}(A),
\end{equation*}
где $\lambda_{\mathrm{min}}(A)$~--- минимальное собственное число матрицы $A$.

Для $y\neq 0$ имеем цепочку соотношений
$$
\frac{\langle y, (S + \gamma D)y \rangle}{\langle y, y \rangle} =
\frac{\langle y, S y \rangle}{\langle y, y \rangle} +
\gamma \frac{\langle y, Dy \rangle}{\langle y, y \rangle} \geq
$$
$$
\geq \min\limits_{y\neq 0}\frac{\langle y, S y \rangle}{\langle y, y \rangle} +
\gamma \min\limits_{y\neq 0}\frac{\langle y, Dy \rangle}{\langle y, y \rangle} =
\lambda_{\mathrm{min}}(S) + \lambda_{\mathrm{min}}(D) > 0.
$$
Поскольку $\lambda_{\mathrm{min}}(S) < 0$ и $\lambda_{\mathrm{min}}(D) = \min\limits_{j=1,2, \ldots, m}(t_j - t_{j-1})$, получаем спектральное условие
\begin{equation}\label{P3}
\gamma \min\limits_{j=1,2, \ldots, m}(t_j - t_{j-1}) > |\lambda_{\mathrm{min}}(S)|,
\end{equation}
которое гарантирует положительную определенность матрицы $S+\gamma D$. При этом функция
$\varphi_{\gamma}(y)$ приобретает свойство строгой выпуклости.

Таким образом, приходим к заключению: невыпуклая задача (\ref{P0}) при условии (\ref{P3}) на параметр $\gamma$ и точки переключения аппроксимируется в конечномерном ва\-риан\-те выпуклой квадратичной задачей (\ref{P2}), допускающей решение за конечное число итераций.

Рассмотрим второй возможный случай, когда матрица $S$ отрицательно определена. Для отношения Рэлея найдем оценку сверху
\begin{equation*}
\frac{\langle y, (S + \gamma D)y \rangle}{\langle y, y \rangle} \leq
\max\limits_{y\neq 0}\frac{\langle y, S y \rangle}{\langle y, y \rangle} +
\gamma \max\limits_{y\neq 0} \frac{\langle y, Dy \rangle}{\langle y, y \rangle} =
\lambda_{\mathrm{max}}(S) + \lambda_{\mathrm{max}}(D) < 0.
\end{equation*}
Поскольку $\lambda_{\mathrm{max}}(S) < 0$ и $\lambda_{\mathrm{max}}(D) = \max\limits_{j=1,2, \ldots, m}(t_j - t_{j-1})$, имеем оценку
\begin{equation}\label{P4}
\gamma \max\limits_{j=1,2, \ldots, m}(t_j - t_{j-1}) < |\lambda_{\mathrm{max}}(S)|,
\end{equation}
которая обеспечивает условие отрицательной определенности матрицы $S+\gamma D$.

Таким образом, при условии (\ref{P4}) функция $\varphi_{\gamma}(y)$ строго вогнутая, т. е. конечномерная задача (\ref{P2}) решается перебором угловых точек.

Наконец, в случае положительной определенности матрицы $S$ функция $\varphi_{\gamma}(y)$ строго выпуклая для всех $\gamma > 0$.

{\bf Замечание.} Выделим типичный случай равномерной сетки точек переключения с шагом $h=t_j - t_{j-1}, \; j=1,2, \ldots, m.$ Тогда условия (\ref{P3}), (\ref{P4}) регуляризации зада\-чи~(\ref{P2}) представляются соответственно в виде
\begin{equation*}
\gamma h > |\lambda_{\mathrm{min}}(S)|, \; \; \gamma h < |\lambda_{\mathrm{max}}(S)|.
\end{equation*}
При этом правые части неравенств зависят от шага $h$, т.~е. для заданного $h$ данные неравенства определяют условия на выбор параметра $\gamma$.

{\bf 4. Заключение.} Рассмотрена задача оптимизации линейной управляемой системы относительно билинейно квадратичного функционала с параметром. Осуществлена параметризация допустимых управлений в классе кусочно постоянных функций с редукцией к конечномерной задаче квадратичной оптимизации. Получены условия на параметр и узлы аппроксимирующей сетки, при которых конечномерная задача допускает глобальное решение за конечное число итераций. В качестве направлений для обобщения предлагаемого подхода можно указать следующие:

--- случай векторной управляющей функции;\par
--- задачи оптимального управления линейными гиперболическими уравнениями и системами уравнений с управлениями, сосредоточенными на границе.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{15/lit-ra}

%\newpage
\input{15/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~18.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
