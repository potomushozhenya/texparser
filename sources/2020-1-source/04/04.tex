%
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,16.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ИНФОРМАТИКА} \vspace{1.6cm}%1.8cm}

\noindent{\small УДК 519.178, 519.174.2\\ %  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}\\ %
MSC 05C85

}

\vskip3mm

\noindent{\bf Определение работоспособности системы, структура которой\\ задана графом%$^{*}$%
 }

\vskip3mm

\noindent{\it А.~Г.~Карпов, В.~А. Клемешев, Д.~Ю.~Куранов%$\,^1$%
%, И.~О. Фамилия%$\,^2$%

 }

\efootnote{
%%
%\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке
%Российского научного фонда (проект  № 18-71-00006).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
%%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum04 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum04}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2.0mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

\noindent%
%$^1$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:} \textit{Карпов А.~Г.,
Клемешев В.~А., Куранов Д.~Ю.} Определение работоспособности
системы, структура которой задана графом~// Вестник
Санкт-Петербургского университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~16.
Вып.~\issuenum. С.~\pageref{p4}--\pageref{p4e}. \doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum04

\vskip3mm

{\leftskip=7mm\noindentПредложена система алгоритмов для анализа
систем различной природы, структура которых задана с~помощью
графов большой сложности. Анализ состоит в~проверке связности
и~физической реализуемости системы, структура которой задана
графом, а также в~проверке отсутствия нерабочих петель.
Предложенные алгоритмы могут быть использованы не только для
разработки новых систем, но и~для диагностики рабочего
оборудования и~поиска неисправностей. Подход к~определению
физической реализуемости графа состоит в~том, что сначала строится
система базисных циклов, а затем устанавливается, входит ли каждая
ветвь в~один из них. Работа комплекса алгоритмов демонстрируется
на примере электрической системы, однако полученные результаты
могут быть распространены на системы другой природы, например,
с~помощью
электромеханических аналогий.\\[1mm]
\textit{Ключевые слова}: граф, связность графа, базисный цикл.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{1. Введение.} Теория графов --- мощный инструмент изучения
систем [1--5]. Однако эффективность реализации ее методов
колеблется в~широких пределах, а исследователи до сих пор заняты
поисками более совершенных алгоритмов. По сути дела применение
теории графов, например для разработки и~анализа электрических
цепей, ограничивается очень простыми системами и~выполняется
вручную.

Под простой системой мы понимаем систему, граф которой является,
во-первых, планарным и, во-вторых, может быть построен
и~преобразован вручную и~про\-конт\-ро\-ли\-ро\-ван визуально. По
нашей оценке к простым системам можно отнести такие, граф которых
содержит не более 100 вершин.

Цель работы --- разработка алгоритмов, позволяющих определить
работоспособность технических систем, структура которых задана
графом. Под состоянием работоспособности системы понимаем
отсутствие в~системе неработающих элементов, наличие которых
возможно либо из-за неисправности элементов, либо в~результате
конструкторских ошибок. Кроме того, предлагаемые алгоритмы должны
обеспечивать актуальное и~эффективное распараллеливание обработки
данных, что соответствует современному технологическому уровню
вычислительной техники.

Предварительный анализ работоспособности необходим для того, чтобы
составить систему уравнений, решение которой позволяет определить
(проконтролировать) статические и~динамические характеристики как
системы в~целом, так и~отдельных ее элементов.



Работоспособность системы, структура которой задана графом,
определяется, по нашему мнению, следующими тремя условиями:
%\renewcommand{\labelitemi}{---}
%\renewcommand{\labelitemii}{$\bullet$}
%\begin{itemize}\itemsep-3pt
%    \item

---    связностью графа;
%    \item

---    физической реализуемостью системы;
%    \item

---    отсутствием нерабочих петель.
%\end{itemize}


Под физической реализуемостью мы понимаем соответствие графа
системы фундаментальным законам сохранения, а именно законам
сохранения импульса и~сохранения заряда, которые следуют из
непрерывности пространства. В~теории графов они объединяются под
названием закона сохранения последовательной переменной [6]. Если
граф системы отвечает условию физической реализуемости, то каждое
его ребро принадлежит какому-нибудь контуру (циклу). Выяснить это
можно с~помощью построения базисной цикломатической матрицы
$\mathbf{C}$ с~использованием алгебраического метода [7]:
\begin{equation*}
    \mathbf{C} = \big[\mathbf{C}_b \mathbf{E}\big]_{\lceil(r-v+1) \times r\rceil},
\end{equation*}

\begin{equation*}
    \mathbf{CD}^T = 0,
    \qquad
    \mathbf{D}^T =
    \begin{bmatrix}
        \mathbf{E}\\[3pt]
        \mathbf{D}^T_c
    \end{bmatrix}_{r \times (v-1)},
    \qquad
    \mathbf{C}_b = - \mathbf{D}^T_c,
\end{equation*}

\begin{equation*}
    \mathbf{D}_c = \mathbf{I}_{11}^{-1}\,\, \mathbf{I}_{12},
\end{equation*}

\noindent где $
%\begin{equation*}
    \Big[
        \mathbf{I}_{11\,\lceil(v-1)\times(v-1)\rceil}\,\, \mathbf{I}_{12\,\lceil(v-1)\times(r-v+1)\rceil}
    \Big]_{\lceil(v-1) \times r\rceil}
%\end{equation*}
$ --- усеченная на одну строку матрица инциденций графа;
$\mathbf{D}$ --- базисная матрица разрезающих множеств; $v$ ---
число вершин графа; $r$ --- число ребер графа. Если в~каждом
столбце $\mathbf{C}_b$ имеется хотя бы одно значение, отличное от
нуля, это означает, что каждая ветвь остовного дерева входит
в~какой-нибудь базисный цикл, а каждая хорда --- в~свой базисный
цикл по определению и~способу построения остовного дерева. Тогда
каждое ребро графа находится в~каком-нибудь цикле, и~система,
структура которой задана таким графом, обладает свойством
физической реализуемости.





При определении вычислительной сложности алгебраического метода
следует учитывать следующее. В~упомянутом алгоритме используется
большая доля мультипликативных операций (операции умножения
и~обращения матриц), также есть условные операции при формировании
рабочих матриц. При обращении матрицы следует также вычислять ранг
или определитель матрицы. Данное требование в~явном виде не
присутствует в~алгоритме, но эти операции необходимы при
реализации, ибо обратной матрицы может просто не существовать.
Таким образом, трудоемкость алгебраического метода можно оценить
как $\Theta(v^3)$ с~мультипликативными операциями (где $\Theta(x)$
--- точная оценка, тогда как $O(x)$ --- асимптотическая оценка
сверху).

Кроме того, требуется предварительно задать и~учитывать
направления дуг графа, что требует дополнительных операций,
связанных с~переименованием и~сортировкой вершин и~ребер.

В работе [7] приводится алгоритм, позволяющий избежать операции
обращения матрицы $\mathbf{I}_{11}$, что уменьшает максимальную
трудоемкость, но она все еще остается на уровне $O(v^3)$, при этом
сохраняются все другие недостатки алгебраического метода.

%\begin{figure}[h!]
%    \centering
%    \includegraphics[width=0.45\textwidth]{fig-1}
%    \caption{Нерабочая петля}
%    \label{fig:badloop}
%\end{figure}


Под нерабочей петлей понимаем совокупность вершин и~ребер графа,
которая соединена с~остальной частью графа только в~одной вершине,
и соответствующие ей элементы не принимают участия в~работе
системы (рис.~1).

\begin{figure}[h!]
\centering
\includegraphics[scale=1]{04/fig1}

\vskip 2mm {\small{\it Рис. 1.} Нерабочая петля }%\label{fig:badloop}
\end{figure}


Терминология, использованная в~настоящей статье, заимствована из
[7], в~частности, под параллельной переменной понимается
переменная, принимающая одинаковые значения для параллельно
соединенных элементов, а под последовательной переменной~---
переменная, принимающая одинаковые значения для последовательно
соединенных элементов.


%\section{Структура алгоритмического обеспечения определения работоспособности системы, заданной графом}
\textbf{2. Структура алгоритмического обеспечения определения
работоспособности системы, заданной графом.} Применяемый подход
состоит в~том, чтобы не устанавливать физическую реализуемость
системы до составления системы уравнений, а попытаться определить
совокупность базисных циклов графа системы, по которой собственно
и составляется система уравнений.

Под базисным циклом понимается цикл, содержащий одну хорду
и~некоторую совокупность ветвей остовного дерева [7]. Для каждой
хорды существует базисный цикл, и~он единственный. Отсюда следует,
что число базисных циклов равно числу хорд, или $r-v+1$.


Для иллюстрации работы алгоритмов используется электрическая
система, представленная на рис.~2. Ее граф и~матрица смежности
приведены на рис.~3.


Решение поставленной задачи состоит из следующих этапов.


$\bullet$ Проверка связности по собственным числам матрицы
Кирхгофа или алгебраическим методом [2, 7].

$\bullet$ Построение дерева.

Построение дерева может быть выполнено, например, по
модифицированному алгоритму Прима---Карскала [1, 2], исходной
информацией является матрица смежности графа \textbf{S}, результат
получается в~матрице смежности дерева \textbf{ST} (рис.~4).


$\bullet$ Упорядочение массива ребер.

Направление дуги задается от вершины с~меньшим номером $i$
к~вершине с~б\'ольшим номером $j$, т.~е. $\mathbf{R}[a].i <
\mathbf{R}[a].j$. Структура первого столбца упорядоченного массива
ребер представлена на рис.~5, где $v$ --- число ветвей, $r$ ---
число ребер.

$\bullet$ Определение базисных циклов (см. раздел~3).


$\bullet$ Проверка физической реализуемости.

\begin{figure}[h!]
    \begin{minipage}[t]{0.4\textwidth}
        \centering
        \includegraphics[scale=1]{04/fig2}
  \vskip 4mm
{\small{\it Рис. 2.} Схема электрической\\ системы ($Z_i$
--- импеданс элемента,\\ $i$ соответствует номеру ребра)\\ }
          %  \label{fig:scheme}
    \end{minipage}
 \hfill  % \quad
    \begin{minipage}[t]{0.57\textwidth}
            \vspace*{-5.5cm}
            \centering
            \includegraphics[scale=1]{04/fig3}\\[5pt]
                \begin{minipage}[t]{0.43\textwidth}
                    \small
                    %\captionof{table}{
                    Матрица смежности \textbf{S}\\[5pt]
                    \centering  %
{\footnotesize
                        \begin{tabular}{c|ccccc}
                        %\hline
                         &1&2&3&4&5\\ \hline
                        1&0&1&0&1&1 \rule{0pt}{2.5ex}\\ %\hline
                        2&1&0&1&0&1\\ %\hline
                        3&0&1&0&1&0\\ %\hline
                        4&1&0&1&0&1\\ %\hline
                        5&1&1&0&1&0\\ %\hline
                        \end{tabular} %
}
                    \end{minipage}
                    \qquad
                    \begin{minipage}[t]{0.43\textwidth}
                        \small
                        %\captionof{table}{
                        Массив ребер \textbf{R}\\[5pt]
                        \centering  %
{\footnotesize
                        \begin{tabular}{cccc}
                        %\hline
                        a&i&j&nnc\\
                        \hline
                        1&1&2&0 \rule{0pt}{2.5ex}\\ %\hline
                        2&1&4&1\\ %\hline
                        3&1&5&0\\ %\hline
                        4&2&3&0\\ %\hline
                        5&2&5&0\\ %\hline
                        6&3&4&0\\ %\hline
                        7&4&5&0\\ \hline
                        \end{tabular}%
}
                    \end{minipage}
     \vskip 2mm
\vskip 2mm {\small{\it Рис. 3.} Граф системы, его матрица
смежности \textbf{S}\\ и~массив ребер \textbf{R} (число вершин
$v=5$,\\ число ребер $r=7$)\\ }
%                    \label{fig:graph}
    \end{minipage}
\end{figure}
\begin{figure}[h!]
\centering
     \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[scale=1]{04/fig4}
    \end{minipage}
    \begin{minipage}[t][0cm][t]{0.45\textwidth}
        \small
        \centering
        \vspace*{-3.3cm}
        Матрица смежности \textbf{ST}\\[5pt]
{\footnotesize
        \begin{tabular}{c|ccccc}
        %\hline
         &1&2&3&4&5\\ \hline
        1&0&1&0&1&1\rule{0pt}{2.5ex}\\ %\hline
        2&1&0&1&0&0\\ %\hline
        3&0&1&0&0&0\\ %\hline
        4&1&0&0&0&0\\ %\hline
        5&1&0&0&0&0\\
        %\hline
        \end{tabular} %
        }
    \end{minipage}

\centering\vskip 2mm {\small{\it Рис. 4.} Результат построения
дерева (слева) и~матрица смежности дерева \textbf{ST} (справа) }
%    \label{fig:tree}
\end{figure}
%\begin{figure}[h]
 \vspace*{-1.0cm}
{\small
\begin{eqnarray*}
a \rule{20pt}{0pt}\\%\hphantom{aaaa1}\\
\left.
\begin{array}{c}
1\\
\ldots\\
v-1
\end{array}
\right\}&\text{Ветви}
\\
\left.
\begin{array}{c}
v\\
\ldots\\
r
\end{array}\hphantom{a}
\right\}&\text{Хорды}
\end{eqnarray*} }
%
%
\vskip 2mm {\centerline%
{\small{\it Рис. 5.} Первый столбец упорядоченного
массива ребер} }
%\label{fig:col}
%\end{figure}
%\pagebreak
\vskip 2mm


Если каждая ветвь входит в~какой-нибудь базисный цикл, то система
удовлетворяет условию физической реализуемости, в~противном случае
физическая реализуемость отсутствует.


$\bullet$ Проверка наличия нерабочих петель.

Если все ветви, принадлежащие базисному циклу, входят только
в~него, то они вместе с~хордой этого базисного цикла образуют
нерабочую петлю (см. рис.~1), что, ра\-зу\-меет\-ся, не относится
к~случаю, когда все элементы системы соединены последовательно,
и~соответствующий базисный цикл является единственным.


%\section{Алгоритм определения базисных циклов}\label{algo-nnc}
\textbf{3. Алгоритм определения базисных циклов.} Исходные данные:
упорядоченный массив ребер, матрица смежности дерева. Результат:
массивы базисных циклов с~коэффициентами параллельных переменных
дуг-ветвей в~уравнении базисного цикла; число базисных циклов,
в~которые входит каждая ветвь (в $\mathbf{R}[i].nnc$). Для каждой
хорды построение базисного цикла выполняется независимо,
обеспечивая эффективное распараллеливание процесса.

%{\color{red}
Переменные, используемые в~алгоритме определения базисных циклов:\\
\begin{tabular}{@{}l@{---\ }p{0.9\textwidth}}
    $a$             & номер хорды;\\
    $\mathbf{R}[a]$ & хорда $(i,j)$, $\mathbf{R}[a].i < \mathbf{R}[a].j$, направление дуги --- от вершины $i$ к~вершине $j$;\\
    $\mathbf{ST}$   & матрица смежности дерева;\\
    $\mathbf{STC}$  & рабочая матрица цикла;\\
    $d$             & число ветвей цикла;\\
    $q$             & индекс в~структуре $NC$, $k$ ($k=i$), $l$, $d$, $\mathbf{STC}[k,l]=d$;\\
    $NC$            & структура базисных циклов: $array[1..r-v+1]\ of\ NNC$;\\
    $NC[q]$\,       & элемент структуры $NC$, \newline где $q=c-v+1$, $c$ --- номер хорды, $v$ --- число вершин, $r$ --- число ребер;\\
    $NNC$           & \parbox[t]{0.92\textwidth}{
                                        структура базисного цикла:\\
                                        \begin{tabular}{@{}lp{0.82\textwidth}}
                                            $ic$:&  $array[1..v-1]\ of\ integer$ --- индекс хорды $i$ (номер вершины, из которой исходит хорда),\\
                                            $jc$:&  $array[1..v-1]\ of\ integer$ --- индекс хорды $j$ (номер вершины, в~которую приходит хорда),\\
                                            $ac$:&  $array[1..v-1]\ of\ integer$ --- номер ветви,\\
                                            $kc$:&  $array[1..v-1]\ of\ integer$ --- коэффициент параллельной переменной ветви,\\
                                            $dnc$:& $array[1..v-1]\ of\ integer$ --- длина базисного цикла  $-1$.
                                        \end{tabular}}
\end{tabular}
%$a$ --- номер хорды;\\
%$\mathbf{R}[a]$ --- хорда $(i,j)$, $\mathbf{R}[a].i < \mathbf{R}[a].j$, направление дуги --- от вершины $i$ к~вершине $j$;\\
%$\mathbf{ST}$ --- матрица смежности дерева;\\
%$\mathbf{STC}$ --- рабочая матрица цикла;\\
%$d$ --- число ветвей цикла;\\
%$q$ --- индекс в~структуре $NC$, $k$ ($k=i$), $l$, $d$, $\mathbf{STC}[k,l]=d$;\\
%$NC$ --- структура базисных циклов: $array[1..r-v+1]\ of\ NNC$;\\
%$NC[q]$ --- \parbox[t]{0.85\textwidth}{элемент структуры $NC$, $q=c-v+1$, \\
%                                     $c$ --- номер хорды, $v$ --- число вершин, $r$ --- число ребер;
%                                    }\\
%$NNC$ --- \parbox[t]{0.92\textwidth}{
%                                   структура базисного цикла:\\
%                                   \begin{tabular}{@{}lp{0.82\textwidth}}
%                                       $ic$:&  $array[1..v-1]\ of\ integer$ --- индекс хорды $i$ (номер вершины, из которой исходит хорда),\\
%                                       $jc$:&  $array[1..v-1]\ of\ integer$ --- индекс хорды $j$ (номер вершины, вз которую исходит хорда),\\
%                                       $ac$:&  $array[1..v-1]\ of\ integer$ --- номер ветви,\\
%                                       $kc$:&  $array[1..v-1]\ of\ integer$ --- коэффициент параллельной переменной ветви,\\
%                                       $dnc$:& $array[1..v-1]\ of\ integer$ - длина базисного цикла - 1.
%                                   \end{tabular}
% }
%} %color RED

\medskip
Алгоритм определения базисного цикла состоит в~следующем.

1. Выбор хорды, для которой будет строиться базисный цикл, где
$a$~--- номер хорды в~массиве ребер (дуг); $i$~--- вершина, из
которой исходит хорда; $j$~--- вершина, в~которую приходит
хорда~($i<j$).

Копирование матрицы смежности дерева \textbf{ST} в~рабочую матрицу
цикла \textbf{STС}.

2. Поиск в~строке $j$ матрицы \textbf{STС} единичных значений,
т.~е. вершин, с~которыми вершина $j$ связана ветвями. Если
найденная вершина совпадает с~вершиной $i$, то базисный цикл
состоит только из двух дуг: рассматриваемой хорды и~ветви ($i,j$),
а его длина равна 2; переход к~п.~5.

Если найденная вершина не совпадает с~вершиной $i$, то, возможно,
она входит в~строящийся базисный цикл хорды $a$. Выявленная связь
отмечается числом $-1$ в~матрице \textbf{STС}, а связи найденной
вершины --- числом 2 в~матрице \textbf{STС}, т.~е. возможный
базисный цикл будет включать не менее двух ветвей. Положить
текущее число ветвей цикла равным 2.


3. Продолжение построения базисного цикла, число ветвей которого
не должно превышать $v-1$. Поиск в~матрице \textbf{STС} всех
значений, равных текущему числу ветвей цикла. Если найдено такое
значение и~при этом достигнута вершина $i$, то переход к~п.~5.
Если получено такое значение, но не достигнута вершина $i$, то
связи найденной вершины, отмеченные единицей, заменяются текущим
числом ветвей цикла, увеличенным на единицу.


4. Наращивание текущего числа ветвей цикла на единицу. Переход
к~п.~3.

5. Инициализация структуры $NC[q]$, где $q = a-v+1$ --- номер
структуры, соответствующей $a$-й хорде. К этому моменту, двигаясь
по матрице \textbf{STС} от вершины $j$, достигнем вершины $i$,
и~элемент $\mathbf{STC}[i,j] = d$ --- числу ветвей строящегося
базисного цикла. Положить $p$ равным $d$.

6. Поиск в~массиве ребер ветви, входящей в~строящийся базисный
цикл и~соответствующей текущему значению $p$. Заполнение $p$-й
строки в~структуре $NC[q]$ с~учетом направления ветви для
определения коэффициента, с~которым параллельная переменная
найденной ветви входит в~уравнение базисного цикла (рис.~6)
рассматриваемой хорды $a$.

7. Уменьшение $p$ на единицу для движения по матрице \textbf{STC}
до вершины $j$. Если $p > 0$, то переход к~п.~6.

8. Конец.

%   \medskip


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{04/fig6}

\vskip 2mm {\small{\it Рис. 6.} Коэффициент при параллельной
переменной $p$-й
ветви,\\ входящей в~базисный цикл $q$-й хорды\\ }%\label{fig:coeff}
\end{figure}


%\begin{figure}[!h]
%    \centering
%    %\includegraphics[width=0.35\textwidth]{fig-6}
%    \includegraphics{fig-6}
%    \caption{Коэффициент при параллельной переменной $p$-й ветви, входящей в~базисный цикл $q$-й хорды}
%    \label{fig:coeff}
%\end{figure}


Этапы выполнения алгоритма представлены на рис.~7
и 8, %
%На рисунке~9
%представлен
%\noindent
результат получения ориентированного графа и~структур базисных
циклов графа, приведенного на рис.~3,~--- на рис.~9.




%\begin{figure}[h!]
%    \begin{minipage}[t]{0.45\textwidth}
%        \centering
%        \includegraphics[width=0.6\textwidth,clip]{fig-7}
%    \end{minipage}
%    \begin{minipage}[t][0cm][t]{0.45\textwidth}
%        \centering
%        \vspace*{-2.8cm}
%        \small
%       Исходное состояние \textbf{STC}\\[5pt]
%        \begin{tabular}{ccccc}
%        %\hline
%        0&1&0&1&1\\ %\hline
%        1&0&1&0&0\\ %\hline
%        0&1&0&0&0\\ %\hline
%        1&0&0&0&0\\ %\hline
%        1&0&0&0&0\\ %\hline
%        \end{tabular}
%    \end{minipage}
%    \\[5pt]
%    \begin{minipage}[t]{0.44\textwidth}
%        \centering
%        \includegraphics{fig-7-1}
%    \end{minipage}
%    \begin{minipage}[t]{0.44\textwidth}
%        \centering
%        \footnotesize
%        \includegraphics{fig-7-2}
%    \end{minipage}
%    \caption{Базисный цикл хорды (3,4), $i=3$, $j=4$\\Указаны направления дуг и~коэффициенты при параллельных переменных дуг,
%    входящих в~уравнение базисного цикла}
%    \label{fig:contour}
%\end{figure}


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{04/fig7}

\vskip 2mm {\small{\it Рис. 7.} Базисный цикл хорды (3,4), $i=3$, $j=4$\\
} %\label{fig:contour}

\vskip 0.5mm {\footnotesize Указаны направления дуг и~коэффициенты
при параллельных переменных дуг,\\ входящих в~уравнение базисного
цикла\\ }
\end{figure}



\begin{figure}[h!]
\centering
    \begin{minipage}[t]{0.47\textwidth}
        \centering
       \footnotesize% \small
        $NC[2]$\\[5pt]
        \begin{tabular}{cccccc}
                & dnc & ic & jc & ac & kc \\[5pt]
            1   &  0  & 0  & 0  & 0  & 0  \\
            2   &  0  & 0  & 0  & 0  & 0  \\
            3   &  0  & 0  & 0  & 0  & 0  \\ %\rule{0pt}{10pt} \\
            4   &  0  & 0  & 0  & 0  & 0  \\
            $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
            $v-1$ &  0  & 0  & 0  & 0  & 0  \\
        \end{tabular}
    \end{minipage}
    \begin{minipage}[t]{0.47\textwidth}
        \centering
       \footnotesize%  \small
        $NC[2]$ \quad $l=2$, $k=3$, $p=3$\\[5pt]
        \begin{tabular}{cccccc}
            %\hline
                & dnc & ic & jc & ac & kc \\[5pt]
            1   &  0  & 0  & 0  & 0  & 0  \\
            2   &  0  & 0  & 0  & 0  & 0  \\
            3   &  3  & 3  & 4  & 4  & +1 \\ %\rule{0pt}{10pt} \\
            4   &  0  & 0  & 0  & 0  & 0  \\
            $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
            $v-1$ &  0  & 0  & 0  & 0  & 0  \\
        \end{tabular}\\
        \begin{flushleft}
            \vskip-5pt
            \hskip7.6mm $\mathbf{R}[4].nnc:=\mathbf{R}[4].nnc+1$
        \end{flushleft}
    \end{minipage}

\vskip16pt

    \begin{minipage}[t]{0.47\textwidth}
        \centering
      \footnotesize%   \small
        $NC[2]$ \quad $l=1$, $k=2$, $p=2$\\[5pt]
        \begin{tabular}{cccccc}
                & dnc & ic & jc & ac & kc \\[5pt]
            1   &  0  & 0  & 0  & 0  & 0  \\
            2   &  3  & 3  & 4  & 1  & +1  \\
            3   &  3  & 3  & 4  & 4  & +1  \\
            \hline
            4   &  0  & 0  & 0  & 0  & 0 \rule{0pt}{9pt} \\
            $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
            $v-1$ &  0  & 0  & 0  & 0  & 0  \\
        \end{tabular}\\
        \begin{flushleft}
            \vskip-5pt
            \hskip7.6mm $\mathbf{R}[1].nnc:=\mathbf{R}[1].nnc+1$
        \end{flushleft}
    \end{minipage}
    %\footnotesize
    \begin{minipage}[t]{0.47\textwidth}
        \centering
     \footnotesize%    \small
        $NC[2]$ \quad $l=4$, $k=1$, $p=1$\\[5pt]
        \begin{tabular}{cccccc}
            %\hline
                & dnc & ic & jc & ac & kc \\[5pt]
            1   &  3  & 3  & 4  & 2  & $-1$  \\
            2   &  3  & 3  & 4  & 1  & +1  \\
            3   &  3  & 3  & 4  & 4  & +1 \\
            \hline
            4   &  0  & 0  & 0  & 0  & 0\rule{0pt}{9pt}  \\
            $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
            $v-1$ &  0  & 0  & 0  & 0  & 0  \\
        \end{tabular}\\
        \begin{flushleft}
            \vskip-5pt
            \hskip7.6mm $\mathbf{R}[2].nnc:=\mathbf{R}[2].nnc+1$
        \end{flushleft}
    \end{minipage}

\vskip 4mm {\small{\it Рис. 8.} Составление структуры базисного
цикла хорды (3,4), $i = 3$, $j = 4$, $q = 2$
    }%\label{fig:inwork}
\end{figure}






\begin{figure}[h!]
\centering
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \includegraphics[scale=1]{04/fig9}
    \end{minipage}
%   \hskip5mm
    \begin{minipage}[t][0cm][t]{0.25\textwidth}
        %\centering
        \small
       \vspace*{-3.0cm}
        Для ветвей\\
        $\mathbf{R}[1].nnc = 2$\\
        $\mathbf{R}[2].nnc = 2$\\
        $\mathbf{R}[3].nnc = 2$\\
        $\mathbf{R}[4].nnc = 1$\\
    \end{minipage}

    \vskip10pt
    \begin{minipage}[t]{0.4\textwidth}
        \centering
        \small
        $NC[1]$ --- хорда 5\\[5pt]
        \begin{tabular}{cc|ccc}
             dnc & ic & jc & ac & kc  \\[5pt]
              2  & 2  & 5  & 3  & $-1$\\
              2  & 2  & 5  & 1  & +1  \\
              \hline
              0  & 0  & 0  & 0  & 0\rule{0pt}{9pt}   \\
              0  & 0  & 0  & 0  & 0   \\
             $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
        \end{tabular}
    \end{minipage}
    %\hskip10pt
    \hfill
    \begin{minipage}[t]{0.4\textwidth}
        \centering
        \small
        $NC[2]$ --- хорда 6\\[5pt]
        \begin{tabular}{ccccc}
             dnc & ic & jc & ac & kc  \\[5pt]
              3  & 3  & 4  & 2  & $-1$\\
              3  & 3  & 4  & 1  & +1  \\
              \hline
              3  & 3  & 4  & 4  & +1\rule{0pt}{9pt}  \\
              0  & 0  & 0  & 0  & 0   \\
             $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\\
        \end{tabular}
    \end{minipage}
        %\hskip10pt
        %\hfill

    \vskip10pt
    %\raggedright
    \begin{minipage}[t]{0.3\textwidth}
        \centering
        \small
        $NC[3]$ --- хорда 7\\[5pt]
        \begin{tabular}{cc|ccc}
             dnc & ic & jc & ac & kc  \\[5pt]
             \hline
              2  & 4  & 5  & 3  & $-1$\rule{0pt}{9pt}\\
              2  & 4  & 5  & 2  & +1  \\
              0  & 0  & 0  & 0  & 0   \\
              0  & 0  & 0  & 0  & 0   \\
              \hline
             $\cdots$ & $\cdots$ & $\cdots$& $\cdots$& $\cdots$\rule{0pt}{9pt}\\
        \end{tabular}
    \end{minipage}

\vskip 2mm {\small{\it Рис. 9.} Полученный ориентированный граф
(сверху, хорды перечеркнуты)\\ и~структуры базисных циклов
(снизу)\\ }%\label{fig:result-graph}
\end{figure}



Оценка трудоемкости предложенного алгоритма оценивается авторами
как $O(v^3)$ для наихудшего случая, а в~среднем потребуется
выполнить меньше операций. При этом основную долю операций
занимают операции присваивания, несколько меньшую долю ---
условные операции и~совсем незначительную --- аддитивные операции.
Из-за наличия достаточно большого количества условных операций
сложно дать более точную теоретическую оценку трудоемкости.

Для оценки трудоемкости алгоритмов были реализованы как
алгебраический метод, так и~метод, разработанный авторами. Оценка
трудоемкости производилась как для графа, приведенного для
иллюстрации работы алгоритма, так и~для графов с~большим числом
вершин и~ребер. При измерении времени не учитывались операции
ввода/вывода и~подготовки входных данных. Для алгебраического
метода использовалась высокопроизводительная библиотека
\texttt{OpenBLAS}. На тестовых данных реализация алгебраического
метода уступала по времени вычислений описанному алгоритму
в~2--4~раза.


%\section{Заключение}
\textbf{4. Заключение.} Предложена система алгоритмов, позволяющих
составить системы уравнений для систем различной природы,
структура которых задана с~помощью графов любой сложности. При
этом обеспечены проверки связности графа, физической реализуемости
системы и~отсутствия (наличия) нерабочих петель, что даст
возможность использовать рассмотренные алгоритмы не только для
разработки новых систем, но и~для диагностики рабочего
оборудования и~поиска неисправностей.

Подход к~определению физической реализуемости графа состоит в~том,
что сначала строится система базисных циклов, а затем
устанавливается, входит ли каждая ветвь в~один из них. Если это не
так, то представленная система не обладает свойством физической
реализуемости.

Прежде всего мы рассматриваем технические системы (электрические,
электромеханические и~механические, последние для исследования
могут быть преобразованы в~электрические с~использованием систем
электромеханических аналогий [6]), однако полученные результаты
могут быть распространены на системы другой природы.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{04/lit-ra}

%\newpage
\input{04/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

%\thispagestyle{empty}

\vskip 3mm

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~16.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~16.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %

}
