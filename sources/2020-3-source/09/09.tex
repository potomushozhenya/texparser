
\noindent{\small УДК 517.977.1  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~16.~Вып.~\issuenum}\\
MSC 93C05

}

\vskip3mm

\noindent{\bf К~теории конструктивного построения линейного регулятора%$^{*}$%
 }

\vskip3mm

\noindent{\it А.~М.~Камачкин, Н.~А.~Степенко, Г.~М.~Хитров%$\,^1$%
%, В.~М.~Буре$\,^{1,2}$%
%, О.~А.~Митрофанова$\,^{1,2}$%
%, Е.~П.~Митрофанов$\,^{1,2}$%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
%\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (грант № 19-29-05184 мк).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent%
%$^2$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:}
\textit{Камачкин~А.~М., Степенко~Н.~А., Хитров~Г.~М.} К~теории
конструктивного построения линейного регулятора~// Вестник
Санкт-Петербургского университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~16.
Вып.~\issuenum.
С.~\pageref{p9}--\pageref{p9e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum09

\vskip3mm

{\leftskip=7mm\noindentИсследуется классическая задача
стационарной стабилизации по состоянию линейной стационарной
управляемой системы. Рассматриваются эффективные, легко
алгоритмизируемые методы построения регуляторов управляемых
систем: метод В.~И.~Зубова и~метод П.~Бруновски. Указываются
наиболее удачные их модификации, облегчающие построение линейного
регулятора. Предлагается новая модификация построения линейного
регулятора с~использованием преобразования матрицы исходной
системы в~блочно-диагональный вид. Данная модификация содержит все
преимущества как метода В.~И.~Зубова, так и~метода П.~Бруновски
и~позволяет свести задачу с~многомерным управлением к~задаче
стабилизации совокупности независимых подсистем со скалярным
управлением для каждой подсистемы.\\[1mm]
\textit{Ключевые слова}: стабилизация движений, линейный
регулятор, канонические формы управляемости.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{1.} %Общая система управления с~многомерным управлением
Следуя классической задаче теории стабилизации движений~[1--3],
рассмотрим общую систему управления с~многомерным управлением,
заданную линейной стационарной системой
\begin{equation}\label{eq:ABu}
  \dot x = Ax + Bu,
\end{equation}
где $x$~---  $n$-мерный вектор переменных системы; $A$~--- матрица
размерности $n\times n$; управление $u=\big(u_1,\dots,u_r\big)^T$
есть $r$-мерный вектор; $B=\big[B_1\,\dots B_r\big]$~---  матрица
размерности~$n\times r$. Будем считать, что матрица $B$ состоит из
линейно независимых столбцов, так как в~противном случае
система~\eqref{eq:ABu} будет полностью эквивалентна системе с~этой
же матрицей $A$, но с~управлением $u$ меньшей размерности, при
котором матрица будет уже состоять из линейно независимых
столбцов.

Вектор управления $u$ выбираем в~виде
\begin{equation}\label{eq:uCx}
u = Cx
\end{equation}
так, чтобы нулевое решение системы~\eqref{eq:ABu} было
асимптотически устойчиво по Ляпунову. Матрицу $C$  размерности
$r\times n$ обычно называют {\it линейным регулятором}. Иными
словами, ищем линейный стационарный регулятор, обеспечивающий
асимптотическую устойчивость замкнутой системе~\eqref{eq:ABu}.
Рассмотрим задачу выбора эффективного и~алгоритмизируемого метода
построения такого линейного регулятора. В~статье сравниваются два
подхода решения задачи: метод В.\:И.~Зубова и~метод П.~Бруновски.
Название методов условное, поскольку они основаны на работах
В.\:И.~Зубова~[1] и П.~Бруновски~[4]. После них было написано
большое количество работ, где предлагались другие алгоритмы
стабилизации, но все они громоздки и~трудно алгоритмизуемы,
особенно в~случае многомерного управления, что отражено, например,
в~обзоре~[5].

Будем считать, что ранг \textit{матрицы управляемости}
$V_\mathcal{K}$ равен  $$ V_\mathcal{K} =\big[B\,\,AB\,\dots
A^{n-1}B\big] = n,
$$
т.~е. система~\eqref{eq:ABu} полностью управляема~[3]. % {Klmn}


Построим теперь матрицу $V$~---  классического базиса линейного
пространства~[1, с.~157],  инвариантного относительно оператора
$A$, который будет отражать структуру системы
управления~\eqref{eq:ABu}.

Среди столбцов матрицы управляемости $V_\mathcal{K}$ есть $n$
линейно независимых. Выберем из этих линейно независимых векторов
систему базисных векторов линейного пространства следующим
образом:
\begin{equation}\label{eq:V}
V = \Big[B_{j_1}\,AB_{j_1}\dots A^{k_1-1}B_{j_1}\ \dots\
B_{j_s}\,AB_{j_s}\dots A^{k_s-1}B_{j_s}\ \dots\
B_{j_\rho}\,AB_{j_\rho}\dots A^{k_\rho-1}B_{j_\rho}\Big],
\end{equation}
где возрастающие номера $j_s$, $s=1,\dots,\rho$, берутся из
множества номеров $\{1,\dots,r\}$, причем $\rho\le r$ и~всегда
$j_1=1$, в~силу линейной независимости столбцов матрицы $B$.
Здесь, очевидно, должно выполняться, что размеры $k_s$ цепочек
базисных векторов, формирующихся для каждого из $B_{j_s}$,
отвечают равенству
$$
k_1 + \dots + k_\rho = n,
$$
т.~е. общая размерность матрицы $V$ есть $n\times n$. При этом
каждый, следующий за замыкающим соответствующую $j_s$-ю цепочку
базисных векторов, вектор $A^{k_s}B_{j_s}$ является линейно
зависимым со всеми (для всех цепочек перед $j_s$-й включительно)
предыдущими векторами из базиса $V$.
%\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\indent\textbf{2.} %Структура пространства системы управления
Отметим структуру пространства системы управления, которая
формируется матрицами $A$, $B$ и~способом задания базиса $V$.
Здесь $\rho$~---  количество столбцов~$B_{j_s}$ матрицы $B$,
которые участвуют в~формировании матрицы базиса $V$ и~задают свою
цепочку длины $k_s$ линейно независимых базисных векторов
$$
B_{j_s},AB_{j_s},\dots,A^{k_s-1}B_{j_s},
$$
где целые числа $k_s>0$ для всех $s=1,\dots,\rho$.

Так как каждый вектор $A^{k_s}B_{j_s}$ линейно зависимый со всеми
ему предыдущими векторами из матрицы $V$, то, очевидно, существует
представление этих векторов через линейные комбинации
предшествующих им векторов из матрицы $V$ вида
$$
A^{k_1}B_{j_1} = -p_1^{(1)}A^{k_1-1}B_{j_1} - \dots -
p_{k_1}^{(1)}B_{j_1},
$$
откуда, сгруппировав
$$
\Big(A^{k_1} + p_1^{(1)}A^{k_1-1} + \dots +
p_{k_1}^{(1)}E\Big)B_{j_1} = 0,
$$
находим для $s=1$~---  первой цепочки из $V$ и~\eject
$$ %\begin{multline*}
A^{k_s}B_{j_s} = -p_1^{(s)}A^{k_s-1}B_{j_s} - \dots - p_{k_s}^{(s)}B_{j_s} +$$ $$ %\\[4pt]
+~ \bar p_1^{(s-1,s)}A^{k_{s-1}-1}B_{j_{s-1}} + \dots + \bar
p_{k_{s-1}}^{(s-1,s)}B_{j_{s-1}} + \dots + \bar
p_1^{(1,s)}A^{k_1-1}B_{j_1} + \dots + \bar p_{k_1}^{(1,s)}B_{j_1},
$$ %\end{multline*}
или
\begin{equation}\label{eq:AksBjs}
\Big(A^{k_s} + p_1^{(s)}A^{k_s-1} + \dots +
p_{k_s}^{(s)}E\Big)B_{j_s} = \sum\limits_{i=1}^{s-1}\Big(\bar
p_1^{(i,s)}A^{k_i-1} + \dots + \bar p_{k_i}^{(i,s)}E\Big)B_{j_i}
\end{equation}
для всех остальных $s=2,\dots,\rho$.

Но тогда при умножении на такой вектор обратной матрицы к~$V$
получаем для $s=1$ вектор $F_{m_1}$:
$$
F_{m_1} = V^{-1}A^{k_1}B_{j_1} = -p_1^{(1)}e_{k_1} -
p_2^{(1)}e_{k_1-1} - \dots - p_{k_1}^{(1)}e_1 =
\Big(-p_{k_1}^{(1)},\dots,-p_1^{(1)},0,\dots,0\Big)^T,
$$
для остальных $s=2,\dots,\rho-1$ определяем вектор $F_{m_s}$:
$$ %\begin{multline*}
%\!\!\!
F_{m_s} = V^{-1}A^{k_s}B_{j_s} = -p_1^{(s)}e_{m_s} - p_2^{(s)}e_{m_s-1} -\dots - p_{k_s}^{(s)}e_{m_{s-1}+1} +$$ $$ %\\[6pt]
%\!\!\!\!
+~ \bar p_1^{(s-1,s)}e_{m_{s-1}} + \bar p_2^{(s-1,s)}e_{m_{s-1}-1} + \dots + \bar p_{k_{s-1}}^{(s-1,s)}e_{m_{s-2}+1} + \dots$$ $$ %\\[6pt]
\dots + \bar p_1^{(1,s)}e_{m_1} + \bar p_2^{(1,s)}e_{m_1-1} + \dots + \bar p_{k_1}^{(1,s)}e_1 =$$ $$ %\\[4pt]
=\Big(\bar p_{k_1 }^{(1,s)},\dots,\bar p_1^{(1,s)},\dots,\bar
p_{k_{s-1}}^{(s-1,s)} ,\dots,\bar
p_1^{(s-1,s)},-p_{k_s}^{(s)},\dots,-p_1^{(s)},0,\dots,0\Big)^T
$$ %\end{multline*}
и для последнего $s=\rho$ находим вектор $F_{m_\rho}$:
$$
\!\!\!\!\!\!\!\!\!\!\!\! F_{m_\rho} = V^{-1}A^{k_\rho}B_{j_\rho} =
\Big(\bar p_{k_1}^{(1,\rho)},\dots,\bar p_1^{(1,\rho)} ,\dots,\bar
p_{k_{\rho-1}}^{(\rho-1,\rho)},\dots,\bar
p_1^{(\rho-1,\rho)},-p_{k_\rho
}^{(\rho)},\dots,-p_1^{(\rho)}\Big)^T.
$$
Все вектора $F_{m_s}$ являются $n$-мерными для всех
$s=1,\dots,\rho$ и~величина
\begin{equation}\label{eq:m_s}
m_s = \sum\limits_{i=1}^s k_s,
\end{equation}
где $m_1 = k_1$ и~$m_\rho = n$. Далее часто будет встречаться
обозначение $m_{s-1}$, которое, для ясности, при $s=1$ доопределим
значением $m_0=0$ (так как оно будет всегда использоваться только
в связке типа $m_{s-1}+1$ и~подобных).
%\vskip3mm

{\bf Замечание 1}. {Здесь важно отметить, что как сами $B_{j_s}$,
так и~отвечающие каждому вектору $B_{j_s}$ значения
\begin{equation}\label{eq:pks}
-p_{k_s}^{(s)},\dots,-p_1^{(s)}
\end{equation}
как раз и~определяют однозначно структуру пространства,
описываемого базисом $V$, системы управления~\eqref{eq:ABu}:
задают не только $k_s$~---  размерности подпространств, но
и~указывают те компоненты $u_{j_s}$ вектора управления $u$, по
которым и~происходит воздействие на основную систему,
$s=1,\dots,\rho$.}
%\vskip3mm
\smallskip

Действительно, если учесть смысл преобразования $V^{-1}AV$, то
очевидно, что значения~\eqref{eq:pks} задают полиномы
$$
\chi_s(\lambda) = \lambda^{k_s} + p_1^{(s)}\lambda^{k_s-1} + \dots
+ p_{k_s}^{(s)} = \big(\lambda -
\lambda_1^{(s)}\big)\cdot\dots\cdot\big(\lambda -
\lambda_{k_s}^{(s)}\big),
$$
которые являются множителями характеристического полинома
$\chi_A(\lambda)$ матрицы $A$:
$$
\chi_A(\lambda) = \prod\limits_{s=1}^\rho\chi_s(\lambda),
$$
а числа $\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$ являются его корнями и, следовательно, %т.~е.
 собственными числами матрицы $A$.
%\vskip3mm
% \eject

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{3.} %Метод Зубова
Теперь рассмотрим основные методы использования базиса $V$
в~решении задачи стабилизации линейных стационарных систем.
Изложим сначала метод~В.~И.~Зубова~[1, 2, 6] и~отразим его
ключевые особенности.

Произведем замену переменных
$$
x=Vy
$$
и переведем исходную систему~\eqref{eq:ABu} к~виду
\begin{equation}\label{eq:FQv}
\dot y = V^{-1}AVy + V^{-1}Bu = Fy + Q_V\,u,
\end{equation}
где матрица
\begin{multline*}
F = V^{-1}AV = \Big[V^{-1}AB_{j_1}\dots V^{-1}A^{k_1-1}B_{j_1}\ \, V^{-1}A^{k_1}B_{j_1}\dots \\[4pt]
\dots V^{-1}AB_{j_s}\dots V^{-1}A^{k_s-1}B_{j_s}\ \, V^{-1}A^{k_s}B_{j_s}\dots \\[6pt]
\qquad\qquad \dots V^{-1}AB_{j_\rho}\dots V^{-1}A^{k_\rho-1}B_{j_\rho}\ \, V^{-1}A^{k_\rho}B_{j_\rho}\Big] =\\[4pt]
=\Big[e_2\dots e_{k_1}\ F_{m_1}\dots e_{m_{s-1}+2}\dots e_{m_s}\ F_{m_s}\dots e_{m_{\rho-1}+2}\dots e_{m_\rho}\ F_{m_\rho}\Big] =\\[8pt]
\hfill =\left(\begin{array}{ccccc}
F_{k_1k_1}  & \dots  & F_{k_1k_s} & \dots & F_{k_1k_\rho} \\
 & \ddots & \vdots & & \vdots \\
 & & F_{k_sk_s} & \dots & F_{k_sk_\rho} \\
 & & & \ddots & \vdots \\
0 & & & & F_{k_\rho k_\rho}
\end{array}\right).\hfill
\end{multline*}
Здесь $e_i$ при $i=2,\dots,m_\rho=n$ --- $n$-мерные единичные векторы, матрицы $F_{k_sk_s}$ размерности $k_s\times k_s$, фробениусовы нормальные формы и~матрицы $F_{k_sk_{s+i}}$ размерности $k_s\times k_{s+i}$, $i=1,\dots,\rho-s$,  соответственно есть%: %запишем следующим образом:
$$
F_{k_sk_s} = \left(\begin{array}{ccccl}
0 & 0 & \dots & 0 & -p_{k_s}^{(s)} \\[6pt]
1 & 0 & \dots & 0 & -p_{k_s-1}^{(s)} \\[6pt]
0 & 1 & \dots & 0 & -p_{k_s-2}^{(s)} \\[4pt]
\vdots & \vdots & \ddots & \vdots & \quad\vdots \\[4pt]
0 & 0 & \dots & 1 & -p_1^{(s)}
\end{array}\right),
\quad %\textrm{и}\quad
F_{k_sk_{s+i}} = \left(\begin{array}{cccc}
0 & \dots & 0 & \bar p_{k_s}^{(s,s+i)} \\[4pt]
\vdots & \dots & \vdots & \hspace{-16pt}\vdots \\[4pt]
0 & \dots & 0 & \bar p_1^{(s,s+i)}
\end{array}\right).
$$
Примем, что  $B_{j_1}=B_1$. С учетом этого матрица $Q_V$ будет выглядеть как %имеет вид
$$
Q_V = V^{-1}\Big[B_1\dots B_{j_i^*}\dots B_{j_s}\dots B_r\Big]
% = \Big[e_1\dots V^{-1}B_{j_i^*}\dots e_{m_s-k_s+1}\dots V^{-1}B_r\Big] =
%$$
%$$
= \Big[e_1\dots Q_{j_i^*}\dots e_{m_{s-1}+1}\dots Q_r\Big],
$$
где векторы $e_{m_{s-1}+1}$ находятся на позиции $j_s$-го столбца
матрицы $Q_V$ и~являются\break $m_{s-1}+1$ единичными $n$-мерными
векторами, $s=1,\dots,\rho$. Векторы $Q_{j_i^*}=V^{-1}B_{j_i^*}$,
отвечающие столбцам матрицы $B$, не участвовавшим в~формировании
базиса $V$ (индексы $j_i^*$, $i=1,\dots,r-\rho$, также находятся
среди множества номеров $\{1,\dots,r\}$, но не совпадают со
значениями $j_s$, $s=1,\dots,\rho$), представляют собой векторы
коэффициентов линейных разложений самих векторов~$B_{j_i^*}$ по
векторам базиса $V$, сформированных на векторах $B_{j_s}$, стоящих
перед вектором $B_{j_i^*}$ в~матрице $B$. Вектор $Q_r$ является
либо вектором $e_{m_{\rho-1}+1}$, если вектор $B_r$ участвовал
в~формировании матрицы $V$, либо вектором $Q_{j_{r-\rho}^*}$
в~противном случае.
%\vskip3mm
\smallskip

Как видим, матрица $F$ системы~\eqref{eq:FQv} не
блочно-диагональная, так как матрицы $F_{k_sk_{s+i}}$, находящиеся
над блочной диагональю, могут содержать ненулевые компоненты,
$s=1,\dots,\rho$ и~$i=1,\dots,\rho-s$. В~таком случае разбить
систему~\eqref{eq:FQv} на $\rho$ полностью независимых друг от
друга подсистем со скалярными управлениями $u_{j_s}$ (учитывая вид
матрицы $Q_V$) не представляется возможным.
%\vskip3mm
\smallskip

Однако, учитывая квазитреугольный вид матрицы $F$ (со стоящими на
главной диагонали блоками $F_{k_sk_s}$ размерности $k_s\times
k_s$), сделаем переобозначения переменных $y$ следующим образом:
%%%%%$$
%%%%%Y^{(s)} =
%%%%%\Big(y_1^{(s)},\dots,y_{k_s}^{(s)}\Big)^T,\quad s=1,\dots,\rho,
%%%%%%\left(\begin{array}{c}
%%%%%%y_1^{(s)} \\
%%%%%%\vdots \\
%%%%%%y_{k_s}^{(s)}
%%%%%%\end{array}\right), \quad s=1,\dots,\rho,
%%%%%$$
%%%%%где
%%%%%$$
%%%%%y_i^{(s)} = y_{m_{s-1}+i},\quad\textrm{для}\quad i=1,\dots,k_s.
%%%%%$$
$$
Y^{(s)} = \Big(y_1^{(s)},\dots,y_{k_s}^{(s)}\Big)^T,$$ %
%\quad\textrm{
где %}\quad
$y_i^{(s)} = y_{m_{s-1}+i},~~ \textrm{для всех}~~
s=1,\dots,\rho,~~ i=1,\dots,k_s. $

Тогда система~\eqref{eq:FQv} в~переменных $y$ перепишется как
$$
\left\{\begin{array}{l} \dot Y^{(s)} = F_{k_sk_s}Y^{(s)} +
\sum\limits_{i=1}^{\rho-s} \left(\begin{array}{c}
\bar p_{k_s}^{(s,s+i)} \\[4pt]
\hspace{-16pt}\vdots \\[4pt]
\bar p_1^{(s,s+i)}
\end{array}\right)
y_{k_{s+i}}^{(s+i)}
%F_{k_sk_{s+i}}Y^{(s+i)}
+ e_1^{(k_s)}u_{j_s} + \Big[Q_{j_{i^*}^*}\dots\
Q_{j_{r-\rho}^*}\Big] \left(\!\!\begin{array}{c}
u_{j_{i^*}^*} \\
\vdots \\
u_{j_{r-\rho}^*}
\end{array}\!\!\right),\\[8pt]
s=1,\dots,\rho,
\end{array}\right.
$$
здесь $e_1^{(k_s)}$~---  первый единичный вектор $k_s$-размерности %(индекс $(s)$~---  означает принадлежность к~$s$-му блоку уравнений и, следовательно, говорит о~размерности $k_s$ этого единичного вектора)
и управление $u_{j_s}$~---  $j_s$-й элемент управления $u$; номер
$j_{i^*}^*$~---  первый из номеров $j_i^*$, который по своему
значению превосходит номер~$j_s$ (само значение индекса
$j_{i^*}^*=j_s+1$). При $s=\rho$ второго слагаемого (неоднородной
составляющей) в~правой части системы нет.

Векторы $e_1^{(k_s)}$ получаются из векторов $e_{m_{s-1}+1}$ (матрицы $Q_V$) путем отбрасывания всех нулей над 1, которая сама стоит на ($m_{s-1}+1$)-й строке, т.~е. на первой строке системного блока, относящегося к~набору переменных $Y^{(s)}$, и~отбрасывания всех нулей после %\break
$m_s$-й строки, так как следующий по порядку единичный вектор
$e_{m_s+1}$ матрицы~$Q$ содержит свою 1 на ($m_s+1$)-й строке
(относящейся уже к~системному блоку переменных~$Y^{(s+1)}$).
%\medskip

Положим теперь, что все управления
%$$
%\left(\begin{array}{c}
%u_{j_1^*} \\
%\vdots \\
%u_{j_{r-\rho}^*}
%\end{array}\right) = 0,
%$$
$\big(u_{j_1^*},\dots,u_{j_{r-\rho}^*}\big)^T = 0$, т.~е.
система~\eqref{eq:FQv} окончательно примет вид
$$
\dot Y^{(s)} = F_{k_sk_s}Y^{(s)} + e_1^{(k_s)}u_{j_s} +
\sum\limits_{i=1}^{\rho-s} \left(\begin{array}{c}
\bar p_{k_s}^{(s,s+i)} \\[4pt]
\hspace{-16pt}\vdots \\[4pt]
\bar p_1^{(s,s+i)}
\end{array}\right)
y_{k_{s+i}}^{(s+i)},
% \sum\limits_{i=1}^{\rho-s} F_{k_sk_{s+i}}Y^{(s+i)},
\quad s=1,\dots,\rho.
$$
Здесь каждый блок переменных $Y^{(s)}$ представляет собой линейную
неоднородную систему дифференциальных уравнений (кроме последнего,
при $s=\rho$), и~тогда для устойчивости данных систем необходимо
и~достаточно добиться устойчивости соот\-вет\-ст\-вую\-щих
однородных (с учетом, разумеется, линейного представления
управления $u_{j_s}$) систем в~{\it канонической форме}
\begin{equation}\label{eq:Ys_e1}
\dot Y^{(s)} = F_{k_sk_s}Y^{(s)} + e_1^{(k_s)}u_{j_s}, \quad
s=1,\dots,\rho.
\end{equation}

Следовательно, задача построения многомерного управления сводится
к последовательному для каждого блока переменных $Y^{(s)}$
применению метода В.\:И.~Зубова по\-строе\-ния скалярного
управления
%$$
%u_{j_s} = \gamma_s Y^{(s)} =
%\Big(\gamma_1^{(s)},\dots,\gamma_{k_s}^{(s)}\Big)
%\left(\!\!\begin{array}{c}
%y_1^{(s)} \\
%\vdots \\
%y_{k_s}^{(s)}
%\end{array}\!\!\right),
%$$
$u_{j_s} = \gamma_s Y^{(s)}, % = \Big(\gamma_1^{(s)},\dots,\gamma_{k_s}^{(s)}\Big)Y^{(s)},
$
где строки $\gamma_s$ определяются, согласно~[1, 2], % {Zub1,Smir}
однозначным образом в~зависимости от коэффициентов
соответствующего эталонного полинома, задающего наперед заданные
собственные числа, расположенные в~открытой левой полуплоскости.
%\medskip

Таким образом, хотя полученная квазитреугольная матрица $F$
позволила решить задачу стабилизации методом В.\:И.~Зубова,
предпочтительнее было бы получить такую матрицу замены переменных,
после перехода к~которым матрица $A$ преобразовывалась
в~блочно-диагональную. Это, в~свою очередь, позволяет свести
исходную задачу~\eqref{eq:ABu} с~многомерным управлением к~ряду
независимых друг от друга задач ста\-би\-ли\-зации линейных
стационарных систем меньших размерностей со скалярными
уп\-рав\-лениями.
%\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\textbf{4.} % Модификация базиса Луенбергера
Теперь укажем гибридную модификацию методов~[1, 7] % {Zub1,Lue}
построения базиса новых координат для перехода
системы~\eqref{eq:ABu} к~форме с~квазитреугольной матрицей,
с~диагональными блоками в~виде {\it канонической формы
управляемости $($controll\-able canonical form $($CCF$))$},
полностью соответствующими диагональным блокам матрицы $F$
(яв\-ляю\-щи\-ми\-ся их транспонированием) из
системы~\eqref{eq:FQv}, (8), но для скорректированного метода
построения базиса $V$.

1. Вернемся снова к~исходной системе управления~\eqref{eq:ABu}
в~прежних переменных $x$. Будем строить матрицу $V$ на основе
структуры~\eqref{eq:V} таким образом, чтобы или один какой-либо
вектор из матрицы $B$ сформировал весь базис $V$, или, если ни
одного такого вектора не нашлось, то выберем векторы
$B_{j_1},\dots,B_{j_\rho}$, где $1<\rho\le r$, из матрицы $B$ так,
чтобы длины $k_s$ их цепочек базисных векторов
$B_{j_s},AB_{j_s},\dots,A^{k_s-1}B_{j_s}$, $s=1,\dots,\rho$,
удовлетворяли условию
\begin{equation}\label{eq:k_s}
k_s\le k_{s+1}
\end{equation}
для всех $s=1,\dots,\rho-1$.

2. Матрица $V$ невырожденная, следовательно, можно определить
обратную к~ней матрицу $V^{-1}$. Рассмотрим в~матрице $V^{-1}$
строки $v_{m_s}$ для всех номеров $m_s$, определенных, как и~ранее
в~\eqref{eq:m_s}, при $s=1,\dots,\rho$. Исходя из того, что
$v_{m_s}$~---  это $m_s$-я строка обратной матрицы $V^{-1}$, то
при умножении данной строки на столбцы матрицы $V$ будет,
очевидно, верно равенство
$$
v_{m_s}V = e_{m_s}^T,
$$
где $e_{m_s}^T$~---  транспонированный $m_s$-й единичный
$n$-мерный вектор. \vspace{2pt}

3. Так как $A^{k_s-1}B_{j_s}$~---  $m_s$-й столбец матрицы $V$, то
также получаем, что
\begin{equation}\label{eq:SBjs}
\begin{array}{rcl}
v_{m_s}A^{k_s-1}B_{j_s} & = & 1,\\
v_{m_s}A^iB_j & = & 0,\quad\textrm{если}\quad
% i\not = k_s-1,j\not = j_s,
(i,j)\not = (k_s-1,j_s),
\end{array}
\end{equation}
где значения $(i,j)$ выбираются в~соответствии со структурой
матрицы $V$. Причем для $s=2,\dots,\rho$ второе свойство
из~\eqref{eq:SBjs} можно дополнить всеми значениями $i=0,1,\dots$
при условии, что $j<j_s$, так как в~таком случае вектор $A^iB_j$
является либо базисным вектором из матрицы $V$, занимающим позицию
с 1-го по $m_{s-1}$-й столбец, либо представляющим собой линейную
комбинацию этих первых $m_{s-1}$ столбцов матрицы $V$ (т.~е.
никоим образом не включающим в~свое представление базисного
вектора $A^{k_s-1}B_{j_s}$).

4. Составим следующую матрицу $S$ для замены переменных от $x$
к~$z$:
\begin{equation}\label{eq:S}
S = \left[\begin{array}{c}
v_{m_1}\\[2pt]
v_{m_1}A\\
\vdots\\
v_{m_1}A^{k_1-1}\\[2pt]
\hline
\vdots\\
\hline
v_{m_s}\\[2pt]
v_{m_s}A\\
\vdots\\
v_{m_s}A^{k_s-1}\\[2pt]
\hline
\vdots\\
\hline
v_{m_{\rho}}\\[2pt]
v_{m_{\rho}}A\\
\vdots\\
v_{m_{\rho}}A^{k_{\rho}-1}
\end{array}\right].
\end{equation}

5. Матрица $S$ является невырожденной, т.~е. все ее строки
являются линейно независимыми. Действительно, если предположить
обратное, то тогда будут существовать одновременно не равные нулю
числа $\alpha_i^{(j)}$ при всех $j=1,\dots,\rho$ и~$i=1,\dots,k_j$
такие, что линейная комбинация всех строк матрицы $S$ с~этими
коэффициентами $\alpha_i^{(j)}$ будет равна нулевой строке
$$
\sum\limits_{j=1}^\rho\Big(\alpha_1^{(j)}v_{m_j} +
\alpha_2^{(j)}v_{m_j}A + \dots +
\alpha_{k_j}^{(j)}v_{m_j}A^{k_j-1}\Big) = (0,\dots,0),
$$
и откуда следует, что выполняются скалярные равенства
$$
\sum\limits_{j=1}^\rho\Big(\alpha_1^{(j)}v_{m_j} +
\alpha_2^{(j)}v_{m_j}A + \dots +
\alpha_{k_j}^{(j)}v_{m_j}A^{k_j-1}\Big)A^lB_{j_s} =
(0,\dots,0)A^lB_{j_s} = 0
$$
для $s=1,\dots,\rho$ и~$l=0,\dots,k_s-1$. В~силу~\eqref{eq:SBjs},
последовательно для всех $s$
и также последовательно для всех $l$ %$l=0,\dots,k_s-1$
находим, что каждый $\alpha_{k_s-l}^{(s)} = 0$. Таким образом,
по\-лу\-чаем, что все числа $\alpha_i^{(j)}=0$, что противоречит
сделанному предположению о~линейной зависимости строк матрицы $S$,
т.~е. матрица $S$ невырожденная.

6. Здесь, так как $SS^{-1}=E$, также очевидно, что строка
\begin{equation}\label{eq:SS1}
v_{m_s}A^iS^{-1} = e_{m_{s-1}+i+1}^T
\end{equation}
для всех $i=0,\dots,k_s-1$ и~$s=1,\dots,\rho$.
% \medskip


{\bf Теорема 1.} {\it Для всякой полностью управляемой
системы~\eqref{eq:ABu} в~случае построения базиса $V$,
согласно~\eqref{eq:V}, при выполнении условия~\eqref{eq:k_s} можно
построить невырожденную матрицу $S$ вида~\eqref{eq:S} перехода
к~новым координатам следующим образом:
$$
x = S^{-1}z,
$$
которая преобразует систему~\eqref{eq:ABu} к~системе вида
\begin{equation}\label{eq:Brn}
\dot z = SAS^{-1}z + SBu = Gz + Q_Su,
\end{equation}
где новая матрица системы является квазитреугольной:
$$
G = SAS^{-1} = \left(\begin{array}{c}
e_2^T\\
\vdots\\
e_{m_1}^T\\[4pt]
v_{m_1}A^{k_1}S^{-1}\\[2pt]
\hline
\vdots\\
\hline
e_{m_s-k_s+2}^T\phantom{\Big|}\\
\vdots\\
e_{m_s}^T\\[4pt]
v_{m_s}A^{k_s}S^{-1}\\[2pt]
\hline
\vdots\\
\hline
e_{m_{\rho-1}+2}^T\phantom{\Big|}\\
\vdots\\
e_{m_\rho}^T\\[4pt]
v_{m_\rho}A^{k_\rho}S^{-1}
\end{array}\right) =
\left(\begin{array}{ccccc}
G_{k_1k_1} & \dots & G_{k_1k_s} & \dots & G_{k_1k_\rho}\\
& \ddots & \vdots & & \vdots\\
& & G_{k_sk_s} & \dots & G_{k_sk_\rho}\\
& & & \ddots & \vdots\\
0 & & & & G_{k_\rho k_\rho}
\end{array}\right),
$$
здесь строки $v_{m_s}A^{k_s}S^{-1}$ находятся на позиции $m_s$-й
строки матрицы $G$. Матрицы диагональных блоков $G_{k_sk_s}$
размерностей $k_s \times k_s$ и~матрицы $G_{k_sk_{s+i}}$
наддиагональных блоков размерностей $k_s\times k_{s+i}$
соответственно имеют вид
$$
G_{k_sk_s} = \left(\!\begin{array}{ccccc}
0 & 1 & 0 &\! \dots\! & 0\\
0 & 0 & 1 &\! \dots\! & 0\\
\vdots & \vdots & \vdots &\! \ddots\! & \vdots\\
0 & 0 & 0 &\! \dots\! & 1\\
\!-p_{k_s}^{(s)}\! &\! -p_{k_s-1}^{(s)}\! &\! -p_{k_s-2}^{(s)}\!
&\! \dots\! &\! -p_1^{(s)} \!
\end{array}\!\right)\!,
\quad G_{k_sk_{s+i}} = \left(\!\begin{array}{ccc}
0 &\! \dots\! & 0\\
\vdots &\! \dots\! & \vdots\\
0 &\! \dots\! & 0\\
\!\alpha_1^{(s,s+i)}\! &\! \dots\! &\! \alpha_{k_{s+i}}^{(s,s+i)}
\!
\end{array}\!\right)\!,
$$
где $s=1,\dots,\rho$, $i=1,\dots,\rho-s$ и~для каждого $s$-го
горизонтального набора блоков $($с $(m_s-k_s+1)$-й строки по
$m_s$-ю строку$)$ числа, заполняющие последние строки всех блоков
$G_{k_sk_s},G_{k_sk_{s+1}},\dots,G_{k_sk_\rho}$ и~нулей перед
этими блоками $($в случае $s\ge2$$)$ складываются в~строчку
$v_{m_s}A^{k_s}S^{-1}$.

Матрица $Q_S$ будет иметь вид
$$
Q_S = \Big[e_{m_1}^{(j_1)}\dots Q_{j_i^*}\dots
e_{m_\rho}^{(j_\rho)}\Big],
$$
где векторы $e_{m_s}^{(j_s)}$ находятся на позиции $j_s$-го
столбца матрицы $Q_S$ и~являются $m_s$ единичными $n$-мерными
векторами, $s=1,\dots,\rho$. Векторы $Q_{j_i^*}=SB_{j_i^*}$,
отвечающие столбцам матрицы $B$, не участвовавшим в~формировании
базиса $V$ $($индексы $j_i^*$,\break $i=1,\dots,r-\rho$, также
находятся среди множества номеров $\{1,\dots,r\}$, но не совпадают
со значениями $j_s$, $s=1,\dots,\rho$$)$ представляют собой
векторы коэффициентов линейных разложений самих
векторов~$B_{j_i^*}$ по векторам базиса $V$, сформированных на
векторах $B_{j_s}$, где $j_s<j_i^*$, с~учетом умножения на матрицу
$S$.
% стоящих перед вектором $B_{j_i^*}$ в~матрице $B$.
}


Д о~к~а з а~т е л ь с~т в~о. Действительно, строка
$v_{m_s}A^{k_s}$ не входит в~невырожденную матрицу $S$,
следовательно, линейно зависима со всеми строками матрицы $S$,
т.~е. представима в~виде некоторой линейной комбинации строк этой
матрицы:
$$
v_{m_s}A^{k_s} =
\sum\limits_{l=1}^{k_1}\alpha_l^{(s,1)}v_{m_1}A^{l-1} + \dots +
\sum\limits_{l=1}^{k_s}\alpha_l^{(s,s)}v_{m_s}A^{l-1} + \dots +
\sum\limits_{l=1}^{k_\rho}\alpha_l^{(s,\rho)}v_{m_\rho}A^{l-1}.
$$
Тогда, в~силу~\eqref{eq:SBjs}, последовательно для
$h=1,\dots,s-1$, но для каждого такого $h$ также последовательно
для $i = 1,\dots,k_h$ (т.~е. цикл по $i$ внутри цикла по $h$)
находим, что
\begin{gather*}
0 = v_{m_s}A^{k_s}A^{i-1}B_{j_h} =
\sum\limits_{l=1}^{k_h}\alpha_l^{(s,h)}v_{m_h}A^{l-1}A^{i-1}B_{j_h}
+ \dots +
\sum\limits_{l=1}^{k_s}\alpha_l^{(s,s)}v_{m_s}A^{l-1}A^{i-1}B_{j_h} + \dots \\
\dots +
\sum\limits_{l=1}^{k_\rho}\alpha_l^{(s,\rho)}v_{m_\rho}A^{l-1}A^{i-1}B_{j_h}
= \alpha_{k_h-i+1}^{(s,h)}.
\end{gather*}
То есть на каждом шаге $h$ в~выражении
$v_{m_s}A^{k_s}A^{i-1}B_{j_h}$, пробегая значения $i =
1,\dots,k_h$, получаем, что все $\alpha_l^{(s,h)} = 0$ при
$l=1,\dots,k_h$, и~уже при следующем шаге $h+1$ слагаемые
в~выражении $v_{m_s}A^{k_s}A^{i-1}B_{j_{h+1}}$ с~этими
коэффициентами $\alpha_l^{(s,h)}$ не участвуют (как впрочем и~все
предыдущие), здесь $s = 2,\dots,\rho$.

Таким образом, разложение всех строчек $v_{m_s}A^{k_s}$ по базису
матрицы $S$ сводится к~виду
\begin{equation}\label{eq:vmsAks}
v_{m_s}A^{k_s} =
\sum\limits_{l=1}^{k_s}\alpha_l^{(s,s)}v_{m_s}A^{l-1} + \dots +
\sum\limits_{l=1}^{k_\rho}\alpha_l^{(s,\rho)}v_{m_\rho}A^{l-1},\quad
s=1,\dots,\rho,
\end{equation}
и аналогично предыдущему определяем значения $\alpha_l^{(s,s)}$
следующим образом. В~силу~\eqref{eq:SBjs}, для фиксированного $s$
и всех $i = 1,\dots,k_s$ будет, с~одной стороны, выполняться
выражение
\begin{gather*}
v_{m_s}A^{k_s}A^{i-1}B_{j_s} = \sum\limits_{l=1}^{k_s}\alpha_l^{(s,s)}v_{m_s}A^{l-1}A^{i-1}B_{j_s} + \dots + \sum\limits_{l=1}^{k_\rho}\alpha_l^{(s,\rho)}v_{m_\rho}A^{l-1}A^{i-1}B_{j_s} =\\
=
\sum\limits_{l=1}^{k_s}\alpha_l^{(s,s)}v_{m_s}A^{l-1}A^{i-1}B_{j_s}.
\end{gather*}
Но, с~другой стороны, из~\eqref{eq:AksBjs} находим, что
$$
v_{m_s}A^{k_s}A^{i-1}B_{j_s}\, =\, v_{m_s}A^{i-1}A^{k_s}B_{j_s}\,
=\, -p_1^{(s)}v_{m_s}A^{i-1}A^{k_s-1}B_{j_s} - \dots -
p_{k_s}^{(s)}v_{m_s}A^{i-1}B_{j_s},
$$
так как произведение строки $v_{m_s}A^{i-1}$ на вектор из правой
части~\eqref{eq:AksBjs}, в~силу~\eqref{eq:SBjs}, очевидно, равно
$$
\sum\limits_{l=1}^{s-1}\Big(\bar
p_1^{(l,s)}v_{m_s}A^{i-1}A^{k_l-1}B_{j_l} + \dots + \bar
p_{k_l}^{(l,s)}v_{m_s}A^{i-1}B_{j_l}\Big) = 0.
$$
Окончательно получаем, что для каждого $i = 1,\dots,k_s$
выполняется равенство
$$
\alpha_1^{(s,s)} v_{m_s}A^{i-1}\! B_{j_s}\! + \dots +
\alpha_{k_s}^{(s,s)}v_{m_s}A^{i+k_s \! -2}\! B_{j_s} \!\! =\!
-p_1^{(s)}v_{m_s}A^{i+k_s-2}\! B_{j_s}\! - \dots -
p_{k_s}^{(s)}v_{m_s}A^{i-1}\! B_{j_s},
$$
откуда, группируя по одинаковым компонентам
$v_{m_s}A^{i-1}B_{j_s},\dots,v_{m_s}A^{i+k_s-2}B_{j_s}$
и~записывая все $k_s$ таких равенств, приходим к~однородной
алгебраической системе уравнений
$$
\left(\begin{array}{llcl}
v_{m_s}B_{j_s} & v_{m_s}AB_{j_s} & \dots & v_{m_s}A^{k_s-1}B_{j_s}\\[8pt]
v_{m_s}AB_{j_s} & v_{m_s}A^2B_{j_s} & \dots & v_{m_s}A^{k_s}B_{j_s}\\
\quad\quad\vdots & \quad\quad\vdots & \dots & \quad\quad\vdots\\
v_{m_s}A^{k_s-1}B_{j_s} & v_{m_s}A^{k_s}B_{j_s} & \dots &
v_{m_s}A^{2k_s-2}B_{j_s}
\end{array}\right)
\left(\begin{array}{rcl}
\alpha_1^{(s,s)}\!\!\!\!\! & + &\!\!\! p_{k_s}^{(s)}\\[8pt]
\alpha_2^{(s,s)}\!\!\!\!\! & + &\!\!\! p_{k_s-1}^{(s)}\\
& \vdots &\\
\alpha_{k_s}^{(s,s)}\!\!\!\!\! & + &\!\!\! p_1^{(s)}
\end{array}\!\right) =
\left(\begin{array}{c}
0\\[4pt]
0\\
\vdots\\
0
\end{array}\right).
$$
Матрица этой системы симметрическая, в~силу~\eqref{eq:SBjs},
с~единицей на обратной диагонали и~нулями над этой диагональю,
т.~е. ее определитель равен по модулю 1, и~так как эта система
однородная, то единственным ее решением является нулевое, т.~е.
\begin{equation}\label{eq:alphass}
\alpha_l^{(s,s)} = -p_{k_s-l+1}^{(s)}\quad\textrm{для всех}\quad
s=1,\dots,\rho,\ l=1,\dots,k_s.
\end{equation}

Оставшиеся коэффициенты $\alpha_l^{(s,s+i)}$ для всех
$i=1,\dots,\rho-s$ и~$l=1,\dots,k_{s+i}$ уже зависят от
соотношения значений $k_{s+i}$ к~величине $k_s$, и~в~общем случае
их точные формулы выписать затруднительно, да к~тому же это и~не
существенно для дальнейших выводов.

Тогда, учитывая~\eqref{eq:SS1}, \eqref{eq:vmsAks}
и~\eqref{eq:alphass},
%то, что $v_{m_s}A^iS^{-1} = e_{m_{s-1}+i+1}^T$ для всех $s=1,\dots,\rho$ и~$i=0,\dots,k_s-1$,
сама строка $v_{m_s}A^{k_s}S^{-1}$ окончательно фор\-ми\-рует\-ся
из линейной комбинации $n$-мерных строк
$e_{m_{s-1}+1}^T,\dots,e_{m_\rho}^T$ следующим образом:
\begin{multline*}
v_{m_s}A^{k_s}S^{-1} = \sum\limits_{l=1}^{k_s}
-p_{k_s-l+1}^{(s)}e_{m_{s-1}+l}^T +
\sum\limits_{l=1}^{k_{s+1}}\alpha_l^{(s,s+1)}e_{m_s+l}^T + \dots +
\sum\limits_{l=1}^{k_\rho}\alpha_l^{(s,\rho)}e_{m_{\rho-1}+l}^T =\\[8pt]
= \Big(0,\dots,0,\ -p_{k_s}^{(s)},\dots,-p_1^{(s)},\
\alpha_1^{(s,s+1)},\dots,\alpha_{k_{s+1}}^{(s,s+1)},\ \dots,\
\alpha_1^{(s,\rho)},\dots,\alpha_{k_\rho}^{(s,\rho)}\Big)
\end{multline*}
для всех $s=1,\dots,\rho$ (при $s=1$ нулей в~начале строки нет).


Таким образом, матрица $G$ системы~\eqref{eq:Brn} является
квазитреугольной, причем ее диагональные блоки полностью
соответствуют диагональным блокам квазитреугольной матрицы $F$
системы~\eqref{eq:FQv}, т.~е. $G_{k_sk_s}=F_{k_sk_s}^T$.


Далее покажем структуру матрицы $Q_S = \big[SB_1\ \dots\
SB_r\big]$, где все столбцы $SB_{j_s}$, $s=1,\dots,\rho$, состоят
из чисел, определяемых выражениями
\begin{equation}\label{eq:vmiAB}
v_{m_i}A^{l(i)}B_{j_s},\quad i=1,\dots,\rho,\quad l(i) =
0,\dots,k_i-1.
\end{equation}
В силу~\eqref{eq:SBjs}, при $i<j_s$ все такие
значения~\eqref{eq:vmiAB} равны нулю, при $i=j_s$
все~\eqref{eq:vmiAB} также равны нулю, кроме
$$
v_{m_s}A^{k_s-1}B_{j_s} = 1
$$
(который занимает позицию $m_s$-й строки), и, наконец, при
$i>j_s$, в~силу условия~\eqref{eq:k_s}, все $l(i)\le k_s-1$, т.~е.
векторы $A^{l(i)}B_{j_s}$ принадлежат базису $V$ и~опять же,
в~силу~\eqref{eq:SBjs}, все такие значения~\eqref{eq:vmiAB} также
равны нулю.

Таким образом, получаем, что все $j_s$-е столбцы  матрицы $Q_S$
при управлении $u$ имеют вид
$$
SB_{j_s} = e_{m_s}^{(j_s)},\quad s=1,\dots,\rho.
$$

Оставшиеся столбцы $Q_{j_i^*}=SB_{j_i^*}$, отвечающие столбцам
матрицы $B$, не участвовавшим в~формировании базиса $V$, никакой
роли в~управлении системы~\eqref{eq:Brn} не оказывают, так как
соответствующие им управления $u_{j_i^*}$ можно принять нулевыми.
Теорема доказана.\hfill \qed



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\indent\textbf{5.} %Метод Бруновски
Теперь отметим еще один метод синтеза линейного регулятора для системы в~канонической форме Бруновски~[4], %{Bru}
которая полностью эквивалентна исходной системе~\eqref{eq:ABu}. На основании базиса~\eqref{eq:S} переведем систему~\eqref{eq:ABu} к~канонической форме~\eqref{eq:Brn} системы управления с~многомерным управлением, которая позволяет выбрать закон линейной обратной связи для создания любых наперед заданных собственных чисел в~замкнутой системе. Укажем способ приведения этой системы к~{\it канонической форме Бруновски}~[4], %{Bru}
 что даст возможность ввести стабилизирующее управление напрямую в~систему, исключительно в~виде коэффициентов эталонных полиномов (для каждого $s$-го блока свой).
\smallskip

Теперь, когда структура матрицы $G$ системы~\eqref{eq:Brn}
известна, добавим в~эту систему закон линейной обратной связи
заменой управления $u=(u_1,\dots,u_r)^T$ на новое управление $\bar
u = (\bar u_1,\dots,\bar u_\rho)^T$ следующим образом:
\begin{equation}\label{eq:feedback}
Q_S\,u = - \widetilde G z + \widetilde E\bar u,
\end{equation}
где матрицы $\widetilde G,\widetilde E$ размерностей $n\times
n,n\times\rho$ соответственно имеют вид
$$
\widetilde G = \left(\begin{array}{c}
0\\
\vdots\\
0\\[2pt]
v_{m_1}A^{k_1}S^{-1}\\[2pt]
\hline
\vdots\\
\hline
0\\
\vdots\\
0\\[2pt]
v_{m_s}A^{k_s}S^{-1}\\[2pt]
\hline
\vdots\\
\hline
0\\
\vdots\\
0\\[2pt]
v_{m_{\rho}}A^{k_\rho}S^{-1}
\end{array}\right),\quad
\widetilde E = \big[e_{m_1}\dots e_{m_s}\dots e_{m_\rho}\big].
$$
В матрице $\widetilde G$ строки $v_{m_s}A^{k_s}S^{-1}$ стоят на
тех же позициях $m_s$-х строк, что и~в~матрице~$G$, остальные
строки в~матрице $\widetilde G$ нулевые. Векторы $e_{m_s}$
являются $m_s$-ми единичными векторами размерности $n\times1$,
здесь везде $s=1,\dots,\rho$. Матрицу $\widetilde E$ можно также
записать в~виде $\widetilde E =
\mathrm{diag}\Big\{e_{k_1}^{(k_1)},\dots,e_{k_s}^{(k_s)},\dots,e_{k_\rho}^{(k_\rho)}\Big\}$,
где верхний индекс~$(k_s)$ обозначает размерность $k_s$-го
единичного вектора $e_{k_s}^{(k_s)}$, $s=1,\dots,\rho$.

Тогда после этой замены управления с~введением линейной обратной
связи~\eqref{eq:feedback} система~\eqref{eq:Brn} разобьется на
$\rho$ независимых систем в~канонической форме Бруновски
$$
\dot Z^{(s)} = \left(\!\begin{array}{ccccc}
0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & 0 & \dots & 1\\
0 & 0 & 0 & \dots & 0
\end{array}\!\right)Z^{(s)} +
\left(\!\begin{array}{c}
0\\
\vdots\\
0\\
1
\end{array}\!\right)\bar u_s,
\quad s = 1,\dots,\rho,
$$
в которой
$$
Z^{(s)} = \left(\!\!\begin{array}{c}
z_{m_{s-1}+1}\\
\vdots \\
z_{m_s}
\end{array}\!\!\right).
$$

Для систем в~таком виде скалярные управления $\bar u_s$ задаются
напрямую как
$$
\bar u_s = \gamma_s Z^{(s)} =
\Big(-\mu_{k_s}^{(s)},\dots,-\mu_1^{(s)}\Big)Z^{(s)},
$$
через коэффициенты эталонных полиномов
\begin{equation}\label{eq:p_et}
p_\textrm{et}^{(s)}(\lambda) =
\prod\limits_{i=1}^{k_s}\Big(\lambda - \lambda_i^{(s)}\Big) =
\lambda^{k_s} + \mu_1^{(s)}\lambda^{k_s-1} + \dots +
\mu_{k_s}^{(s)},
\end{equation}
где $\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$~---  наперед
заданные собственные числа, расположенные в~открытой левой
полуплоскости, $s=1,\dots,\rho$. В~данном случае для каждого блока
уравнений $(s)$ замкнутая таким управлением система, очевидно,
будет иметь вид
$$
\dot Z^{(s)} = \left(\!\begin{array}{ccccc}
0 & 1 & 0 & \dots & 0\\
0 & 0 & 1 & \dots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & 0 & \dots & 1\\
-\mu_{k_s}^{(s)} & -\mu_{k_s-1}^{(s)} & -\mu_{k_s-2}^{(s)} & \dots
& -\mu_1^{(s)}
\end{array}\!\right)Z^{(s)}
$$
с сопровождающей матрицей системы своего характеристического
полинома $p_\textrm{et}^{(s)}(\lambda)$ и~соответствующими
заданными собственными числами
$\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$.

В многомерном случае для системы~\eqref{eq:Brn} с~учетом
замены~\eqref{eq:feedback} вектор управления $\bar u$ будет
определяться как
\begin{equation}\label{eq:Gamma_z}
\bar u = \Gamma z,
\end{equation}
где матрица $\Gamma =
\mathrm{diag}\big\{\gamma_1,\dots,\gamma_\rho\big\}$ размерности
$\rho\times n$. И тогда замыкание системы~\eqref{eq:Brn}
управлением $\bar u$ с~использованием обратной
связи~\eqref{eq:feedback} приведет к~системе
$$
\dot z = \Big(G - \widetilde G + \widetilde E\Gamma\Big)z,
$$
откуда при обратной замене переменных, от $z$ к~$x$, получаем
систему
$$
\dot x = \bigg(A - S^{-1}\Big(\widetilde G - \widetilde
E\Gamma\Big)S\bigg)x.
$$
Принимая, что исходное управление $u$ системы~\eqref{eq:ABu}
ищется в~виде~\eqref{eq:uCx} с~постоянной матрицей $C$ данного
линейного регулятора размерности $r\times n$, приходим
к~матричному уравнению
$$
BC = - S^{-1}\Big(\widetilde G - \widetilde E\Gamma\Big)S.
$$

Полученное матричное уравнение не позволяет окончательно выразить
матрицу $C$ для стабилизирующего управления~\eqref{eq:uCx}
в~системе~\eqref{eq:ABu}. Тем самым синтез стабилизирующего
управления для системы~\eqref{eq:ABu} методом приведения исходной
системы к~канонической форме Бруновски возможен только
с~использованием специальной обратной связи~\eqref{eq:feedback}.
%\medskip



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\indent\textbf{6.} % Базис прямой суммы подпространств
Оба рассмотренных выше способа построения базиса нового
пространства переменных позволяли перевести систему
управления~\eqref{eq:ABu} к~канонической форме на основе
квазитреугольной матрицы системы. Но, очевидно, что лучшей
канонической формой для системы управления~\eqref{eq:ABu} была бы
форма с~блочно-диагональной матрицей системы, позволяющая
разделить многомерную систему на независимые подсистемы меньших
размерностей и~тем самым  решать задачу управления динамикой части
фазовых переменных отдельно от других. Укажем условия и~метод
преобразования уже имеющегося классического базиса $V$ к~новому
базису $W$, при переходе к~координатам которого матрица новой
системы управления, сохраняя структуру диагональных блоков матрицы
$F$ из~\eqref{eq:FQv}, определяемых первоначальным базисом $V$,
становилась бы блочно-диагональной согласованно со структурой
новой матрицы при управлении $u$.

Далее будем строить именно такой базис $W$ линейного пространства
оператора $A$, приводящего при соответствующей замене переменных
\begin{equation}\label{eq:yWx}
x = Wy
\end{equation}
матрицу $A$ к~матрице $P$ новой системы управления
\begin{equation}\label{eq:P_W}
\dot y = W^{-1}AWy + W^{-1}Bu = Py + Q_W\,u,
\end{equation}
где матрица $P$ уже блочно-диагональная и~имеет вид
$$
P = \left(\begin{array}{ccc}
F_{k_1k_1} & & 0\\
& \ddots &\\
0 & & F_{k_\rho k_\rho}
\end{array}\right)
$$
с теми же блоками $F_{k_sk_s}$ на диагонали, что и~в~матрице $F$
из системы~\eqref{eq:FQv}, при замене переменных с~базисом $V$,
здесь $s=1,\dots,\rho$. То есть структура исходного базиса $V$
будет полностью задавать и~структуру базиса $W$.

{\bf Теорема 2.} {\it Пусть для полностью управляемой
системы~\eqref{eq:ABu} построен некоторый базис $V$,
сформированный на столбцах $B_{j_s}$ матрицы $B$,
согласно~\eqref{eq:V}, и~который, тем самым, задает разбиение
характеристического полинома $\chi_A(\lambda)$ матрицы $A$ на
множители вида
$$
\chi_A(\lambda) = \prod\limits_{s=1}^\rho\chi_s(\lambda),\quad
\chi_s(\lambda) = \lambda^{k_s} + p_1^{(s)}\lambda^{k_s-1} + \dots
+ p_{k_s}^{(s)}.
$$

Тогда, если для такого базиса $V$ выполняются условия
\begin{equation}\label{eq:A_sB_js}
\mathrm{rank}\bigg(\Big(A^{k_s} + p_1^{(s)}A^{k_s-1} + \dots +
p_{k_s}^{(s)}E\Big)\Big[B_1\,\dots\ B_{j_s}\Big]\bigg) < j_s,\quad
s=1,\dots,\rho,
\end{equation}
то этот базис $V$ линейного пространства, инвариантного
относительно оператора~$A$, может быть преобразован к~базису $W$,
представляющего собой прямую сумму линейных подпространств
$$
W = \Big[\tilde B_{j_1}\,A\tilde B_{j_1}\,\dots\ A^{k_1-1}\tilde
B_{j_1}\ \dots\ \tilde B_{j_s}\,A\tilde B_{j_s}\,\dots\
A^{k_s-1}\tilde B_{j_s}\ \dots\ \tilde B_{j_\rho}\,A\tilde
B_{j_\rho}\,\dots\ A^{k_\rho-1} \tilde B_{j_\rho}\Big],
$$
полностью соответствующий структуре исходного базиса $V$. Базис
каждого подпространства
\begin{equation}\label{eq:Ls}
\tilde B_{j_s},A\tilde B_{j_s},\dots ,A^{k_s-1}\tilde B_{j_s}
\end{equation}
задается начальным вектором $\tilde B_{j_s}$, отвечающим
соответствующему вектору $B_{j_s}$ из базиса $V$, который
представляет собой линейную комбинацию всех векторов из
матрицы~$B$ с~первого столбца по $j_s$-й столбец включительно,
т.~е.
\begin{equation}\label{eq:tildeBjs}
\tilde B_{j_s} = \Big[B_1\,\dots\ B_{j_s}\Big]b_s,
\end{equation}
где $b_s$~---  $j_s$-мерный вектор коэффициентов, удовлетворяющий
условию $($в силу вида~\eqref{eq:tildeBjs}$)$, что
\begin{equation}\label{eq:As_tildeBjs}
\Big(A^{k_s} + p_1^{(s)}A^{k_s-1} + \dots +
p_{k_s}^{(s)}E\Big)\tilde B_{j_s} = 0
\end{equation}
для всех $s=1,\dots,\rho$.
% \eject

В силу построения, базис $W$ после перехода к~новым
координатам~\eqref{eq:yWx} будет обеспечивать блочно-диагональный
вид матрицы системы~\eqref{eq:P_W}.}
\smallskip

Д о~к~а з а~т е л ь с~т в~о. Из структуры квазитреугольной матрицы
$F$ следует, что и~ее характеристическая матрица $\lambda E-F$
также будет квазитреугольной, с~блоками на диагонали $\lambda
E-F_{k_sk_s}$; здесь единичные матрицы $E$ подразумеваются
с~размерностями, согласованными с~размерностями матриц $F$,
$F_{k_sk_s}$. Тогда, в~силу фробениусовой формы матриц
$F_{k_sk_s}$ и~квазитреугольной структуры матрицы $F$, очевидно,
что характеристический полином $\chi_F(\lambda)$ матрицы $F$ будет
совпадать с~характеристическим полиномом $\chi_A(\lambda)$
матрицы~$A$ и~будет произведением определителей матриц $\lambda
E-F_{k_sk_s}$, т.~е.
$$
\chi_A(\lambda) = \chi_F(\lambda) = \big|\lambda E - F\big| =
\prod_{s=1}^{\rho}\big|\lambda E - F_{k_sk_s}\big| =
\prod_{s=1}^{\rho}\chi_s(\lambda),
$$
где полиномы
$$
\chi_s(\lambda) = \lambda^{k_s} + p_1^{(s)}\lambda^{k_s-1} + \dots
+ p_{k_s }^{(s)} = \big(\lambda -
\lambda_1^{(s)}\big)\!\times%\cdot
\dots\times\!%\cdot
\big(\lambda -\lambda_{k_s}^{(s)}\big).
$$
Здесь коэффициенты $p_1^{(s)},\dots,p_{k_s}^{(s)}$ задаются
последним столбцом матрицы $F_{k_sk_s}$, а~значения
$\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$ есть корни полиномов
$\chi_s(\lambda)$, которые являются также корнями
характеристического полинома $\chi_A(\lambda)$, т.~е. собственными
числами матрицы~$A$.

Введем теперь матрицы $A_s$ размерности $n\times n$ следующего
вида:
$$
A_s = \chi_s(A) = A^{k_s} + p_1^{(s)}A^{k_s-1} + \dots +
p_{k_s}^{(s)}E = \big(A - \lambda_1^{(s)}E\big)\times%\cdot
\dots \times%\cdot
\big(A - \lambda_{k_s}^{(s)}E\big),~~~ s=1,\dots,\rho.
$$
Ранг этих матриц, определяющих алгебраическую однородную
систему~\eqref{eq:As_tildeBjs},
$$
\mathrm{rank}\big(A_s\big) < n,
$$
так как их определитель
$$
\big|A_s\big| = \big|A -
\lambda_1^{(s)}E\big|\times%\cdot
\dots \times%\cdot
\big|A -
\lambda_{k_s}^{(s)}E\big| = 0\times%\cdot
\dots \times%\cdot
0 = 0,
$$
т.~е. все эти матрицы $A_s$ для систем~\eqref{eq:As_tildeBjs}
вырожденные.

Теперь, учитывая условие~\eqref{eq:A_sB_js}, соответствующая этой
матрице однородная алгебраическая система уравнений относительно
$j_s$-мерного вектора $b_s$:
$$
A_s\Big[B_1\,\dots\ B_{j_s}\Big]b_s = \Big(A^{k_s} +
p_1^{(s)}A^{k_s-1} +\dots + p_{k_s}^{(s)}E\Big)\Big[B_1\,\dots\
B_{j_s}\Big]b_s = 0
$$
будет иметь бесконечное количество ненулевых решений для всех
$s=1,\dots,\rho$.

Из этих решений $b_s$ будем выбирать любое максимально простого
вида, которое будет задавать и~сам первый
вектор~\eqref{eq:tildeBjs}, и~всю соответствующую ему базисную
цепочку~\eqref{eq:Ls}, причем, в~силу~\eqref{eq:As_tildeBjs},
очевидно, что любой вектор вида $A^{k_s+i}\tilde B_{j_s}$,
$i=0,1,\dots$, уже будет линейно зависимым только с~векторами из
своей соот\-вет\-ст\-вую\-щей цепочки базиса~$W$.

По построению, векторы $\tilde B_{j_s}$, $s=1,\dots,\rho$, будут
линейно независимы между собой, так как каждый следующий вектор
$\tilde B_{j_s} =\Big[B_1\,\dots\ B_{j_s}\Big]b_s$ содержит
в~своей комбинации новый вектор $B_{j_s}$, который линейно
независим со всеми предыдущими $B_{j_i}$ (и вообще со всеми
векторами из $B$), входящими в~разложения $\tilde B_{j_i}$,
$i=1,\dots,s-1$. Соответственно будут линейно независимы все
векторы в~соответствующих цепочках базиса $W$. Теорема~2
доказана.\hfill \qed


Так как, вообще говоря, векторы $B_{j_s}$ матрицы $B$ уже не
входят в~новый базис $W$, то матрица $Q_W = W^{-1}B$
системы~\eqref{eq:P_W} теряет свою правильную единичную структуру,
согласованную с~матрицей $P$, необходимую для определения
линейного регулятора вида~\eqref{eq:uCx}. Однако, учитывая
выполнение условия~\eqref{eq:A_sB_js} теоремы~2, это не является
неразрешимой проблемой, так как в~таком случае достаточно
произвести промежуточную замену с~матрицей $D$ размерности
$r\times\rho$, управления $u$ вида
\begin{equation}\label{eq:D}
u = D\bar u,
\end{equation}
восстанавливающую согласованную с~матрицей $P$ структуру матрицы
при новом управлении $\bar u$ размерности $\rho\times1$, т.~е.
чтобы было верно равенство
$$
Q_WD = W^{-1}BD = \doublewidetilde E = \big[e_1\dots
e_{m_{s-1}+1}\dots e_{m_{\rho-1}+1}\big],
$$
где $e_{m_{s-1}+1}$~---  это $m_{s-1}+1$ единичные $n$-мерные векторы матрицы $\doublewidetilde E$ размерности $n\times\rho$, $s=1,\dots,\rho$. Матрицу $\doublewidetilde E$  (аналогично записи матрицы $\widetilde E$) можно также записать в~виде $\doublewidetilde E = \mathrm{diag}\Big\{e_1^{(k_1)},\dots,e_1^{(k_\rho)}\Big\}$, где, по прежнему, верхний индекс~$(k_s)$ обозначает размерность $1$-го единичного вектора $e_1^{(k_s)}$.%, $s=1,\dots,\rho$.


{\bf Теорема 3.} {\it В~случае выполнения
условия~\eqref{eq:A_sB_js} теоремы~$2$ матрица $D$ для
замены~\eqref{eq:D} определяется однозначным образом.}


Д о~к~а з а~т е л ь с~т в~о. Действительно, дополним все векторы
$b_s$, $s=1,\dots,\rho$, снизу нулями до размерности $r\times1$
и~составим из таких векторов матрицу $D = \big[D_1\dots
D_\rho\big]$. Тогда, в~силу построения векторов $\tilde B_{j_s}$
вида~\eqref{eq:tildeBjs}, очевидно, что\pagebreak
$$
W^{-1}BD_s = W^{-1}\Big[B_1\,\dots\ B_{j_s}\Big]b_s = W^{-1}\tilde
B_{j_s} = e_{m_{s-1}+1}
$$
для всех $s=1,\dots,\rho$. Теорема доказана.\hfill \qed


Таким образом, теоремы~2 и~3 позволяют преобразовать исходную
систему~\eqref{eq:ABu} к~системе вида
\begin{equation}\label{eq:P_E}
\dot y = W^{-1}AW + W^{-1}BD\bar u = Py + \doublewidetilde E\bar
u,
\end{equation}
которая, в~силу блочно-диагонального вида матрицы $P$ и~согласованного с~ней вида матрицы $\doublewidetilde E$ (единицы в~столбцах стоят на строчках, являющихся первыми строками в~блоках $F_{k_sk_s}$ матрицы $P$), разбивается на $\rho$ независимых подсистем со скалярными управлениями вида~\eqref{eq:Ys_e1} (здесь просто $u_{j_s} = \bar u_s$) для всех $s=1,\dots,\rho$. Эти подсистемы представляют собой {\it каноническую форму} для метода В.\:И.~Зубова в~случае скалярного управления и~их задачи стабилизации решаются, как обычно, из~[1]. % {Zub1}
%\smallskip

Однако рассмотрим еще одну дополнительную замену переменных, на основе идеи~[2], % {Smir}
когда для каждого блока $(s)$ на основе матриц $F_{k_sk_s}$
строятся матрицы $T_s$ вида
$$
T_s = \left(\begin{array}{ccccc}
p_{k_s-1}^{(s)} & p_{k_s-2}^{(s)} & \dots & p_1^{(s)} & 1\\[8pt]
p_{k_s-2}^{(s)} & p_{k_s-3}^{(s)} & \dots & 1 & 0\\[4pt]
% p_{n-3} & p_{n-4} & \dots & 0 & 0\\
\vdots & \vdots &  \iddots & \vdots & \vdots\\[4pt]
p_1^{(s)} & 1 & \dots & 0 & 0\\[8pt]
1 & 0 & \dots & 0 & 0
\end{array}
\right).
$$
В силу симметричности матриц $T_s$, будут симметричными и~матрицы
$F_{k_sk_s}T_s$, так как
\begin{gather*}
F_{k_sk_s}T_s = \left( \left(\begin{array}{ccccl}
0 & 0 & \dots & 0 & 0\\[7pt]
1 & 0 & \dots & 0 & 0\\[7pt]
0 & 1 & \dots & 0 & 0\\[1.5pt]
\vdots & \vdots & \ddots & \vdots & \vdots \\[1.5pt]
0 & 0 & \dots & 1 & 0
\end{array}\right) +
\left(\begin{array}{ccccl}
0 & 0 & \dots & 0 & -p_{k_s}^{(s)} \\[4pt]
0 & 0 & \dots & 0 & -p_{k_s-1}^{(s)}\\[4pt]
0 & 0 & \dots & 0 & -p_{k_s-2}^{(s)}\\%[2pt]
\vdots & \vdots & \ddots & \vdots & \quad\vdots \\%[4pt]
0 & 0 & \dots & 0 & -p_1^{(s)}
\end{array}\right)
\right)T_s = \\[6pt]
= \left(\begin{array}{cccccc}%{c|ccccc}
-p_{k_s}^{(s)} & 0 & 0 & \dots & 0 & 0\\[6pt]
%\hline
0 & p_{k_s-2}^{(s)} & p_{k_s-3}^{(s)} & \dots & p_1^{(s)} & 1\\[6pt]
0 & p_{k_s-3}^{(s)} & p_{k_s-4}^{(s)} & \dots & 1 & 0\\
\vdots & \vdots & \vdots & \!\iddots %\vspace{-16pt}\hspace{-7pt}\rotatebox{70}{$\ddots$} %\ddots
& \vdots & \vdots\\
0 & p_1^{(s)} & 1 & \dots & 0 & 0\\[6pt]
0 & 1 & 0 & \dots & 0 & 0
\end{array}
\right),
\end{gather*}
откуда получаем выражение
$$
F_{k_sk_s}T_s = \big(F_{k_sk_s}T_s\big)^T = T_s^TF_{k_sk_s}^T =
T_sF_{k_sk_s}^T,
$$
где вид матриц $F_{k_sk_s}^T = G_{k_sk_s}$ такой же, как
и~в~теореме~1 (т.~е. фробениусовая форма с~нижней строчкой).

Теперь, сформировав общую матрицу
$$
T = \left(\begin{array}{ccc}
T_1 & & 0\\
& \ddots &\\
0 & & T_\rho
\end{array}\right)
$$
и произведя замену переменных
$$
y = Tz,
$$
учитывая, что $PT = TP^T$, переходим от системы~\eqref{eq:P_E}
к~системе вида
\begin{equation}\label{eq:P^T}
\dot z = T^{-1}PTz + T^{-1}\doublewidetilde E\bar u = P^Tz +
\widetilde E\bar u = \left(\begin{array}{ccc}
G_{k_1k_1} & & 0\\
& \ddots &\\
0 & & G_{k_\rho k_\rho}
\end{array}\right)z + \widetilde E\bar u,
\end{equation}
в которой, как и~ранее, матрица $\widetilde E = \big[e_{m_1}\dots e_{m_\rho}\big] = \mathrm{diag}\big\{e_{k_1}^{(k_1)},\dots,e_{k_\rho}^{(k_\rho)}\big\}$ размерности~$n\times\rho$. Вид матрицы $\widetilde E$ следует из того, что и~$T^{-1} = \mathrm{diag}\big\{T_1^{-1},\dots,T_\rho^{-1}\big\}$ яв\-ляет\-ся блочно-диагональной (как обратная к~блочно-диагональной), и~сама матрица $\doublewidetilde E = \mathrm{diag}\big\{e_1^{(k_1)},\dots,e_1^{(k_\rho)}\big\}$ тоже блочно-диагональная. %, т.~е. $\doublewidetilde E = \mathrm{diag}\big\{e_1^{(k_1)},\dots,e_1^{(k_\rho)}\big\}$, где верхний индекс $(k_s)$~---  обозначает размерность единичного вектора, $s=1,\dots,\rho$.
Рассмотрев перемножение двух любых согласованных блоков
$$
T_se_{k_s}^{(k_s)} = e_1^{(k_s)}
$$
и заметив верность этого равенства (так как $e_1^{(k_s)}$ ---
последний столбец матрицы~$T_s$), получаем равенство
$$
e_{k_s}^{(k_s)} = T_s^{-1}T_se_{k_s}^{(k_s)} =
T_s^{-1}e_1^{(k_s)},\quad s=1,\dots,\rho,
$$
что и~подтверждает вид матрицы $\widetilde E$.

Далее, задавая $\rho$ эталонных полиномов
$p_\textrm{et}^{(s)}(\lambda)$ вида~\eqref{eq:p_et}
с~соответствующими, наперед заданными, собственными числами
$\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$ из левой
полуплоскости, строим управление $\bar u$ вида~\eqref{eq:Gamma_z},
где матрица $\Gamma =
\mathrm{diag}\big\{\gamma_1,\dots,\gamma_\rho\big\}$ размерности
$\rho\times n$ за\-дает\-ся коэффициентами эталонных полиномов
$p_\textrm{et}^{(s)}(\lambda)$ и~коэффициентами
блоков~$G_{k_sk_s}$ сле\-дую\-щим образом:
$$
\gamma_s =
\Big(p_{k_s}^{(s)}-\mu_{k_s}^{(s)},\dots,p_1^{(s)}-\mu_1^{(s)}\Big),\quad
s = 1,\dots,\rho.
$$

И тогда замыкание системы~\eqref{eq:P^T} управлением $\bar u =
\Gamma z$ приведет к~системе
$$
\dot z = \Big(P^T + \widetilde E%_T
\Gamma\Big)z
$$
c диагональными блоками своих сопровождающих (характеристических)
полиномов $p_\textrm{et}^{(s)}(\lambda)$ с~собственными числами
$\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$.

Возвращаясь, двойной обратной заменой $z = T^{-1}W^{-1}x$
к~первоначальным переменным $x$, получаем систему вида
$$
\dot x = \Big(A + BD\Gamma T^{-1}W^{-1}\Big)x
$$
и находим матрицу $C$ линейного регулятора~\eqref{eq:uCx}
$$
C = D\Gamma T^{-1}W^{-1},
$$
которая стабилизирует исходную систему~\eqref{eq:ABu} и~доставляет
ей любые, наперед заданные, собственные числа
$\lambda_1^{(s)},\dots,\lambda_{k_s}^{(s)}$ из левой
полуплоскости, $s=1,\dots,\rho$.


{\bf Замечание 2.} Действуя подобным образом, получаем аналогичный
матричный групповой стабилизатор, который с~успехом применяется
для декомпозиции многомерных систем управления~[8].


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\indent\textbf{7.} В~заключение подведем итоги. % Таким образом
Установлено, что метод В.\:И.~Зубова в~том виде, в~котором он
представлен в~этой работе, является более универсальным, основным
методом построения линейного регулятора. Потому, если бы нас
спросили, какое последнее достижение науки в~области тематики
статьи, то отметили бы работу~[1] члена-корреспондента АН СССР
Владимира Ивановича Зубова, которому в этом году исполнилось бы 90
лет. Заметим, что, как отмечено выше, рассматриваемая задача
перетекает в~задачу о~размещении собственных чисел матрицы
замкнутой системы. Задача размещения также была сформулирована
В.\:И.~Зубовым, но здесь мы этих вопросов глубоко не касаемся.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{09/lit-ra}

%\newpage
\input{09/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~16.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~16.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %
%
}
