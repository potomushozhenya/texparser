


\noindent{\small УДК 519.85 + 51-74  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}\\
MSC 90C25

}

\vskip1.8mm

\noindent{\bf Равновесное распределение потоков по маршрутам\\
линейной транспортной сети как решение системы\\ линейных
алгебраических уравнений$^{*}$ }

\vskip2.0mm

\noindent{\it А.~Ю.~Крылатов$^{1,2}$, А.~П.~Широколобова$^1$}


\efootnote{
%
\vspace{-3mm}\parindent=7mm
%
\vskip 0.1mm $^{*}$ Работа А. Ю. Крылатова выполнена при
финансовой поддержке Российского научного фонда (проект №
17-71-10069). (A.~Yu.~Krylatov was jointly supported by a grant
from the Russian Science Foundation (Project N 17-71-10069))\par
%
%\vskip 2.0mm
%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp07 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum03 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp07 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum03}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\vskip1.5mm

{\footnotesize



\noindent $^1$~Санкт-Петербургский государственный университет,
Российская Федерация,

\noindent\hskip2.45mm 199034, Санкт-Петербург,
Университетская~наб., 7--9


\noindent $^2$~Институт проблем транспорта им. Н.~С.~Соломенко
РАН, Российская Федерация,

\noindent\hskip2.45mm 199178, Санкт-Петербург, 12-я линия В. О.,
13


}

\vskip2.5mm





{\small \noindent \textbf{Для цитирования:} \textit{Крылатов
А.~Ю., Широколобова А.~П.} Равновесное распределение потоков по
маршрутам линейной транспортной сети как решение системы линейных
алгебраических уравнений~// Вестник Санкт-Петербургского
университета. Прикладная математика. Информатика. Процессы
управления. \issueyear. Т.~14. Вып.~\issuenum.
С.~\pageref{p3}--\pageref{p3e}.
\doivyp/spbu10.\issueyear.\issuenum03

\vskip3mm

{\leftskip=7mm\noindentНастоящая работа ориентирована на развитие
методологических инструментов, позволяющих поддерживать процессы
принятия решений в~области управления улично-дорожной сетью
крупных городов. При этом реализация управленческих воздействий
подразумевает наличие возможностей оказывать влияние на объект
управления. В~сфере управления транспортными потоками необходимо
иметь возможность оказывать воздействие на транспортные потоки.
Однако в~первую очередь необходимо иметь исчерпывающую информацию
о транспортных потоках. С~практической точки зрения наиболее
ценной является информация о~потоках на маршрутах, нежели
о~потоках на дугах транспортной сети. Изучена модель распределения
потоков по маршрутам линейной транспортной сети. Линейность сети
(линейные функции задержек на дугах) позволит сводить решение
задачи распределения потоков к~системе линейных уравнений
и~условий в~виде выполнения ряда линейных неравенств.
Формализована транспортная сеть в~виде ориентированного графа
произвольной топологии. Задача распределения транспортных потоков
по маршрутам поставлена в~виде задачи условной нелинейной
оптимизации. Доказана теорема сводимости задачи распределения
потоков по маршрутам линейной транспортной сети к~системе линейных
алгебраических уравнений (СЛАУ) и~неравенств. Детально разобран
пример применения конструктивного доказательства теоремы сведения
задачи распределения потоков по маршрутам транспортной сети
к~СЛАУ.\\[1mm]
\textit{Ключевые слова}: условная нелинейная оптимизация,
конкурентное равновесие Вардропа, распределение потоков по
маршрутам транспортной сети.

}

}





\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\indent {\bf 1. Введение.} Принципы Вардропа распределения
транспортных потоков были сформулированы в~1952 г. и~заключались
в~том, что любая транспортная система по прошествии некоторого
времени приходит в~равновесное состояние [1]. Согласно первому
принципу, <<время передвижения по всем используемым маршрутам
одинаково для всех участников движения и~меньше времени, которое
потратит любой участник движения, изменив свой маршрут>> [1, c.
345], а~по второму, <<среднее время передвижения является
минимальным>> [1, c. 345]. При этом распределение потоков
в~соответствии с~первым принципом Вардропа называется
\textit{конкурентным равновесием}, а~распределение потоков по
второму~--- \textit{системным оптимумом}. Впервые математическую
формулировку этих принципов предложил Бекманн [2]. Впоследствии
данная математическая модель стала классической [3] и~является
одним из ключевых методологических инструментов в~теории
транспортных потоков [4, 5].

Отметим, что идея Вардропа равновесного распределения потоков
относится к~области так называемых поведенческих моделей
(behavioral models), современный исчерпывающий обзор которых можно
найти в~[6]. Однако распределение потоков по дугам транспортной
сети может быть оценено не только на основе моделирования
поведения участников движения при выборе ими маршрута следования.
Впервые набор эвристических правил, позволяющих получать оценки
нагрузки транспортных потоков на дуги улично-дорожной сети, был
предложен Г.~В.~Шелейховским в~1936~г. [7]. Математическое
доказательство сходимости метода Шелейховского для задачи
с~транспортными ограничениями было дано в~1967~г. [8]. В~1970~г.
Вильсон выделил энтропийный подход для моделирования распределения
транспортных потоков [9]. Содержательно, математически
формализованный метод Шелейховского можно отнести именно
к~энтропийному подходу. Воплощение развиваемых в~данном
направлении идей применительно к~улично-дорожной сети
Санкт-Петербурга можно найти в~[10, 11].

Сейчас во многих исследованиях  большое внимание обращается на
распределение транспортных потоков. Связан такой интерес прежде
всего с~тем, что развитие моделей и~методов решения задачи
распределения потоков в~сети, с~одной стороны, дает богатые
прикладные результаты, с~другой --- позволяет получать новые
подходы и~алгоритмы решения различного рода оптимизационных задач.
Таким образом, развитие данного направления вносит вклад как
в~теорию (условная нелинейная оптимизация, математическое
программирование, исследование операций и~т.~д.), так и~в~практику
(поддержка принятия решений на транспорте, городские транспортные
навигационные системы, системы транспортного планирования
и~т.~п.). Среди зарубежных авторов, вносящих вклад в~развитие
моделей и~методов равновесного распределения потоков, в~первую
очередь следует выделить Патрикссона [12], среди отечественных
---  И.~В.~Коннова [13, 14] и~В.~В.~Мазалова [15, 16]. Среди
последних наших статей укажем [17, 18], теоретико-игровые
постановки можно найти в~[19, 20].

Настоящая работа ориентирована на развитие методологических
инструментов, позволяющих поддерживать процессы принятия решений
в~области управления улично-дорожной сетью крупных городов. При
этом реализация управленческих воздействий подразумевает наличие
возможностей оказывать влияние на объект управления. В~сфере
управления транспортными потоками необходимо иметь возможность
воздействовать на транспортные потоки. Однако прежде всего следует
иметь исчерпывающую информацию о~транспортных потоках.
С~практической точки зрения наиболее ценной является информация
о~потоках на маршрутах, нежели о~потоках на дугах транспортной
сети. В статье будет изучена модель распределения потоков по
маршрутам линейной транспортной сети согласно первому принципу
Вардропа. Линейность сети (линейные функции задержек на дугах)
позволит сводить решение задачи распределения потоков к~системе
линейных алгебраических уравнений (СЛАУ) и~выполнению ряда
линейных неравенств.

Статья построена следующим образом. Общей постановке
математической задачи распределения потоков по дугам транспортной
сети посвящен п. 2. В~п. 3 исследована линейная сеть из
параллельных неоднородных маршрутов, доказана конструктивная
теорема сведения задачи распределения потоков по дугам
транспортной сети к~СЛАУ относительно переменных значений потоков
по маршрутам транспортной сети. В~п. 4 детально разобран пример
использования методики, взятой из доказательства теоремы (п. 3),
к~конкретной транспортной сети. В~п. 5 даны основные выводы по
работе.

\indent {\bf 2. Распределение потоков по дугам транспортной сети.}
Традиционно в~качестве искомых переменных в~задаче распределения
транспортных потоков применяются значения потоков на дугах
транспортной сети ({\it link-route formulation}) [21]. Рассмотрим
формализацию такой задачи на примере транспортной сети,
представленной ориентированным связным графом $G=(V,E)$. Введем
такие обозначения: $V$ --- множество последовательно
пронумерованных узлов графа $G$; $E$ --- множество последовательно
пронумерованных дуг графа $G$; $W$ --- множество пар узлов графа
$G$ (районов отправления---прибытия), $w \in W$; $R^{w}$ ---
множество маршрутов между парой $w \in W$; $x_e$ --- транспортный
поток по дуге $e \in E$, $x = (\ldots, x_e, \ldots)$; $f_r^{w}$
--- транспортный поток по маршруту $r \in R^{w}$, $f^w = \{ f_r^w
\}_{r \in R^w}$ и~$f = \{ f^w \}_{w \in W}$; $F^{w}$ ---
совокупный транспортный спрос между парой $w \in W$; $t_e (x_e)$
--- время передвижения (задержка) по дуге $e \in E$ потока $x_e$;
$\delta_{e,r}^{w}$ --- индикатор, равный $$\delta_{e,r}^{w} =
\left\{\begin{array}{ll}
1, \quad \mbox{если дуга } e \in E \mbox{ <<входит>> в~маршрут } r \in R^{w} , \\
0, \quad \mbox{в противном случае}. \end{array}\right.$$


Задача поиска конкурентного равновесия Вардропа в~сети,
представленной как граф $G$,  может быть сформулирована в~виде
следующей задачи условной нелинейной оптимизации [21]:


\begin{equation} \label{f1}
f^* = \arg \min_f \sum_{e \in E} \int\limits_0^{x_e} t_e (u) du
\end{equation}
при
\begin{equation} \label{f2}
\sum_{r \in R^{w}} f_r^{w} = F^{w} ~\quad \forall w \in W,
\end{equation}

\begin{equation} \label{f3}
f_r^{w} \geq 0 ~\quad \forall r \in R^{w}, \enspace w \in W,
\end{equation}

\noindent где
\begin{equation} \label{f4}
x_e = \sum_{w \in W} \sum_{r \in R^{w}} f_r^{w} \delta_{e,r}^{w}
~\quad \forall e \in E.
\end{equation}
Другими словами, доказано, что решение задачи
(\ref{f1})--(\ref{f4}) приводит к~такому распределению потоков,
что время движения по всем используемым маршрутам одинаково
и~меньше времени движения по неиспользуемым маршрутам между каждой
парой $w \in W$ [21].

При этом, как следует из вида задачи (\ref{f1})--(\ref{f4}),
в~традиционной постановке задачи распределения потоков в~качестве
искомых переменных берутся значения потоков на дугах транспортной
сети. В~общем случае невозможно восстановить значения потоков по
маршрутам по имеющимся величинам потоков по дугам транспортной
сети. Тем не менее значения потоков по маршрутам транспортной сети
являются важным управленчески значимым параметром. В~п.~3 будет
изложен подход нахождения распределения потоков по маршрутам
линейной транспортной сети посредством решения СЛАУ для случая
линейной транспортной сети.

\indent {\bf 3. Распределение потоков по маршрутам транспортной
сети.} Вначале рассмотрим транспортную сеть из параллельных
маршрутов с~одной парой исток---сток. Будем считать, что каждый из
параллельных (альтернативных) маршрутов состоит из дуг с~разными
характеристиками. В~таком случае данную сеть будем называть сетью
из параллельных {\it неоднородных} маршрутов. Введем следующие
обозначения: $R$~--- множество параллельных (непересекающихся)
маршрутов между парой исток---сток; $l_r$~--- количество
последовательно соединенных дуг маршрута $r \in R$; $F$~---
транспортный спрос между парой исток---сток; $f_i$~---
распределяемый транспортный поток по маршруту $r$, $f=(\ldots,
f_r, \ldots)$, $\sum_{r \in R} f_r = F$; $h_{rj}$~--- стационарный
(не зависящий от потока по маршруту) транспортный поток на дуге
$j$ маршрута $r$, $h_{rj} \geq 0$, $r \in R$; $t_{rj} (f_r,
h_{rj}) = a_{rj} + b_{rj} \left( f_r + h_{rj} \right)$~--- время
движения по загруженной дуге $j$ маршрута $r$, $a_{rj} \geq 0$
(время свободного движения по дуге), $b_{rj} > 0$ (величина,
обратная пропускной способности дуги), $j=\overline{1, l_r}$,\, $r
\in R$. Сформулируем задачи поиска конкурентного равновесия
и~системного оптимума Вардропа на сети из параллельных каналов
в~виде оптимизационных программ:
\begin{gather} \label{f3.4.1}
\min_{f} \sum_{r \in R} \sum_{j = 1}^{l_r} \int\limits_0^{f_r}
t_{rj}(u, h_{rj}) du
\end{gather}
при ограничениях
\begin{gather} \label{f3.4.2}
\sum_{r \in R} f_r = F,
\end{gather}
\begin{gather} \label{f3.4.3}
f_r \geq 0 ~\quad \forall r \in R.
\end{gather}

Заметим, что в~записи функционала (\ref{f3.4.1}) в~качестве
аргумента функции $t_{rj} (.)$ фигурирует $(f_r, h_{rj})$ для всех
$j=\overline{1, l_r}$,\, $r \in R$, несмотря на то, что
управляемыми параметрами в~сформулированных задачах являются
распределяемые потоки $f$, а~стационарные потоки $h_{rj}$ для всех
$j=\overline{1, l_r}$,\, $r \in R$, входят в~функционал как
заданные параметры.
Такая формализация произведена намеренно ввиду важности той смысловой нагрузки, которую величины $h_{rj}$,~ $j=\overline{1,l_r}$,\, $r \in R$, будут нести в~дальнейших построениях. %Можно говорить, что в~качестве решения задачи распределения потоков при $h = 0$ получаются \textit{невозмущенные} потоки. Если же $h \neq 0$ (то есть на дугах сети имеются и~другие потоки), то в~качестве решения задачи распределения потоков получаются \textit{возмущенные} потоки.

Введем дополнительные обозначения:
\begin{equation} \label{f3.4.4}
a_r = \sum_{j=1}^{l_r} a_{rj}, \quad b_r = \sum_{j=1}^{l_r}
b_{rj}, \quad h_r = \sum_{j=1}^{l_r} b_{rj} h_{rj},
\end{equation}
где величина $a_r$ может быть интерпретирована как время
свободного движения по всему маршруту $r$, состоящему из $l_r$
дуг; $b_r$~--- как характеристика пропускной способности всего
маршрута; $h_r$~--- как характеристика нагрузки  стационарных
потоков на весь маршрут.

\textbf{Лемма.} \textit{Без умаления общности будем считать, что
маршруты перенумерованы таким образом, что
\begin{gather} \label{f3.4.5}
a_1 + h_1 \leq \ldots \leq a_{|R|} + h_{|R|}.
\end{gather}
Тогда конкурентное равновесие в~линейной сети из параллельных
неоднородных маршрутов единственно $($с точностью до
обозначений$)$ и~достигается следующим распределением транспортных
потоков$:$\newpage
\begin{equation} \label{f3.4.6}
f_r^* = \frac{F + \sum_{s=1}^{r^*} \frac{a_s + h_s}{b_s}}{b_r
\sum_{s=1}^{r^*} \frac{1}{b_s}} - \frac{a_r + h_r}{b_r}, ~\quad r
\leq r^*,
\end{equation}
\begin{equation} \nonumber
f_r^* = 0, \quad r^* < r \leq |R|,
\end{equation}
где $r^*$ определяется из условий
\begin{gather} \nonumber
\sum_{r=1}^{r^*} \frac{a_{r^*} + h_{r^*} - a_r - h_r}{b_r} \leq F
< \sum_{r=1}^{r^*} \frac{a_{r^*+1} + h_{r^*+1} - a_r - h_r}{b_r} .
\end{gather}
}

Д~о~к~а~з~а~т~е~л~ь~с~т~в~о. В~случае линейных функций задержек
целевая функция (\ref{f3.4.1}) является выпуклой, в~то время как
множество ограничений (\ref{f3.4.2}), (\ref{f3.4.3}) линейное.
Таким образом, для задачи (\ref{f3.4.1})--(\ref{f3.4.3}) условия
Куна---Таккера относятся к~ необходимым и~достаточным. Построим
для задачи (\ref{f3.4.1}) с~ограничениями (\ref{f3.4.2}),
(\ref{f3.4.3}) лагранжиан
$$L = \sum_{r \in R} \int\limits_0^{f_r} (a_r + b_r u + h_r) du + \mathfrak{t}^* \left(F - \sum_{r \in R} f_r \right)+ \sum_{r \in R} \eta_r (-f_r)$$
и продифференцируем его:
\begin{gather} \label{f3.4.9}
\frac{\partial{L}}{\partial{f_r}} = (a_r + b_r f_r + h_r) -
\mathfrak{t}^* - \eta_r ~\quad \forall r \in R.
\end{gather}
Согласно условию дополнительной нежесткости, $\eta_r {f_r}^*=0$
для всех $r \in R$. Таким образом, в~силу (\ref{f3.4.9}), получаем
\begin{gather} \nonumber
a_r + b_r f_r + h_r \left\{
\begin{array}{ll}
= \mathfrak{t}^* & \textrm{при } {f_r}^* > 0 \textrm{,}\\
\geq \mathfrak{t}^* & \textrm{при } {f_r}^* = 0 \textrm{,}
\end{array} \right.
\quad \forall r \in R,
\end{gather}
откуда имеем
\begin{gather} \nonumber
{f_r}^* = \left\{
\begin{array}{ll}
\frac{\mathfrak{t}^* - a_r - h_r}{b_r} & \textrm{при } a_r + h_r < \mathfrak{t}^* \textrm{,}\\
0 & \textrm{при } a_r + h_r \geq \mathfrak{t}^* \textrm{,}
\end{array} \right.
\quad \forall r \in R.
\end{gather}
Если при выполнении (\ref{f3.4.5}) выбрать $r^*$ таким образом,
что
\begin{equation} \label{f3.4.10}
a_{r^*} + h_{r^*} \leq \mathfrak{t}^* < a_{r^*+1} + h_{r^*+1},
\end{equation}
то
$$\sum_{r=1}^{r^*} f_r = \sum_{r=1}^{r^*} \frac{\mathfrak{t}^* - a_r - h_r}{b_r} = F,$$
откуда
$$\mathfrak{t}^* = \frac{F + \sum_{s=1}^{r^*} \frac{a_s + h_s}{b_s}}{\sum_{s=1}^{r^*} \frac{1}{b_s}}.$$
В свою очередь, для определения $r$ воспользуемся условием
(\ref{f3.4.10}) и~придем к~требуемому.

В силу того, что условия Куна---Таккера необходимые и~достаточные
для задачи (\ref{f3.4.1})--(\ref{f3.4.4}), найденное решение
является единственным (с точностью до обозначений). Лемма
доказана.

Отметим, что примененные при доказательстве леммы методологические
приемы также использовались при исследовании сети из параллельных
однородных маршрутов в~работе [22]. Но при этом предполагалось,
что маршруты неоднородны, т.~е. состоят из дуг с~разными
характеристиками, а~также учитывалась возможность наличия на всех
дугах сети стационарных потоков. Под стационарным потоком
понимается поток на дуге, который создает на ней стационарную
нагрузку. Другими словами, считается, что каждой дуге присущи не
только такие характеристики как пропускная способность и~время
свободного движения, но и~стационарный поток. Таким образом,
полученный, благодаря лемме, результат позволяет найти равновесное
распределение потоков на сети из параллельных каналов в~случае,
когда на дугах сети уже имеется нагрузка в~виде стационарных
потоков.

Обобщим результаты на случай сети произвольной топологии.
Справедлива сле\-дую\-щая теорема.

\textbf{Теорема.} \textit{Оптимизационная задача
$(\ref{f1})$--$(\ref{f3})$ с~линейными функциями задержки $t_{e}
(x_e) = a_{e} + b_e x_e$, $a_e \geq 0$, $b_e > 0$, для всех $e \in
E$ эквивалентна системе линейных уравнений и~неравенств
относительно переменных потоков по маршрутам $f$. }

Д~о~к~а~з~а~т~е~л~ь~с~т~в~о. В~случае линейных функций задержек
целевая функция (\ref{f1}) выпуклая, в~то время как множество
ограничений (\ref{f2}), (\ref{f3}) является линейным. Таким
образом, для задачи (\ref{f1})--(\ref{f3}) условия Куна---Таккера
необходимы и~достаточны. Построим для задачи (\ref{f1})
с~ограничениями (\ref{f2}), (\ref{f3}) лагранжиан
$$L = \sum_{e \in E} \int\limits_0^{\sum_{w \in W} \sum_{r \in R^{w}} f_r^{w} \delta_{e,r}^{w}} t_e (u) du + \sum_{w \in W} \mathfrak{t}^w \left(F^w - \sum_{r \in R^w} f_r^w \right)+ \sum_{w \in W} \sum_{r \in R^w} \eta_r^w (-f_r^w)$$
и продифференцируем его, имея в~виду, что
%\begin{gather} \nonumber
%\frac{\partial }{ \partial f_r^w} \int_0^{x_e} t_e (u) du = \frac{\partial }{ \partial x_e} %\int_0^{x_e} t_e (u) du \enspace \frac{\partial x_e}{ \partial f_r^w} = t_e (x_e) \delta_{e,r}^w %\quad \forall e \in E, r \in R^w, w \in W,
%\end{gather}
\begin{gather} \nonumber
\frac{\partial }{ \partial f_r^w} \int\limits_0^{\sum_{\nu \in W} \sum_{p \in R^{\nu}} f_p^{\nu} \delta_{e,p}^{\nu}} t_e (u) du = t_e \left(\sum_{\nu \in W} \sum_{p \in R^{\nu}} f_p^{\nu} \delta_{e,p}^{\nu} \right) \frac{\partial }{ \partial f_r^w} \left( \sum_{\nu \in W} \sum_{p \in R^{\nu}} f_p^{\nu} \delta_{e,p}^{\nu} \right) = \\
= t_e \left(\sum_{\nu \in W} \sum_{p \in R^{\nu}} f_p^{\nu}
\delta_{e,p}^{\nu} \right) \delta_{e,r}^w \stackrel{(\ref{f4})}{=}
t_e (x_e) \delta_{e,r}^w ~\quad \forall e \in E,~ r \in R^w,~ w
\in W. \nonumber
\end{gather}
Тогда
\begin{gather} \label{ff15}
\frac{\partial L}{ \partial f_r^w} = \sum_{e \in E} t_e (x_e)
\delta_{e,r}^w - \mathfrak{t}^w - \eta_r^w ~\quad \forall r \in
R^w,~ w \in W.
\end{gather}
Согласно условию дополнительной нежесткости, $\eta_r^w {f_r^w}=0$
для всех $r \in R^w$, $w \in W$. Таким образом, в~силу
(\ref{ff15}), имеем
\begin{gather} \label{ff16}
\sum_{e \in E} t_e (x_e) \delta_{e,r}^w \left\{
\begin{array}{ll}
= \mathfrak{t}^w & \textrm{при } f_r^w > 0 \textrm{,}\\
\geq \mathfrak{t}^w & \textrm{при } f_r^w = 0 \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W.
\end{gather}
Левая часть выражения (\ref{ff16}) есть время движения по маршруту
$r \in R^w$ (сумма времен движения по всем дугам, входящим в~этот
маршрут).

Рассмотрим произвольный маршрут $r \in R^w$ между парой $w \in W$.
С точностью до обозначений будем считать, что маршрут $r$ состоит
из дуг $j$,\, $j = \overline{1, l_r^w}$, где $l_r^w$~---
количество дуг маршрута $r \in R^w$. В~таком случае выражение
(\ref{ff16}) с~точностью до обозначений может быть переписано
в~виде
\begin{gather} \nonumber
\sum_{j=1}^{l_r^w} t_{rj} (x_{rj}) \left\{
\begin{array}{ll}
= \mathfrak{t}^w & \textrm{при } f_r^w > 0 \textrm{,}\\
\geq \mathfrak{t}^w & \textrm{при } f_r^w = 0 \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W,
\end{gather}
что в~случае линейных функций задержек на дугах сети приводит
к~формуле
\begin{gather} \label{ff17}
\sum_{j=1}^{l_r^w} \left(a_{rj} + b_{rj} x_{rj} \right) \left\{
\begin{array}{ll}
= \mathfrak{t}^w & \textrm{при } f_r^w > 0 \textrm{,}\\
\geq \mathfrak{t}^w & \textrm{при } f_r^w = 0 \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W.
\end{gather}

По маршруту $r \in R^w$ между парой $w \in W$ распределяется поток
$f_r^w \geq 0$, который проходит по каждой дуге данного маршрута
$j$,\, $j = \overline{1, l_r^w}$. При этом по каждой дуге $j$, $j
= \overline{1, l_r^w}$, могут быть распределены потоки других
маршрутов $f_p^\nu$,\, $p \in R^\nu$,\, $\nu \in W$. Для каждой
дуги $j$,\, $j = \overline{1, l_r^w}$, сумму таких потоков будем
обозначать $h_{rj}^w$ для всех $j \in r$, $r \in R^w$, $w \in W$.
Другими словами, для дуги $j$ маршрута $r \in R^w$ между парой $w
\in W$ имеет место равенство $x_{rj} = f_r^w + h_{rj}^w$. Таким
образом, от (\ref{ff17}) переходим к~ выражению
\begin{gather} \label{ff18}
\sum_{j=1}^{l_r^w} \left(a_{rj} + b_{rj} (f_r^w + h_{rj}^w)
\right) \left\{
\begin{array}{ll}
= \mathfrak{t}^w & \textrm{при } f_r^w > 0 \textrm{,}\\
\geq \mathfrak{t}^w & \textrm{при } f_r^w = 0 \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W.
\end{gather}
Введем обозначения
\begin{gather} \label{ff19} \nonumber
a_r^w = \sum_{j=1}^{l_r^w} a_{rj}, \quad b_r^w =
\sum_{j=1}^{l_r^w} b_{rj}, ~\quad h_r^w = \sum_{j=1}^{l_r^w}
b_{rj} h_{rj}^w.
\end{gather}
В таком случае (\ref{ff18}) примет вид
\begin{gather} \label{ff20} \nonumber
a_r^w + b_r^w f_r^w + h_r^w \left\{
\begin{array}{ll}
= \mathfrak{t}^w & \textrm{при } f_r^w > 0 \textrm{,}\\
\geq \mathfrak{t}^w & \textrm{при } f_r^w = 0 \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W,
\end{gather}
откуда имеем
\begin{gather} \label{ff21}
f_r^w = \left\{
\begin{array}{ll}
\frac{\mathfrak{t}^w - a_r^w - h_r^w}{b_r^w} & \textrm{при } a_r^w + h_r^w < \mathfrak{t}^w \textrm{,}\\
0 & \textrm{при } a_r^w + h_r^w \geq \mathfrak{t}^w \textrm{,}
\end{array} \right.
~\quad \forall r \in R^w,~ w \in W.
\end{gather}
Без умаления общности, будем считать, что маршруты между каждой
парой $w \in W$ упорядочены таким образом, что
\begin{equation} \label{ff22} \nonumber
a_1^w + h_1^w \leq \ldots \leq a_{|R^w|}^w + h_{|R^w|}^w.
\end{equation}
Определим маршрут $r^w$ такой, что
\begin{equation} \label{ff23}
a_{r^w}^w + h_{r^w}^w < \mathfrak{t}^w \leq a_{r^w+1}^w +
h_{r^w+1}^w.
\end{equation}
В этом случае, согласно (\ref{ff21}), имеем
$$\sum_{r \in R^w} f_r^w = \sum_{r=1}^{r^w} f_r^w = \sum_{r=1}^{r^w} \frac{\mathfrak{t}^w - a_r^w - h_r^w}{b_r^w} = F^w,$$
откуда находим, что
$$\mathfrak{t}^w = \frac{F^w + \sum_{s=1}^{r^w} \frac{a_s^w + h_s^w}{b_s^w}}{\sum_{s=1}^{r^w} \frac{1}{b_s^w}}.$$
Согласно (\ref{ff23}), получаем
$$a_{r^w}^w + h_{r^w}^w < \frac{F^w + \sum_{s=1}^{r^w} \frac{a_s^w + h_s^w}{b_s^w}}{\sum_{s=1}^{r^w} \frac{1}{b_s^w}} \leq a_{r^w+1}^w + h_{r^w+1}^w$$
или
\begin{equation} \label{ff24} \nonumber
\sum_{r=1}^{r^w} \frac{a_{r^w}^w + h_{r^w}^w - a_r^w -
h_r^w}{b_r^w} \leq F^w < \sum_{r=1}^{r^w} \frac{a_{r^w+1}^w +
h_{r^w+1}^w - a_r^w - h_r^w}{b_r^w}.
\end{equation}

Таким образом, в~силу того, что условия Куна---Таккера являются
необходимыми и~достаточными, приходим к~следующему:
оптимизационная задача (\ref{f1})--(\ref{f4}) эквивалентна СЛАУ
и~набору неравенств

\begin{equation} \label{ff1} \nonumber
f_r^w = \frac{F^w + \sum_{s=1}^{r^w} \frac{a_s^w +
h_s^w}{b_s^w}}{b_r^w \sum_{s=1}^{r^w} \frac{1}{b_s^w}} -
\frac{a_r^w + h_r^w}{b_r^w}, \quad r \leq r^w, \quad \forall
\thinspace w \in W,
\end{equation}
\begin{equation} \label{ff2} \nonumber
f_r^w = 0, \quad r^w < r \leq |R^w|, \quad \forall \thinspace w
\in W,
\end{equation}
где $r^w$ определяется из условий
\begin{gather} \label{ff3} \nonumber
\sum_{r=1}^{r^w} \frac{a_{r^w}^w + h_{r^w}^w - a_r^w -
h_r^w}{b_r^w} \leq F^w < \sum_{r=1}^{r^w} \frac{a_{r^w+1}^w +
h_{r^w+1}^w - a_r - h_r}{b_r}, ~\quad \forall \thinspace w \in W,
\end{gather}
при
\begin{gather} \label{ff4} \nonumber
a_1^w + h_1^w \leq \ldots \leq a_{|R^w|}^w + h_{|R^w|}^w, ~\quad
\forall \thinspace w \in W,
\end{gather}
с
\begin{equation} \nonumber
a_r^w = \sum_{j=1}^{l_r^w} a_{rj}^w, \quad b_r^w =
\sum_{j=1}^{l_r^w} b_{rj}^w, \quad h_r^w = \sum_{j=1}^{l_r^w}
b_{rj}^w h_{rj}^w, ~\quad \forall \thinspace r \in R^w,~ w \in W.
\end{equation}

%Покажем, что одновременное решение систем линейных уравнений (\ref{ff1}), (\ref{ff2}) для всех пар $w \in W$ приведет к~конкурентному равновесию в~сети $G$. Предположим, что мы нашли конкретное решение $\overline{f} = \left( \ldots, \overline{f}^w, \ldots \right)$, которое удовлетворяет системам линейных уравнений (\ref{ff1}), (\ref{ff2}) одновременно для всех $w \in W$, но не является конкурентным равновесием. В~таком случае имеется по крайней мере один $\overline{f}^{\overline{w}}$, который не обеспечивает конкурентное равновесие для пары $\overline{w}$. При этом, если $\overline{f}^{\overline{w}}$ удовлетворяет системе линейных уравнений (\ref{ff1}), (\ref{ff2}) для всех пар $w \in W$, то значит $\overline{f}^{\overline{w}}$ в~том числе удовлетворяет подсистеме линейных уравнений (\ref{ff1}), (\ref{ff2}) конкретно для $\overline{w}$. Однако, если $\overline{f}^{\overline{w}}$ удовлетворяет системе линейных уравнений (\ref{ff1}), (\ref{ff2})  для $\overline{w}$, то, согласно лемме, $\overline{f}^{\overline{w}}$ обеспечивает конкурентное равновесие для пары $\overline{w}$. Приходим к~противоречию.

%Таким образом, одновременное решение систем линейных уравнений (\ref{ff1}), (\ref{ff2}) для всех пар $w \in W$ действительно приведет к~конкурентному равновесию в~сети $G$.

%Полученные результаты справедливы для любых $h_r^w$. В~общем случае $h_r^w = h_r^w (f)$, при этом, в~случае линейной сети $h_r^w (f)$ линейная функция многих переменных.
%Таким образом, получаем систему линейных уравнений относительно переменных $f$, сформированную как объединение систем линейных уравнений для всех пар $w \in W$.

\noindent Теорема доказана.

Доказательство теоремы  конструктивно в~том смысле, что предлагает
метод сведения задачи распределения потоков к~СЛАУ относительно
переменных потоков по маршрутам. Алгоритм конкретных действий по
сведению задачи распределения потоков к~СЛАУ может быть следующим:

1) для каждой пары районов отправления---прибытия $w \in W$
формируем систему из уравнений
\begin{equation} \nonumber
f_r^w = \frac{F^w + \sum_{s=1}^{r^w} \frac{a_s^w +
h_s^w}{b_s^w}}{b_r^w \sum_{s=1}^{r^w} \frac{1}{b_s^w}} -
\frac{a_r^w + h_r^w}{b_r^w}
\end{equation}
для всех используемых маршрутов $r \in R^w$;\newpage

2) объединяем получившиеся СЛАУ в~одну общую систему, имея в~виду,
что $h_{rj}^w = \sum_{\nu \in W} \sum_{p \in R^\nu \backslash r}
f_p^\nu \delta_{j,p}^\nu$, для всех $j \in r$,\, $r \in R^w$,\, $w
\in W$;

3) решаем общую СЛАУ.


\indent {\bf 4. Пример решения задачи распределения потоков по
маршрутам транспортной сети посредством решения СЛАУ.} Рассмотрим
сеть, представленную на рисунке, с~характеристиками, введенными
в~табл. 1.

%\begin{figure}[h!]
%\begin{center}
%\includegraphics[width=0.8\linewidth]{example_route_find1.jpg}
%%\caption{Транспортная сеть}
%\label{p3.2}
%\end{center}
%\end{figure}


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{03/fig1}

\vskip 2mm {\small{\it Рисунок.} Транспортная сеть} }
\end{figure}


\vskip 2mm
\begin{center}
{\small

{\it Таблица 1.} {\bf Характеристики маршрутов}

}

\vskip 3mm

{\footnotesize


\begin{tabular}{|c|c|c|c|c|c|c|c|c|}\hline

& \multicolumn{2}{|c|}{Маршрут 1} & \multicolumn{2}{|c|}{Маршрут
2} & \multicolumn{2}{|c|}{Маршрут 3} &
\multicolumn{2}{|c|}{Маршрут 4} \\ \cline{2-9}%
\raisebox{5pt}[1pt]{$i$} & $a_i$ & $b _i$ & $a_{2i}$ & $b_{2i}$ &
$a_{3i}$ & $b_{3i}$ & $a_i$ & $b _i$ \\ \hline%
1 & 4 & 0.5 & 2 & 0.2 & 1.5 & 0.15 & 5 & 0.4 \\ \hline%
2 &  &  & 1.5 & 0.15 & 1.5 & 0.15 &  & \\ \hline%
3 &  &  & 1.5 & 0.2 & 1 & 0.2 &  & \\ \hline%
\end{tabular}


}
\end{center}
\vskip 2mm

%\begin{table}[h!]
%\caption{\textbf{Характеристики маршрутов}} \label{t3} \centering
%\begin{tabular}{|c|}
%\hline
%\\
%\hline%\noalign{\smallskip}
%$i$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%1 \\
%2 \\
%3 \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|c|}
%\hline
%\multicolumn{2}{|c|}{Маршрут 1} \\
%\hline%\noalign{\smallskip}
%$a_i$ & $b _i$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%4 & 0.5 \\
%& \\
%& \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|c|}
%\hline
%\multicolumn{2}{|c|}{Маршрут 2} \\
%\hline%\noalign{\smallskip}
%$a_{2i}$ & $b_{2i}$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%2 & 0.2 \\
%1.5 & 0.15 \\
%1.5 & 0.2 \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|c|}
%\hline
%\multicolumn{2}{|c|}{Маршрут 3} \\
%\hline%\noalign{\smallskip}
%$a_{3i}$ & $b_{3i}$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%1.5 & 0.15 \\
%1.5 & 0.15 \\
%1 & 0.2 \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|c|}
%\hline
%\multicolumn{2}{|c|}{Маршрут 4} \\
%\hline%\noalign{\smallskip}
%$a_i$ & $b_i$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%5 & 0.4 \\
%& \\
%& \\
%\hline
%\end{tabular}
%\end{table}


Предполагается, что рассматриваемый граф ориентированный, имеет
два истока (круги) и~два стока (квадраты). Каждая пара
исток---сток соединена двумя маршрутами: первая пара ---
маршрутами 1 и~2, а~вторая~--- 3 и~4. В~свою очередь, маршрут~1
состоит из одной дуги, маршрут 2 --- из дуг 2.1, 2.2 и~2.3,
маршрут 3 --- из дуг 3.1, 3.2 и~3.3, маршрут 4 --- из одной дуги.
При этом заметим, что 2.2 и~3.2 --- это одна и~та же дуга.

Тем не менее необходимо, чтобы все дуги каждого отдельно взятого
маршрута были пронумерованы. Таким образом, получаем две задачи
распределения транспортного потока по двум подсетям
с~параллельными маршрутами. При этом $F_1 = 20$ и~$F_2 = 30$.
Тогда, благодаря (\ref{f3.4.4}), окончательно определяем
характеристики для каждого маршрута (табл. 2).

%\begin{figure}[h!]
%\begin{center}
%\includegraphics[width=0.8\linewidth]{example_route_find2.eps}
%\caption{Транспортная сеть}
%\label{p3.3}
%\end{center}
%\end{figure}


\vskip 2mm
\begin{center}
{\small

{\it Таблица 2.} {\bf Характеристики маршрутов}

}

\vskip 3mm

{\footnotesize


\begin{tabular}{|c|c|c|c|c|}\hline

& Маршрут 1 & Маршрут 2 & Маршрут 3 & Маршрут 4 \\ \cline{2-5}%
\raisebox{5pt}[1pt]{Параметр} & $i=1$ & $i=2$ & $i=3$ & $i=4$ \\ \hline%
$a_i$ & 4 & 5 & 4 & 5 \\ \hline%
$b_i$ & 0.5 & 0.55 & 0.5 & 0.4 \\ \hline%
$h_i$ & 0 & $0.15 \cdot f_3$ & $0.15 \cdot f_2$ & 0 \\ \hline%
\end{tabular}


}
\end{center}

\vskip 2mm






%\begin{table}[h!]
%\caption{\textbf{Характеристики маршрутов}} \label{t4} \centering
%\begin{tabular}{|c|}
%\hline
%\\
%\hline%\noalign{\smallskip}
%\\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%$a_i$ \\
%$b_i$ \\
%$h_i$ \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|}
%\hline
%\multicolumn{1}{|c|}{Маршрут 1} \\
%\hline%\noalign{\smallskip}
%$i=1$\\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%4 \\
%0.5 \\
%0 \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|}
%\hline
%\multicolumn{1}{|c|}{Маршрут 2} \\
%\hline%\noalign{\smallskip}
%$i=2$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%5 \\
%0.55 \\
%$0.15 \cdot f_3$ \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|}
%\hline
%\multicolumn{1}{|c|}{Маршрут 3} \\
%\hline%\noalign{\smallskip}
%$i=3$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%4 \\
%0.5 \\
%$0.15 \cdot f_2$ \\
%\hline
%\end{tabular}
%\begin{tabular}{|c|}
%\hline
%\multicolumn{1}{|c|}{Маршрут 4} \\
%\hline%\noalign{\smallskip}
%$i=4$ \\
%%\noalign{\smallskip}
%\hline
%%\noalign{\smallskip}
%5 \\
%0.4 \\
%0 \\
%\hline
%\end{tabular}
%\end{table}

Применив (\ref{f3.4.6}), получаем СЛАУ
\begin{equation} \nonumber
f_1 = \frac{20 + \frac{4}{0.5} + \frac{5 + 0.15 f_3}{0.55} }{0.5
\left( \frac{1}{0.5} + \frac{1}{0.55} \right)} - \frac{4}{0.5},
\end{equation}
\begin{equation} \nonumber
f_2 = \frac{20 + \frac{4}{0.5} + \frac{5 + 0.15 f_3}{0.55} }{0.55
\left( \frac{1}{0.5} + \frac{1}{0.55} \right)} -
\frac{5+0.15f_3}{0.55},
\end{equation}
\begin{equation} \nonumber
f_3 = \frac{30 + \frac{4 + 0.15 f_2}{0.5} + \frac{5}{0.4} }{0.5
\left( \frac{1}{0.5} + \frac{1}{0.4} \right)} - \frac{4 + 0.15
f_2}{0.5},
\end{equation}
\begin{equation} \nonumber
f_4 = \frac{30 + \frac{4 + 0.15 f_2}{0.5} + \frac{5}{0.4} }{0.4
\left( \frac{1}{0.5} + \frac{1}{0.4} \right)} - \frac{5}{0.4}.
\end{equation}
Преобразовав ее, приходим к~СЛАУ в~матричном виде
\begin{equation} \nonumber
\left(
\begin{array}{cccc}
1 & 0 & -0.14 & 0 \\
0 & 1 & 0.14 & 0 \\
0 & 0.17 & 1 & 0 \\
0 & -0.17 & 0 & 1
\end{array}
\right) \left(
\begin{array}{c}
f_1 \\
f_2 \\
f_3 \\
f_4
\end{array}
\right) = \left(
\begin{array}{c}
11.42 \\
8.57 \\
14.44 \\
15.55
\end{array}
\right),
\end{equation}
откуда окончательно определяем значения потоков по маршрутам как
решение СЛАУ:
\begin{equation} \nonumber
\left(
\begin{array}{c}
f_1 \\
f_2 \\
f_3 \\
f_4
\end{array}
\right) = \left(
\begin{array}{c}
13.3 \\
6.7 \\
13.3 \\
16.7
\end{array}
\right).
\end{equation}
В качестве проверки можно подставить эти величины в~функции
задержки и~увидеть, что $t_1 (f_1) = t_2 (f_2) = 10.7$ и~$t_3
(f_3) = t_4 (f_4) = 11.7$. Таким образом, все маршруты являются
используемыми и~дополнительной проверки выполнения условий в~виде
неравенств не требуется.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\indent {\bf 5. Заключение.} Была рассмотрена задача распределения
потоков по маршрутам линейной транспортной сети, которая
представлялась ориентированным графом произвольной топологии.
Задача распределения транспортных потоков по маршрутам была
поставлена как задача условной нелинейной оптимизации. Была
доказана теорема о~сводимости задачи распределения потоков по
маршрутам линейной транспортной сети к~СЛАУ и~набора условий
в~виде неравенств. Приведен пример использования конструктивного
доказательства теоремы сведения задачи распределения потоков по
маршрутам транспортной сети к~СЛАУ.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{03/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{03/ref-s}

%%%%%N DOI в~ссылке!!!!!!!!!!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize




%\thispagestyle{empty}

\vskip 3mm

%\thispagestyle{empty}


\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\vskip 5mm


%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak

%\vskip 3mm

%\textit{Буре Артем Владимирович}~--- аспирант; e-mail:
%bure.artem@gmail.com

%\vskip 2mm

%\emph{Bure Artem Vladimirovich}~--- post-graduate student; e-mail:
%bure.artem@gmail.com

%}
