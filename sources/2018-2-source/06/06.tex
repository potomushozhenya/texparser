%\begin{center}
%{\footnotesize
%\begin{tabular}{lcr}
%$\issueyear$   & ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА  &  Том\,13.\,\,Вып.\,$\issuenum$ \\
%\multicolumn{3}{c}{ПРИКЛАДНАЯ МАТЕМАТИКА.
%ИНФОРМАТИКА. ПРОЦЕССЫ УПРАВЛЕНИЯ}\\
%\end{tabular}
%\end{center}
%}
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,14.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ИНФОРМАТИКА} \vspace{1.8cm}

\noindent{\small УДК 519.688\\
MSC 68J10

}

\vskip2mm

\noindent{\bf Выделение однородных зон сельскохозяйственного поля
для закладки\\ опытов с помощью беспилотного летательного
аппарата%$^{*}$
}

\vskip2.5mm

\noindent{\it В.~М.~Буре$^{1, 2}$, Е.~П.~Митрофанов$^1$,
О.~А.~Митрофанова$^{1, 2}$, А.~Ф.~Петрушин$^1$}


\efootnote{
%
\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Работа Е. С. Барановского выполнена при
%финансовой поддержке Российского фонда фундаментальных
%исследований (грант № 16-31-00182 мол\_а).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%

}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp09 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp09 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\vskip1.5mm

{\footnotesize



\noindent $^1$~Агрофизический научно-исследовательский институт,
Российская Федерация,

\noindent\hskip2.45mm 195220, Санкт-Петербург, Гражданский пр., 14


\noindent $^2$~Санкт-Петербургский государственный университет,
Российская Федерация,

\noindent\hskip2.45mm 199034, Санкт-Петербург,
Университетская~наб., 7--9


}

\vskip3mm





{\small \noindent \textbf{Для цитирования:} \textit{Буре В.~М.,
Митрофанов Е.~П., Митрофанова О.~А., Петрушин А.~Ф.} Выделение
однородных зон сельскохозяйственного поля для закладки опытов с
помощью беспилотного летательного аппарата~// Вестник
Санкт-Петербургского университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~14.
Вып.~\issuenum. С.~\pageref{p6}--\pageref{p6e}.
\doivyp/spbu10.\issueyear.\issuenum06

\vskip3mm

{\leftskip=7mm\noindentК важным этапам исследований, направленных
на решение задач точного земледелия, относится закладка полевых
опытов. Необходимым условием проведения таких опытов является
обеспечение однородности выбранного земельного участка.
Большинство существующих методик выделения однородных зон для
проведения опытов основано на дорогостоящем и трудозатратном
отборе и анализе проб почвы. Альтернативным и перспективным
подходом представляется использование беспилотного летательного
аппарата. В работе достаточно подробно представлены все этапы
выбора однородного земельного участка с~помощью аэрофотосъемки.
Объектом было выбрано поле с~многолетним посевом <<козлятника>> на
базе Меньковского филиала Агрофизического института (Ленинградская
область). Аэрофотосъемка осуществлялась в~2015--2017~гг. благодаря
беспилотному летательному аппарату <<Геоскан 401>>. Полученные
данные обрабатывались с~помощью специализированного программного
обеспечения: сшивка и~выравнивание производились в~программе
Agisoft PhotoScan, тематическая обработка и~выделение однородных
участков поля --- в~программах QGis и~Saga Gis. Для оценки
состояния растительности был применен вегетационный индекс NDVI
(Normalized Difference Vegetation Index). Для кластеризации
однородных участков поля по параметрам NDVI использовался алгоритм
ISODATA (Iterative Self-Organizing Data Analysis Technique
Algorithm). В работе представлены результаты кластеризации снимков
одного и того же поля в разные временные периоды. Были построены
пересечения этих аэрофотоснимков, выделены четыре кластера,
которые являются пересечением соответствующих однородных зон за
рассмотренные временные периоды. Установлено,
что\linebreak\newpage\noindent закладку опытов целесообразно
проводить на данных участках, так как присутст\-вую\-щая
там однородность представляется более устойчивой в динамике.\\[1mm]
\textit{Ключевые слова}: аэрофотосъемка, точное земледелие,
кластеризация, алгоритм ISODATA.

}

}





\vskip 4mm



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


 { \bfseries  Введение.}
Важным элементом агрономической науки, изучающей влияние
параметров окружающей среды на развитие сельскохозяйственных
культур, является закладка полевых опытов. Согласно классическому
подходу Б. А. Доспехова, земельный участок, предназначенный для
закладки опыта, прежде всего должен отвечать требованиям
типичности или репрезентативности, а также однородности почвенного
покрова [1]. Это позволит обеспечить достаточную точность
результатов проведения опыта. Часто для выделения однородной зоны
требуются исследование истории участка, его рельефа, почвенное
обследование, изучение засоренности и других параметров.

Без анализа почвы нельзя говорить о типичности опыта, почва
опытного участка должна быть однообразной. В современных условиях
результаты почвенных обследований обрабатываются и хранятся с
применением геоинформационных систем. В~последнее время наряду с
классическим обследованием почв, выполняемым с по\-мощью почвенных
разрезов, начали применяться методы классификации почв на основе
данных дистанционного зондирования (ДДЗ)~[2--4].

Однако каким бы детальным не было почвенное обследование, оно не
может выявить микропестроту почв. Поэтому очень важно наблюдать за
состоянием культурной или дикой растительности будущего опытного
участка в динамике. Такое наблюдение позволяет выявить, где
расположены пятна с наиболее бедной и плодородной почвами. Для
осуществления данных наблюдений эффективным средством является
применение ДДЗ.

 { \bfseries  Объекты исследования.}
Опыты проводились в 2015--2017 гг. на базе Меньковского филиала
Агрофизического научно-исследовательского института (деревня
Меньково, Гатчинский район, Ленинградская область). Было выбрано
поле с многолетним посевом «козлятника». Для получения ДДЗ был
использован квадрокоптер «Геоскан 401», оснащенный двумя
фотокамерами для съемки в видимом и ближнем инфракрасном
диапазонах спектра. Высота полетов составляла в среднем 75 м,
пространственное разрешение снимков~---~2~см на пиксель.

{\bfseries Методы обработки ДДЗ Земли.} Полученные данные
обрабатывались с по\-мощью специализированного программного
обеспечения: сшивка и выравнивание осуществлялись в программе
Agisoft PhotoScan, тематическая обработка и выделение однородных
участков поля~--- в программах QGis и Saga Gis. Для оценки
состояния растительности был применен вегетационный индекс NDVI
(Normalized Difference Vegetation Index), вычисляемый по следующей
формуле [5]:
  \begin{equation*}
  \text{NDVI} = \frac {\text{NIR} - \text{RED}}{\text{NIR} + \text{RED}},                                     \end{equation*}
где NIR~--- отражение в ближней инфракрасной области спектра, а
RED~--- отражение в красной области спектра.

По результатам расчетов было получено пространственное
распределение индекса NDVI на поле.

Для кластеризации однородных участков поля по параметрам NDVI
использовался алгоритм ISODATA (Iterative Self-Organizing Data
Analysis Technique Algorithm) [6]. Входными данными алгоритма
являются заранее заданные параметры: $\bf {x} = [x_1, ...,
x_N]^T$~--- выборка параметров NDVI; $K_0$~--- желаемое количество
кластеров; $n_{\text{min}}$~--- минимальное количество выборок в
каждом кластере (для отбрасывания кластеров);
$\sigma^2_{\text{max}}$~--- максимальная дисперсия (для разбиения
кластеров); $d_{\text{min}}$~--- минимальное попарное расстояние
(для слияния кластеров). Пошагово алгоритм можно представить
следующим образом.

{\it Шаг 1}. Выбор случайным образом исходных средних векторов
$\{m_1, ..., m_K\}, K = K_0$, из набора данных.

{\it Шаг 2}. Определение каждой точки данных $x$ в кластер с самым
близким значением:
  \begin{equation*}
  x \in \omega_i ,\,\,  \text { если }  d(x, m_i) = \text{min} \{d(x, m_1), ..., d(x, m_K)\}.                                     \end{equation*}

{\it Шаг 3}. Отбрасывание кластеров, содержащих слишком мало
элементов, т.~е., если $n_j < n_{\text{min}}$, тогда отбрасывается
$\omega_j$, а его элементы перераспределяются в другие кластеры,
$K \leftarrow K - 1$.

{\it Шаг 4}. Обновление для каждого кластера $\omega_j  (j = 1,
..., K)$ среднего вектора
 \begin{equation*}
  m_j = \frac {1}{n_j} \sum \limits_{x \in \omega_j} x,                                    \end{equation*}
а также ковариационной матрицы
 \begin{equation*}
  \Sigma_j = \frac {1}{n_j} \sum \limits_{x \in \omega_j} (x - m_j) {(x - m_j)}^T.                                   \end{equation*}
Диагональными элементами матрицы являются дисперсии $\sigma^2_1,
..., \sigma^2_N$.

{\it Шаг 5}. Если $K \le \frac {K_0}{2}$ (слишком мало кластеров),
тогда переход к шагу 6 для разбиения; иначе если $K > 2K_0$
(слишком много кластеров), тогда переход к шагу 7 для слияния;
иначе переход к шагу 8.

{\it Шаг 6}. Разбиение. Для каждого кластера $\omega_j  (j = 1,
..., K)$ осуществляется поиск наибольшей ковариации $\sigma^2_m =
\text{max}\{\sigma^2_1, ..., \sigma^2_N\}$. Если $\sigma^2_m >
\sigma^2_{\text{max}}$ и $n_j > 2n_{\text{min}}$, тогда $m_j$
разбивается на два новых центра кластеров: %
% \begin{equation*}
$  m^+_j = m_j + \sigma_m, ~\,~  m^-_j = m_j - \sigma_m.$\\
%\end{equation*}
Устанавливается $K \leftarrow K + 1$.

Переход к шагу 8.

{\it Шаг 7}. Слияние. Вычисляются $\frac {K(K - 1)}{2}$ попарных
расстояний между каждыми двумя средними векторами кластеров:
 \begin{equation*}
  d(\omega_i, \omega_j) = \frac {1}{4} {(m_i - m_j)}^T {\left[\frac {\Sigma_i + \Sigma_j}{2}\right]}^{-1} (m_i + m_j) + \text{log}\left[\frac {|\frac {\Sigma_i + \Sigma_j}{2}|}{{(|\Sigma_i| |\Sigma_j|)}^{1/2}}\right] \end{equation*}   \begin{equation*}   (1 \le i, j \le K, i > j).                            \end{equation*}
Для каждого расстояния, удовлетворяющего условию $d(\omega_i,
\omega_j) < d_{\text{min}}$, осу\-ществ\-ляет\-ся слияние
соответствующих кластеров с образованием нового:
 \begin{equation*}
  m_i = \frac {1}{n_i + n_j} [n_im_i + n_jm_j].                             \end{equation*}
Удаляется $m_j$, устанавливается $K \leftarrow K - 1$.

{\it Шаг 8}. Алгоритм завершается, если достигнуто максимальное
количество итераций, в противном случае осуществляется переход к
шагу 2.

Результатом работы этого алгоритма являются схемы
пространственного распределения однородных зон на поле. Описанный
алгоритм обработки был применен для данных ДЗЗ  за
2015--2017~гг.\newpage

  { \bfseries  Результаты и их обсуждение.}
На рис. 1 представлены результаты кластеризации снимков с помощью
алгоритма ISODATA одного и того же поля в разные временные
периоды. Видно, что существуют различия в выделенных зонах, однако
можно выделить зоны их пересечения; такой подход представляется
наиболее целесообразным для выбора участка, предназначенного для
закладки прецизионного опыта с удобрениями.


\begin{figure}[h!]
\centering{
\includegraphics[scale=0.88]{06/fig1}

\vskip 1mm {\small{\it Рис. 1.} Кластеризация снимков с помощью
алгоритма ISODATA\\ одного и того же поля в разные временные
периоды} }
\end{figure}


%%\bfullwidth
%\begin{figure}[h!]
%\includegraphics[height=100mm,width=0.9\textwidth]{1.pdf}
%\caption{.~Кластеризация снимков с помощью алгоритма ISODATA
%одного и того же поля в разные временные периоды } \label{fig1}
%\end{figure}
%%\efullwidth

На рис. 2 приведен результат пересечения полученных
аэрофотоснимков, также выделены четыре кластера, которые являются
пересечением соответствующих однородных %
\begin{figure}[h!]
%\centering{
\includegraphics[scale=0.88]{06/fig2}  %}

\vspace*{-15mm}
\flushright{\small%
\parbox[b]{5.5cm}{{\it Рис. 2.} Пересечение соответствующих
однородных зон за рассмотренные временные периоды\\
 }

}

\end{figure}
зон за рассмотренные временные периоды. Соответственно закладку
опытов целесообразно проводить на данных участках, так как
присутствующая там однородность представляется более устойчивой в
динамике.




%\begin{figure}[h!]
%\centering{
%\includegraphics[scale=0.9]{06/fig2}
%
%\vskip 2mm {\small{\it Рис. 2.} Пересечение соответствующих
%однородных зон\\ за рассмотренные временные периоды} }
%\end{figure}




%%\bfullwidth
%\begin{figure}[h!]
%\includegraphics[height=100mm,width=0.9\textwidth]{2.pdf}
%\caption{.~Пересечение соответствующих однородных зон за
%рассмотренные временные периоды } \label{fig2}
%\end{figure}
%%\efullwidth

Большинство методик выделения однородных зон связано с
обследованием почвы с помощью взятия и анализа проб, что является
довольно трудозатратным подходом. Таким образом, для определения
однородного земельного участка для размещения опыта более
перспективно использовать беспилотный летательный аппарат.

{ \bfseries  Заключение.} В большинстве случаев для выделения
однородных зон сельскохозяйственного поля проводятся обследование
почвенного покрова, включающее ручной или машинный (например,
благодаря мобильному комплексу, разработанному в~Агрофизическом
институте) пробоотбор, а также лабораторный анализ полученных
образцов. В сравнении с такими подходами применение беспилотного
летательного аппарата позволяет снизить материальные расходы и
трудозатраты, а также обеспечить оперативность получения
результатов. Следует также отметить, что аэрофотосъемка и
обработка данных с помощью геоинформационных систем дают
возможность автоматизировать решение задач точного земледелия,
связанных с выделением однородных зон сельскохозяйственного поля
для закладки опытов.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{06/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{06/ref-s}
%
%%%%%N DOI в~ссылке!!!!!!!!!!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
{\footnotesize
%\vskip 3mm
%\thispagestyle{empty}
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\vskip 5mm

%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak \vskip 3mm

%{\it Балонин Николай Алексеевич}~-- доктор технических наук,
%профессор; e-mail: korbendfs@mail.ru

%{\it Сергеев Михаил Борисович}~-- доктор технических наук,
%профессор,  директор; e-mail: mbse@mail.ru

%\vskip 2mm

%\emph{Balonin Nikolaj Alekseevich}~-- doctor of technical
%sciences, professor; e-mail: korbendfs@mail.ru


%\emph{Sergeev Mikhail Borisovich}~-- doctor of technical sciences,
%director; e-mail: mbse@mail.ru


%}


%\thispagestyle{empty}
