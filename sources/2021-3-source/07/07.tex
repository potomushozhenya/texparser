%
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,17.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ПРОЦЕССЫ
УПРАВЛЕНИЯ} \vspace{1.5cm}%1.8cm}

\noindent{\small УДК 517.977.1\\ %  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\ %
MSC 93B03

}

\vskip2.5mm%3mm

\noindent{\bf Построение множеств достижимости и управляемости в специальной \\ линейной задаче управления$^{*}$%
 }

\vskip2.0%2.5
mm

\noindent{\it А.\,С. Попков %$^1$%
%, И.~О. Фамилия%$\,^2$%

}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (проект № 19-31-90033).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent%
%$^1$~%
Санкт-Петербургский государственный университет, Российская Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9



}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip2.5%3
mm

{\small \noindent \textbf{Для цитирования:} \textit{Попков А.\,С.} Построение множеств достижимости и управляемости в~специальной линейной задаче управления~// Вестник
Санкт-Пе\-тер\-бург\-ско\-го университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~17.
Вып.~\issuenum.
С.~\pageref{p7}--\pageref{p7e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum07

\vskip2.5%3
mm

{\leftskip=7mm\noindentРассматривается вопрос о построении множеств достижимости и управляемости для задачи управления, в которой движение объекта описывается линейной системой обыкновенных дифференциальных уравнений, а управление выбирается из класса кусочно-постоянных функций. Также заданы прямые двусторонние ограничения для компонент вектора управлений. Приведены определения множеств достижимости и управ\-ляе\-мос\-ти. Показано, что задачи построения этих множеств эквивалентны и могут быть сведены к задаче линейного отображения многомерного куба. Анализируются существующие подходы к решению поставленной задачи. Поскольку они чрезмерно трудоемки, возникает вопрос о создании более эффективного алгоритма. В работе предложен алгоритм построения искомых множеств как системы линейных неравенств. В виде теоремы доказана корректность алгоритма. Оценена сложность представленного подхода.\\[1mm]
\textit{Ключевые слова}: управление, оптимальное управление, кусочно-постоянное управление, множество достижимости, множество управляемости, линейное отображение, элиминация Фурье\,---\,Моцкина.

}

}

\vskip 3%4
mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\indent {\bf 1. Введение.} Большое внимание привлекает вопрос о достижимости объектом управления желаемого положения за определенное время при допустимом управлении. В задачах управления обычно задается терминальная задача --- требование о~попадании в определенную точку или множество. Однако заранее неизвестно, является ли терминальная задача выполнимой. В настоящем исследовании будет изучена задача  с кусочно-постоянным управлением при заданных  двусторонних ограничениях на него. Такая задача была описана Р.\,Габасовым [1] и решается сведением к задаче линейного программирования с ее последующим решением. Также она  может рассматриваться в контексте  позиционной оптимизации:  управление перестраивается в~режиме реального времени в случае обнаружения отклонений от заданной траектории. В такой постановке данную задачу можно отнести к актуальному классу задач типа <<предиктор\,---\,корректор>> [2--4].

Задача построения множеств достижимости и управляемости была неоднократно рассмотрена как в классических источниках [5--7], так и в более современной литературе [8]. Отличие этой работы --- акцент на специальном виде управления: оно выбирается из класса кусочно-постоянных функций, благодаря чему, как будет показано ниже, множества достижимости и~управляемости являются выпуклыми многогранниками и описываются системами линейных неравенств.

Несмотря на то, что рассматривается линейная управляемая система, методы решения нелинейных задач зачастую состоят в использовании линеаризованных систем. Поэтому предполагается, что полученные в текущей работе результаты могут быть применены при разработке алгоритмов поиска оптимального управления в нелинейном случае.

\indent {\bf 2. Постановка задачи.} Рассмотрим линейную задачу управления. Предположим, что движение управляемого объекта описывается системой обыкновенных дифференциальных уравнений
\begin{equation}
\label{1}
	\dot x = Ax + Bu + c,
\end{equation}
где $x = x(t)$ --- $n$-мерная вектор-функция фазовых переменных;  $u = u(t)$ --- $r$-мерная вектор-функция управлений; $t$ --- независимая переменная (время); $A$ --- матрица $n\times n$; $B$ --- матрица $n\times m$; $c$ --- $n$-мерный вектор.

Цель управления --- перевод объекта из начального положения в  конечное за заранее определенное время~$T$:
\begin{equation}
\label{2}
	x(0) = x_*, \quad x(T) = x^*.
\end{equation}

Пусть управления $u_i(t)$ будут выбираться из класса кусочно-постоянных функций с заданным периодом дискретизации $h = T/N$:
\begin{equation}
\label{3}
\left\{
\begin{array}{ll}
u_i(t) = u_{i,k}, &\text{если } (k-1)h \leqslant t < kh, \\
k = \overline{1, N}, &i = \overline{1,m}.
\end{array}
\right.
\end{equation}
При этом на них наложены прямые ограничения:
\begin{equation}
\label{4}
	l_{*i} \leqslant u_i(t) \leqslant l^*_i.
\end{equation}

Обычно задача управления дополняется критерием качества, но он не имеет значения при исследовании множеств достижимости и управляемости. Поэтому будем рассматривать задачу управления (\ref{1})--(\ref{4}).

Определимся с тем, что будем понимать под множеством достижимости и множеством управляемости.

\textbf{Определение 1.} Пусть в момент $\hat{t}$ ($0\leqslant \hat{t} < T$) управляемый объект находится в со\-стоя\-нии $\hat{x}$. Будем называть \textit{множеством достижимости} $X_1(t, \hat{t}, \hat{x})$ задачи (\ref{1})--(\ref{4})\linebreakмножество всевозможных состояний $x^{(1)}(t)$, где $t \in (\hat{t}, ~T]$, в которые система (\ref{1}) может перейти за время $t-\hat{t}$ при начальном условии $x(\hat{t}) = \hat{x}$ и выборе управления вида (\ref{3}), удовлетворяющего ограничению (\ref{4}):
\begin{equation*}
\begin{array}{c}
X_1(t, \hat{t}, \hat{x}) =  \{x^{(1)}(t) = x(t)~|~\dot x(\tau) \equiv Ax(\tau)+Bu(\tau)+c,~ x(\hat{t}) = \hat{x},~\tau \in [\hat{t},~t],\\
 u(\tau) \text{ удовлетворяет (\ref{3}), (\ref{4})}\}.
 \end{array}
\end{equation*}

\textbf{Определение 2.} Пусть в момент $\hat{t}$ ($0 < \hat{t} \leqslant T$) управляемый объект должен попасть в состояние $\hat{x}$. Будем называть \textit{множеством управляемости} $X_2(t, \hat{t}, \hat{x})$ задачи (\ref{1})--(\ref{4}) множество всевозможных состояний $x^{(2)}(t)$, где $t \in [0, ~\hat{t})$, из которых система (\ref{1}) может перейти за время $\hat{t} - t$ в состояние $x(\hat{t}) = \hat{x}$ и выборе управления вида (\ref{3}), удовлетворяющего ограничению (\ref{4}):
\begin{equation*}
\begin{array}{c}
X_2(t, \hat{t}, \hat{x}) =  \{x^{(2)}(t) = x(t)~|~\dot x(\tau) \equiv Ax(\tau)+Bu(\tau)+c,~ x(\hat{t}) = \hat{x},~\tau \in [t, ~\hat{t}],\\%[0.2cm]
 u(\tau) \text{ удовлетворяет (\ref{3}), (\ref{4})}\}.
 \end{array}
\end{equation*}

Цель данной работы заключается в описании этих множеств в удобном для анализа виде.

\indent {\bf 3. Переход к задаче линейного отображения.} Покажем, что задачи по\-строе\-ния множеств $X_1(t, \hat{t}, \hat{x})$ и $X_2(t, \hat{t}, \hat{x})$ являются эквивалентными и могут быть сведены к задаче линейного отображения выпуклого многогранника.

Выпишем для задачи (\ref{1}) с начальным условием $x(\hat{t}) = \hat{x}$ формулу Коши
\begin{equation}
\label{5}
x(t) = e^{A(t-\hat{t})}\left(\hat{x} + \int\limits_{\hat{t}}^t e^{-A(\tau - \hat{t})}\left(Bu(\tau)+c\right)d\tau\right)
\end{equation}
и воспользуемся представлением управления в виде (\ref{3}).

Среди чисел $\overline{1, N}$ найдем $k_1$ такое, что $(k_1-1)h \leqslant \hat{t} < k_1h$. Аналогично получим число $k_2$ таким образом, что либо $t \in [0, T)$, тогда среди чисел $\overline{1, N}$ можем определить $k_2$, для которого  $(k_2-1)h \leqslant t < k_2h$, либо $t=T$, тогда положим $k_2 = N$.

Зададим последовательность

\begin{equation}
\label{6}
s_k =
\left\{
	\begin{aligned}
		\hat{t} ~~~~&\text{при }k=k_1-1,\\
		kh ~~&\text{при }k=\overline{k_1, k_2-1},\\
		t ~~~~&\text{при }k=k_2.
	\end{aligned}
\right.
\end{equation}

Теперь перепишем (\ref{5}), раскрыв скобки и воспользовавшись представлением уп\-равления в~виде (\ref{3}) с учетом (\ref{6}):
\begin{equation}
\label{7}
x(t) = e^{A(t-\hat{t})}\hat{x} + \sum_{i=1}^m\sum_{k=k_1}^{k_2}\left(\int\limits_{s_{k-1}}^{s_k} e^{A(t-\tau)}b_id\tau u_{i,k}\right)+\int\limits_{\hat{t}}^t e^{A(t-\tau)}cd\tau.
\end{equation}
Здесь $b_i$ обозначает $i$-й столбец матрицы $B$.

Произведем замены:
\begin{equation}
\label{8}
\begin{aligned}
	U_1 &= \left(u_{1,k_1}, u_{2,k_1}, \ldots, u_{m,k_1}, u_{1,k_1+1}, u_{2,k_1+1}, \ldots, u_{m,k_2}\right)^T, \\
	d_{i,k}^{(1)} &= \int\limits_{s_{k-1}}^{s_k} e^{A(t-\tau)}b_id\tau, \\
	D_1 &= \left(d^{(1)}_{1,k_1}, d^{(1)}_{2,k_1}, \ldots, d^{(1)}_{m,k_1}, d^{(1)}_{1,k_1+1}, d^{(1)}_{2,k_1+1}, \ldots, d^{(1)}_{m,k_2}\right), \\
	q_1 &= e^{A(t-\hat{t})}\hat{x} +\int\limits_{\hat{t}}^t e^{A(t-\tau)}cd\tau. \\
\end{aligned}
\end{equation}
Тогда равенство (\ref{7}) с учетом (\ref{8}) перепишем следующим образом:
\begin{equation}
\label{9}
x = D_1U_1 + q_1.
\end{equation}

\so{Замечание}. Вообще говоря, матрица $D_1$ и вектор $q_1$, а следовательно, и вектор $x$ зависят от параметров $t$, $\hat{t}$, $\hat{x}$. Более того, выбор $t$ и $\hat t$ влияет на размер вектора $U_1$ и количество столбцов в $D_1$. Будем считать их зафиксированными, и для простоты опустим обозначения зависимостей.

Таким образом, получили систему линейных алгебраических уравнений, в которых матрица $D_1$ имеет размерность $n\times r$, где $r = m(k_2-k_1+1)$. Конечное значение $r$ определяется выбором точек $t$ и $\hat{t}$, например, при $t=0$ и $\hat{t}=T$ имеем $r=mN$.

Введем $L^{(1)}_1$ и $L^{(1)}_2$ как $r$-мерные векторы, состоящие из $k_2-k_1+1$ повторений векторов $(l_{*1}, \ldots, l_{*m})^T$ и $(l_1^*, \ldots, l_m^*)^T$ соответственно.

Тогда прямые ограничения на компоненты вектора $U_1$ можно переписать так:
\begin{equation}
\label{10}
L^{(1)}_1 \leqslant U_1 \leqslant L^{(1)}_2.
\end{equation}

Как видно, задача построения множества достижимости состоит в нахождении всех векторов $x(t)$ таких, что существует вектор $U_1$, компоненты которого удовлетворяют двусторонним ограничениям (\ref{10}), и выполняется линейное равенство (\ref{9}).

Немного упростим вид задачи (\ref{9}), (\ref{10}). Сделаем замену вектора управлений и вектора фазовых переменных:
\begin{equation}
\label{11}
\begin{aligned}
v_j &= \frac{2U_{1,j} - \left(L^{(1)}_{1,j}+ L^{(1)}_{2,j}\right)}{L^{(2)}_{1,j} - L^{(1)}_{1,j}}, \quad j=\overline{1,r},\\
y &= x - \frac{1}{2}D_1\left(L_1^{(1)}+L_2^{(1)}\right) - q_1.
\end{aligned}
\end{equation}
Также введем матрицу $P$ размера $n\times r$, состоящую из столбцов
$$p_j = \frac{1}{2}D_{1,j}\left(L_{2,j}^{(1)}-L_{1,j}^{(1)}\right),$$
где $D_{1,j}$ --- $j$-й столбец матрицы $D_1$.

В новых переменных (\ref{11}) задача (\ref{9}), (\ref{10}) примет вид
\begin{equation}
\label{12}
\begin{aligned}
y &= Pv, \\
-1 \leqslant v_j \leqslant& \, 1,~j = \overline{1, r}.
\end{aligned}
\end{equation}
Таким образом, для построения множества достижимости необходимо провести линейное отображение $r$-мерного куба в $n$-мерное пространство. В качестве матрицы линейного оператора выступает матрица $P$ размерности $n\times r$.

Аналогичным образом сведем задачу нахождения множества управляемости. Для задачи (\ref{1}) с конечным условием $x(\hat{t}) = \hat{x}$ рассмотрим формулу Коши
\begin{equation}
\label{13}
\hat{x} = e^{A(\hat{t}-t)}\left(x(t) + \int\limits_t^{\hat{t}} e^{-A(\tau - %\hat
{t})}\left(Bu(\tau)+c\right)d\tau\right)\!.
\end{equation}

Среди чисел $\overline{1, N}$ найдем $k_1$ и $k_2$ такие, что $(k_1-1)h \leqslant t < k_1h$, и либо $\hat{t} \in [0, ~T)$, тогда существует $k_2$ такое, что $(k_2-1)h \leqslant \hat{t} < k_2h$, либо $\hat{t}=T$, тогда $k_2 = N$.

Зададим последовательность

\begin{equation}
\label{14}
s_k =
\left\{
	\begin{aligned}
		t ~~~~&\text{при }k=k_1-1,\\
		kh ~~&\text{при }k=\overline{k_1, k_2-1},\\
		\hat{t} ~~~~&\text{при }k=k_2.
	\end{aligned}
\right.
\end{equation}

Перепишем (\ref{13}), раскрыв скобки и воспользовавшись представлением управления в виде (\ref{3}) с учетом (\ref{14}):
\begin{equation}
\label{15}
x(t) = e^{-A(\hat{t}-t)}\hat{x} - \sum_{i=1}^m\sum_{k=k_1}^{k_2}\left(\int\limits_{s_{k-1}}^{s_k} e^{-A(\tau-t)}b_id\tau u_{ik}\right)-\int\limits_t^{\hat{t}} e^{-A(\tau-t)}cd\tau.
\end{equation}

Введем такие обозначения:
\begin{equation}
\label{16}
\begin{aligned}
	U_2 &= \left(u_{1k_1}, u_{2k_1}, \ldots, u_{mk_1}, u_{1k_1+1}, u_{2k_1+1}, \ldots, u_{mk_2}\right)^T, \\
	d_{ik}^{(2)} &= -\int\limits_{s_{k-1}}^{s_k} e^{-A(\tau-t)}b_id\tau, \\
	D_2 &= \left(d^{(2)}_{1k_1}, d^{(2)}_{2k_1}, \ldots, d^{(2)}_{mk_1}, d^{(2)}_{1k_1+1}, d^{(2)}_{2k_1+1}, \ldots, d^{(2)}_{mk_2}\right), \\
	q_2 &= e^{-A(\hat{t}-t)}\hat{x} - \int\limits_t^{\hat{t}} e^{-A(\tau-t)}cd\tau. \\
\end{aligned}
\end{equation}

Тогда равенство (\ref{15}) с учетом (\ref{16}) перепишем как
\begin{equation}
\label{17}
x = D_2U_2 + q_2.
\end{equation}

Равенства (\ref{9}), (\ref{17}) имеют одинаковую форму. Тогда с учетом прямых ограничений задачи построения множества достижимости и множества управляемости могут быть сведены к задаче (\ref{12}). В этом смысле они эквивалентны.

\indent {\bf 4. Свойства множеств.} Здесь и далее будем рассматривать свойства множества достижимости, подразумевая, что они также справедливы и для множества управ\-ляе\-мости.

С учетом результатов сведения в п.\,3 введем два множества.

\textbf{Определение 3.} Будем называть \textit{множеством допустимых управлений} множество $\mathbb{V} = [-1;~1]^r$, а \textit{множеством допустимых состояний} --- множество $\mathbb{Y} = \{y \in \mathbb{R}^n|~~\exists v \in \mathbb{V}: y = Pv\}$.

\textbf{Свойство 1.} $\mathbb{Y}$ --- непустое, ограниченное, замкнутое, выпуклое множество.

Оно следует из того, что множество $\mathbb{V}$ непустое, ограниченное, замкнутое и вы\-пук\-лое, а линейное отображение сохраняет вышеперечисленные свойства.

\textbf{Свойство 2.} $\mathbb{Y}$ --- выпуклая оболочка точек $\{p^1,\dots,p^{2^r}\}$, где $p^k=Pv^k$, $v^k$ --- вершины $\mathbb{V}$.

Множество $\mathbb{V}$, очевидно, является выпуклой оболочкой своих вершин, т.\,е. $\forall v \in V~\exists \lambda_k$, $k=\overline{1,2^r}$: $v=\sum\limits_{k=1}^{2^r}\lambda_kv^k$, где $\sum\limits_{k=1}^{2^r}\lambda_k = 1$, $\lambda_k\geqslant 0$.\newpage

Тогда при $\forall y \in Y ~\exists \lambda_k$
$$
y=\sum\limits_{k=1}^{2^r}\lambda_kPv^k=\sum\limits_{k=1}^{2^r}\lambda_kp^k,\quad \sum\limits_{k=1}^{2^r}\lambda_k = 1, \quad\lambda_k\geqslant 0, \quad k=\overline{1,2^r}.
$$
Следовательно, множество $\mathbb{Y}$ --- выпуклая оболочка векторов $p^k=Pv^k$.

\textbf{Свойство 3.} $\mathbb{Y}$ --- выпуклый многогранник, вершинами которого является подмножество набора векторов $\{p^1,\dots,p^{2^r}\}$, где $p^k=Pv^k$, $v^k$ --- вершины $\mathbb{V}$.

Оно вытекает из свойства 2 и свойств выпуклых оболочек.

\textbf{Свойство 4.} Если $y \in \mathbb{Y}$, то и $-y\in\mathbb{Y}$.

Если $y\in\mathbb{Y}$, то $\exists v\in\mathbb{V}:~ y=Pv$. Но и $-v\in\mathbb{V}$, а следовательно, $P(-v)=-y\in\mathbb{Y}.$

\textbf{Свойство 5.} Множество $\mathbb{Y}$ описывается системой неравенств типа $-b~\leqslant $ $Ay~\leqslant ~b$.

Это множество является выпуклым многогранником и может быть описано системой линейных неравенств. По свойству 4, если выполняется $a_iy\leqslant b_i$, то это неравенство будет справедливо и для $-y: a_i(-y)\leqslant b_i$. Тогда $-b_i\leqslant a_iy$.

\indent {\bf 5. Обзор алгоритмов.} Существует несколько подходов к решению задачи (\ref{12}). Коротко опишем их ниже.

{\it 1. Построение выпуклой оболочки.} Как было показано в свойстве 3, многогранник $\mathbb{Y}$ есть выпуклая оболочка точек $Pv^k$, где $v^k$ --- вершины куба $\mathbb{V}$. Однако уже при достаточно небольшой размерности $r$ такой подход выглядит нереализуемым, учитывая вычислительную сложность алгоритмов построения выпуклых оболочек. Так, при $r=100$ будет получено $2^{100} \approx 10^{30}$ вершин куба.

{\it 2. Суммы Минковского.} Отложим в пространстве $\mathbb{R}^n$ $r$ отрезков: от точки $-p^1$ до точки $p^1$, от точки $-p^2$ до точки $p^2$ и т.\,д. Тогда найдем множество $\mathbb{Y}_1$ как геометрическое место точек, принадлежащих первому отрезку: $\mathbb{Y}_1 = \{y \in \mathbb{R}^n|~y= \gamma p^1, -1 \leqslant \gamma \leqslant 1\}$. Множество $\mathbb{Y}_2$ определим как сумму Минковского множества $\mathbb{Y}_1$ и второго отрезка: $\mathbb{Y}_2 = \{y_1 + y_2 \in \mathbb{R}^n|~y_1 \in \mathbb{Y}_1, ~y_2= \gamma p^2, -1 \leqslant \gamma \leqslant 1\}$. Продолжим строить суммы для всех отрезков, и в конце получим множество $\mathbb{Y}$
$$
\mathbb{Y} = \left\{y_1 + y_2 \in \mathbb{R}^n|~y_1 \in \mathbb{Y}_{r-1}, ~y_2= \gamma p^r, -1 \leqslant \gamma \leqslant 1\right\}.
$$
К сожалению, и такой подход также имеет экспоненциальную сложность. На первом шаге будет построен отрезок, соединяющий две точки, на втором --- многоугольник с четырьмя вершинами, а на последнем --- многогранник, который может содержать $2^r$ вершин.

{\it 3. Алгоритм Фурье\,---\,Моцкина.} Более перспективными выглядят алгоритмы, работающие не с вершинами многогранника, а с его гранями. К ним относится метод элиминации Фурье\,---\,Моцкина [9]. Его суть заключается в исключении переменных из системы неравенств. Метод итеративно удаляет по одной переменной из неравенств. Тогда, если рассмотреть систему (\ref{12}) как систему неравенств относительно переменных $y$ и $v$, задача сведется к исключению $r$ переменных $v_i$ из этой системы.

Тем не менее и у такого подхода есть недостаток --- при исключении переменных генерируeтся слишком много избыточных ограничений, и, если не отсеивать их на каждом шаге, в концу алгоритма будет получена система из $n \cdot 2^r$ неравенств.


Построим более эффективный алгоритм.

\indent {\bf 6. Основной результат.} На первом шаге необходимо удалить лишние (линейно зависимые) переменные состояния. Если ранг матрицы $P$ меньше количества строк, выделим $n-\operatorname{rank} P$ компонент вектора $y$ и выразим их через остальные. Таким образом, будет получено $n-\operatorname{rank} P$ ограничений типа равенств. В дальнейшем будем предполагать, что этот этап пройден и в распоряжении имеется матрица $P$ полного ранга: $\operatorname{rank}P = n \leqslant r$. Кроме того, будем подразумевать, что $n \geqslant 2$ (при $n=1$ алгоритм построения множества довольно очевиден).

Теперь будем перебирать столбцы матрицы $P$. Выберем $n-1$ линейно независимых столбцов и найдем фундаментальную систему решений относительно вектора-строки $\tilde a$ для уравнения
\begin{equation}
\label{18}
\tilde a \left(p^{j_1}, \dots, p^{j_{n-1}}\right) = 0.
\end{equation}
Это однопараметрическое семейство решений. Выберем из него какое-нибудь значение. Например, для единственности решения можно добавить ограничение $\|\tilde a\| = 1$. По сути вектор $\tilde a$ является нормальным вектором гиперплоскости в пространстве $\mathbb{R}^n$, построенной по векторам  $p^{j_1}, \dots, p^{j_{n-1}}$.

Теперь умножим $\tilde a$ на матрицу $P$ и найдем максимум произведения полученного выражения на вектор $v \in \mathbb{V}$:
\begin{equation}
\label{19}
\tilde \beta = \max_{v\in \mathbb{V}} \tilde a P v = \sum_{j=1}^r |\tilde a p^j|,
\end{equation}
где $\tilde a P$ представляет собой $r$-мерную вектор-строку, содержащую значения проекций вектора $\tilde a$ на столбцы матрицы $P$. Причем по построению проекции на векторы  $p^{j_1}, \dots, p^{j_{n-1}}$ равны нулю. Поскольку компоненты вектора $v$ изменяются от $-1$ до $1$ и не зависят друг от друга, то максимальное значение слагаемого $\tilde a p^j v_j$ достигается при $v = \operatorname{sgn} (a p^j)$ и равно $|a p^j|$.

Введем матрицу $A$, состоящую из векторов-строк $\tilde{a}$, построенных для всех наборов линейно независимых (л.н.з.) столбцов $p^{j_1}, \dots, p^{j_{n-1}}$ матрицы $P$, и вектор $b$, состоящий из чисел $\tilde{\beta}$, соответствующих строкам $\tilde{a}$. Также введем множество $$\bar{\mathbb{Y}} = \{y \in \mathbb{R}^n|~-b \leqslant Ay \leqslant b\}.$$

\textbf{Теорема.} \textit{$y \in \mathbb{Y}$ тогда и только тогда, когда $y \in \bar{\mathbb{Y}}$.}

\so{Доказательство}. \textit{Необходимость.} Пусть вектор $y \in \mathbb{Y}$. Значит, су\-щест\-вует вектор $v$ такой, что $y = Pv$ и $v \in \mathbb{V}$. Покажем, что $-b~\leqslant~Ay~\leqslant~b$.

Подставляя в это неравенство выражение $Pv$ вместо $y$, для строки $l$ получим
$$-\beta_l \leqslant a_lPv \leqslant \beta_l,$$
или, что то же,
$$-\sum_{j=1}^r |a_lp^j| \leqslant \sum_{j=1}^ra_lp^jv_j \leqslant \sum_{j=1}^r |a_lp^j|.$$
А поскольку  $v_j \in [-1; 1],~j=\overline{1, r}$, неравенство, очевидно, выполняется для любого $l=\overline{1,k}$, а значит, $y \in\bar{\mathbb{Y}}$.

\textit{Достаточность.}

I. Рассмотрим матрицу $A$, размерность которой $k\times n$, где $k$ --- количество различных наборов из $n-1$ линейно независимых столбцов матрицы $P$. Для начала покажем, что $k\geqslant n$. Поскольку $\operatorname{rank}P = n$, то в матрице $P$ найдется $n$ л.н.з. столбцов. Тогда из них можно составить $n$ наборов по $n-1$ л.н.з. столбцов в каждом.

Теперь покажем, что $\operatorname{rank}A = n$. Составим матрицу $\bar{P}$ из $n$ л.н.з. столбцов матрицы $P$: $\bar{P} = (p^{j_1}, \dots, p^{j_n})$. По построению в матрице $A$ найдутся такие $n$ столбцов $a_{l_1}, \dots, a_{l_n}$, что
$$a_{l_i}p^{j_1} = \dots = a_{l_i}p^{j_{i-1}}  = a_{l_i}p^{j_{i+1}}  = \dots = a_{l_i}p^{j_n}  = 0, \quad  i = \overline{1,n}.$$
Составим из этих строк матрицу $\bar{A}$. Тогда
$$\bar{A}\bar{P} = \left(
\begin{matrix}
a_{l_1}p^{j_1}  & 0 & \cdots & 0 \\
0 & a_{l_2}p^{j_2} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & a_{l_n}p^{j_n}
\end{matrix}
\right).
$$


Далее предположим, что $a_{l_i}p^{j_i} = 0$. Это означает, что $a_{l_i}\bar{P} = (0~0~\dots~0)$, из чего следует линейная зависимость столбцов матрицы $\bar{P}$, что противоречит условиям. Потому $a_{l_i}p^{j_i} \neq 0$ $\forall i = \overline{1,n}$. Тогда $\det(\bar{A}\bar{P}) \neq 0$, следовательно, $\det(\bar{A}) \neq 0$ или, что то же, $\operatorname{rank}\bar{A} = n$.

Так как матрица $\bar{A}$ составлена из строк матрицы $A$, то $\operatorname{rank}A \geqslant n$. Но поскольку $A$ содержит $n$ столбцов, то $\operatorname{rank}A = n$.

II. Для доказательства достаточности стоит показать: для любой точки $y \in \bar{\mathbb{Y}}$ найдется такая точка $v \in \mathbb{V}$, что будет справедливо $y = Pv$. Для начала докажем это для вершин множества $\bar{\mathbb{Y}}$.

Выберем такую точку $\hat{y}$ из пространства $\mathbb{R}^n$, что выполняется $-b\leqslant A\hat{y}\leqslant b$. При этом среди данных неравенств существуют $n$ таких ограничений, что:

1) строки $a_{l_1}, \dots, a_{l_n}$, порождающие эти неравенства, являются л.н.з.;

2) в точке $\hat{y}$ эти неравенства переходят в равенства по одному из двусторонних ограничений. Не умаляя общности, будем считать, что в равенства переходят верхние ограничения: $a_{l_i}\hat{y} = \beta_{l_i},\, i = \overline{1,n}$.

При таких условиях точка $\hat{y}$ будет являться вершиной многогранника $\bar{\mathbb{Y}}$.

Поскольку $\operatorname{rank}P = \operatorname{rank}\{P, \hat{y}\} = n$, система уравнений $Pv = \hat{y}$ будет иметь по крайней мере одно решение. Необходимо показать существование решения при $v \in \mathbb{V}$.

Предположим от противного: для любого вектора $v$, являющегося решением системы $Pv = \hat{y}$, найдется номер $j^*$, что $|v_{j^*}| > 1$.

III. Определим вектор $\hat{v}: P\hat{v} = \hat{y}$ так, чтобы он обладал рядом удобных свойств. Для этого выберем некоторое равенство $a_{l_i}\hat{y} = \beta_{l_i}$. Для удобства обозначим $\bar{a} = a_{l_i}$, $\bar{\beta} = \beta_{l_i}$.

Столбцы матрицы $P$ можно разделить на два класса: ортогональные и неортогональные со строкой $\bar{a}$. Пусть число $r_1$ обозначает количество ортогональных столбцов. Из свойств строки $\bar{a}$ и матрицы $P$ следует, что $r_1 \geqslant n-1$, но при этом существует по крайней мере один неортогональный столбец. Для простоты переставим столбцы $P$ таким образом, что сначала будут идти ортогональные:
\begin{equation*}
\left\{
	\begin{array}{l}
		\bar{a} p^j = 0, ~j=\overline{1, r_1}, \\
		\bar{a} p^j \neq 0,~ j=\overline{r_1+1, r}.
	\end{array}
	\right.
\end{equation*}

Теперь положим, что $\hat{v}_j = \operatorname{sgn} (\bar{a} p^j)$, $j=\overline{r_1+1, r}$. В таком случае равенство $\bar{a} \hat{y} = \bar{\beta}$ будет выполняться вне зависимости от значений остальных $\hat{v}_j$:
$$
\bar{a} \hat{y} = \bar{a} P \hat{v} = \sum_{j=1}^r \bar{a} p^j \hat{v}_j = \sum_{j=r_1+1}^r \bar{a} p^j \operatorname{sgn} (\bar{a} p^j) = \sum_{j=r_1+1}^r |\bar{a} p^j| = \bar{\beta}.
$$

Далее зададимся вопросом нахождения $\hat{v}_1, \dots, \hat{v}_{r_1}$. По построению $\bar{a}$ известно, что существует набор из $n-1$ л.н.з. столбцов матрицы $P$, ортогональных со строкой $\bar{a}$. Следовательно, $\operatorname{rank}\{p^1, \dots, p^{r_1} \} = n-1$. Тогда можно выделить $n-1$ столбцов, как базис этого подпространства, и выразить через них остальные столбцы. Пусть базисными будут столбцы $p^1, \dots, p^{n-1}$:
%
\begin{equation}
\label{lin_dep}
	c_{1,j}p^1 + \dots + c_{n-1,j}p^{n-1} + p^j = 0, \quad j = \overline{n, r_1}.
\end{equation}

Далее введем обозначения:
\begin{equation*}
	\hat{A} = \left(
	\begin{matrix}
		a_{l_1}\\
		\vdots\\
		a_{l_{i-1}}\\
		a_{l_{i+1}}\\
		\vdots\\
		a_{l_n}
	\end{matrix}\right), \quad
	\hat{b} = \left(
	\begin{matrix}
		\beta_{l_1} - \sum_{j=r_1+1}^r a_{l_1}p^j \hat{v}_j\\
		\vdots\\
		\beta_{l_{i-1}} - \sum_{j=r_1+1}^r a_{l_{i-1}}p^j \hat{v}_j\\
		\beta_{l_{i+1}} - \sum_{j=r_1+1}^r a_{l_{i+1}}p^j \hat{v}_j\\
		\vdots\\
		\beta_{l_n} - \sum_{j=r_1+1}^r a_{l_n}p^j \hat{v}_j
	\end{matrix}\right).
\end{equation*}

Тогда имеет место система из $n-1$ уравнений с $r_1$ неизвестными:

\begin{equation}
\label{sys}
	\hat{A}(p^1\hat{v}_1 + \dots + p^{r_1}\hat{v}_{r_1}) = \hat{b}.
\end{equation}
Будем называть \textit{базисными переменными} те $\hat{v}_j$, которые стоят при столбцах, входящих в базис подпространства, а решение системы (\ref{sys}) \textit{базисным}, если небазисныe переменныe равны нулю. Дополнительно обозначим множество индексов базисных переменных символом $B$, а небазисных --- $NB$.

\textbf{Лемма.} \textit{Если для любого решения системы} (\ref{sys}) {\it найдется номер $j^*$ такой, что $|\hat{v}_{j^*}| > 1$, то существуют такие базисное решение $\tilde{v}$ и номер $j'$, что $|\tilde{v}_{j'}| > 1 + \sum_{j\in NB}|c_{j',j}|$.}

\so{Доказательство}. Для простоты пусть $B = \{1, \dots, n-1\}$, а тогда $NB = \{n, n+1, \dots, r_1\}$. Введем матрицу $P_1$, состоящую из столбцов $(p^1, \dots, p^{n-1})$.

Поскольку размер матрицы $\hat{A} P_1$   $(n-1)\times (n-1)$ и ее ранг равен $n-1$, то для заданного базиса система (\ref{sys}) имеет единственное решение. Найдем его и обозначим $\tilde{v}_1, \dots, \tilde{v}_{n-1}$.

Докажем лемму методом индукции в зависимости от количества небазисных столбцов.

1. Пусть $r_1 = n-1$. По условию леммы существует такое $j^*$, что $|\tilde{v}_{j^*}| > 1$.

2. Пусть $r_1 = s$, $s > n-1$ и существуют базис $\{1, \dots, n-1\}$ и номер $j_1$, что $|\tilde{v}_{j_1}| > 1 + \sum_{j=n}^{s-1}|c_{j_1,j}|$. Необходимо показать, что есть такое базисное решение $\tilde{v}$ и номер $j'$, что $|\tilde{v}_{j'}| > 1 + \sum_{j\in NB}|c_{j',j}|$.

Перепишем (\ref{sys}), подставив базисное решение:
\begin{equation*}
	\hat{A}(p^1\tilde{v}_1 + \dots + p^{n-1}\tilde{v}_{n-1}) = \hat{b}.
\end{equation*}
В левой части равенства вычтем и прибавим выражение $\hat{A} p^s \lambda_s$, где $\lambda_s$ --- некоторый параметр:
\begin{equation*}
	\hat{A}(p^1\tilde{v}_1 + \dots + p^{n-1}\tilde{v}_{n-1} - p^s \lambda_s + p^s \lambda_s) = \hat{b}.
\end{equation*}

Теперь для вычитаемой части представим $p^s$ в виде линейной комбинации столбцов $p^1, \dots,$ $ p^{n-1}$ согласно (\ref{lin_dep}):
\begin{equation*}
	\hat{A}\left(p^1(\tilde{v}_1+c_{1,s}\lambda_s) + \dots + p^{n-1}(\tilde{v}_{n-1}+c_{n-1,s}\lambda_s) + p^s \lambda_s\right) = \hat{b}.
\end{equation*}

Таким образом, получим новое решение системы (\ref{sys}), зависящее от параметра~$\lambda_s$:\pagebreak

\begin{equation*}
\hat{v}_j =
\left\{
	\begin{array}{l}
		\tilde{v}_j + c_{j,s}\lambda_s,~~ j=\overline{1,n-1}, \\[0.2cm]
		0, ~~j=\overline{n,s-1}, \\[0.2cm]
		\lambda_s, ~~j=s.
	\end{array}
	\right.
\end{equation*}
Будем рассматривать $\lambda_s$ в пределах от $-1$ до $1$.

По условию существует номер $j_1$, что $|\tilde{v}_{j_1}| > \mu$, где $\mu = 1 + \sum_{j=n}^{s-1}|c_{j_2,j}|$. Рассмотрим, что произойдет с $\hat{v}_{j_1}$ при варьировании $\lambda_s$.
Не умаляя общности, предположим, что $|\hat{v}_{j_1}|$ возрастает при увеличении $\lambda_s$, т.\,е. $|\tilde{v}_{j_1} + c_{j_1,s}| = |\tilde{v}_{j_1}| + |c_{j_1,s}|$. Тогда возможны два варианта:

а) при уменьшении $\lambda_s$ до $-1$ абсолютное значение  $\hat{v}_j$ остается больше $\mu$. Следовательно, $|\tilde{v}_{j_1} - c_{j_1,s}| = |\tilde{v}_{j_1}| - |c_{j_1,s}| > 1 + \sum_{j=n}^{s-1}|c_{j_1,j}|$. В таком случае лемма доказана и $j' = j_1$;

б) найдется число $\lambda_s^1$ в пределах $(-1,~0)$, что $|\tilde{v}_{j_1} + \lambda_s^1 c_{j_1,s}| = \mu$. В этом случае по условию леммы при $\lambda_s = \lambda_s^1$
существует номер $j_2$, для которого справедливо $|\tilde{v}_{j_2} + \lambda_s^1 c_{j_2,s}| > \mu$. Тогда посмотрим, в каком направлении изменяется $|\hat{v}_{j_2}|$ при стремлении $\lambda_s$ к $-1$. Если $|\hat{v}_{j_2}|$ уменьшается, то по аналогии с $j_1$ либо $j' = j_2$, либо есть число $\lambda_s^{2}$ ($-1<\lambda_s^{2} < \lambda_s^{1}$), для которого выполняется равенство $|\hat{v}_{j_2} + \lambda_s^{2} c_{j_2,s}| = \mu$. При этом найдется номер $j_3$ такой, что $|\tilde{v}_{j_3} + \lambda_s^{2} c_{j_3,s}| > \mu$. Продолжая по той же логике, для некоторого номера $j_k$ окажется, что $|\tilde{v}_{j_k} - c_{j_k,s}| > \mu$, следовательно, $j' = j_k$.

Если же $|\hat{v}_{j_2}|$ возрастает при уменьшении $\lambda_s$, т.\,е. $|\tilde{v}_{j_2} - c_{j_2,s}| = |\tilde{v}_{j_2}| + |c_{j_2,s}|$, то с учетом непрерывной зависимости $\hat{v}_{j_1}$ и $\hat{v}_{j_2}$ от $\lambda_s$ можно определить небольшое положительное число $\varepsilon$, для которого справедлива система

$$
\left\{
\def\arraystretch{1.2}
	\begin{array}{l}
		 \left|\tilde{v}_{j_1}+(\lambda_s^1+\varepsilon)c_{j_1,s}\right| = |\tilde{v}_{j_1}|+(\lambda_s^1+\varepsilon)|c_{j_1,s}|  > \mu, \\[0.2cm]
		 \left|\tilde{v}_{j_2}+(\lambda_s^1+\varepsilon)c_{j_2,s}\right| = |\tilde{v}_{j_2}|-(\lambda_s^1+\varepsilon)|c_{j_2,s}|  >  \mu.
	\end{array}
\right.
$$
Тогда умножим второе неравенство на $\left|\frac{c_{j_1,s}}{c_{j_2,s}}\right|$  и прибавим к первому:
\begin{equation}\label{22}
		 |\tilde{v}_{j_1}|+\left|\frac{c_{j_1,s}}{c_{j_2,s}}\right||\tilde{v}_{j_2}|  > \mu\left(1+\left|\frac{c_{j_1,s}}{c_{j_2,s}}\right|\right).
\end{equation}
Теперь необходимо перестроить базис --- внести столбец $p^s$ вместо $p^{j_2}$:
$$
B_s = B\textbackslash\{j_2\}\cup \{s\}, \quad NB_s = NB\cup\{j_2\} \textbackslash\{s\}.
$$
Для этого нужно найти такое $\lambda_s$, что $\hat{v}_{j_2}$ обратится в нуль. Новое базисное решение можно выразить через старое следующим образом:
$$ \tilde{v}^{(s)} =
\left\{
	\begin{array}{ll}
		\tilde{v}_j - \frac{c_{j,s}}{c_{j_2, s}}\tilde{v}_{j_2},& j \in B_s\textbackslash\{s\}, \\[0.2cm]
		- \frac{1}{c_{j_2, j}}\tilde{v}_{j_2},&  j=s, \\[0.2cm]
		0,& j = j \in NB_s.
	\end{array}
	\right.
$$

Также изменится представление небазисных столбцов через базисные:
$$
	\sum_{k\in B_1} c^{(s)}_{k, j}p^k + p^j = 0~\quad \forall  j\in NB_1,
$$
где
$$
c^{(s)}_{k,j} =
\left\{
	\begin{array}{lll}
		c_{k,j} - c_{j_2,j}\frac{c_{k,s}}{c_{j_2,s}},&\forall  k\in B_s\textbackslash\{s\}, &\forall  j\in NB_s\textbackslash\{j_2\}, \\[0.2cm]
		-c_{j_2,j}\frac{1}{c_{j_2,s}},&  k=s, &\forall  j\in NB_s\textbackslash\{j_2\}, \\[0.2cm]
		\frac{c_{k,s}}{c_{j_2,s}},&\forall  k \in B_s\textbackslash\{s\}, &  j=j_2, \\[0.2cm]
		\frac{1}{c_{j_2, s}},& k=s, & j=j_2. \\
	\end{array}
	\right.
$$

Следовательно, необходимо показать: в базисном решении $\hat{v}_j$ существует такой номер $j'$, что $|\tilde{v}_{j'}^{(s)}| > 1 + \sum_{j\in NB_s}\left|c^{(s)}_{j',j}\right|$.

Из выдвинутых ранее предположений известно, что $\tilde{v}_{j_1}c_{j_1,s} > 0$, а $\tilde{v}_{j_2}c_{j_2,s} < 0$. Отсюда можно сделать вывод, что $\tilde{v}_{j_1}\left(\frac{c_{j_1,s}}{c_{j_2,s}}\tilde{v}_{j_2}\right) < 0$, а потому $|\tilde{v}_{j_1}^{(s)}| = \left|\tilde{v}_{j_1} - \frac{c_{j_1,s}}{c_{j_2, s}}\tilde{v}_{j_2}\right| = \left|\tilde{v}_{j_1}\right| + \left|\frac{c_{j_1,s}}{c_{j_2, s}}\tilde{v}_{j_2}\right|$. Используя (\ref{22}), получим неравенство
$$
|\tilde{v}_{j_1}^{(s)}| > \left(1 + \sum_{j=n}^{s-1}|c_{j_2,j}|\right) \left(1+\left|\frac{c_{j_1,s}}{c_{j_2,s}}\right|\right) > 1 + \left|\frac{c_{j_1,s}}{c_{j_2,s}}\right| + \sum_{j=n}^{s-1}\left| c_{j_2,j}\frac{c_{j_1,s}}{c_{j_2,s}}\right|,
$$
или в других обозначениях:
$$
|\tilde{v}_{j_1}^{(s)}| > 1 + \left|c^{(s)}_{j_1,j_2}\right| + \sum_{j=n}^{s-1}\left|c^{(s)}_{j_1,j}\right| = \sum_{j\in NB_s}\left|c^{(s)}_{j_1,j}\right|.
$$
Для этого случая $j' = j_1$.
Таким образом, лемма доказана, и можем вернуться к доказательству основной теоремы. \qed

Для простоты определим базисными переменными $\tilde{v}_1, \dots, \tilde{v}_{n-1}$. Также положим $j' = 1$, а $c_{j', j}$ переобозначим как $c_j$. Тогда можем доопределить вектор $\hat{v}$:
$$
\left\{
	\begin{array}{l}
		\hat{v}_1 > 1 + \sum_{j=n}^{r_1}|c_j|,\\[0.2cm]
		\hat{v}_j = 0, ~j=\overline{n, r_1}. \\
	\end{array}
	\right.
$$

IV. Покажем, что среди строк матрицы $A$ существует строка $a^*$ такая, что

1) $a^*p^2 = a^*p^3 = \dots = a^*p^{n-1} = 0$;

2) $\operatorname{sgn} (a^*p^1) = \operatorname{sgn} (\hat{v}_1)$;

3) $(a^*p^j)(\bar{a} p^j) \geqslant 0 \quad \forall j = \overline{1,r}$.

Известно, что $\operatorname{rank}\{p^1, p^2, \dots, p^{n-1}\} = n-1$. Поскольку $\operatorname{rank}P = n$, то в этой матрице найдется такой столбец $p^s$, что $\operatorname{rank}\{p^1, p^2, \dots, p^{n-1}, p^s\} = n$, а тогда $\operatorname{rank}\{p^2, \dots, p^{n-1}, p^s\} = n-1$.

По построению в матрице $A$ существует такая строка $a$, что $ap^2 = ap^3 = \dots = ap^{n-1} = ap^s = 0$, но $ap^1 \neq 0$.

Благодаря тому, что неравенства $-\beta_l \leqslant a_ly \leqslant \beta_l$ инвариантны относительно нуля, в матрице $A$ можно заменить строку $a_l$ строкой $-a_l$. Следовательно, можно добиться выполнения $ap^1\hat{v}_1 > 0$.

Таким образом, показано существование вектора $a$, удовлетворяющего требованиям 1 и 2. Выполнение требования 3 покажем по индукции.

{\it База.} Для $j=\overline{1, n-1}$ выполняется очевидно, поскольку $\bar{a} p^j = 0$.

{\it Шаг индукции.} Пусть $(ap^j)(\bar{a} p^j) \geqslant 0$ для $j=\overline{1,k-1}$, но $(ap^k)(\bar{a} p^k) < 0$. Тогда существуют два неотрицательных числа $\gamma_1$ и $\gamma_2$, для которых справедливо $\gamma_1 ap^k +  \gamma_2 \bar{a} p^k = 0$. Введем строку $a^* = \gamma_1 a +  \gamma_2 \bar{a} $, в этом случае $a^*p^k = 0$. Поскольку $\bar{a}$ ортогональна с векторами $p^1, p^2, \dots, p^{n-1}$, а, в свою очередь, $a$ ортогональна с векторами  $p^2, \dots, p^{n-1}, p^s$, то справедливо
$$a^*p^j =(a + \bar{a})p^j=0 \quad\forall j=\overline{2, n-1}.$$
При этом $a^*p^1\hat{v}_1 = a p^1\hat{v}_1 > 0$. Это означает, что строка $a^*$ удовлетворяет требованиям 1 и 2.

Кроме того, при $\forall j = \overline{1,k}$
$$
(a^*p^j)(\bar{a} p^j) = (\gamma_1 ap^j +  \gamma_2 \bar{a} p^j)(\bar{a} p^j) = \gamma_1 (ap^j)(\bar{a} p^j) +  \gamma_2 (\bar{a} p^j)(\bar{a} p^j) \geqslant 0.
$$
Осталось показать, что $a^*$ входит в матрицу $A$. В матрице $A$ существует строка $a_l$, построенная как решение системы из $n-1$ уравнений:
$$
a_lp^2 = \dots = a_lp^{n-1} = a_lp^k = 0.
$$
Поскольку решение данной системы представляет собой однопараметрическое семейство и $a^*$ является еe решением, то $a_l$ и $a^*$ совпадают с точностью до множителя. Так как множитель не влияет на выполнение свойств (и строку всегда можно умножить на $-1$), можно говорить о том, что $a^*$ есть строка матрицы $A$.

Таким образом, по индукции показано, что найдется строка $a^*$, удовлетворяющая трем требованиям.

V. Найдем  $\beta^* =  \max_{v\in \mathbb{V}}(a^*Pv)$. Ранее было определено, как небазисные столбцы выражаются через базисные (\ref{lin_dep}). Воспользуемся тем фактом, что $a^*p^j = 0$ для $j=\overline{2, n-1}$. Умножив равенства (\ref{lin_dep}) на $a^*$ слева, получим равенства
\begin{equation*}
\label{dep}
a^*p^j = -c_ja^*p^1~ ~\forall j=\overline{n,r_1}.
\end{equation*}
Тогда
$$
\beta^* = a^*p^1 \operatorname{sgn} \left(a^*p^1\right) +  \sum_{j=n}^{r_1}\left(-c_ja^*p^1\right)\operatorname{sgn} \left(-c_ja^*p^1\right) + \sum_{j=r_1+1}^{r}\left|a^*p^j\right|  =
$$
$$
= \left|a^*p^1\right|\left(1 + \sum_{j=n}^{r_1}|c_j|\right) + \sum_{j=r_1+1}^{r}\left|a^*p^j\right|.
$$

Теперь найдем значение  $a^*P\tilde{v}$. Поскольку $a^*p^j = 0, ~j=\overline{2,n-1}$, $\hat{v}_j = 0$, $j=\overline{n,r_1}$, и $\hat{v}_j = \operatorname{sgn} (\bar{a} p^j), ~ j=\overline{r_1+1,r}$, получим выражение
$$
a^*P\hat{v} = a^* p^1\hat{v}_1 +  \sum_{j=r_1+1}^{r}a^*p^j \operatorname{sgn} (\bar{a} p^j).
$$
%
Поскольку $(a^*p^j)(\bar{a} p^j) > 0$, то $\operatorname{sgn} (a^*p^j) = \operatorname{sgn} (\bar{a} p^j)$. Учитывая $a^*Pv_1 > 0$, найдем, что
$$
a^*P\hat{v} = \left|a^* p^1\right|\left|\hat{v}_1 \right| +  \sum_{j=r_1+1}^{r}\left|a^* p^j\right|.
$$
Наконец, оценим выражение $a^*P\hat{v} - \beta^*$:
$$
a^*P\hat{v} - \beta^* =  \left|a^* p^1\right| \left(\left|\hat{v}_1 \right| - 1 - \sum_{j=n}^{r_1}|c_j| \right) > 0.
$$
Следовательно, $a^*P\hat{v} > \beta^*$, а так как $\hat{y} = P\hat{v}$, то $a^*\hat{y} > \beta^*$. Таким образом, показано противоречие: $\hat{y} \notin \bar{\mathbb{Y}}$. Значит, существует $\hat{v}$ такое, что $\hat{y} = P\hat{v}$ и $\hat{v} \in \mathbb{V}$.

VI. Было показано, что вершины многогранника $\bar{\mathbb{Y}}$ принадлежат множеству $\mathbb{Y}$, обозначим их $y^1, \dots, y^h$.

Известно, что многогранник может быть описан, как выпуклая оболочка своих вершин, т.\,е. $y \in \bar{\mathbb{Y}}$ тогда и только тогда, когда $y = \sum_{i=1}^h \lambda_i y^i$, где $\sum_{i=1}^h\lambda_i = 1, \lambda_i \geqslant 0$. Так как $y^i \in \mathbb{Y}$, то существует вектор $v^i \in \mathbb{V}$, для которого $y^i = Pv^i$. Значит, $y = \sum_{i=1}^h \lambda_i y^i = \sum_{i=1}^h \lambda_i Pv^i = Pv$.

Поскольку $\mathbb{V}$ --- выпуклое множество, то выпуклая оболочка точек, принадлежащих ему, входит в его состав. Следовательно, $v = \sum_{i=1}^hv^i \in \mathbb{V}$, поэтому $y \in \mathbb{Y}$. В результате показано, что если $y \in \bar{\mathbb{Y}}$, то $y \in \mathbb{Y}$. \qed

\indent {\bf 7. Анализ алгоритма.} В итоге алгоритм построения множества достижимости задачи (\ref{12}) состоит из следующих фаз:

1) исключение линейно-зависимых уравнений из системы $y=Pv$. Для этого можно воспользоваться методом Гаусса. В результате будет получено $n-n_1$ линейных уравнений относительно $y$, если $\operatorname{rank} P = n_1$;

2) составление матрицы $A$ из строк $\tilde{a}$  (\ref{18}) и вектора $b$ из чисел $\tilde{\beta}$ (\ref{19}). Максимально возможное количество строк в матрице $A$ --- число сочетаний $C^{n_1}_r$. Найти строки $\tilde{a}$ можно как решение системы (\ref{18}) или как обобщение векторного произведения на $n_1$-мерное пространство. Например, для трехмерного пространства строку $\tilde{a}$ для столбцов $p^{j_1}$ и $p^{j_2}$ можно найти как определитель
$$
\tilde{a} =
\begin{vmatrix}
\vec{i} & p^{j_1}_1 & p^{j_2}_1\\
\vec{j} & p^{j_1}_2 & p^{j_2}_2\\
\vec{k} & p^{j_1}_3 & p^{j_2}_3\\
\end{vmatrix}.
$$
Таким образом, задачу можно свести к подсчету $C^{n_1}_r$ $n_1$-мерных определителей.

\indent {\bf 8. Заключение.} В работе был предложен алгоритм построения множеств достижимости и управляемости для линейной задачи управления с двусторонними ограничениями. Алгоритм состоит в переходе от задачи $(\ref{1})$--$(\ref{4})$ к системе $(\ref{12})$, построении системы линейных неравенств относительно $y$ и обратному переходу к переменным $x(t)$. В результате будет найдено множество достижимости (управляемости), заданное системой линейных ограничений.

Кроме непосредственного использования этих множеств, существуют еще два полезных применения:

 $\bullet$\,\,\,в задаче управления с внешним возмущением, которое может вносить существенные коррективы в движение управляемого объекта, а управление в связи с этим периодически перестраивается в режиме реального времени [10], может быть полезно при каждом пе\-ре\-строе\-нии оценивать, является ли  желаемое положение системы достижимым;

$\bullet$\,\,\,нелинейные задачи управления могут решаться с помощью линеаризаций системы. Так, в работе [11] описывается алгоритм построения управления для нелинейной системы, состоящий в последовательной линеаризации системы и построении управления уже для линейной системы. Однако из-за неточности линеаризаций в~ка\-кой-то момент может оказаться, что желаемое финальное состояние недостижимо. Вероятность возникновения этой проблемы можно минимизировать, если на каждом шаге оценивать, как далеко финальное состояние находится от границы множества достижимости.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{07/lit-ra}

%\newpage
\input{07/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
