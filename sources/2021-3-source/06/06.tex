%
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,17.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ИНФОРМАТИКА} \vspace{1.2cm}%1.8cm}

\noindent{\small УДК 004.9:003.26\\ %  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\ %
MSC 11Т71

}

\vskip3mm

\noindent{\bf Пример внутренней функции для схемы SPONGE$^{*}$%
 }

\vskip2.5 mm

\noindent{\it Р. М. Оспанов, Е. Н. Сейткулов, Н. М. Сисенов, Б. Б. Ергалиева %$^2$%
%, И.~О. Фамилия%$\,^2$%

}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Министерства цифрового развития, инноваций и аэрокосмической промышленности Республики Казахстан (грант №
AP06851124).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize



\noindent%
%$^1$~%
Евразийский национальный университет им. Л. Н. Гумилёва, Казахстан,

\noindent%
%\hskip2.45mm%
010000, Нур-Султан, ул. Сатпаева, 2



%\noindent%
%%$^1$~%
%Санкт-Петербургский государственный университет, Российская
%Федерация,
%
%\noindent%
%%\hskip2.45mm%
%199034, Санкт-Петербург, Университетская~наб., 7--9


}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3 mm

{\small \noindent \textbf{Для цитирования:} \textit{Оспанов Р. М., Сейткулов Е. Н., Сисенов Н. М., Ергалиева Б. Б.} Пример внутренней функции для схемы SPONGE~// Вестник
Санкт-Пе\-тер\-бург\-ско\-го университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~17.
Вып.~\issuenum.
С.~\pageref{p6}--\pageref{p6e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum06

\vskip2.0%3
mm

{\leftskip=7mm\noindentПредложен новый вариант внутренней функции, лежащей в~основе перспективной современной схемы построения криптографических хеш-функций Sponge (криптографическая губка). Описываемый пример аналогичен перестановке Keccak, но \mbox{имеет} ряд основных отличий. Внутренняя функция оперирует над 2048-битовым состоянием $S$, который можно рассматривать как трехмерный битовый массив размером $4\times 8\times 64$. Структуру внутренней функции составляют 5 преобразований, аналогичных Keccak. Но, во-первых, в~приведенном примере вместо 5-битового $S$-блока используется 8-би\-товый, в~связи с~чем изменены параметры трехмерного представления состояния. Во-вторых, для формирования раундовых констант вместо регистра сдвига с~линейной обратной связью применяется словарный регистр сдвига с~обратной связью по переносу кольцевой конфигурации. Проведен анализ свойств этих преобразований.\\[1mm]
\textit{Ключевые слова}: информационная безопасность, криптография, хеш-функция, модификация Sponge, симметричное шифрование.

}

}

\vskip 3%4
mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\bf 1. Введение.} В~настоящее время существует множество различных схем для построения криптографических хеш-функций. Наиболее популярной и~перспективной альтернативой стала схема Sponge (криптографическая губка) [1, 2]. Схема Sponge~--- это простая итерационная схема для построения функции с~входом переменной длины и~выходом произвольной длины на основе внутренней функции $f$, являющейся преобразованием фиксированной длины или перестановкой, оперирующей с~постоянным числом $b$ битов $(b = r + c)$. Значение $r$ называется битовой скоростью, а~$c$~--- мощностью. В~алгоритме используется переменная $S$ длиной $b$, называемая состоянием. К~состоянию $S$ и~применяют внутреннюю функцию $f$. С помощью этой схемы, кроме хеш-функций, можно создавать такие криптопримитивы как блочные симметричные шифры, коды аутентификации сообщения и~поточные шифры. По такой схеме был спроектирован алгоритм Keccak [3], ставший победителем конкурса SHA-3. В~ алгоритме Keccak внутренняя функция $f:Z_{2^b} \rightarrow Z_{2^b}$ представляет собой перестановку множества $Z_{2^b}$, построенную как итерационный блочный шифр, в~котором раундовые ключи заменяются некоторыми простыми раундовыми константами.

В данной статье рассматривается пример внутренней функции, аналогичный перестановке Keccak, но имеющий некоторые отличия. Во-первых, вместо 5-битового $S$-бло\-ка используется 8-битовый. В~связи с~этим изменены параметры трехмерного представления состояния. Во-вторых, для формирования раундовых констант вместо регистра сдвига с~линейной обратной связью применяется словарный регистр сдвига с~обратной связью по переносу кольцевой конфигурации (известный в~англоязычной литературе как <<word ring Feedback with Carry Shift Register (word ring FCSR)>>).

Регистры сдвига с~обратной связью по переносу обладают хорошими свойствами регистров сдвига с~линейной обратной связью: последовательностями с~известным периодом и~хорошими статистическими свойствами. Но в~отличие от регистров сдвига с~линейной обратной связью они обеспечивают внутреннюю устойчивость к~алгеб\-раи\-ческим и~корреляционным атакам. Регистры сдвига с~обратной связью по переносу кольцевой конфигурации обобщают предыдущие представления Галуа и~ Фибоначчи и~имеют много преимуществ по сравнению с~этими представлениями. Во-первых, они сохраняют все хорошие и~традиционные свойства регистров сдвига с~обратной связью по переносу (известный период, большая энтропия). Во-вторых, они обходят слабые стороны представлений Фибоначчи и~Галуа. В-третьих, кольцевое представление обладает более быстрой диффузионной характеристикой и~лучшими результатами реа\-лизации. Сведения о~регистрах сдвига с~обратной связью по переносу можно найти, например, в~работе [4].

% ------------------------------------------------- 2. Структура функции -------------------------------------------

{\bf 2. Структура функции.} Внутренняя функция представляет собой перестановку, которую можно описать как последовательность операций над 2048-битовым состоянием $S$. Состояние $S$ разбивается на 32 64-битовых слова $S_0, S_1, …, S_{31}$. Слова записываются в~матрицу $4\times 8$ последовательно слева направо и~сверху вниз. Четверки $S_i , S_{i+8} , S_{i+16}, S_{i+24} ,\, i = 0, 1,\dots, 7$, называются вертикальными плоскостями, а~восьмерки $S_{8j} , S_{8j+1},…, S_{8j+7} ,\, j = 0, 1, 2, 3$,~--- горизонтальными. Другими словами, состояние $S$ можно рассматривать как трехмерный битовый массив: $S(x, y, z), ~ x = 0, 1,\dots, 3, ~ y = 0, 1, \dots, 7, ~ z = 0, 1, \dots, 63$.

Действие внутренней функции состоит в~32-кратном повторении последовательности преобразований.%\\

\vspace{3mm}
{\itshape Преобразование 1}:
\vspace{-3mm} \begin{multline*}
\mbox{\,\,\,\,\,\,\,\,\,\,\,\,\,\,} f_1(S(x, y, z)) = S(x, y, z) + S(0, y-1, z) + S(1, y-1, z) + S(2, y-1, z) ~+ \\
 +~S(3, y-1, z)+ S(0, y+1, z-1) + S(1, y+1, z-1) + S(2, y+1, z-1) + S(3, y+1, z-1)\\
 \text{при } \quad x = 0, 1, …, 3, \quad y = 1, …, 6, \quad z = 1, …, 63;\\
 f_1(S(x, 0, 0)) = S(x, 0, 0) + S(0, 7, 0) + S(1, 7, 0) + S(2, 7, 0) + S(3, 7, 0)~+ \\
 +~S(0, 1, 63) + S(1, 1, 63) + S(2, 1, 63) + S(3, 1, 63) \text{ при } x = 0, 1, …, 3;\\
 f_1(S(x, 7, 0)) = S(x, 7, 0) + S(0, 6, 0) + S(1, 6, 0) + S(2, 6, 0) + S(3, 6, 0)~+\\
 +~S(0, 0, 63) + S(1, 0, 63) + S(2, 0, 63) + S(3, 0, 63) \text{ при } x = 0, 1, …, 3.\\
\end{multline*}

%\pagebreak
\vspace*{-3mm}%\indent
{\itshape Преобразование 2}:
%\begin{equation*}
\vspace{-3mm}
$$  f_2(S(x, y, z)) = S(x, y, z - (t + 1)(t + 2)/2),%\\
$$%  \end{equation*}

  \noindentгде $t  $ такое, что $ 0 \leq t < 32$
и~$\begin{pmatrix} x \\ y\end{pmatrix} =\begin{pmatrix} 0&1\\2&3\end{pmatrix}  ^t\begin{pmatrix} 1\\0\end{pmatrix}$ в~$GF(4)^{2\times 2}$ , или $t = -1$ при $ x = y =0$.

\vspace{3mm}
{\itshape Преобразование 3}:
$$
  f_3(S(x, y, z)) = S(x', y', z), %\text{ где }x', y'\text{ такие, что }\begin{pmatrix}x\\y\end{pmatrix}=\begin{pmatrix}0&1\\2&3\end{pmatrix}\begin{pmatrix}x'\\y'\end{pmatrix}.%
$$

\noindentгде $x', y'$ такие, что \begin{pmatrix}x\\y\end{pmatrix}=\begin{pmatrix}0&1\\2&3\end{pmatrix}\begin{pmatrix}x'\\y'\end{pmatrix}.

{\itshape Преобразование 4}: $f_4$ --- оптимальный 8-би\-товый $S$-блок, применяемый к~\mbox{8-би-}\linebreakтовым строкам $S(x, 0, z), S(x, 1, z), S(x, 2, z), S(x, 3, z), S(x, 4, z), S(x, 5, z), S(x, 6, z),$ $ S(x, 7, z)$. В~данной статье он не определяется. Можно использовать уже существующие оптимальные $S$-блоки или сформировать с~помощью известных методов генерации оптимальных  $S$-блоков.

{\itshape Преобразование 5}: $f_5$ состоит в~сложении слова $S_{31}$ с~64-битовой константой $C$, которая вычисляется при помощи словарного регистра сдвига с~обратной связью по переносу кольцевой конфигурации.


	
% ------------------------------------------------- 3. Анализ свойств преобразований -------------------------------------------

{\bf 3. Анализ свойств преобразований.} Преобразование $f_1$ является линейным. Его предназначение~--- обеспечение диффузии. Также оно инвариантно относительно сдвигов во всех направлениях. Его действие можно описать следующим образом: оно добавляет к~каждому биту $S(x, y, z)$ побитовую сумму битов из двух столбцов: $S(x-1, *, z)$ и~$S(x+1, *, z-1)$. Без преобразования $f_1$ внутренняя функция не будет обеспечивать диффузию какого-либо значения.

Преобразование $f_2$ состоит из перемещений внутри рядов, направленных на обеспечение межплоскостной дисперсии. Без него диффузия между плоскостями была бы очень медленной. Оно инвариантно относительно сдвигов в~$z$-направлении. 32 сдвиговых констант определяются по формуле $i(i + 1)/2$ по модулю длины ряда. Можно доказать, что для любого $l$ последовательность $i (i + 1 ) /2 \mod 2^l$ имеет период $2l + 1$ и~любая подпоследовательность с~$n2^l \le i<(n+1) 2^l$ проходит через все значения $Z_{2^l}$.\linebreak Из этого следует, что для рядов с~длинами 64 и~32 все сдвиговые константы различны. Для рядов с~длинами 16 и 9 сдвиговые константы встречаются дважды, с~дли\-ной~7~--- один раз, с~длинами 8, 4 и~2~--- одинаково часто, за исключением сдвиговой константы~0, которая встречается на один раз чаще.

Преобразование $f_3$ является перемещением рядов. Его предназначение~--- обеспечение дисперсии, направленной на долгосрочную диффузию. Преобразование действует линейно по координатам $(x, y)$: ряд в~положении $(x, y)$ переходит в~положение $(x, y)M^T$, где $M = \begin{pmatrix}0&1\\2&3\end{pmatrix}$ --- матрица размерoм $2 \times 2$ с~ элементами из $GF(4)$. Отсюда вытекает, что ряд в~начале координат (0, 0) не меняет своего положения. Поскольку преобразование работает на плоскостях независимо, оно инвариантно относительно сдвигов в~направлении $z$.

Преобразование $f_4$ есть единственное нелинейное отображение во внутренней функции. Без него раундовая функция была бы линейной. Его можно рассматривать как параллельное применение 256 8-битовых $S$-блоков.

$S$-блоки относятся к~основным компонентам, определяющим нелинейность и~ уровень стойкости алгоритма. Для защиты алгоритма от различных типов атак $S$-блоки должны соответствовать ряду критериев. Из-за большого количества существующих критериев, их противоречивости или частичной взаимозависимости проблематично сформировать $S$-блок, обладающий всеми известными заданными свойствами. Поэтому на практике используются $S$-блоки, удовлетворяющие главным критериям, существенным для конкретного симметричного алгоритма. Такие $S$-блоки принято называть оптимальными. Критерии оптимального $S$-блока могут быть установлены для целого класса криптографических алгоритмов, а~также заданы и~для отдельно взятого криптопримитива. При выборе таблиц замен для новых шифров основными критериями служат нелинейность и~дифференциальная равномерность. Дифференциальная равномерность является показателем стойкости против дифференциальной атаки. Например, для 8-битных подстановок оптимальны для дифференциальной равномерности значения не больше 8. Нелинейность~--- показатель стойкости против линейной атаки. Оптимальными для 8-битных подстановок являются значения не меньше 100. Алгебраическая степень и~алгебраический иммунитет есть показатели стойкости против алгебраических атак. В~случае 8-битных подстановок к~ оптимальным для алгебраической степени относятся значения не меньше 7, а~максимальным для алгебраического иммунитета считается 3 при 441 уравнении. В~случае подстановок 4 в~4 бита критерий ал\-геб\-раи\-чес\-ко\-го иммунитета не играет большой роли, так как они могут быть описаны системой уравнений второй степени. Но в~то же время он не может равняться 1. Ещe одним критерием служит отсутствие циклов длины 1, т. е. неподвижных (фиксированных) точек. Существует и~множество других критериев. Современные критерии ориентированы на защиту от существующих видов криптоанализа: линейного, алгебраического и~различных вариаций дифференциального. Еще один критерий связан с~принадлежностью подстановок к~разным классам эквивалентности векторных булевых функций. Он используется лишь в~том случае, когда в~алгоритме применяется более одного узла нелинейной замены. Многие исследования показывают, что идеальных $S$-блоков, вероятнее всего, нет. Поэтому было введено понятие оптимального $S$-блока, критерии которого определяются для конкретного криптографического алгоритма (или класса криптографических алгоритмов) и~являются оптимальными с~точки зрения защиты от существующих видов атак.

В настоящей статье $S$-блоки для преобразования $f_4$ не определяются. Можно использовать уже существующие оптимальные $S$-блоки или сформировать с~помощью известных методов генерации оптимальных $S$-блоков. Сведения о~методах генерации оптимальных $S$-блоков можно найти, например, в~работах [5--14].

Преобразование $f_5$ состоит из сложения раундовых констант и~направлено на нарушение симметрии. Без него раундовая функция была бы инвариантной относительно сдвигов в~направлении $z$, и~все раунды были бы равны, что делало бы внутреннюю функцию подверженной атакам, использующим симметрию, таким как, например, слайдовая атака. Биты раундовых констант различны от раунда к~раунду и~при\-ни\-мают\-ся в~качестве выходных данных словарного регистра сдвига с~обратной связью по переносу кольцевой конфигурации. Константы добавляются только в~одном ряде состояния. Из-за этого нарушение распространяется через $f_1$ и~$f_4$ на все ряды в~течение одного раунда.

% ------------------------------------------------- 4. Заключение -------------------------------------------

{\bf 4. Заключение.} В~настоящей статье предложен новый вариант внутренней функции, лежащей в~основе перспективной современной схемы построения криптографических хеш-функций Sponge (криптографическая губка). Описываемый пример аналогичен перестановке Keccak, но имеет некотoрые отличия. Внутренняя функция оперирует над 2048-битовым состоянием $S$, который можно рассматривать как трехмерный битовый массив размером $4 \times 8 \times  64$. Структуру внутренней функции составляют 5 преобразований $f_1, f_2, f_3, f_4, f_5$, аналогичных Keccak, но, во-первых, вместо\linebreak 5-битового $S$-блока используется 8-битовый, во-вторых, для формирования раундовых констант вместо регистра сдвига с~линейной обратной связью применяется словарный регистр сдвига с~обратной связью по переносу кольцевой конфигурации. Проведен анализ свойств таких преобразований.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{06/lit-ra}

%\newpage
\input{06/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
