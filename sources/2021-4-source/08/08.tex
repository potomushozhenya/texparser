
\noindent{\small УДК 519.178  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\
MSC 91B38

}

\vskip3mm

\noindent{\bf Точные штрафные функции в~задаче выбора оптимального\\ оптового заказа в~условиях быстрого колебания спроса$^{*}$%
 }

\vskip3.0mm

\noindent{\it В. М. Буре, В. В. Карелин, Л. Н. Полякова%$^1$%
%, И.~О. Фамилия%$\,^2$%

}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (проект № 20-07-0108).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum08} }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum08}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent%
%$^1$~%
Санкт-Петербургский государственный университет, Российская Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9



}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip2.5mm

{\small \noindent \textbf{Для цитирования:} \textit{Буре В. М., Карелин В. В., Полякова Л. Н.}
Точные штрафные функции в~задаче выбора оптимального оптового заказа в~условиях быстрого колебания спроса~// Вестник
Санкт-Пе\-тер\-бург\-ско\-го университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~17.
Вып.~\issuenum.
С.~\pageref{p8}--\pageref{p8e}. \\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum08

\vskip2.5mm

{\leftskip=7mm\noindentРассматривается задача выбора оптимальной стратегии поведения
торговой фирмы в~рамках максиминного подхода,
когда возможен ажиотажный спрос (rush demand). В~одной из работ авторов
исследовалась близкая  по постановке задача выбора оптимальной стратегии поведения
торговой фирмы,
в~которой маркетинговые исследования прогнозировали резкое падение спроса.
 В~этой статье описывается другая ситуация на рынке, когда возникает
ажиотажный спрос на новый товар с~последующим резким падением спроса
после достижения насыщения на некотором промежутке времени $[0, T]$. Необходимость изучения такой схемы оптового заказа связана с~тем,
 что, во-первых, склады торговой фирмы имеют ограниченный объем и~не могут вместить весь заказанный объем товара; во-вторых, производитель
 не может предложить сразу всю за\-казанную партию товара, так как не весь
 товар может быть произведен в~начальный
(нулевой) момент времени, сразу после поступления заказа.  Предложена математи\-чес\-кая модель, позволяющая выбрать
оптимальную стратегию заказа торговой фирмы в~условиях ажиотажного
роста спроса на новый товар в~промежутке времени $\tau_1,\tau_2$
в~некоторый неизвестный момент времени, а также время~$\tau_*\in [\tau_3,\tau_4]$
последующего резкого падения спроса в~промежутке времени
$[\tau_3,\tau_4]$ в~связи с~насыщением рынка новым товаром.
Приведены четыре возможных варианта
оптимизационных задач.
Для их решения   разработан метод точных штрафных функций.
Безусловно, описанная задача может быть решена и~другими максиминными методами.\\[1mm]
\textit{Ключевые слова}: уровень запаса товара, случайный спрос, дефицит товара, ажиотажный спрос, скидка, максимин, метод точных штрафных функций.

}

}

\vskip 3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\bf 1. Введение.}
В данной работе будем считать, что спрос на товар носит постоян\-ный характер (константа)
на некотором промежутке времени $[ 0,\tau^*]$.  В~момент времени  $\tau^*\in [\tau_1,\tau_2]$
спрос
на новый товар становится ажиотажным, моменты времени  $\tau_1,\tau_2$    известны.
Подобная ситуация вполне возможна, если продается новый товар, ранее не известный покупателям.
Маркетинговые
исследования позволяют с~высокой сте\-пенью уверенности предположить,
что через некоторое время возникнет очень высокий спрос на новый товар,
который сохранится в~течение некоторого времени, пос\-ле чего произойдет резкое
падение спроса в~связи с~достижением уровня насыщения рынка. Примем,
что можно указать границы возникновения повышенного спроса,
а~именно моменты времени $\tau_1,\tau_2$.
Далее, в~некоторый момент времени  $\tau_*\in [\tau_3,\tau_4]$
произойдет резкое падение спроса. Будем предполагать,
что в~результате маркетинговых исследований можно
указать границы промежутков,
т.~е. моменты времени   $\tau_1, \tau_2, \tau_3, \tau_4$,
причем
$  0<\tau_1<\tau_2<\tau_3<\tau_4<T.$

В работе [1]
изучалась близкая по постановке задача, в~которой
маркетинговые исследования прогнозировали резкое падение спроса.
В этой статье рассматривается другая ситуация на рынке,
когда возникает ажиотажный спрос на новый товар
с последующим резким падением спроса.
Торговая фирма использует двухступенчатую схему оптового заказа товара.
Весь заказанный у~фирмы-производителя товар делится на две части. Первая
партия товара поступает сразу, она должна быть продана в~течение
некоторого промежутка времени  $[0,T_1]$. Вторая партия товара поставляется
в конечный момент времени $T_1$.
 Однако на промежутке времени $[T_1,T]$
она также продается, но со скидкой.

Моменты времени  $T_1$ и~$T$  выбираются торговой фирмой из условия максимизации
дохода фирмы в~рамках рассматриваемой модели спроса на реализуемый товар.
Целесообразность применения двухступенчатой схемы оптового заказа связана
с ограниченным объемом складов и~расходами на хранение товара, а~также с~тем,
что производство всего заказанного товара требует значительных финансовых средств,
выплачиваемых торговой фирмой фирме-производителю товара.
Кроме того, могут быть ограничения, обусловленные  производственными мощностями
фирмы-производителя.  Будем считать, что в~момент времени $T_1$  торговая
фирма полностью продаст первую партию товара и~получит средства, часть
которых она сможет выплатить фирме-производителю. В~момент времени  $T$
происходит завершение полной реализации всего закупленного товара.
Выбор моментов времени $T_1$ и~$T$ с~учетом предположений о~характере спроса
позволяет определить
объем первой партии заказанного товара и~общий объем всего заказанного
у~производителя товара.
Близкие по постановке задачи рассматривались в~работах [2--17].%\\

Введем следующие обозначения:
$c$ --- закупочная цена единицы товара у~производителя; $ p (p > c)$ --- цена единицы товара для покупателя в~магазине торговой фирмы; $s$ --- скидка, предоставляемая покупателю при покупке единицы товара при дефиците товара (товар поставляется покупателю позже); $T_{1}$  --- момент времени, когда первая партия товара реализована; $T$ 	--- момент времени поступления второй партии товара; $\tau^* $ --- момент резкого увеличения спроса, $\tau^* \in [\tau_{1}, \tau_{2}]$; $\tau_* $ --- момент резкого падения спроса, $\tau_* \in [\tau_{3}, \tau_{4}]$; $\tau_{1}, \tau_{2}, \tau_3, \tau_4$ --- известные константы, $ 0<\tau_1<\tau_2<\tau_3<\tau_4<T$; $h$ ---  уровень ажиотажного спроса; $l_1$ --- начальный уровень спроса до возникновения ажиотажного спроса $ l_1\ll  h$; $l_2$ ---  уровень спроса после прекращения  ажиотажного спроса $l_2\ll l_1\ll  h$; $Q$ --- общий объем всего заказанного у~ производителя товара; $Q_{1}$~--- объем первой партии товара; $Q_{2}$~--- объем второй партии товара; $Q _{1}^{\rm (max)}$~ --- максимально возможный объем первой партии товара; $Q _{1}^{\rm (min)}$~--- минимально возможный объем первой партии товара; $Q _{2}^{\rm (max)} $~--- максимально возможный объем второй партии товара; $Q _{2}^{\rm (min)}$~ --- минимально возможный объем второй партии товара; $M(t)$~--- текущий уровень запаса товара (дефицита товара); $D(t)$~--- мгновенный спрос на товар; $V$~--- потери, связанные с~дефицитом товара в~торговой фирме; $TP (T_{1}, T )$~--- усредненный доход торговой фирмы.

{\bf 2. Постановка задачи и~основные результаты.} Будем предполагать,
что функция спроса на товар имеет следующий
вид:		
\begin{equation*}
   D(t)=\left\{
  \begin{array}{cc}
   l_1, & t <  \tau^*, \\
   h,&\tau^*\leq t \leq  \tau_*,\\
      l_2, & \tau_*<t,
  \end{array}
\right.
~~0<l_2\ll l_1\ll h.
\end{equation*}
%$$ 0<l_2\ll l_1\ll h.$$


  Таким образом, спрос в~момент времени  $\tau^*$
резко возрастает с~уровня $l_1$  на   уровень $h$
и
далее в~момент времени $\tau_*$   падает до самого низкого уровня
$l_2$,   который может быть
практически равен нулю.
Уровень запаса $ M(t)$  для  $t\in [0,  \min(\tau^*, T_1)]$
 определяется дифференциальным соотношением
$$
\frac{ d M(t)  }{d t} = -D(t)= -l_1
$$
при обязательном выполнении условия
 $$  M(T_1 ) = 0.$$
Следовательно, для   $t\in [0,  \min (\tau^*, T_1) ]$  справедливо равенство
 $$  M(t)= -l_1 t +  Q_1. $$
Из равенства  $M(T_1) =  0  $ при условии
 $T_1<\tau^*$ имеем
 $$Q_1 = l_1\, T_1. $$
Из формулировки задачи следует, что должно выполняться неравенство

\[Q_{1}^{(\min)} \leq Q_{1} \leq Q_{1}^{(\max)}.\]
Предположим, что
$$
l_1\,\tau_1< Q_{1}^{(\min)}.
$$
Очевидно, что в~этом случае  должно выполняться неравенство $T_1>\tau_1$.

Исходя из экономической природы задачи, с~учетом требования сбалансированности
объемов двух партий товара, последнее неравенство необходимо дополнить
еще одним условием. В~результате приходим к~неравенству, которое вытекает из содержательной экономической
формулировки задачи:
\begin{equation}\label{m1}
  \tau_1<T_1<\tau_2.
\end{equation}
Его выполнение нужно для сбалансированности двух партий товара,
так
как моменты времени $T_1$ и~$T$
полностью определяют объем партий товара.
 Неформальная постановка задачи заключается в~том,
чтобы выбрать эти моменты времени
из условия максимизации дохода торговой фирмы
при обязательном выполнении неравенства (\ref{m1}).
 Далее будем считать, что выполнены следующие неравенства:
$$
0<\tau_1<T_1<\tau_2<\tau_3<\tau_4<T.
$$

Потери, связанные с~недопоставкой (дефицитом) товара на промежутке
$  [t_1,T],$
определяются функцией
$$
V(\tau^*, \tau_*,T_1,T)=s Q_2(\tau^*, \tau_*,T_1,T),
$$
где
$$
Q_2(\tau^*, \tau_*,T_1,T)=l_1(\tau^*-T_1)_{+}+h(\tau_*-\tau^*)+l_2(T-\tau_*),
$$
$$
(\tau^*-T_1)_{+}=\left\{\begin{array}{cc}
                   0, & \tau^*<T_1, \\
                   \tau^*-T_1 & \tau^*\geq T_1.
                 \end{array}
                 \right.
$$


Усредненный доход торговой фирмы рассчитываем по выражению
$$
TP(\tau^*, \tau_*,T_1,T)=
\frac{1}{T}\left\{(p-c)Q(\tau^*, \tau_*,T_1,T)-V(\tau^*, \tau_*,T_1,T)\right\},
$$
в котором
$$
Q(\tau^*, \tau_*,T_1,T)=Q_1(\tau^*, \tau_*,T_1,T)+Q_2(\tau^*, \tau_*,T_1,T),$$
$$
\ \  Q_1(\tau^*, \tau_*,T_1,T)=l_1\min(\tau^*,T_1)+h(T_1-\tau^*)_{+}.
$$
Следовательно,
$$
TP(\tau^*, \tau_*,T_1,T)=\frac{1}{T}\left\{ (p-c)
(Q_1(\tau^*, \tau_*,T_1,T)+Q_2(\tau^*, \tau_*,T_1,T))
-sQ_2(\tau^*, \tau_*,T_1,T)\right\}=
$$
$$
=\frac{1}{T}\left\{(p-c)
Q_1(\tau^*, \tau_*,T_1,T)+(p-c-s)Q_2(\tau^*, \tau_*,T_1,T)
\right\}.
$$
Также выполнены ограничения
$$
  \begin{array}{c}
    Q_1^{(\min)}\leq Q_1(\tau^*, \tau_*,T_1,T)\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq Q_2(\tau^*, \tau_*,T_1,T)\leq Q_2^{(\max)}, \\
    0<\tau_1<T_1<\tau_2<\tau_3<\tau_4<T.
  \end{array}
$$

Распишем более детально функции   $Q_1(\tau^*, \tau_*,T_1,T) $ и~$ Q_2(\tau^*, \tau_*,T_1,T)$.

Если $\tau^*< T_1$,   то
$$\min(\tau^*,T_1)=\tau^*, \ (T_1-\tau^*)_{+}=T_1-\tau^*,\
 \max(\tau^*,T_1)=T_1.
$$

Пусть  $\tau^*\geq T_1$, тогда $$\min(\tau^*,T_1)=T_1, \ (T_1-\tau^*)_{+}=0,
\ \max(\tau^*,T_1)=\tau^*.$$
Таким образом, имеем систему
$$
Q_1(\tau^*, \tau_*,T_1,T)=\left\{\begin{array}{cc}
                   l_1\tau^*+h (T_1-\tau^*), & \tau^*<T_1, \\
                    l_1 T_1, & \tau^*\geq T_1,
                 \end{array}
                 \right.
$$
$$
Q_2(\tau^*, \tau_*,T_1,T)=\left\{\begin{array}{cc}
                   h(\tau_*-T_1)+l_2(T-\tau_*), & \tau^*<T_1, \\
                   l_1(\tau_*- T_1)+h(\tau_*-\tau^*)+l_2(T-\tau_*), & \tau^*\geq T_1.
                 \end{array}
                 \right.
$$
Если  $\tau^*<T_1$, то  $TP(\tau^*, \tau_*,T_1,T)$   запишем в~виде

$$
TP(\tau^*, \tau_*,T_1,T)=
                  \frac{1}{T}\left\{(p-c)(l_1\tau^*+h (T_1-\tau^*))+
                  (p-c-s)(h(\tau_*-T_1)+l_2(T-\tau_*))\right\}.
$$
Если $\tau^*\geq T_1$, то находим, что


 $$TP(\tau^*, \tau_*,T_1,T)=
                  \frac{1}{T}\left\{  (p-c)  l_1 T_1+(p-c-s)(
                  l_1(\tau_*- T_1)+h(\tau_*-\tau^*)+l_2(T-\tau_*))
                  \right\} .
$$
Отсюда  при $\tau^*<T_1$  имеем уравнение
$$
TP(\tau^*, \tau_*,T_1,T)= \frac{1}{T}\left\{\tau^*(p-c)(l_1-h)+\tau_*(p-c-s)(h-l_2)\right.
+$$ $$+\left. (p-c)hT_1+(p-c-s)l_2T\right\}.
$$

Если $\tau^*\geq T_1$, то получим, что
$$
TP(\tau^*, \tau_*,T_1,T)= \frac{1}{T}\left\{\tau^*h(c+s-p)+\tau_*(p-c-s)(l_1-l_2+h)\right.+$$ $$+\left. sl_1T_1+(p-c-s)l_1 T\right\}.
$$


Пусть $ \tilde{\tau}^*, \tilde{\tau}_*$  --- решения   минимизационной задачи
\begin{equation}\label{m4}
{\footnotesize  \min_{\begin{array}{c} \tau^*\in [\tau_1,\tau_2] \\
                                        \tau_*\in [\tau_3,\tau_4]
                                      \end{array}} }
 TP(\tau^*, \tau_*, T_1,T).
\end{equation}




   Введем множество
$$
\mathfrak{T}=
\left\{
(T_1,T)\in \Bbb R^2 \Bigg |
  \begin{array}{c}
    Q_1^{(\min)}\leq l_1\min(\tilde{\tau}^*,T_1)+h(T_1-\tilde{\tau}^*)_{+}\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq l_1(\tilde{\tau}^*-T_1)_{+}+h(\tilde{\tau}_*-\tilde{\tau}^*)+
    l_2(T-\tilde{\tau}_*)
    \leq Q_2^{(\max)}, \\
    0<\tau_1<T_1<\tau_2<\tau_3<\tau_4<T
  \end{array}
  \right\}.
$$

В рамках построенной модели можно сформулировать оптимизационную задачу
для выбора оптимальных моментов времени $T_1$  и~$T$   следующего вида:
\begin{equation}\label{m5}
  \max_{(T_1,T)\in \mathfrak{T}} TP(\tilde{\tau^*}, \tilde{\tau}_*,T_1,T).
\end{equation}

Решение оптимизационных задач (2), (3)
 приводит к~максиминному выбору моментов времени
$T_1$  и~$T$.

Заметим, что функция $ TP(\tau^*, \tau_*, T_1,T)$  при фиксированных $T_1$  и~ $T$
линейна по $\tau^*$  и~  $\tau_*$. Следовательно, минимум
линейной функции $ TP(\tau^*, \tau_*, T_1,T)$ при линейных ограничениях
$\tau^*\in [\tau_1,\tau_2], \  \tau_*\in [\tau_3,\tau_4]$
достигается в~крайних точках изучаемых отрезков.
Рассмотрим четыре возможных варианта.

Пусть $\tilde{\tau}^*=\tau_1,\, \tilde{\tau}_*=\tau_3$ и~$\tau_1<T_1.$
В таком  случае имеем
$$
TP(\tau_1, \tau_3,T_1,T)= \frac{1}{T}\left\{\tau_1(p-c)(l_1-h)+\tau_3(p-c-s)(h-l_2)\right.
+$$ $$+\left.(p-c)hT_1+(p-c-s)l_2T\right\},
$$
$$
\mathfrak{T}_1=
\left\{
(T_1,T)\in \Bbb R^2 \Bigg |\
  \begin{array}{c}
    Q_1^{\min}\leq l_1\min({\tau}_1,T_1)+h(T_1-{\tau}_1)_{+}\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq l_1({\tau}_1-T_1)_{+}+h({\tau}_3-{\tau}_1)+
    l_2(T-{\tau}_3)
    \leq Q_2^{(\max)}, \\
    0<\tau_1<T_1<\tau_3<T,
  \end{array}
  \right\}=
$$
$$
=
\left\{
(T_1,T_2)\in \Bbb R^2 \Bigg |
  \begin{array}{c}
    Q_1^{(\min)}\leq l_1\tau_1+h(T_1-{\tau}_1)\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq h({\tau}_3-{\tau}_1)+
    l_2(T-{\tau}_3)
    \leq Q_2^{(\max)}, \\
    0<\tau_1<T_1<\tau_3<T
  \end{array}
  \right\}.
$$
Таким образом, в~этом случае необходимо максимизировать на
плоскости непрерывно дифференцируемую функцию
 при наличии линейных ограничений, т. е. решить оптимизационную задачу
 \begin{equation}\label{4}
   \max_{(T_1,T)\in \mathfrak{T}_1} TP(\tau_1, {\tau}_3,T_1,T).
 \end{equation}

Пусть $\tilde{\tau}^*=\tau_1,\, \tilde{\tau}_*=\tau_4$ и~$\tau_1<T_1.$
В данном случае имеем
$$
TP(\tau_1, \tau_4,T_1,T)= \frac{1}{T}\left\{\tau_1(p-c)(l_1-h)+\tau_4(p-c-s)(h-l_2)
\right.+$$ $$+\left.(p-c)hT_1+(p-c-s)l_2T\right\},
$$
$$
\mathfrak{T}_2=
\left\{
(T_1,T_2)\in \Bbb R^2 \Bigg |
  \begin{array}{c}
    Q_1^{(\min)}\leq l_1\tau_1+h(T_1-{\tau}_1)\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq h({\tau}_4-{\tau}_1)+
    l_2(T-{\tau}_4)
    \leq Q_2^{(\max)}, \\
    0<\tau_1<T_1<\tau_4<T
  \end{array}
  \right\}.
$$
Здесь также необходимо решать оптимизационную задачу, аналогичную задаче
(4).

Пусть $\tilde{\tau}^*=\tau_2,\, \tilde{\tau}_*=\tau_3$ и~$\tau_2\geq T_1.$
Тогда имеем
$$
TP(\tau_2, \tau_3,T_1,T)= \frac{1}{T}\left\{\tau_2 h(c+s-p)\!+\!\tau_3(p-c-s)(l_1-l_2+h)\!+\!
sl_1T_1+(p-c-s)l_1 T\right\},
$$
$$
\mathfrak{T}_3=
\left\{
(T_1,T)\in \Bbb R^2 \Bigg |\
  \begin{array}{c}
    Q_1^{\min}\leq l_1\min({\tau}_2,T_1)+h(T_1-{\tau}_3)_{+}\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq l_1({\tau}_2-T_1)_{+}+h({\tau}_3-{\tau}_2)+
    l_2(T-{\tau}_3)
    \leq Q_2^{(\max)}, \\
    0<T_1< \tau_2<\tau_3<T,
  \end{array}
  \right\}=
$$
$$
=
\left\{
(T_1,T)\in \Bbb R^2 \Bigg |\
  \begin{array}{c}
    Q_1^{\min}\leq l_1 T_1\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq l_1({\tau}_2-T_1)_{+}+h({\tau}_3-{\tau}_2)+
    l_2(T-{\tau}_3)
    \leq Q_2^{(\max)}, \\
     0<T_1< \tau_2<\tau_3<T
  \end{array}
  \right\}.
$$
Итак, получим  оптимизационную задачу
 \begin{equation}\label{m7}
   \max_{(T_1,T)\in \mathfrak{T}_3} TP(\tau_2, {\tau}_3,T_1,T).
 \end{equation}

Пусть  $\tilde{\tau}^*=\tau_2,\, \tilde{\tau}_*=\tau_4$ и~$\tau_2\geq T_1.$
Тогда имеем
$$
TP(\tau_2, \tau_4,T_1,T)= \frac{1}{T}\left\{\tau_2 h(c+s-p)\!+\!\tau_4(p-c-s)(l_1-l_2+h)\!+\!
sl_1T_1+(p-c-s)l_1 T\right\},
$$
$$
\mathfrak{T}_4=
\left\{
(T_1,T)\in \Bbb R^2 \Bigg |\
  \begin{array}{c}
    Q_1^{\min}\leq l_1 T_1\leq Q_1^{(\max)}, \\
    Q_2^{(\min)}\leq l_1({\tau}_2-T_1)_{+}+h({\tau}_4-{\tau}_2)+
    l_2(T-{\tau}_4)
    \leq Q_2^{(\max)}, \\
     0<T_1< \tau_2<\tau_4<T
  \end{array}
  \right\}.
$$
Следовательно, в~каждом из вариантов следует
 максимизировать непрерывно дифференцируемую функцию  на плоскости при наличии линейных ограничений, т. е. на многограннике.%\\

В математическом программировании для решения  задач (4}), (5)
 существует достаточное число
алгоритмов (см.,  например, [18--21]):
%\cite{vas,po,ctf,fed}]
 метод проекции градиентов,
метод условного градиента, метод линеаризации,
метод штрафных функций.
Остановимся более детально на методе точных штрафных функций [22].

{\bf 3. Метод точных штрафных функций.} Метод штрафных функций яв\-ляет\-ся одним  из наиболее простых и~широко известных  для решения задач нелинейного программирования.
Он был введен Курантом в~1943~г.
из соображений, связанных с~физической природой рассматривавшейся задачи.
Основная идея метода состоит в~приближенном сведении задачи максимизации
при ограничениях к~задаче максимизации некоторой функции без ограничений;
при этом вспомогательная  функция подбирается
таким образом, чтобы она совпадала с~заданной максимизируемой
функцией внутри области и~быстро возрастала вне ее.

Рассмотрим задачу  условной оптимизации:
найти
\begin{equation}
\sup_{x\in X}f(x),
\label{mk:1}
\end{equation}
где $f$ --- непрерывная на $\Bbb R^n$ функция.
Предположим, что множество $X \subset \Bbb R^n $  непусто
и компактно.
Пусть множество $X$
задано в~виде
%\begin{equation}
$$
X = \{  x\in \Bbb R^n \bigm | \varphi(x) = 0   \},
%\label{mk:2}\end{equation}
$$
здесь $\varphi$ ---  непрерывная на $\Bbb R^n$ функция, и~$$
\varphi(x) < 0 \quad \forall x\not \in X.
$$
Тогда множество $X$ есть  замкнутое множество точек глобального
максимума функции $\varphi$  на $\Bbb R^n$.
Как обычно, для решения задачи (\ref{mk:1}) методом штрафных функций
введем функцию
$$
F(c,x) = f(x) + c \varphi(x),
$$
где $c$ --- некоторое неотрицательное число,
называемое {\it штрафным параметром}.
 Рассмотрим задачу безусловной минимизации
\begin{equation}
\sup_{x\in \Bbb R^n}F(c,x).
\label{mk:3}
\end{equation}
Для применения методов штрафов существенно предположение
о существовании решений у~вспомогательных задач.
Примем, что супремум в~задаче (7)
достигается для любого неотрицательного  числа $c$.
Достаточным условием для этого является ограниченность
лебегова множества
$$
\{ x\in \Bbb R^n \bigm |  f(x)\leq f(x_0)\},
$$
в котором $x_0$ --- некоторая точка из $\Bbb R^n$.
Будем считать,что
$$
x^{*} = \mbox{arg}\max_{x\in X} f(x),\quad f^*=\max_{x\in X}
f(x)=f(x^*),\quad F^{*}(c)= \max_{x\in \Bbb R^n}F(c,x),\quad
$$
$$
x(c) = \mbox{arg}\max_{x\in\Bbb R^n} F(c,x),\quad x^{**} =
\mbox{arg}\max_{x\in \Bbb R^n} f(x),\quad f^{**}=f(x^{**}).
$$
Предположим, что $ f^{**}<+\infty$. Заметим, что $ f^* \leq F^*(c)$  для любого положительного~$c$.\linebreak
%
\indentВыберем монотонно возрастающую последовательность  неотрицательных
чисел $\{ c_k\}\ ( k=1,2,\dots ) $, стремящуюся к~$+\infty$.
Положим $c_1=0$.
Тогда
$$
x^{**}=x(c_1)= f^{**}.
$$
На первом шаге проверяем принадлежность
множеству $X$ точки глобального минимума функции $f$ на $\Bbb R^n$.

В теории штрафных функций большое значение имеет
следующая теорема.

%\vskip 0.2cm
{\bf Теорема} [22]{\bf .}
{\it Если} $x(c_k)$  {\it есть последовательность решений вспомогательных
задач }(\ref{mk:3}),
{\it то справедливы следующие неравенства:}
%\\ \noindent\\

$
1)  \quad F^*(c_k)=F(c_k,x(c_k)) \geq F(c_{k+1},x(c_{k+1}))=
F^*(c_{k+1}) \quad \forall k>0;\quad\quad\quad\quad
$

%\\ \noindent\\
$
2)  \quad f(x(c_k))\geq f(x(c_{k+1}));
$

%\\ \noindent\\
$
3) \quad f(x(c_k))\geq F(c_k,x(c_{k}))\geq f^*.\pagebreak
%\quad\qquad\qquad \qquad
$

%\\ \noindent\\
%\label{mk:4} \end{equation}
\noindentТаким образом, последовательности чисел
$\{f(x(c_k))\}$ и~$\{F(c_k,x_k)\}$ являются невозрастающими,
причем число $f^*$ --- их нижняя грань.

%\vskip 0.2cm
%\noindent
{\bf Лемма 1.} {\it При сделанных предположениях
справедливо  неравенство}
\begin{equation}
\varphi(x(c_{k+1}))\geq \varphi(x(c_{k}))\quad
\forall  k>0.
\label{mk:5}
\end{equation}

Обозначим множество
$$
{\cal L}(x^{**})=\{
x\in \Bbb R^n \bigm | \varphi(x)\leq \varphi(x^{**})\},
$$
которое компактно в~силу непрерывности функции $\varphi$.
Из неравенства (8) вытекает, что
все точки последовательности $\{x(c_{k})\}$ будут лежать
во множестве ${\cal L}(x^{**})$.


%\vskip 0.2cm
%\noindent
{\bf Лемма 2.} {\it Для любой последовательности положительных
чисел $\{ c_k\},$
$ c_k\to +\infty,$
cправедливо соотношение}
$$
\varphi(x(c_k))\begin{array}{c}
 \\
 \longrightarrow \\
{ }^{ k\to +\infty}
 \end{array}  0.
$$

Следовательно, последовательность  точек $\{x(c_k)\}$,
получаемая в~результате глобальной максимизациии  семейства
функций $F(c_k,x)$,
является максимизирующей последовательностью для функции $\varphi$.

Как правило, при решении задач с~ограничениями в~виде неравенств:
найти
\begin{equation}
\sup_{x\in X}f(x),
\label{mkk:1}
\end{equation}
где
$
X = \{  x\in \Bbb R^n \bigm | h_i(x) \leq 0, i=1,...,m   \}
$
и $f,h_i$ --- непрерывные на $\Bbb R^n$ функции,
используется функция
$$
\varphi(x)=\min\{0, -  h_1(x), \dots,- h_m(x) \}.
$$

Особый интерес представляют точные штрафные функции, т. е.
функции, для которых существует такой штрафной параметр $c^*$,
что для любых $c\geq c^*$ множество точек максимума функции
$F(c,x)$ на $\Bbb R^n$ будет совпадать со~множеством решений задачи (6).
Такой параметр $c^*$ будем называть {\it точным штрафным параметром}
для семейства функций $F(c,x)$. Поэтому любое число, превосходящее
точный штрафной параметр, является также точным штрафным параметром.
Очевидно, что реализация метода точных штрафных функций прежде всего зависит
от свойств функции, с~помощью которой задается ограничение.


Поэтому функция $\varphi$ должна удовлетворять
некоторым условиям, при выполнении которых она
пригодна  для конструирования семейства
штрафных функций, обладающего точным штрафным параметром. Отметим, что при выполнении данных условий
точный штрафной параметр существует всегда, какова бы ни была
целевая функция, лишь бы она была локально липшицева на $\Bbb R^n$.
Целевая функция влияет только на величину точного штрафного параметра.



Для решения  задачи (9) с~линейными ограничениями
$$
X = \{  x\in \Bbb R^n \bigm | \langle a_i,x\rangle + b_i\leq 0, i=1,\dots,m   \}
$$
можно использовать функцию
$$
\varphi(x)=\min\{0, -  \langle a_i,x\rangle - b_i, \dots,
- \langle a_m,x\rangle - b_m \}, \ a_i\in \Bbb R^n,\ b_i\in \Bbb R.
$$
Нетрудно доказать [22], что для такой функции существует точный штрафной параметр.
Например, в~качестве такого параметра можно взять величину
$$c^*=\max\{ ||a_1||,\dots, ||a_m||\}.$$


{\bf 4. Заключение.} Изложенная выше методика сводит решение задачи (6)
к максимизации функции $F(c,x)$ на $\Bbb R^n$.
Но многие методы безусловной
максимизации данной функции находят точку,
которая есть точка локального максимума, если максимизируемая
функция не вогнута. Следовательно, при плохом начальном приближении
будет найден локальный максимум $x(c_k)$ функции $F(c_k,x)$.
Этот факт нарушает сходимость и~является существенным
недостатком метода штрафных функций в~применении к~невогнутым
задачам. В~случае, если решается задача вогнутого
программирования, то, как нетрудно проверить, функция
$F(c_k,x)$ будет вогнутой, потому указанная трудность исчезает.
Но возникает другая трудность. Из
приведенных оценок
следует, что для получения хорошего приближения необходимо брать
коэффициент $c_k$ достаточно большим, но тогда
все производные по параметру $x$ функции $F(c_k,x)$
становятся большими, поскольку они пропорциональны
величине $c_k$.

Все указанные трудности проявляют себя в~практических
расчетах, что снижает эффективность метода.
В вычислительных алгоритмах метода штрафных функций
используется идея постепенного возрастания параметра $c$
вместе с~постепенным увеличением точности
решения вспомогательных задач.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{08/lit-ra}

%\newpage
\input{08/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
