


\noindent{\small УДК 519.63, 51-73  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\
MSC 65M12, 35J05

}

\vskip3mm

\noindent{\bf Аналитические и~численные решения двумерных задач \\ теплопроводности и~электронной оптики$^{*}$%
 }

\vskip3mm

\noindent{\it Г.\:И. Курбатова, Е.\:М. Виноградова%$\,^1$%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (грант № 20-07-01086).\par%
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum03 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum03}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize




\noindent%
%$^2$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:}
\textit{Курбатова Г.\:И., Виноградова Е.\:М.} Аналитические и~численные решения двумерных задач теплопроводности и~электронной оптики~//
Вестник Санкт-Пе\-тер\-бург\-ского университета. Прикладная
математика. Информатика. Процессы управления. \issueyear. Т.~17.
Вып.~\issuenum.
С.~\pageref{p3}--\pageref{p3e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum03

\vskip3mm

{\leftskip=7mm\noindentДанная работа посвящена сравнительному анализу   эффективности   различных методов численного решения нестационарной двумерной задачи теплопроводности в~цилиндрической системе координат при отсутствии осевой симметрии, проведенному на  основе  полученного  аналитического  решения  двумерной  задачи  теплопроводности в~установившемся  режиме.
		%Численные решения нестационарной задачи теплопроводности получены  четырьмя  методами --- по локально-одномерной схеме Самарского, по схеме переменных направлений Писмена\,---\,Рек\-форда,  по  схеме стабилизирующей поправки  Дугласа\,---\,Рекфорда,  по семейству схем расщепления  Яненко.
		Аналитическое решение стационарной задачи для уравнения Лапласа представлено в~виде, обеспечивающем точное выполнение разрывных граничных условий.  Для сравнения эффективности  рассматриваемых    численных методов
		%Самарского, Писмена\,---\,Рекфорда, Дугласа\,---\,Рекфорда  и~ Яненко
		вычислялась  средняя по исследуемой области относительная  погрешность расчета температуры.
		%discontinuous boundary conditions
		%
		Приведенные результаты  имеют  большое  прикладное   значение  при  расчетах процессов транспортировки газа  по  морским  трубопроводам и~поля фокусирующих систем при транспортировке пучков заряженных частиц  в~задачах электронной оптики.\\[1mm]
\textit{Ключевые слова}: морские газопроводы,  метод фронтального интервала, модель теплообмена, численный метод с~повышенной точностью,  электронная оптика.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\bf 1. Введение. }  Целью работы  является  выбор эффективного метода численного решения  двумерных  задач теплопроводности  и~электронной оптики.  Известно немало подходов к~численному решению многомерных  задач теплопроводности, наибольший  интерес  представляет класс аддитивных методов  [1], которые, кроме доказанной экономичности, допускают возможность распараллеливания, что позволяет существенно  сократить  время счета.

В  работе рассмотрено решение  двумерных  параболических уравнений  в~кольцевых областях  при отсутствии осевой симметрии. Эти  уравнения   имеют большое значение в~моделировании  морских  газопроводов,  систем  электронной оптики,   упруго-деформированного  состояния тел. Численное решение таких задач получено  наиболее  популярными  аддитивными методами: 1) по локально-одномерной схеме Самарского; 2) по схеме переменных направлений Писмена\,---\,Рек\-форда;  3)  по  схеме стабилизи\-рую\-щей поправки  Дугласа\,---\,Рекфорда;   4)  по семейству схем расщепления  Яненко.


Обоснованный  выбор эффективного численного метода   облегчается при  наличии  явного аналитического решения   задачи. Для   {\it нестационарных} двумерных задач теплопроводности  в~кольцевых областях  при отсутствии осевой симметрии аналитические решения   довольно громоздки,  поэтому использование их  в~качестве  тестовых задач, по нашему мнению,  мало  перспективно.

Решения задачи  Дирихле для  {\it стационарного} уравнения  теплопроводности   в~полярных координатах для кругового кольца в~ ряде частных случаев  известны.  В~[2] указанные четыре  метода  тестировались   на    следующей задаче:
\begin{equation}
 \frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial T}{\partial r}\right)+\frac{1}{r^2}\frac{\partial}{\partial \varphi}\left(\frac{\partial T}{\partial \varphi}\right)=0,
\end{equation}%1
\begin{equation*}
r \in [R_1, 2R_1],\quad \varphi \in [0,2\pi],
\end{equation*}
\begin{equation}
 T(R_1,\varphi) =T_1+(T_2-T_1)\, (1+\mbox{cos}^2\varphi), \quad \,\varphi \in [0,2\pi],
\end{equation}%2
\begin{equation}
 T(2 R_1,\varphi) =T_2+(T_2-T_1)\, \mbox{sin}^2\varphi, \quad \quad \,\varphi \in [0,2\pi],
\end{equation}%3
 имеющей простое   аналитическое решение:
\begin{equation*}
T(r,\varphi)=(T_2-T_1)\left(\frac{5}{2}+\left(\frac{2R_1^2}{3r^2}-\frac{r^2}{6R_1^2}\right)\mbox{cos} 2\varphi\right)+2T_1-T_2.
\end{equation*}%4

Однако граничные  условия  (2), (3) редко   встречаются в~практических  задачах.
%Явные  аналитические решения уравнения Лапласа (1)  в~кольце с~произвольными  неоднородными граничными условиями  по $\varphi $   авторам  неизвестны.
В~настоящей  работе  представлено новое  аналитическое решение   краевой  задачи  для  уравнения Лапласа (1)  в~кольцевой  области   при граничных  условиях
\begin{equation}
   r = R_1, \ \varphi \in [0,2\pi]: \   T(R_1,\varphi,t)=T_0,
\end{equation}%5%4
%\begin{equation*}
%\hspace{-5.1cm}  r = R_2,
%\end{equation*}
\begin{equation}
r = R_2, \  \hspace{0.1cm}\varphi \in (-\varphi_0, \varphi_0): \   T(R_2,\varphi,t)=T_1^0,
\end{equation} %6%5
$$
 r = R_2, \  \hspace{0.1cm}\varphi \in (\varphi_0,2\pi-\varphi_0): \   T(R_2,\varphi,t)=T_2^0, \  0<\varphi_0<\pi.
$$
%$$
%0<\varphi_0<\pi.
%$$
Граничные условия  (5) позволяют  охватить  широкий класс  задач электронной  оптики  и~установившегося  теплообмена морского  газопровода   при  разных  вариантах его   заглубления  в~грунт [2, 3].


%\vskip 0.3cm


{\bf 2. Постановка нестационарной  задачи.}
Рассмотрим выход на установившийся режим распределения температуры $T=T(r,\varphi,t)$, моделируемого уравнением теплопроводности
 \begin{equation}
\frac{\partial T}{\partial t} =\frac{a}{r}\frac{\partial}{\partial r}\left( r\frac{\partial T}{\partial r}\right)+\frac{a}{r^{2}}\frac{\partial^{2}T}{\partial\varphi^{2}}, \ \ t>t_0,
\end{equation} %7%6
в кольцевой области $G = \{(r,\varphi),\  r\in[R_1,R_2), \ \varphi\in[0,2\pi] \}$
 при  краевых  условиях (4), (5),   дополнительном    условии  периодичности по переменной $\varphi$:
\begin{equation}
t>t_0, \ \  r\in[ R_1,R_2), \ \ \varphi \in [0, 2\pi]: \ \ T(r,\varphi,t)=T(r,\varphi+2\pi,t)
\end{equation} %8%7
и при  постоянном  начальном условии
\begin{equation}
 T(r,\varphi,t_0)=T_b\hspace{-0.0mm}.
\end{equation} %9%8
Величины  $T_0$, $T_1^0$, $T_2^0$, $T_b$ считаются постоянными, $a$ ---  коэффициент температуропроводности материала.
Приведем алгоритмы  численного решения нестационарной    задачи (4)--(8)  аддитивными методами.

%\vskip 0.3cm


{\bf 3. Локально-одномерная схема  Самарского.}  Эта абсолютно устойчивая разностная схема
  является аддитивной  и~экономичной,  она допускает  обобщение  на трехмерные уравнения теплопроводности.
 Оператор Лапласа в~уравнении (6) представ\-ляется  в~виде суммы двух  операторов $L_r$, $L_{\varphi}$:
%, соответствующих пространственным переменным $r$ и~$\varphi$:
\begin{equation*}
\frac{\partial T}{\partial t} = a(L_r(T) + L_{\varphi}(T)),
\end{equation*}
$$
\ \  L_r = \frac{1}{r}\frac{\partial}{\partial r}\left( r\frac{\partial }{\partial r}\right),  \ \  L_{\varphi} = \frac{1}{r^{2}}\frac{\partial^{2} }{\partial\varphi^{2}}.
$$
Переход на следующий временной слой выполняется в~два этапа.

%\underline
{Первый этап}:
 \begin{equation}\label{10}
\frac{\partial T}{\partial t} = aL_r(T) \
 \end{equation}% 10%9
 с~начальным условием (8) и~граничными условиями (4), (5).

%\underline
{Второй  этап}:
\begin{equation}
\frac{\partial T}{\partial t} = aL_{\varphi}(T) \
\end{equation}%11
с  условием периодичности (7).
В  качестве начального распределения температуры на этом этапе   используются значения  температуры,  полученные из решения соответствующих задач   первого этапа.

 Вводится равномерная пространственная сетка
$\omega = \{(r_i,\varphi_j), r_i = R_1+i h_r,\  \varphi_j = j h_{\varphi};\  i=0,\ldots,N_r; $  $j=0,\ldots, N_{\varphi}\}$    с~шагами $h_r$, $h_{\varphi}$ по переменным  $r$ и~$\varphi $ соответственно ($h_{\varphi} = 2\pi/ N_{\varphi}$, $h_r = (R_2-R_1)/N_r$);
 $\{t_n =n\tau, n = 0,1,\ldots N_{t}\}$ --- равномерная сетка по времени с~шагом $\tau$.
Каждый промежуток времени $[t_n, t_{n+1}]$ разбивается моментом  времени $t_{n+1/2} = t_n+ \tau /2$ на две равные части;  $T_{i,j}^{n+1/2}$ ---  температура в~узле $(r_i, \varphi_j, t_{n+1/2})$.

{На первом этапе} для каждого $j$ одномерное уравнение теплопроводности (9) аппроксимируется по следующей  неявной монотонной разностной схеме:
%
%Дифференциальнее операторы $L_r$   и~ $L_{\varphi}$ (\ref{5}) аппроксимируются следующим образом ($\Lambda_r \sim L_r$ и~ $\Lambda_{\varphi} \sim L_{\varphi}$):
\begin{equation}
\frac{T_{i,j}^{n+1/2}-T_{i,j}^{n}}{\tau}\! =  \! \frac{a}{r_i}\left(\! \left( r_i+\frac{h_r}{2}\right)\!\frac{T_{i+1,j}^{n+1/2}-T_{i,j}^{n+1/2}}{h_r^2} - \left( r_i-\frac{h_r}{2}\right)\!\frac{T_{i,j}^{n+1/2}-T_{i-1,j}^{n+1/2}}{h_r^2}\right)  \hspace*{-1mm},
\end{equation} %12%11
\begin{equation*}
 i = 1,\ldots,N_r-1.
\end{equation*}
Выражения  (11) записываются в~виде  трехточечных разностных уравнений
 %\begin{equation}\label{9}
%A_i T_{i-1,j}^{n+1/2}-B_i T_{i,j}^{n+1/2} +C_i T_{i+1,j}^{n+1/2} = F_i, \ \ i = 1, \ldots,N_r-1;
%\end{equation}
%\begin{equation*}
%A_i = \frac{\tau a}{h_r^2}\left( 1-\frac{h_r}{2 r_i} \right), \ \ B_i = \left( 1 + 2\frac{\tau a}{h_r^2}\right) , \ \ C_i = \frac{\tau a}{h_r^2}\left( 1+\frac{h_r}{2 r_i} \right),  \ \ F_i = -T_{i,j}^{n}.
%\end{equation*}
%Уравнения (\ref{9})
и  дополняются условиями на внутренней $i = 0$ и~внешней $i = N_r$ границах области $G$:
\begin{equation}% 13%12
T_{0,j}^{n+1/2} = T_0,
\end{equation}
\begin{equation}
T_{N_r,j}^{n+1/2} =
%\begin{cases}
%T_1^0, &j = 0,\ldots,\varphi_0/h_{\varphi}\mbox{ и~}j = N_{\varphi}-\varphi_0/h_{\varphi},\ldots,N_{\varphi},\\
%T_2^0, &j = \varphi_0/h_{\varphi} +1,\ldots,N_{\varphi}-\varphi_0/h_{\varphi}-1.
%\end{cases}
%\end{equation} %14
\begin{cases}
T_1^0, &j = 0,\ldots,(n_0-1) \mbox{ и~} j = (N_{\varphi}-n_0+1),\ldots,N_{\varphi}, \  n_0=\varphi_0/h_{\varphi}, \\
T_2^0, &j = (n_0 +1),\ldots,N_{\varphi}-(n_0+1).
\end{cases}
\end{equation} %14
Получившаяся  система с~трехдиагональной матрицей решается методом  прогонки.
%\begin{equation}\label{progonka3}
%T_{i-1,j}^{n+1/2}= \alpha_{i,j}\,T_{i,j}^{n+1/2} + \beta_{i,j}, \ \ i = N_r,\ldots,1.
%\end{equation}
%\begin{equation}\label{progonka1}
%\alpha_{0,j}=0, \ \ \beta_{0,j}=T_0;
%\end{equation}
%\begin{equation}\label{progonka2}
%\alpha_{i+1,j}=\frac{C_i}{B_i-\alpha_{i,j}\,A_i}, \ \ \beta_{i+1,j}=\frac{A_i\beta_{i,j}-F_i}{B_i-\alpha_{i,j}\,A_i}, \ \ i = 0,\ldots,N_r-1.
%\end{equation}
%\begin{equation}\label{progonka3}
%T_{i-1,j}^{n+1/2}= \alpha_{i,j}\,T_{i,j}^{n+1/2} + \beta_{i,j}, \ \ i = N_r,\ldots,1.
%\end{equation}

{На втором этапе} для каждого $i$ одномерное   уравнение теплопроводности (10) аппроксимируется по   неявной разностной схеме
\begin{equation}
\frac{T_{i,j}^{n+1}-T_{i,j}^{n+1/2}}{\tau} = a\frac{T_{i,j+1}^{n+1}-2T_{i,j}^{n+1}+T_{i,j-1}^{n+1}}{r_i^2h_{\varphi}^2},  \ \ j = 0,\ldots,N_{\varphi}.
\end{equation}% %14
Уравнения (14) совместно с~ разностным аналогом условий периодичности (7)
\begin{equation}
T_{i,j+N_{\varphi}}^{n+1}=T_{i,j}^{n+1}
\end{equation} %15
приводятся к~системе разностных уравнений
%которая решается методом циклической прогонки \cite{AbramovAndreeva} для каждого фиксированного $i$ ($i = 0,\ldots,N_r$)
\begin{equation*}
T_{i,N_{\varphi}-1}^{n+1}-C_{i,j}T_{i,0}^{n+1}+T_{i,1}^{n+1}=-F_{i,0},
\end{equation*}
\begin{equation} %16
T_{i,j-1}^{n+1}-C_{i,j}T_{i,j}^{n+1}+T_{i,j+1}^{n+1}=-F_{i,j},  \ \ j = 1,\ldots,N_{\varphi}-1,
\end{equation}
\begin{equation*}
T_{i,N_{\varphi}-1}^{n+1}-C_{i,j}T_{i,{N_{\varphi}}}^{n+1}+T_{i,0}^{n+1}=-F_{i,N_{\varphi}},
\end{equation*}
\begin{equation*}
C_{i,j} = 2 +\frac{r_i^2 h_{\varphi}^2}{a\tau},  \ F_{i,j} = \left( \frac{r_i^2 h_{\varphi}^2}{a\tau}\right)T_{i,j}^{n+1/2} \hspace{-1mm}.
\end{equation*}
Матрица этой системы не имеет трехдиагонального вида. Чтобы ее решить,  для каждого $i$  использовался   метод циклической прогонки, который,  как  известно [4],  яв\-ляет\-ся  экономичнее итерационных.
%Приведем алгоритм  метода циклической прогонки для второго этапа локально-одномерной схемы Самарского.
%Решение системы (16) ищется в~виде
%\begin{equation*}
%T_{i,j}^{n+1}= p_{i,j}+ T_{i,N_{\varphi}}^{n+1}q_{i,j}, \ \ j = 1,\ldots, N_{\varphi}-1,
%\end{equation*}
%\begin{equation*}
%T_{i,N_{\varphi}}^{n+1} =T_{i,0}^{n+1}=\frac{\beta_{i,N_{\varphi}+1}+\alpha_{i,N_{\varphi}+1} p_{i,0}}{1-\alpha_{i,N_{\varphi}+1} %q_{i,0}-\gamma_{i,N_{\varphi}+1}}.
%\end{equation*}
%Коэффициенты $p_{i,j}$, $q_{i,j} $  находятся из следующих рекуррентных соотношений:
%\begin{equation} %17
%p_{i,N_{\varphi}-1} = \beta_{i,N_{\varphi}}, \ \ q_{i,N_{\varphi}-1} = \alpha_{i,N_{\varphi}}+\gamma_{i,N_{\varphi}}\end{equation}
%\begin{equation}\%18
%p_{i,j} = \alpha_{i,j+1}p_{i,j+1} + \beta_{i,j+1},  \ \  q_{i,j} = \alpha_{i,j+1}q_{i,j+1} + \gamma_{i,j+1}, \ \ j = N_{\varphi}-2,\ldots,0.
%\end{equation}
%Коэффициенты  $ \alpha_{i,j+1}$, $\beta_{i,j+1}$ и~$\gamma_{i,j+1}$ в~(17) и~(18) определены  соотношениями:
%\begin{equation*}
%\alpha_{i,1} = \frac{1}{C_{i,j}}, \ \ \beta_{i,1} = \frac{F_{i,0}}{C_{i,j}}, \ \ \gamma_{i,1} = \frac{1}{C_{i,j}},
%\end{equation*}
%\begin{equation*}
%\alpha_{i,j+1} = \frac{1}{C_{i,j}-\alpha_{i,j}}, \ \ \beta_{i,j+1} = \frac{F_{i,j}+\beta_{i,j} }{C_{i,j}-\alpha_{i,j}}, \ \ \gamma_{i,j+1} = %\frac{\gamma_{i,j}}{C_{i,j}-\alpha_{i,j}},
%\end{equation*}
%\begin{equation*}
 %j=1,\ldots,N_{\varphi},\ \ i = 0,\ldots,N_r-1.
%\end{equation*}
%Пример  сравнения  численного  решения  задачи   (5)--(9) по  алгоритму локально-одномерной схемы Самарского  с~аналитическим  решением  приведен далее.


%\bigskip

%\vskip 0.3cm


{\bf 4. Метод  переменных направлений  Писмена\,---\,Рекфорда.} Он широко применяется  для решения двумерных параболических уравнений. Решение задачи (4)--(8)  этим методом также проводится в~два этапа.

{На  первом этапе} уравнение (6) аппроксимируется  неявной  разностной  схемой по  переменной $r$  и~явной  ---  по  переменной  $\varphi$:
\begin{equation} %17
\frac{T_{i,j}^{n+1/2}-T_{i,j}^{n}}{\tau} = 0.5\left( \Lambda_r \left( T_{i,j}^{n+1/2}\right) + \Lambda_{\varphi}\left(  T_{i,j}^{n} \right)  \right)\hspace{-1mm}.
\end{equation}

{На  втором этапе}   используется  явная  разностная   схема  по     переменной\  $r$  и~неяв\-ная~--- по $\varphi$:
 \begin{equation}%18
\frac{T_{i,j}^{n+1}-T_{i,j}^{n+1/2}}{\tau} = 0.5\left( \Lambda_r \left( T_{i,j}^{n+1/2}\right) + \Lambda_{\varphi}\left(  T_{i,j}^{n+1} \right)  \right)\hspace{-1mm}.
\end{equation}
%\begin{equation*}
%T_{i,j}^{0}=T_b.
%\end{equation*}
%Дифференциальнее операторы $L_r$   и~ $L_{\varphi}$ (\ref{5}) аппроксимируются следующим образом ($\Lambda_r \sim L_r$ и~ $\Lambda_{\varphi} \sim L_{\varphi}$):
Разностные операторы $\Lambda_r$, $\Lambda_{\varphi}$   записываются следующим образом:
\begin{equation*}%19
\Lambda_r \left( T_{i,j}^{n+1/2}\right)  =
\begin{cases}
&a\left( 1+\frac{h_r}{2r_0}\right)\frac{T_{1,j}^{n+1/2}-T_{0,j}^{n+1/2}}{h_r^2}, \ i=0,\\
& \\
&a\left( \left(1 +\frac{h_r}{2r_i}\right)\frac{T_{i+1,j}^{n+1/2}-T_{i,j}^{n+1/2}}{h_r^2} - \left( 1-\frac{h_r}{2r_i}\right)\frac{T_{i,j}^{n+1/2}-T_{i-1,j}^{n+1/2}}{h_r^2}\right)\hspace{-1mm}, \ i\not =0,
\end{cases}
\end{equation*}
\begin{equation*}%20
\Lambda_{\varphi}\left( T_{i,j}^{n} \right)  = a\frac{T_{i,j+1}^{n}-2T_{i,j}^{n}+T_{i,j-1}^{n}}{r_i^2h_{\varphi}^2}.
\end{equation*}

Уравнения (17) дополняются условиями (8), (12), (13), а~уравнения  (18) ---  условиями периодичности  (15);  в~качестве начального распределения на  втором этапе при\-ме\-няют\-ся значения  температуры,  полученные из решения   задач на первом этапе.

{На первом этапе} уравнения (17)  приводятся к~трехточечным разностным, которые   решаются методом прогонки  для каждого  $j$.
%в которых коэфициенты   $A_i$, $B_i$, $C_i$, $F_i$  имеют следующий вид:
%\begin{equation*}
%A_i = g\left( 1-\frac{h_r}{2r_i}\right) , \ \ B_i = \left( 1+\frac{2g}{r_i}\right) , \ \ C_i = g\left( 1+\frac{h_r}{2r_i}\right),
%\end{equation*}
%\begin{equation*}
 %F_i = -T_{i,j}^{n}-\frac{0.5\tau a}{h_{\varphi}^2 r_i^2}\left(T_{i,j+1}^{n}-2T_{i,j}^{n}+T_{i,j-1}^{n}   \right), \ \ g = \frac{0.5\tau a}{h_{r}%^2}.
%\end{equation*}
%Эти разностные уравнения решаются методом прогонки  для каждого  $j$.

{На втором этапе} разностная аппроксимация (18)  для каждого  $i$ приводит к~системе типа (16) с~соответствующими  коэффициентами $C_{i,j}$, $F_{i,j}$. Решение  этой  системы   проводилось с~помощью     циклической   прогонки.
%\begin{equation*}
%C_{i,j}=2+\frac{r_i^2 }{f}, \ \ F_{0,j} =  \frac{R_1^2 }{f}T_{0,j}^{n+1/2} +  \frac{g}{f}\left( 1+\frac{h_r}{2R_1}\right)(T_{1,j}^{n+1/2}-T_{0,j}^{n+1/2}),
%\end{equation*}
%\begin{equation*}
% F_{i,j} =  \frac{r_i^2 }{f}T_{i,j}^{n+1/2} + \frac{g}{f}\left( \left( 1+\frac{h_r}{2r_i}\right)\left( T_{i+1,j}^{n+1/2}-T_{i,j}^{n+1/2}\right)  - \left( 1-\frac{h_r}{2r_i}\right)\left( T_{i,j}^{n+1/2}-T_{i-1,j}^{n+1/2}\right) \right),
%\end{equation*}
%\begin{equation*}
% F_{N_r,j} = \frac{R_2^2 }{f}T_{0,j}^{n+1/2} -  \frac{g}{f}\left( 1-\frac{h_r}{2R_2}\right)(T_{N_r,j}^{n+1/2}-T_{N_r-1,j}^{n+1/2}),
%\end{equation*}
%\begin{equation*}
%f = \frac{0.5 a \tau}{ h_{\varphi}^2}, \ \ g = \frac{0.5\tau a}{h_{r}^2}.
%\end{equation*}

%Пример  сравнения  численного  решения  задачи   (5)--(9) по  алгоритму метода Писмена\,---\,Рекфорда  с~полученным  аналитическим  решением  приведен далее.



%\bigskip

Ввиду  ограниченности  объема  статьи  алгоритмы   метода стабилизирующей поправки Дугласа\,---\,Рекфорда  и~метода  расщепления Яненко не  приведены,   представлены только результаты  расчетов относительной  погрешности  численного  решения  задачи   (4)--(8)  на  основе полученного  аналитического   решения.


%\vskip 0.3cm


{\bf 5. Аналитическое решение стационарного варианта задачи (4)--(8).}
Трудность аналитического решения этой задачи заключается в~наличии разрыва температуры в~граничной точке ($r=R_2$, $\varphi=\varphi_0$). Построенное аналитическое решение позволяет  удовлетворить граничному условию с~точкой разрыва. Воспользуемся подходом, предложенном в~работе [5]. При граничных условиях (4), (5) распределение температуры симметрично относительно  лучей $\varphi= \pi k $ ($k=0,1$), поэтому достаточно найти решение задачи в~секторе  $\varphi\in [0,\pi]$.
%Функция распределения температуры  $T(r,\varphi)$ удовлетворяет уравнению Лапласа (17) и~граничным условиям (18), (19).
Для решения краевой задачи (1), (4), (5) внутренняя область ($r\in [R_1, R_2)$,  $\varphi\in [0,\pi]$) разбивается на такие подобласти:
{ I} --- $\varphi\in [0,\varphi_{0})$; $r\in [R_1, R_2)$;
{ II} --- $\varphi\in (\varphi_{0}, \pi]$; $r\in [R_1, R_2)$.
В каждой из них распределение температуры представляется следующим образом:
\begin{equation}
\begin{array}{l}
T_{\rm I}(r,\varphi)=T_0+(T_1^0-T_0)\dfrac{\ln ({r}/{R_{1}})}{\ln ({R_{2}}/{R_{1}})}
+\hat{T}_{\rm I}(r,\varphi),
\\[2mm]
T_{\rm II}(r,\varphi)=T_0+(T_2^0-T_0)\dfrac{\ln ({r}/{R_{1}})}{\ln ({R_{2}}/{R_{1}})}
+\hat{T}_{\rm II}(r,\varphi).
\end{array}
\end{equation}%21%19
Функции $\hat{T}_{\rm I}(r,\varphi)$, $\hat{T}_{\rm II}(r,\varphi)$ являются решениями уравнения Лапласа (1) при {\it однородных} граничных условиях в~областях {I} и~{II}:
\begin{equation}
\hat{T}_{\rm I}(R_1,\varphi)=\hat{T}_{\rm I}(R_2,\varphi)=0, \ \ \  \hat{T}_{\rm II}(R_1,\varphi)=\hat{T}_{\rm II}(R_2,\varphi)=0.
\end{equation}%22%20
Краевые задачи (20) для  функций $\hat{T}_{\rm I}(r,\varphi)$, $\hat{T}_{\rm II}(r,\varphi)$  решаются методом разделения переменных. Опуская выкладки, приведем   эти решения:
%
\begin{equation}
	\begin{array}{c}
		\hat{T}_{\rm I}(r,\varphi)=\sum\limits_{n=1}^{\infty} a_{n}\dfrac{\cosh(\lambda_{n}\varphi)}{\cosh(\lambda_{n}\varphi_{0})}\sin\left(\lambda_{n} \ln\dfrac{r}{R_{1}}\right),
				\\[2mm]
				\displaystyle
		\hat{T}_{\rm II}(r,\varphi)=\sum\limits_{n=1}^{\infty} b_{n}\dfrac{\cosh(\lambda_{n}(\pi-\varphi))}{\cosh(\lambda_{n}(\pi-\varphi_{0}))}\sin\left(\lambda_{n} \ln\dfrac{r}{R_{1}}\right),\ \ \ \ \ \lambda_{n}=\frac{\pi n}{\ln ({R_{2}}/{R_{1}})}.
	\end{array}
\end{equation}%23%21
Коэффициенты $a_n$, $b_n$ в~рядах (21) находятся из условий непрерывности функций ${T}_{\rm I}(r,\varphi)$, ${T}_{\rm II}(r,\varphi)$ и~их производных по переменной $\varphi$ при $\varphi=\varphi_0$, $r\in [R_1,R_2)$,  которые  имеют вид
\begin{equation}
a_n=(T^0_2-T^0_1)\dfrac{2(-1)^{n+1}}{\pi n}\dfrac{\tanh(\lambda_{n}(\pi-\varphi_{0}))}{\tanh(\lambda_{n}\varphi_0)+\tanh(\lambda_{n}(\pi-\varphi_{0}))},
\end{equation}%24%22

\begin{equation}
b_n=(T^0_2-T^0_1)\dfrac{2(-1)^{n}}{\pi n}\dfrac{\tanh(\lambda_{n}\varphi_0)}{\tanh(\lambda_{n}\varphi_0)+\tanh(\lambda_{n}(\pi-\varphi_{0}))}.\end{equation}%25%23
Формулы  (19), (21)--(23) представляют собой точное аналитическое решение  краевой задачи (1), (4), (5).


%\vskip 0.3cm


{\bf 6. Оценка достаточного числа членов в~бесконечных рядах (21), обеспечивающего заданную точность аналитического решения.} Рассмотрим,  например, подобласть  {I}.
Функция $\hat{T}_{\rm I}(r,\varphi)$ (21) представлена бесконечным рядом, который имеет, как нетрудно показать, экспоненциальную сходимость.   Запишем функцию $\hat{T}_{\rm I}(r,\varphi)$ (21) так:
$$
\hat{T}_{\rm I}(r,\varphi)=\sum \limits_{n=1}^{N_*}S_n+\sum\limits_{n=N_*+1}^{\infty}S_n,
$$
\begin{equation}
%\begin{array}{l}  	
S_n\!=\!\dfrac{2(T^0_2-T^0_1)(-1)^{n+1}}{\pi n}\dfrac{\tanh(\lambda_{n}(\pi-\varphi_{0}))}{\tanh(\lambda_{n}\varphi_0)\!+\tanh(\lambda_{n}(\pi\!-\!\varphi_{0}))}\dfrac{\cosh(\lambda_{n}\varphi)}{\cosh(\lambda_{n}\varphi_{0})}\sin\!\left(\!\lambda_{n} \ln\!\dfrac{r}{R_{1}}\!\right)\!.
%\end{array}
\end{equation}%26%24
Воспользуемся мажорирующим рядом и~оценим число $N_*$ членов ряда, начиная с~ которого сумма бесконечного ряда $\bigg( \sum\limits_{n=N_*+1}^{\infty}S_n\bigg)$ будет меньше заданной малой величины $\varepsilon_0$ (в К). Опуская выкладки, приведем найденную оценку $N_*(\varepsilon_0)$ для  подобласти~{I}:

\begin{equation*}
	N_*(\varepsilon_0)\ge \dfrac{1}{\beta}\left(\ln\dfrac{\alpha}{\varepsilon_0(\exp\left(\beta\right)-1)}\right),
\ \ \ \alpha=\dfrac{4(T^0_2-T^0_1)}{\pi}, \ \ \ \beta=\frac{\pi (\varphi_{0}-\varphi)}{\ln ({R_{2}}/{R_{1}})}, \ \ \ \varphi\in [0,\varphi_{0}).
\end{equation*}%27
Таким образом, функция $\hat{T}_{\rm  I}(r,\varphi,N_*)=\sum\limits_{n=1}^{N_*}S_n$ с~точностью до $\varepsilon_0$ является решением уравнения (1) с~граничными условиями  $\hat{T}_{\rm I}(R_1,\varphi)=\hat{T}_{\rm I}(R_2,\varphi)=0$   в~подобласти {I}. При $\varphi=\varphi_0=\pi/2$  выражение для $S_n$ (24) упрощается и~бесконечный  ряд для $\hat{T}_{\rm I}(r,\varphi)$ (21) суммируется, функция $\hat{T}_{\rm I}(r,\pi/2)$ имеет вид
\begin{equation*}
\begin{array}{l}
\hat{T}_{\rm I}(r,\pi/2)=\left(\dfrac{T^0_2-T^0_1}{2}\right)\dfrac{\ln ({r}/{R_{1}})}{\ln ({R_{2}}/{R_{1}})}, \ \ \  r\in [R_1,R_2).
\end{array}
\end{equation*}%28
Если $\varphi_0\ne \pi/2$, то на луче $\varphi=\varphi_0$,  исключая особую точку $r=R_2$,  оценка $N_*(\varepsilon_0)$ усложняется, но не представляет принципиальной трудности.

Аналогичным \ образом\   получаются \  оценки  для функции\ \ $\hat{T}_{\rm II}(r,\varphi)$\ \ (21) \  в~\ подоб\-ласти~{II}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55

%\vskip 0.3cm


{\bf 7. Результаты расчетов.}
Для  каждого  набора  параметров задачи  (4)--(8)  рассчитывался   момент времени $t_*$, начиная с~которого с~заданной  точностью $\varepsilon$  устанавливается стационарное распределение температуры $T_{i,j}^*$.

Для сравнения эффективности  рассматриваемых    численных методов
%Самарского, Писмена\,---\,Рекфорда, Дугласа\,---\,Рекфорда  и~Яненко
вычислялась  величина  $\delta^{(k)}$ ---  \textit{средняя по  области $G$  относительная  погрешность   расчета температуры   по   $k$-му   методу    для  момента  времени,  большего момента  $t_*$}:

\begin{equation}
\delta^{(k)} = \frac{1}{N_{\varphi}N_r}\sum_{j=0}^{N_{\varphi}-1}\sum_{i=0}^{N_r-1}\left(\frac{|T^{a}(r_i,\varphi_j) - T_{i,j}^{(k)*}|}{T^a(r_i,\varphi_j)}  \right).
\end{equation}%25
В (25) $T^{a}(r_i,\varphi_j)$ --- температура, определенная по  найденному  аналитическому  решению (21)--(23),   $T_{i,j}^{(k)*}$ ---   температура  в~узле  $(i,j)$  в~момент  времени  $t^n>t^*$,  рассчитанная  по алгоритму    $k$-го  численного  метода  при  одних  и~тех  же  значениях  шагов $h_r, h_{\varphi}, \tau$
%
(при параметрe  $\sigma = 0.9$ $k=1$ соответствует  расчету по  локально-одномерной схеме Самарского, $k=2$ ---  по  схеме переменных направлений Писмена\,---\,Рекфорда, $k=3$ --- по схеме стабилизирующей поправки Дугласа\,---\,Рекфорда, $k=4$ --- по семейству схем  Яненко).


%\smallskip

%\bigskip   \textbf{Результаты расчетов.}

В качестве иллюстрации  расчетов величин  $\delta^{(k)}$     представим   результаты вычислений при следующем варианте параметров  задачи:
%\begin{equation*}
% R_1 = 0.5 \mbox{ м}, \ \  R_2 = 0.54 \mbox{ м}, \ \ a = 5.33\cdot10^{-6}  \mbox{ м}^2/\mbox{c}, \ \ T_b=283.15\ \mbox{ К},
%\end{equation*}
%\begin{equation} \label{params}
%T_0 = 293.15 \mbox{ К}, \ \ T_1^0 = 278.15 \mbox{ К}, \ \ T_2^0 = 283.15 \mbox{ К}, \ \ \varphi_0=\pi/2,
%\end{equation}
%\begin{equation*}
%N_{\varphi}=240, \ \ N_r=41, \ \ \tau=0.001\mbox{ c}, \ \ \varepsilon_0= 10^{-7} \mbox{ К}.
%\end{equation*}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{equation*}
 R_1 = 0.5 \mbox{ м}, \   R_2 = 0.54 \mbox{ м},\ \varphi_0=\pi/2,  \  \ T_b=283.15 \mbox{ К}, \ T_0 = 293.15 \mbox{ К}, \ T_1^0 = 278.15 \mbox{ К},
\end{equation*}
\begin{equation} \label{params}
 T_2^0 = 283.15 \mbox{ К}, \ a = 5.33\cdot10^{-6}  \mbox{ м}^2/\mbox{c}, \  N_{\varphi}=240, \  N_r=41, \  \tau=0.001\mbox{ c}.
\end{equation}%29%30
При этих  параметрах  время $t_{*}$ выхода  численного решения задачи (4)--(8)  на установившийся режим с~точностью до сотых градуса  $t_{*} \approx 9.6$ мин. Количество $N_{*}$  членов ряда, обеспечивающее равномерно по всем $r$ и~ $\varphi$ из расчетной области точность аналитического решения   порядка $ 10^{-8}$  $N_{*}=19$.
Приведем результаты расчетов средней  относительной  погрешности  $\delta^{(k)}$ указанными в п.~1 методами  для  варианта параметров~(26):

\vskip 0.1cm

 \begin{center}
%          Таблица 1. Средняя   относительная  погрешность $\delta^{(k)}$  расчета температуры.
%            \vskip 5mm
%            \begin{tabular}{|c|c|c|c|}
%\hline
%\vspace*{1mm}
%$\delta^{(1)}$  & $\delta^{(2)}$  &  $\delta^{(3)}$  & %$\delta^{(4)}$      \\
%\hline
%\vspace*{1mm}
% $7.71\,\cdot 10^{-4} $  &  $6.57\, \cdot  10^{-4} $ &  $7.75\, \cdot  %10^{-4} $ &  $7.83\, \cdot  10^{-4} $     \\
%\hline
%           \end{tabular}
$\delta^{(1)}=7.71\,\cdot 10^{-4} $;\ \  $\delta^{(2)}=6.57\, \cdot  10^{-4} $; \ \ $\delta^{(3)}=7.75\, \cdot  10^{-4} $;\ \  $\delta^{(4)}=7.83\, \cdot  10^{-4} $.


           \end{center}
%\vskip 0.1cm


{\bf 7. Заключение.} Проведенные расчеты по локально-одномерной схеме Самарского, по схеме переменных направлений Писмена\,---\,Рекфорда, по схеме стабилизирующей поправки Дугласа\,---\,Рекфорда и~по семейству схем Яненко двумерного уравнения теплопроводности в~кольце с~неоднородными граничными условиями по $\varphi$  для разных вариантов параметров подтвердили вывод, сделанный в~работе [2]: наиболее эффективным для решения таких задач является  метод Писмена\,---\,Рекфорда. При одних и~тех же значениях шагов он точнее в~расчетах временных характеристик  и~не уступает другим рассмотренным методам в~точности расчета пространственного  распределения температуры.
Однако обобщение метода Писмена\,---\,Рекфорда на  трехмерные задачи сопряжено с~большими трудностями [1]. Этого недостатка лишена локально-одномерная схема Самарского, точность  расчета  пространственного  распределения температуры которой не меньше,  чем у метода Писмена\,---\,Рекфорда.



Найденное  аналитическое  решение  краевой  задачи для   двумерного уравнения  Лапласа  имеет  также   большое  значение в~задачах  электронной оптики  для  расчета поля фокусирующих систем при транспортировки пучков заряженных частиц в~ускорительной технике и~электронной микроскопии  [5].

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{03/lit-ra}

%\newpage
\input{03/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
