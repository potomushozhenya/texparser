%
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,17.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.8cm} \noindent {\large ИНФОРМАТИКА} \vspace{1.5cm}%1.8cm}

\noindent{\small UDC 004.8\\ %  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~14.~Вып.~\issuenum}\\
MSC 68T50

}

\vskip2mm

\noindent{\bf Research of features of Dostoevsky's publicistic style by using \textit{n}-grams  based on the materials of the ``Time'' and ``Epoch'' magazines$^{*}$%
 }

\vskip2.5mm

\noindent{\it R. V. Abramov, K. A. Kulakov, A. A. Lebedev, N. D. Moskin, A. A. Rogov%$\,^1$
%, A.~M.~Sazonov%$\,^2$%
%, I.~О. Famylia%$\,^2$%
}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ This work
was supported by the Russian Foundation for Basic Research (project N 18-012-90026).\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} St. Petersburg State University, \issueyear%
%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07} }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum07}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


%\noindent%
%%$^2$~%
%St.\,Petersburg State University, 7--9,
%Universitetskaya nab., St.\,Petersburg,
%
%\noindent%
%%\hskip2.45mm%
%199034, Russian Federation



\noindent%
%$^2$~%
Petrozavodsk State University, 33, pr. Lenina, Petrozavodsk,

\noindent%
%\hskip2.45mm%
185910, Russian Federation

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{For citation:} Abramov R. V., Kulakov K. A., Lebedev A. A., Moskin N. D., Rogov A. A.
Re\-search of features of Dostoevsky's publicistic style by using \textit{n}-grams based
on the materials of the ``Time'' and ``Epoch'' magazines.
{\it Vestnik of Saint~Pe\-tersburg University. Applied
Mathematics. Computer Science. Control Processes}, \issueyear,
vol.~17, iss.~\issuenum, pp.~\pageref{p7}--\pageref{p7e}.\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum07

\vskip3mm

{\leftskip=7mm\noindent The paper is devoted to the study of the publicity style of F. M. Dostoevsky on the basis of publications in the journals ``Time'' and ``Epoch'' (1861--1865). For this, fragments of texts (including other authors: M. M. Dostoevsky, N. N. Strakhov, A. A. Golovachev, etc.) were selected in sizes of 500, 700 and 1000 words, on which the occurrence of bigrams and trigrams (encoded sequences of parts of speech) were counted. Decision trees were built on their basis and an analysis of the accuracy of text recognition was performed.  If we consider
the class cation at the rest level of the tree (fragment size 1000), then the accuracy was on average 87 %. This feature is the percentage of the presence of the  adjective-noun  bigram. When analyzing trigrams, the most sign cant feature at the rst level was the   noun-adjective-noun? sequence. The article also discusses the problem of comparing the
resulting decision trees.\\[1mm]
\textit{Keywords}: publicity style, text attribution, decision tree, $n$-gram, F. M. Dostoevsky, in\-for\-ma\-tion system ``Statistical methods for analyzing literary texts'', tree matching.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{hyphenrules}{english}


{\bf 1. Introduction.}
The paper is devoted to the research of the publicistic style of F.~M.~Dostoevsky based on articles
in the magazines ``Time'' and ``Epoch'' (1861--1865). The~list of studied texts, the authors of which in addition
to F.~M.~Dostoevsky are M.~M.~Dostoevsky, N.~N.~Strakhov, A.~A.~ Golovachev, I.~N.~Shill, A.~Grigoriev,
A.~U.~Poretsky and Ya.~P.~Polonsky, is presented in Table 1. There are 19 texts in total, 12 of them belong
to F. M. Dostoevsky and 7 to other authors. The size of a single text is at least 1300 words. Note that some
other articles from these journals still do not have an author, therefore, this work should be considered
in the context of a broader problem, namely attribution of texts (establishment of authorship of anonymous texts).
This problem, which has been declared in the philological community for a long time, is still far from being solved,
and the ownership of certain articles by F. M. Dostoevsky continues to cause lively discussions among experts.
It is for this reason that there is a need to use methods that are not quite traditional for literary studies
as a scientific field for consideration of the required issues~[1].

Mathematical methods and computer technologies can be used to solve this problem [2--8]. Note some authors who used
mathematical methods to solve the problem of text attribution: A.~Q.~Morton, T.~C.~Mendenhall, J.~M.~Farringdon, B.~Efron,
R.~Thisted, W.~J.~Teahan, C.~E.~Chaski, E.~Stamatatos, P.~Juola, R.~D.~Peng, T.~Joachims, J.~J.~Diederich,
C.~Apte, D.~Lowe, R.~Matthews, F.~J.~Tweedie, O.~de Vel, S.~Argamon, S.~Levitan, R.~Zheng. Among other methods of data
mining, decision trees are distin\-gui\-shed by the fact that they are easy to understand and interpret and also do not
require special preliminary data processing.
The specificity of this study is that the analyzed texts are presented
in a pre-reform orthography, which makes it necessary to create new or modernize existing approaches.
By itself, the orthography in the middle of the $19^{\rm th}$ century implies a certain variability of spellings,
which complicates the automatic processing of sources. But at the same time it better allows to trace
the features of the individual author's style, demonstrated in the construction of the text at its different levels.

Usually ``author's style'' means three levels: syntactic, lexical-phraseological and stylistic, although texts can
also be studied at the punctuation and orthography levels. Our proposed analysis is based on taking into account
grammatical and morphological features (namely, the distribution of parts of speech within the analyzed texts),
which should also be considered a distinguishing feature of the work of a particular author.

%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Table 1.} {\bf Source texts for analysis}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{ | c | l | l | c | c | c | c | }
\hline
Code & \multicolumn{1}{c|}{Name} & \multicolumn{1}{c|}{Author} & Journal & Year & \multicolumn{2}{c|}{Number of} \\
\cline{6-7}
& & & & & journal & words \\
\hline
2 &  Fires & F. M. Dostoevsky & Time & 1862 & 1 & 1943 \\
11 & Taras Shevchenko & A. Grigoriev & Time & 1861 & 4 & 1724 \\
13 & Letter to the editor & Y. P. Polonsky & Time & 1863 & 3 & 2303 \\
34 & Literary hysteria & F. M. Dostoevsky & Time & 1861 & 7 & 2808 \\
35 & Young pen & F. M. Dostoevsky & Time & 1863 & 2 & 1872 \\
40 & Subscription for & M. M. Dostoevsky & Time & 1863 & 1 & 2541 \\
& 1863 year & & & & & \\
42 & A number of & F. M. Dostoevsky & Time & 1861 & 1 & 12508 \\
& articles about & & & & & \\
& Russian literature. & & & & & \\
& Introduction & & & & & \\
43 & Slavophiles, & F. M. Dostoevsky & Time & 1862 & 9 & 2058 \\
& montenegrins and & & & & & \\
& westernizers & & & & & \\
75 & A number of articles & F. M. Dostoevsky & Time & 1861 & 2 & 11053 \\
& about Russian & & & & & \\
& literature. G.-bov and & & & & & \\
& the question of art & & & & & \\
77 & Bookness and & F. M. Dostoevsky & Time & 1861 & 8 & 14210 \\
& literacy. Article two & & & & & \\
78 & Recent literary & F. M. Dostoevsky & Time & 1861 & 11 & 4323\\
& phenomena. The & & & & & \\
& newspaper ``Day'' & & & & & \\
82 & The necessary & F. M. Dostoevsky & Time & 1863 & 1 & 3680 \\
& literary explanation & & & & & \\
& about the work... & & & & & \\
86 & To finish. The & F. M. Dostoevsky & Epoch & 1864 & 9 & 1378 \\
& last explanation & & & & & \\
& from ``Modern...'' & & & & & \\
87 & Political review & A. A. Golovachev & Epoch & 1864 & 8 & 10309 \\
89 & Lermontov and his & A. Grigoriev & Time & 1862 & 11 & 7480 \\
& direction. Article two & & & & & \\
92 & Our household chores & A. U. Poretsky & Epoch & 1864 & 12 & 8602 \\
96 & Voice for the & F. M. Dostoevsky & Time & 1862 & 10 & 1334\\
& Petersburg Don & & & & & \\
& Quixote (Regarding & & & & & \\
& the articles by & & & & & \\
& G. Teatrin) & & & & & \\
97 & Remark & F. M. Dostoevsky & Epoch & 1864 & 9 & 1599 \\
116 & Bad signs & N. N. Strakhov & Time & 1862 & 11 & 6331 \\
\hline
\end{tabular}

}
\end{center}\vspace{-3mm}
\end{table}
%\vskip 2mm



{\bf 2. Research methods (description of the experiment).}
In our research of texts \textit{n}-grams (sequences of $n$ elements --- encoded parts of speech) were constructed,
which proved themselves well in solving problems of determining authorship. For example, in [9]
it is shown how to identify non-uniform fragments in the text using 4-grams and counting $\chi^2$ statistics.
In [10] a nonlinear method for constructing \textit{n}-grams based on syntactic dependency trees using
the Stanford analyzer is considered.

In our case the SMALT information system (``Statistical methods for analyzing li\-te\-rary texts'') developed
at the Petrozavodsk State University was used [11]. Specialists in philology carried out grammatical
markup of texts, which took into account 14 parts of speech (noun, adjective, numeral, pronoun, adverb,
category of state, verb, participle, gerund, preposition, conjunction, particle, modal word, interjection).
It also made possible to mark the encountered words as quotes, foreign words, introductory words, abbreviated
words and non-linguistic symbols.

The texts were analyzed using bigrams as follows: the fragment size (500, 700 and 1000 words) and the step
(100, 200 words, etc.) were allocated to select the beginning of the next fragment. Then the frequency of
occurrence of \textit{n}-grams in texts was calculated.



\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{07/fig1a}

%\vskip 2mm {\small{\it Рис. 1.} текст крупный} }
\vskip 5mm

\includegraphics[scale=1]{07/fig1b}

\vskip 2mm {\small{\it Figure.} Decision tree (step 100 words, fragment 1000 words)} \\
{\footnotesize \textit{a} --- bigram; \textit{b} --- trigram.
} }
\end{figure}













The constructed fragments were analyzed using the decision tree. At the same time, the texts of F. M. Dostoevsky
were considered against other authors. In this context, we can mention the well-known machine learning algorithm
called random forest, which was proposed in 2001 [12].

A decision tree is an acyclic graph that classifies objects (in our case, texts) described by a set of features.
Each node in the tree contains a branching condition for one of the attributes. In the classification process
sequential transitions are performed from one node to another in accordance with the values of the object's
attributes (in practice binary trees are usually used).

As a result of their consideration, it turned out that a tree of depth 3 is sufficient to determine the morphological
features of the publicistic style of F. M. Dostoevsky and other writers (Figure, \textit{a}, \textit{b} show fragments
of graphs obtained as a result of calculations with a step of 100 words and a fragment size of 1000 words for bigram
and trigram).



%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Table  2.} {\bf Classification accuracy for different fragments}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{ | c | c | c | c | c | }
\hline
Depth of & Size of sliding & Number of & Fragment size & Accuracy, \% \\
the tree & window & fragments & & \\
\hline
1 & 100 & 816 & 500 & 79.0 \\
2 & 100 & 816 & 500 & 79.0 \\
3 & 100 & 816 & 500 & 83.0 \\
1 & 100 & 790 & 700 & 83.0 \\
2 & 100 & 790 & 700 & 84.0 \\
3 & 100 & 790 & 700 & 88.0 \\
1 & 100 & 751 & 1000 & 87.0 \\
2 & 100 & 751 & 1000 & 90.0 \\
3 & 100 & 751 & 1000 & 91.0 \\
1 & 200 & 405 & 500 & 77.0 \\
2 & 200 & 405 & 500 & 79.0 \\
3 & 200 & 405 & 500 & 86.0 \\
1 & 200 & 392 & 700 & 82.0 \\
2 & 200 & 392 & 700 & 83.0 \\
3 & 200 & 392 & 700 & 89.0 \\
1 & 200 & 372 & 1000 & 88.0 \\
2 & 200 & 372 & 1000 & 91.0 \\
3 & 200 & 372 & 1000 & 93.0 \\
1 & 300 & 268 & 500 & 80.0 \\
2 & 300 & 268 & 500 & 80.0 \\
3 & 300 & 268 & 500 & 86.0 \\
1 & 300 & 260 & 700 & 82.0 \\
2 & 300 & 260 & 700 & 83.0 \\
3 & 300 & 260 & 700 & 88.0 \\
1 & 300 & 247 & 1000 & 87.0 \\
2 & 300 & 247 & 1000 & 91.0 \\
3 & 300 & 247 & 1000 & 91.0 \\
1 & 400 & 199 & 500 & 81.0 \\
2 & 400 & 199 & 500 & 81.0 \\
3 & 400 & 199 & 500 & 88.0 \\
1 & 400 & 193 & 700 & 81.0 \\
2 & 400 & 193 & 700 & 86.0 \\
3 & 400 & 193 & 700 & 91.0 \\
1 & 400 & 183 & 1000 & 87.0 \\
2 & 400 & 183 & 1000 & 88.0 \\
3 & 400 & 183 & 1000 & 93.0 \\
1 & 500 & 158 & 500 & 81.0 \\
2 & 500 & 158 & 500 & 81.0 \\
3 & 500 & 158 & 500 & 89.0 \\
1 & 500 & 153 & 700 & 84.0 \\
2 & 500 & 153 & 700 & 85.0 \\
3 & 500 & 153 & 700 & 91.0 \\
\hline
\end{tabular}

}
\end{center}\vspace{-3mm}
\end{table}
%\vskip 2mm




%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Table  3.} {\bf Classification accuracy for different fragments (continuation) }%

}

\vskip 4mm

{\footnotesize

\begin{tabular}{ | c | c | c | c | c | }
\hline
Depth of & Size of sliding & Number of & Fragment size & Accuracy, \%\\
the tree & window & fragments & & \\
\hline
1 & 500 & 145 & 1000 & 87.0 \\
2 & 500 & 145 & 1000 & 91.0 \\
3 & 500 & 145 & 1000 & 93.0 \\
1 & 600 & 127 & 700 & 81.0 \\
2 & 600 & 127 & 700 & 82.0 \\
3 & 600 & 127 & 700 & 90.0 \\
1 & 600 & 120 & 1000 & 88.0 \\
2 & 600 & 120 & 1000 & 89.0 \\
3 & 600 & 120 & 1000 & 93.0 \\
1 & 700 & 107 & 700 & 84.0 \\
2 & 700 & 107 & 700 & 86.0 \\
3 & 700 & 107 & 700 & 96.0 \\
1 & 700 & 101 & 1000 & 85.0 \\
2 & 700 & 101 & 1000 & 88.0 \\
3 & 700 & 101 & 1000 & 93.0 \\
1 & 800 & 88 & 1000 & 89.0 \\
2 & 800 & 88 & 1000 & 91.0 \\
3 & 800 & 88 & 1000 & 97.0 \\
1 & 900 & 77 & 1000 & 87.0 \\
2 & 900 & 77 & 1000 & 91.0 \\
3 & 900 & 77 & 1000 & 95.0 \\
1 & 1000 & 70 & 1000 & 89.0 \\
2 & 1000 & 70 & 1000 & 93.0 \\
3 & 1000 & 70 & 1000 & 97.0 \\
\hline
\end{tabular}

}
\end{center}\vspace{-3mm}
\end{table}
%\vskip 2mm



{\bf 3. Tree comparison.}
As a result of the analysis of different text fragments, we get a set of decision trees $G_1, G_2, \dots, G_n$
that differ from each other. At the same time, they are united by the fact that they are oriented binary trees,
where each vertex is associated with a certain bigram or trigram (for example, at the root vertex you can observe
``Adjective-Noun'' or ``Noun-Adjective-Noun''), threshold value and Gini index. To research the features of Dostoevsky's
publicistic style it is important to understand how text fragments and decision trees derived from them are related,
i.~e. to switch from abstract models to their philological interpretation. For this we suggest to carry out a
comparative analysis of trees $G_1, G_2, \dots, G_n$ (this direction is known as {\it graph matching}). You can establish
a measure of similarity $d(G_i, G_j)$ on a set of trees (in particular {\it tree edit distance} [13]). After the necessary
calculations a matrix of distances between trees is obtained. After classifying the decision trees you can trace how much
the distance between the trees is related to the conditions for the generating of text fragments.

The first experiments in this direction were carried out using the information system ``Folklore'', which was
previously used to solve the problem of recognizing folklore and author's texts [14]. They showed
that the trees obtained from close attributes are similar to each other (the differences are manifested in the
threshold value for the same features). At this moment we can say that this method is quite stable. However,
additional experiments are required to get recommendations for choosing the step size and fragment size.

{\bf 4. Conclusion.}
Among the experiments the weakest results were shown by decision trees with a fragment size of 500 words (Tables 2, 3).
On decision trees with a depth 3 the accuracy was always less than 89~\%. The most stable results showed fragments
of 1000~words (the most frequency accuracy is 93~\%). The step size significantly influenced the accuracy, however,
this is rather due to the number of analyzed fragments.



%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Table  4.} {\bf The value of the Gini index for various features at the first level}%

}

\vskip 4mm

{\footnotesize

\begin{tabular}{ | l | l | l | l | }
\hline
Gini index & \multicolumn{1}{c|}{Feature} & Gini index & \multicolumn{1}{c|}{Feature}\\
\hline
0.1769 & Adjective-Noun & 0.18322343 & Noun-Adjective-Noun\\
0.1659 & Noun-Adjective & 0.120744636 & Participle-Noun-Adjective\\
0.1577 & Participle-Noun & 0.114925099 & Noun-Noun-Adjective\\
0.1212 & Noun-Preposition & 0.113225856 & Preposition-Participle-Noun\\
0.0953 & Verb-Participle & 0.111462412 & Adjective-Noun-Preposition\\
0.0946 & Noun-Noun & 0.108502517 & Adjective-Noun-Verb\\
0.0911 & Conjunction-Particle & 0.106896858 & Preposition-Noun-Adjective\\
0.0898 & Quote-Quote & 0.105382403 & Noun-Verb-Adjective\\
0.0898 & Noun-Quote & 0.098399618 & Noun-Verb-Participle\\
0.0898 & Pronoun-Conjunction & 0.098296557 & Noun-Preposition-Noun\\
\hline
\end{tabular}

}
\end{center}\vspace{-3mm}
\end{table}
%\vskip 2mm



So with a step of 1000 words and a fragment size of 1000 words we get text splitting without intersections
and only 70 fragments, which are easier to divide into 8 groups than 751 fragments into the same 8 groups
(step 100 words, fragment size 1000 words). In the first case we get an accuracy of 97~\%, in the second 91~\%.
In addition, this suggests that the obtained features predominate in the size of the article, however,
they may be unstable in separated fragments. The proposed method allows them to be identified and subjected
to additional analysis.

If we consider the classification at the first level of the tree (fragment size 1000), then the accuracy was
on average 87~\%. This feature is the percentage of the presence of the ``Adjective-Noun'' bigram. Table 4 provides
information about the value of the Gini index for bigrams and trigrams (step 100 words, fragment size 1000 words)
for various features at the first level. In fragments of texts belonging to F. M. Dostoevsky quite often the
percentage of presence of the bigram ``Adjective-Noun'' is less than 62.5~\% (step --- 100, fragment --- 1000, accuracy ---
90~\% for fragments belonging to F. M. Dostoevsky and 83~\% for other authors). When constructing decision trees for
other steps, the value of this attribute changed insignificantly. In the second and subsequent steps the decision
trees used different bigrams after changing the step. This indicates their less stability for solving the
classification problem.

Note that among the incorrectly classified fragments of the articles that do not belong to F. M. Dostoevsky,
the first and last fragments predominated, which may indicate the editorial correction of Fedor Mikhailovich.

Another trend was observed in the analysis of trigrams. They shared the texts worse. To achieve the same accuracy,
a tree of greater depth was required. At the same time, better results were obtained on trees with a fragment size
of 500 words. Thus, increasing the size of the fragment worsened the result. The most significant feature at the
first level was the ``Noun-Adjective-Noun'' trigram.

\end{hyphenrules}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{07/ref-s-eng}% для английской статьи

%\newpage
\input{07/lit-ra-eng}% для английской статьи

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}

\vskip 3mm

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %

%}
