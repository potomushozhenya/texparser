


\noindent{\small УДК 517.977.1  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}\\
MSC 93C85

}

\vskip3mm

\noindent{\bf Цифровое управление контролируемыми переменными \\ в~заданном диапазоне с~учетом запаздывания$^{*}$%
 }

\vskip3mm

\noindent{\it М.~В.~Сотникова, Р.~А.~Севостьянов%$\,^2$%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
\vspace{-3mm}\parindent=7mm
%%
\vskip 0.1mm $^{*}$ Работа выполнена при финансовой поддержке Российского фонда фундаментальных исследований (проект № 20-07-00531a).\par%
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum12} }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum12}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize




\noindent%
%$^2$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
%\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:}
\textit{Сотникова М.\,В., Севостьянов Р.\,А.} Цифровое управление контролируемыми переменными в~заданном диапазоне с~учетом запаздывания~//
Вестник Санкт-Пе\-тер\-бург\-ского университета. Прикладная
математика. Информатика. Процессы управления. \issueyear. Т.~17.
Вып.~\issuenum.
С.~\pageref{p12}--\pageref{p12e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum12

\vskip3mm

{\leftskip=7mm\noindentРабота посвящена задаче управления динамическим объектом с~удержанием контролируемых переменных внутри требуемого диапазона с~учетом многомерности входа и~выхода, запаздывания, ограничений и~внешних возмущений. Рассматривается формализованная постановка задачи синтеза цифрового  управления. Предлагается метод решения, основанный на применении прогнозирующих моделей. Его ключевая особенность состоит во введении специализированного функционала качества, отражающего специфику приведенной задачи, --- функционала ошибки, включающего вектор <<слабых>> переменных. Данный функционал играет роль штрафа при выходе контроли\-руе\-мых переменных за пределы заданного диапазона. Показано, что реализация закона управления сводится к~решению задачи квадратичного программирования на каждом такте дискретного времени.
Полученные результаты иллюстрируются примером управления процессом переработки нефти в~ректификационной колонне.\\[1mm]
\textit{Ключевые слова}: цифровое управление, прогнозирующая модель, заданный диапазон, оптимизация, ограничение, запаздывание.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{1. Введение.} В~работе рассматривается задача синтеза законов управления контролируемыми переменными динамического объекта с~удержанием их в~заданном диапазоне. Цель --- обеспечить попадание и~затем удержание контролируемых переменных процесса внутри установленных границ. При этом изменение переменных внутри границ может быть произвольным. Особенности предлагаемой постановки задачи --- многомерность входного и~выходного сигналов системы, запаздывание по управлению и~возмущению, ограничения на управляющие воздействия. Дополнительным требованием является возможность адаптивной перенастройки закона управления в~режиме реального времени, например, при добавлении новой контролируемой переменной или изменении границ диапазона для каких-либо из переменных. Такая постановка задачи управления актуальна, в~частности, для процессов нефтеперера\-ботки, где требуемое качество выходных нефтепродуктов обеспечивается нахожде\-нием контролируемых переменных процесса внутри заданных инженером диа\-па\-зо\-нов~[1,\,2].

Специфика цели управления и~отмеченные особенности задачи требуют разработки соответствующих новых методов синтеза законов управления. В~данной работе основным методом, положенным в~основу решения, является теория управления с~прогнозирующими моделями (Model Predictive Control, MPC) [3–7]. Ключевым достоинством MPC-идеологии, определяющим его успешное использование в~практике построения и~эксплуатации систем управления, служит относительная простота базовой схемы формирования обратной связи с~помощью численных методов оптимизации, сочетающаяся с~высокими адаптивными свойствами. К~его недостаткам относятся значительные вычислительные затраты, необходимые на каждом такте дискретного времени для формирования управляющего сигнала. Однако для инерционных объектов, среди которых ректификационные колонны [1], это не имеет принци\-пиаль\-ного значения, поскольку неизбежные запаздывания, вызванные временем счета, существенно меньше, чем постоянные времени переходных процессов.

Синтез законов управления выполняется в~дискретной форме, поскольку в~на\-стоя\-щее время реализация соответствующих вычислительных алгоритмов практически повсеместно осуществляется с~использованием цифровых вычислительных устройств $[8$--$10]$. При этом полученные в~результате дискретизации непрерывных систем разностные уравнения рассматриваются в~качестве основы для синтеза управления.

В данной работе развиваются полученные авторами предшествующих результатов [11]. В~рамках проведенного исследования учтены запаздывания по управлению и~возмущению, ограничения на управляющие воздействия, а~также введен спе\-циаль\-ный функционал, содержащий вектор <<слабых>> переменных и~играющий роль штрафа за выход контролируемых переменных из заданного диапазона.

Полученные результаты иллюстрируются примером управления процессом переработки нефти в~ректификационной колонне.

\indent\textbf{2. Постановка задачи.} В~качестве исходной математической модели объекта управления примем систему линейных обыкновенных дифференциальных уравнений с~запаздыванием, заданную в~форме <<вход\,---\,выход>> и~имеющую следующий обобщенный вид:

\begin{equation}
    y_i = \sum_{j=1}^{n} \frac{k_{ij}}{T_{ij}s+1}e^{-\tau_{ij}s}u_j +
    \sum_{r=1}^{l} \frac{\tilde{k}_{ir}}{\tilde{T}_{ir}s+1}e^{-\tilde{\tau}_{ij}s}f_r,  \,\,\, i=\overline{1,m},
\end{equation}
где $y_i, i=\overline{1,m}$, --- контролируемые переменные;  $u_j,
j=\overline{1,n}$, --- управляющие переменные; $f_r,\, r = \overline{1,l}$, --- возмущения; $k_{ij}$  --- коэффициенты усиления; $T_{ij}$ --- постоянные времени (мин); ${\tau_{ij}}$ --- транспортное запаздывание (мин). Аналогично выполняется для коэффициентов $\tilde k_{ir}$, $\tilde T_{ir}$, $\tilde \tau_{ir}$.  В~модели (1) контролируемые выходы $y_i, i=\overline{1,m}$, а~также возмущения $f_r, \,r = \overline{1,l}$, --- измеряемые переменные. Предполагается, что возмущения ограничены: $|f_r(t)|<M, \,r = \overline{1,l}$, и~являются постоянными или медленно меняющимися.

Линейная математическая модель (1) выбрана в~связи с~тем, что она широко используется специалистами по автоматическому управлению при эмпирическом построении моделей, приближенно представляющих исследуемые процессы, например в~нефтехимической отрасли. Отметим, что в~ряде случаев для получения линейной модели невозможно пользоваться традиционной техникой линеаризации нелинейных уравнений динамики, поскольку либо они неизвестны, либо недостаточны точны, либо крайне сложны и~фактически недоступны для применения. При этом на практике обычно используются упрощенные эмпирические методы построения модели, адекватно представляющей динамику объекта в~окрестности заданной точки. В~частности, в~рассматриваемой прикладной задаче переработки нефти в~ректификационной колонне структура полной нелинейной математической модели крайне сложна, поскольку основывается на законах нефтехимии и~зависит от конкретной промышленной установки, включает сотни уравнений и~фактически неизвестна, а~ее построение требует проведения отдельных дорогостоящих исследований. Потому в~качестве отправной точки взята модель вида (1), которая применяется на практике инженерами для приближенного описания процессов нефтепереработки в~отдельных относительно независимых подсистемах ректификационной колонны. Для ее получения проводятся тестовые эксперименты при определенных начальных условиях на конкретной нефтеперерабатывающей промышленной установке. Естественно, что построенная таким образом модель справедлива только локально.

Будем считать, что модель (1) приближенно описывает динамику объекта в~окрестности начального положения ${\bf y}(0)={\bf y}_s, {\bf u}(0)={\bf u}_s$.
Введем векторы контролируемых, управляющих переменных и~возмущений:

\begin{equation*}
    {\bf y} = \begin{pmatrix} y_1 & ... & y_m \end{pmatrix}^T, \,\,
    {\bf u} = \begin{pmatrix} u_1 & ... & u_n \end{pmatrix}^T, \,\,
    {\bf f} = \begin{pmatrix} f_1 & ... & f_l \end{pmatrix}^T.
\end{equation*}
При этом фактически значения управляющих и~контролируемых переменных в~текущий момент времени $t$ определяются равенствами

\begin{equation}
    \begin{aligned}
        \tilde{\bf {y}}(t) = {\bf y}_s + {\bf y}(t), \\
        \tilde{\bf {u}}(t) = {\bf u}_s + {\bf u}(t).
    \end{aligned}
\end{equation}

В (2) векторы $\tilde{\bf {y}}(t)$ и~$\tilde{\bf {u}}(t)$ являются {\textit{абсолютными}} значениями контролируемых и~управляющих переменных соответственно, а~векторы ${\bf y}(t)$ и~${\bf u}(t)$ --- их {\textit{относительными}} значениями или {\textit{значениями в~приращениях относительно начального положения}} ${\bf y}_s$, ${\bf u}_s$. Введем ограничения на контролируемые переменные:

\begin{equation}
    \tilde{\bf y}_{\rm min} \le \tilde{\bf y}(t) \le \tilde{\bf y}_{\rm max},
\end{equation}
где $\tilde{\bf y}_{\rm min}$ и~$\tilde{\bf y}_{\rm max}$  --- заданные векторы, а~также ограничения на величину и~скорость изменения управляющих переменных:

\begin{equation}
    \begin{aligned}
        &\tilde{\bf u}_{\rm min} \le \tilde{\bf u}(t) \le \tilde{\bf u}_{\rm max}, \\
        &\Delta\tilde{\bf u}_{\rm min} \le \dot{\tilde{\bf u}}(t) \le \Delta\tilde{\bf u}_{\rm max},
    \end{aligned}
\end{equation}
здесь $\tilde{\bf u}_{\rm min}, \tilde{\bf u}_{\rm max}, \Delta\tilde{\bf u}_{\rm min}, \Delta\tilde{\bf u}_{\rm max}$  --- заданные векторы. Отметим, что все ограничения задаются для абсолютных значений управляющих и~контролируемых переменных.

Цель управления объектом (1) состоит в~выполнении ограничений (3) с~учетом ограниченности ресурсов управления (4), т. е. необходимо обеспечить нахождение контролируемых переменных внутри заданного диапазона. В~процессе функционирования системы ограничения (3) на контролируемые переменные могут нарушаться, а~для ограничений (4) на управляющие переменные нарушения не допустимы.

Поставим задачу синтеза цифровой системы управления с~обратной связью, которая обеспечивает достижение цели управления (3) для объекта, заданного математической моделью (1), при условии выполнения ограничений на управляющие переменные (4).

\textbf{3. Построение дискретной модели.} Будем считать, что дискретизация осуществляется только по времени, а~по уровню все величины непрерывные. Такое допущение обосновывается тем, что современные цифровые вычислительные средства имеют достаточно большую разрядную сетку и,~соответственно, пренебрежимо малый шаг квантования по уровню по сравнению с~порядками рассматриваемых величин.

 Пусть $T_s$ --- шаг дискретности, $k$ --- целое число. Введем следующие обозначения для отсчетов используемых сигналов: $y[k]=y(kT_s)$ --- значение измеряемого выхода на $k$-м такте, аналогично $u[k]=u(kT_s)$ --- значение управления на $k$-м такте. Отметим, что управляющий сигнал $u$ является постоянным на шаге дискретности, т. е. на интервале времени $[t_k,t_{k+1}]$, где $t_k=kT_s$, $t_{k+1}=(k+1)T_s$, при этом $u[k]=u(kT_s)=u(t)$,\linebreak $\forall t \in [t_k,t_{k+1}]$.

Выполним дискретизацию модели (1). Заметим, что каждому ненулевому слагае-\linebreakмому первой суммы $y_{ij} = \dfrac{k_{ij}}{T_{ij}s+1}e^{-\tau_{ij}s}u_j$ в~пространстве состояний соответствует скалярное дифференциальное уравнение с~запаздыванием по управлению

\begin{equation}
%    \begin{aligned}
%        &
        \dot{x}_{ij} = -\frac{1}{T_{ij}}x_{ij}+\frac{k_{ij}}{T_{ij}} u_j(t-\tau_{ij}), %\\
%        &
   ~~~     y_{ij} = x_{ij}.
%    \end{aligned}
\end{equation}

Каждое ненулевое слагаемое второй суммы $f_{ij}=\dfrac{\tilde{k}_{ir}}{\tilde{T}_{ir}s+1}e^{-\tilde{\tau}_{ij}s}f_r$ также может быть представлено в~пространстве состояний уравнением вида (5). Поскольку внешние возмущения относятся к~постоянным (или медленно меняющимся), каждому из них отвечает дифференциальное уравнение

\begin{equation}
    \dot{f}_r = 0, \,\, r=\overline{1,l}.
\end{equation}
Отметим, что для медленно меняющихся возмущений уравнение (6) выполняется лишь приближенно на конечном отрезке времени.
Пусть число ненулевых слагаемых в~первой и~второй суммах уравнения (1) равно $n_e$ и~$n_{ed}$ соответственно.

Выполним дискретизацию уравнений (5) с~шагом дискретности $T_s$. При этом шаг дискретности $T_s$ зададим таким образом, чтобы все запаздывания по каждой из компонент управления были кратны этому числу, т. е. для любого запаздывания $\tau_{ij}$ выполнялось равенство $\tau_{ij}=q_{ij}T_s$, где $q_{ij} \geq 1$ --- целое число. Данное требование не является обязательным, однако позволяет избежать некоторой потери точности модели, связанной с~ошибками дискретизации. Аналогично выполняем для возмущений.

Применяя формулу Коши для уравнений (5), получаем следующую модель в~дискретном времени:

\begin{equation}
%    \begin{aligned}
%        &
        x_{ij}[k+1] = a_{ij}x_{ij}[k]+b_{ij}u_j[k-q_{ij}], %        %        \\
%        &
  ~~~      y_{ij}[k] = x_{ij}[k],
%    \end{aligned}
\end{equation}
где $a_{ij}=e^{-T_s/T_{ij}}$; $b_{ij}=(1-e^{-T_s/T_{ij}})k_{ij}$; $q_{ij} \geq 1$ --- целое число такое, что $\tau_{ij}=q_{ij}T_s$. Аналогично выполняем дискретизацию для слагаемых второй суммы. В~результате дискретизации уравнений (6) находим, что

\begin{equation}
    f_r[k+1] = f_r[k], ~~\, r = \overline{1,l}.
\end{equation}

Перейдем к~стандартной дискретной линейной стационарной системе в~пространстве состояний, исключив запаздывание в~модели (7). С~этой целью расширим вектор состояния модели (7), включив в~него дополнительные компоненты, моделирующие запаздывание по управлению [12].

Обозначим максимальное запаздывание по компоненте управления $u_j$ через $\tau_j^{\rm max}$. Введем вспомогательную систему в~пространстве состояний для моделирования запаздывания по управлению $u_j[k-\tau_j^{\rm max}]$.

Пусть $x_1^d[k]=u_j[k-\tau_j^{\rm max}]$, $x_2^d[k]=u_j[k-\tau_j^{\rm max}+1]$, \ldots, $x_{\tau_j^{\rm max}-1}^d[k]=u_j[k-2]$, $x_{\tau_j^{\rm max}}^d[k]=u_j[k-1]$. Тогда справедливы уравнения

\begin{equation}
    \begin{aligned}
        &x_1^d[k+1]=x_2^d[k], \\
        &x_2^d[k+1]=x_3^d[k], \\
        &\vdots \\
        &x_{\tau_j^{\rm max}-1}^d[k+1]=x_{\tau_j^{\rm max}}^d[k], \\
        &x_{\tau_j^{\rm max}}^d[k+1]=u_j[k].
    \end{aligned}
\end{equation}
Вспомогательная система (9) может быть представлена в~ матричном виде

\begin{equation}
%    \begin{aligned}
%        &
        {\bf x}_d^j[k+1]={\bf A}_j^d{\bf x}_d^j[k] + {\bf B}_j^d u_j[k], %\\
%        &
 ~~~       y_j^d[k] = x_1^d[k],
%    \end{aligned}
\end{equation}
где ${\bf A}_j^d$, ${\bf B}_j^d$ --- матрицы, соответствующие уравнениям (9). Из (10) видно, что выходная переменная равна $y_j^d[k] = x_1^d[k]=u_j[k-\tau_j^{\rm max}]$. Любое промежуточное значение запаздывания по управлению, не превышающее $\tau_j^{\rm max}$, представляется соответствующей компонентой вектора состояния ${\bf x}_d^j[k]$. Таким образом, система (9) играет роль «накопителя», который сохраняет требуемое по величине запаздывания число отсчетов входного сигнала.

Аналогично для представления запаздывания по всем остальным компонентам вектора управления необходимо сформировать соответствующую вспомогательную модель вида (10). Объединяя вместе все такие системы, получаем следующую модель, представляющую запаздывания по управлению:

\begin{equation}
    {\bf x}_d[k+1] = {\bf A}_d{\bf x}_d[k]+{\bf B}_d{\bf u}[k].
\end{equation}
Здесь ${\bf x}_d= \begin{pmatrix} {\bf x}_d^1 & ... & {\bf x}_d^n \end{pmatrix}^T$ --- вектор состояния, причем его размерность равна сумме $\tau_1^{\rm max}+...+\tau_n^{\rm max}$, где $\tau_i^{\rm max},i=\overline{1,n}$, --- максимальное запаздывание в~количестве тактов по каждой из компонент управления. Матрицы модели (11) определяются равенст\-вами

\begin{equation*}
    {\bf A}_d = {\rm diag}({\bf A}_1^d,{\bf A}_2^d,...,{\bf A}_n^d),~\,\,{\bf B}_d = {\rm diag}({\bf B}_1^d,{\bf B}_2^d,...,{\bf B}_n^d).
\end{equation*}

В итоге, объединяя разностные уравнения (7) для каждого из ненулевых сла\-гае\-мых первой и~второй сумм уравнения (1), уравнения (8) относительно возмущений, систему (11), представляющую запаздывания по управлению, а~также проводя аналогичные указанным выше действия для моделирования запаздывания по возмущению, получаем полную математическую модель

\begin{equation}
%    \begin{aligned}
%        &
        {\bf x}[k+1] = {\bf{A}}{\bf{x}}[k]+{\bf{B}}{\bf{u}}[k], %\\
%        &
  ~~~      {\bf y}[k] = {\bf{C}}{\bf{x}}[k],
%    \end{aligned}
\end{equation}
в которой ${\bf x} = \begin{pmatrix} {\bf x}_m & {\bf x}_d & {\bf x}_{de} \end{pmatrix}^T$ --- вектор состояния, причем ${\bf x}_m = \begin{pmatrix} {\bf x}_s & {\bf x}_e & {\bf f} \end{pmatrix}^T \in E^{n_e+n_{ed}+l}$ --- часть вектора состояния, соответствующая уравнениям математической модели (7) и~(8): ${\bf x}_s \in E^{n_e}$ и~ ${\bf x}_e \in E^{n_{ed}}$ --- векторы, представляющие передаточные функции от управляющих входов и~возмущений соответственно к~выходам $y_i$,\linebreak ${\bf f} = \begin{pmatrix} f_1 & ... & f_l \end{pmatrix} \in E^l$ --- вектор внешних возмущений. Векторы ${\bf x}_d$ и~${\bf x}_{de}$ --- часть вектора состояния, отвечающая уравнениям вида (11) для моделирования запаздывания по управлениям и~возмущениям. Постоянные матрицы ${\bf A}$, ${\bf B}$, ${\bf C}$ в~модели (12) равны

\begin{equation}
    {\bf A} =
    \begin{pmatrix}
        {\bf A}_m & {\bf A}_{dx} & {\bf A}_{de} \\
        {\bf 0} & {\bf A}_d & {\bf 0}           \\
        {\bf A}_{xe} & {\bf 0} & {\bf A}_{fe}
    \end{pmatrix},\,\,
    {\bf B} =
    \begin{pmatrix}
        {\bf B}_{dx} \\
        {\bf B}_d    \\
        {\bf 0}
    \end{pmatrix},\,\,
    {\bf C} =
    \begin{pmatrix}
    {\bf C}_m  & {\bf 0} & {\bf 0}
    \end{pmatrix}
\end{equation}

Компоненты матриц ${\bf A}_m$, ${\bf A}_{dx}$, ${\bf A}_{de}$, ${\bf A}_{xe}$, ${\bf A}_{fe}$, ${\bf B}_{dx}$, ${\bf C}_m$ определяются уравнениями (1), (7), (8) и~ запаздываниями по компонентам управления и~возмущения. Так, матрицы ${\bf{A}}_{dx}$ и~${\bf{A}}_{de}$ формируются на основе уравнений вида (7) и~отвечают за влияние управлений с~запаздыванием и~возмущений с~запаздыванием на отдельные компоненты вектора состояния. Матрица ${\bf C}_m$ содержит $m$ строк (по количеству контролируемых переменных) и~$n_e+n_{ed}+l$ столбцов. Все ее элементы нулевые, кроме тех, которые отвечают позициям ненулевых слагаемых в~уравнениях (1). Для этих позиций значения равны 1.

В итоге модель (12) с~матрицами (13) является моделью в~дискретном времени, соответствующей исходной модели (1) в~непрерывном времени. В~модели (12) учитываются запаздывания по управлению и~возмущению.

\indent\textbf{4. Синтез цифровой системы управления.} Предлагаемый метод синтеза цифрового закона управления основан на применении теории управления с~прогнозирующими моделями (MPC, Model Predictive Control) [3--7]. Основная идея этого метода состоит в~том, что на каждом такте дискретного времени выполняется оптимизация прогнозируемого движения объекта управления на некоторый интервал времени вперед, называемый горизонтом прогноза, по отношению к~заданному функционалу качества с~учетом текущего состояния объекта, а~также введенных ограничений на управление и~состояние. Результатами такой оптимизации являются оптимальное программное управление и~свойственное ему оптимальное движение на горизонте прогноза. Однако найденное оптимальное управление реализуется для объекта не на всем горизонте прогноза, а~только на его малой начальной части, обычно равной периоду дискретизации. На следующем такте дискретного времени процесс оптимизации повторяется заново для нового,  достигнутого на этот момент, состояния объекта управления. Таким образом, реализация цифрового управления с~прогнозом приводит к~управлению по принципу обратной связи с~дискретным поступлением информации о~состоянии объекта на каждом такте дискретного времени. Рассмотрим формализацию MPC-подхода применительно к~рассматриваемой задаче.

Введем линейную прогнозирующую модель, представляя ее следующей системой разностных уравнений:

\begin{equation}
    \begin{aligned}
        &\bar{{\bf x}}[i+1] = {\bf{A}}\bar{{\bf{x}}}[i]+{\bf{B}}\bar{{\bf{u}}}[i],\,\, i=k+j,\,\, j  = 0,1,2,...,\,\, \bar{{\bf x}}[k] = \tilde{{\bf x}}[k], \\
        &\bar{{\bf y}}[i] = {\bf{C}}\bar{{\bf{x}}}[i].
    \end{aligned}
\end{equation}
Размерности векторов состояния, управления и~измерения здесь такие же, как и~в~системе (12). Матрицы ${\bf A}$, ${\bf B}$ и~${\bf C}$ обеих систем совпадают. Заметим, что прогнозирующая модель (14) на начальном такте $j=0$ инициируется текущим состоянием $\tilde {\bf x}[k]$ реального объекта и~позволяет приближенно спрогнозировать его динамику.

Зададим программное управление ${\bf \overline u} = \begin{pmatrix} {\bf u}[k] & {\bf u}[k+1] & ... & {\bf u}[k+P-1] \end{pmatrix}^T \in E^{nP}$ на горизонте прогноза $P$ и~вычислим соответствующее ему программное движение \linebreak $ {\bf \overline y} = {\bf \overline y} ( {\bf \overline u} ) = \begin{pmatrix} {\bf y}[k+1] & {\bf y}[k+2] & ... & {\bf y}[k+P] \end{pmatrix}^T \in E^{mP}$. В~силу уравнений прогнозирующей
модели (14) имеем выражение

\begin{equation}
    \overline{{\bf y}} = {\bf L}{\bf x}[k]+{\bf M}\overline{\bf u},
\end{equation}
где

\begin{equation*}
    {\bf L} =
    \begin{pmatrix}
        {\bf CA}^{\,\,}  \\
        {\bf CA}^2  \\
        \vdots \\
        {\bf CA}^P
    \end{pmatrix},~
    {\bf M} =
    \begin{pmatrix}
        {\bf CB}  & {\bf 0} & \cdots & {\bf 0}  \\
        {\bf CAB}  & {\bf CB} & \cdots & {\bf 0}  \\
        \cdots  & \cdots & \ddots & \cdots  \\
        {\bf CA}^{P-1}{\bf B}  & {\bf CA}^{P-2}{\bf B} & \cdots & {\bf CB}
    \end{pmatrix}.
\end{equation*}

В дальнейшем для задания программного управления на горизонте прогноза $P$ будем использовать
вектор приращений  управляющих воздействий $$\Delta{\bf \overline u} = \begin{pmatrix} \Delta{\bf u}[k] & \Delta{\bf u}[k+1] & ... & \Delta{\bf u}[k+P-1] \end{pmatrix}^T \in E^{nP},$$ в~котором $\Delta{\bf u}[i]={\bf u}[i]-{\bf u}[i-1],~ i =\overline{k , k+P-1}$. Между векторами $\overline{\bf u}$ и~$\Delta \overline{\bf u}$ существует линейная связь

\begin{equation}
    \overline{\bf u} = {\bf M}_0 {\bf u}[k-1]+{\bf M}_1 \Delta \overline{\bf u},
\end{equation}
здесь
\begin{equation*}
    {\bf M}_0 =
    \begin{pmatrix}
        {\bf E}_{n\times n}  \\
        {\bf E}_{n\times n}  \\
        \vdots \\
        {\bf E}_{n\times n}
    \end{pmatrix}, \,\,
    {\bf M}_1 =
    \begin{pmatrix}
        {\bf E}_{n\times n}  & {\bf 0} & \cdots & {\bf 0}  \\
        {\bf E}_{n\times n} & {\bf E}_{n\times n} & \cdots & {\bf 0}  \\
        \cdots  & \cdots & \ddots & {\bf 0} \\
        {\bf E}_{n\times n}  & {\bf E}_{n\times n} & \cdots & {\bf E}_{n\times n}
    \end{pmatrix}.
\end{equation*}

В результате, подставляя (16) в~формулу (15), получаем уравнение
\begin{equation}
    \overline{\bf y} = \overline{\bf y}(\Delta\overline{\bf u})={\bf L}{\bf x}[k]+\tilde{{\bf M}}_0 {\bf u}[k-1]+\tilde{{\bf M}}_1 \Delta \overline{\bf u},
\end{equation}
где $\tilde{\bf M}_0 = {\bf M}{\bf M}_0$, $\tilde{\bf M}_1 = {\bf M}{\bf M}_1$ --- вспомогательные матрицы. Таким образом, формула (17) позволяет вычислить прогноз $\overline{\bf y} = \overline{\bf y}(\Delta\overline{\bf u})$ динамики движения объекта на горизонте $P$ для заданного программного управления $\Delta\overline{\bf u}$.

Сформируем допустимое множество управлений на горизонте прогноза. Для этого перепишем ограничения (3) и~(4) в~дискретной форме:

\begin{equation*}
    \tilde{\bf y}_{\rm min} \le \tilde{\bf y}[k] \le \tilde{\bf y}_{\rm max},~\,\,
    \tilde{\bf u}_{\rm min} \le \tilde{\bf u}[k] \le \tilde{\bf u}_{\rm max},~\,\,
    \Delta \tilde{\bf u}_{\rm min} \le \Delta \tilde{\bf u}[k] / T_s \le \Delta \tilde{\bf u}_{\rm max}.
\end{equation*}
Тогда для относительных значений данных векторов можно записать аналогичные неравенства:

\begin{equation}
    {\bf y}_{\rm min} \le {\bf y}[k] \le {\bf y}_{\rm max}, \,\,
    {\bf u}_{\rm min} \le {\bf u}[k] \le {\bf u}_{\rm max}, \,\,
    \Delta {\bf u}_{\rm min} \le \Delta {\bf u}[k] \le \Delta {\bf u}_{\rm max}.
\end{equation}
Здесь ${\bf y}_{\rm max} = \tilde{\bf y}_{\rm max} - {\bf y}_s$, \, ${\bf y}_{\rm min} = \tilde{\bf y}_{\rm min} - {\bf y}_s$, \, ${\bf u}_{\rm max} = \tilde{\bf u}_{\rm max} - {\bf u}_s$, \, ${\bf u}_{\rm min} = \tilde{\bf u}_{\rm min} - {\bf u}_s$, \, $\Delta {\bf u}_{\rm max} = T_s \Delta \tilde{\bf u}_{\rm max}$, \, $\Delta {\bf u}_{\rm min} = T_s \Delta \tilde{\bf u}_{\rm min}$ --- вспомогательные векторы, ${\bf y}_s$ и~${\bf u}_s$ --- начальное положение по контролируемым и~управляющим переменным соответственно.

В соответствии с~неравенствами (18) введем следующие ограничения на горизонте прогноза:

1) на величину управляющего сигнала и~скорость изменения управляющего сигнала:

\begin{equation}
    \begin{aligned}
        & u_j^{\rm min} \le u_j[i] \le u_j^{\rm max},\,\, i = \overline{k,k+P-1},\,\,j = \overline{1,n}, \\
        & \Delta u_j^{\rm min} \le \Delta u_j[i] \le \Delta u_j^{\rm max},\,\, i = \overline{k,k+P-1},\,\,j = \overline{1,n},
    \end{aligned}
\end{equation}
где $u_j^{\rm min}$, $u_j^{\rm max}$, $\Delta u_j^{\rm min}$, $\Delta u_j^{\rm max}$, $j=\overline{1,n}$, --- компоненты векторов ${\bf u}_{\rm min}$, ${\bf u}_{\rm max}$, $\Delta {\bf u}_{\rm min}$, $ \Delta{\bf u}_{\rm max}$;

2) на контролируемые переменные:

\begin{equation}
    y_j^{\rm min} \le y_j[i] \le y_j^{\rm max},\,\, i = \overline{k+1,k+P},\,\,j = \overline{1,m},
\end{equation}
где $y_j^{\rm min}$, $y_j^{\rm max}$ --- компоненты векторов ${\bf y}_{\rm min}$, ${\bf y}_{\rm max}$.

С целью решения задачи удержания контролируемых переменных в~заданном диапазоне представим ограничения (20) в~виде

\begin{equation}
    y_j^{\rm min}-\varepsilon_i \le y_j[k+i] \le y_j^{\rm max}+\varepsilon_i,\,\, i = \overline{1,P},\,\,\,j = \overline{1,m},\,\,\, \varepsilon_i \ge 0,
\end{equation}
где $\varepsilon_i,\, i = \overline{1,P}$, --- <<слабые>> переменные. Каждая из них характеризует выполнение ограничений на определенном такте горизонта прогноза. Представим ограничения (21) в~векторной форме:

\begin{equation}
%    \begin{aligned}
%        &
        \overline{\bf y}_{\rm min}-{\bf V \boldsymbol\varepsilon} \le \overline{\bf y} \le \overline{\bf y}_{\rm max}+{\bf V \boldsymbol\varepsilon}, %\\
%        &
  ~~~      {\bf \boldsymbol\varepsilon} \ge 0,
%    \end{aligned}
\end{equation}
здесь ${\bf \boldsymbol\varepsilon}=\begin{pmatrix} \varepsilon_1 & \varepsilon_2 & ... & \varepsilon_P \end{pmatrix} \in E^P$ --- вектор слабых переменных, $\overline{\bf y}_{\rm min} = \begin{pmatrix} {\bf y}_{\rm min} & ... & {\bf y}_{\rm min} \end{pmatrix}^T \in E^{mP}$, \, $\overline{\bf y}_{\rm max} = \begin{pmatrix} {\bf y}_{\rm max} & ... & {\bf y}_{\rm max} \end{pmatrix}^T \in E^{mP}$ --- вспомогательные векторы, ${\bf V}$ --- матрица размера $mP \times P$ со следующей структурой:

$$
    {\bf V} =
    \begin{pmatrix}
        1 & \hdots &  1 & 0 & \hdots & 0 &\hdots & 0 & \hdots & 0 \\
        0 & \hdots &  0 & 1 & \hdots & 1 &\hdots & 0 &\hdots & 0 \\
	 &  &  &  &  &  &  \ddots & & & \\
	0 & \hdots & 0 & 0 & \hdots & 0 &\hdots & 1 &\hdots & 1
    \end{pmatrix}^T.
$$

С учетом формулы (17) преобразуем ограничения (22), приводя их к~системе линейных неравенств относительно вектора $\Delta \overline{\bf u}$:







$$
%    \begin{aligned}
%        &
        {\bf A}_y
            \begin{pmatrix}
            \Delta\overline{\bf u}  \\
            \boldsymbol\varepsilon
        \end{pmatrix} \le
        {\bf b}_y + {\bf b}_{y1}{\bf u}[k-1]+{\bf b}_{y2}{\bf x}[k], %\\
%        &
   ~~~     \boldsymbol\varepsilon \ge 0,
%    \end{aligned}
$$
в которой
$$
    {\bf A}_y =
    \begin{pmatrix}
        \tilde{\bf M}_1 & -{\bf V} \\
        -\tilde{\bf M}_1 & -{\bf V}
    \end{pmatrix},
    \,\,
    {\bf b}_y =
    \begin{pmatrix}
        \overline{\bf y}_{\rm max} \\
        -\overline{\bf y}_{\rm min}
    \end{pmatrix},
    \,\,
    {\bf b}_{y1} =
    \begin{pmatrix}
        -\tilde{\bf M}_0 \\
        \tilde{\bf M}_0
    \end{pmatrix},
    \,\,
    {\bf b}_{y2} =
    \begin{pmatrix}
        -{\bf L} \\
        {\bf L}
    \end{pmatrix}.
$$

Введение слабых переменных позволяет обеспечить возможность нарушения ограничений на контролируемые переменные в~процессе функционирования системы и~добиться того, чтобы допустимое множество в~соответствующей оптимизационной задаче имело решения. Это означает, что в~случае нарушения ограничений всегда можно построить такую оптимальную стратегию управления, целью которой будет приведение контролируемых переменных внутрь заданного диапазона (3).

Рассмотрим ограничения (19) на управляющие воздействия. Ранее было показано, что векторы $\overline{\bf u}$ и~ $\Delta \overline{\bf u}$ связаны формулой (16). Отсюда получаем, что ограничения (19) эквивалентны системе линейных неравенств

$$
    \begin{pmatrix}
        {\bf A}_u  \\
        {\bf A}_{\Delta u}
    \end{pmatrix} \Delta \overline{\bf u} \le
    \begin{pmatrix}
        {\bf b}_u  \\
        {\bf b}_{\Delta u}
    \end{pmatrix} +
    \begin{pmatrix}
        {\bf b}_{u2}  \\
        {\bf 0}
    \end{pmatrix}{\bf u}[k-1].
$$
Здесь $
{\bf A}_u = \begin{pmatrix} {\bf M}_1 \\ -{\bf M}_1 \end{pmatrix}$,
${\bf b}_u = \begin{pmatrix} \overline{\bf u}_{\rm max} \\ -\overline{\bf u}_{\rm max} \end{pmatrix}$,
${\bf b}_{u2} = \begin{pmatrix} {\bf M}_0 \\ -{\bf M}_0 \end{pmatrix}$,
${\bf b}_{\Delta u} = \begin{pmatrix} \Delta \overline{\bf u}_{\rm max} \\ -\Delta \overline{\bf u}_{\rm max} \end{pmatrix} \in E^{2nP}$,
$
    {\bf A}_{\Delta u} =
    \begin{pmatrix}
        {\bf E}_{n \times n} & {\bf 0} & {\bf 0}  \\
        {\bf 0} & \ddots & {\bf 0} \\
        {\bf 0} & {\bf 0}  & {\bf E}_{n \times n}  \\
        -{\bf E}_{n \times n} & {\bf 0} & {\bf 0}  \\
        {\bf 0} & \ddots & {\bf 0} \\
        {\bf 0} & {\bf 0}  & -{\bf E}_{n \times n}
    \end{pmatrix}
$ --- матрица размера $2nP \times nP$.

Составим полную систему ограничений относительно вектора $\Delta \overline{\bf u}$, эквивалентную
исходным неравенствам (19), (20). В~результате получим неравенства

\begin{equation}
    {\bf A}\begin{pmatrix}
        \Delta\overline{\bf u}  \\
        \boldsymbol\varepsilon
    \end{pmatrix} \le {\bf b},
\end{equation}
в которых
\begin{equation*}
    {\bf A} =
    \begin{pmatrix}
        {\bf A}_u & {\bf 0} \\
        {\bf A}_{\Delta u} & {\bf 0} \\
        \tilde{\bf M}_1 & -{\bf V} \\
        -\tilde{\bf M}_1 & -{\bf V} \\
        {\bf 0} & -{\bf E}_P
    \end{pmatrix},
\end{equation*}
%    \,\,\,\,
\begin{equation*}
    {\bf b} =
    \begin{pmatrix}
        {\bf b}_u \\
        {\bf b}_{\Delta u} \\
        {\bf y}_{\rm max} \\
        -{\bf y}_{\rm min} \\
        {\bf 0}
    \end{pmatrix} +
    \begin{pmatrix}
        {\bf b}_{u2} \\
        {\bf 0} \\
        \tilde{\bf M}_0 \\
        -\tilde{\bf M}_0 \\
        {\bf 0}
    \end{pmatrix} {\bf u}[k-1] +
    \begin{pmatrix}
        {\bf 0} \\
        {\bf 0} \\
        {\bf -L} \\
        {\bf L} \\
        {\bf 0}
    \end{pmatrix} {\bf x}[k].
\end{equation*}
%
Введем допустимое множество, определяя его системой линейных неравенств (23):

\begin{equation}
    \Omega = \left\{
    \left( \Delta\overline{\bf u}, \boldsymbol\varepsilon \right) \in E^{nP+P} :
    {\bf A}\left (
    \begin{array}{c}
    \Delta\overline{\bf u}  \\
    \boldsymbol\varepsilon
    \end{array}
    \right ) \le {\bf b}
    \right\}.
\end{equation}

Теперь зададим квадратичный функционал, характеризующий качество процессов управления на горизонте прогноза:
\begin{equation}
    J_k = J_k\left(\overline{\bf y}, \Delta\overline{\bf u}, \right) = \sum \limits_{j=1}^{P}
    \Delta{\bf u}[k+j-1]^T{\bf Q}\Delta{\bf u}[k+j-1]+\rho \boldsymbol\varepsilon^T\boldsymbol\varepsilon,
\end{equation}
где $\rho > 0$ --- весовой коэффициент штрафа за нарушение диапазона. Отметим, что внутри диапазона (3) данный функционал достигает минимального нулевого значения при фиксированном управляющем воздействии. Следовательно, стремление к~его минимизации «втягивает» контролируемые переменные внутрь диапазона, а~затем управляющие воздействия автоматически прекращаются.

С учетом введенных ранее обозначений запишем для функционала (25) выра\-жение

\begin{equation*}
    J_k = J_k\left(\Delta\overline{\bf u}, \boldsymbol\varepsilon  \right) = \Delta\overline{\bf u}^T\overline{\bf Q}\Delta\overline{\bf u}+\rho \boldsymbol\varepsilon^T\boldsymbol\varepsilon =
    \begin{pmatrix} \Delta\overline{\bf u} & \boldsymbol\varepsilon \end{pmatrix}^T \tilde{\bf H}
    \begin{pmatrix}
        \Delta\overline{\bf u} \\
        \boldsymbol\varepsilon
    \end{pmatrix}.
\end{equation*}
В нем $ \overline{\bf Q} = {\rm diag} ({\bf Q}, ..., {\bf Q})$ --- матрица размера $mP \times mP$, $\tilde{\bf H} =
\begin{pmatrix}
    \overline{\bf Q} & {\bf 0} \\
    {\bf 0}  & \rho{\bf E}_p
\end{pmatrix} $ --- симметричная, положительно определенная матрица. В~итоге поставим следующую задачу оптимизации управления на горизонте прогноза с~учетом ограничений (19) и~(20) на управляющие и~контролируемые переменные:

\begin{equation}
    J_k = J_k\left(\Delta\overline{\bf u},\boldsymbol\varepsilon  \right) = \left(
    \Delta\overline{\bf u} \,\, \boldsymbol\varepsilon \right)^T\tilde{\bf H}
    \begin{pmatrix}
        \Delta\overline{\bf u} \\
        \boldsymbol\varepsilon
    \end{pmatrix}  \rightarrow \min \limits_{\begin{pmatrix}
    \Delta\overline{\bf u} & \boldsymbol\varepsilon \end{pmatrix}  \in \Omega \subseteq E^{nP+P}}.
\end{equation}
Здесь $\Omega$ --- допустимое множество (24). Заметим, что размерность задачи оптимизации (26) равна $nP+P$.

Решение задачи (26) определяет оптимальную программную последовательность векторов $\Delta{\bf u}^{*}[k],\Delta{\bf u}^{*}[k+1],...,\Delta{\bf u}^{*}[k+P-1]$, а~также значение вектора слабых переменных $\boldsymbol\varepsilon^{*}$.  В~соответствии со стратегией MPC-подхода используется только первая компонента $\Delta{\bf u}^{*}[k]$ найденного решения на текущем такте. Для следующего такта процесс вычислений повторяется заново. Отметим, что задача оптимизации (26) является задачей выпуклого квадратичного программирования.

В заключение рассмотрим вопрос о построении асимптотического наблюдателя для оценки вектора состояния ${\bf x}$ системы (12), поскольку реализация MPC-закона управления предполагает наличие такой оценки для инициализации прогнозирующей модели (14). Сначала перепишем модель (12), выделив уравнения, относящиеся к~вектору ${\bf x}_s$. Отметим, что компоненты именно этого вектора представляют особый интерес, поскольку они соответствуют отдельным передаточным функциям исходной модели (1). В~результате такого преобразования получим следующие уравнения:

\begin{equation}
    \begin{aligned}
        &{\bf x}_s[k+1] = {\bf A}_s{\bf x}_s[k]+{\bf A}_{ds}{\bf x}_d[k]+{\bf B}_s{\bf u}[k], \\
        &{\bf x}_e[k+1] = {\bf A}_e{\bf x}_e[k]+{\bf A}_f{\bf f}[k]+{\bf A}_{es}{\bf x}_{de}[k], \\
        &\qquad\qquad{\bf y}[k] = {\bf C}_s{\bf x}_s[k]+{\bf C}_e{\bf x}_e[k],
    \end{aligned}
\end{equation}
в которых матрицы ${\bf A}_s$, ${\bf A}_{ds}$, ${\bf B}_s$, ${\bf C}_s$, ${\bf A}_e$, ${\bf A}_f$, ${\bf A}_{es}$, ${\bf C}_e$ получаются извлечением отдельных строк и~столбцов из матриц (13) с~учетом особенностей структуры уравнений (7), (8). Теперь для модели (27) сформируем асимптотический наблюдатель для оценки вектора ${\bf x}_s$:

\begin{equation}
    \begin{aligned}
        {\bf z}[k+1] = {\bf A}_s{\bf z}[k]+{\bf A}_{ds}{\bf x}_d[k]+{\bf B}_s&{\bf u}[k] + {\bf G}({\bf y}[k]-{\bf C}_s{\bf z}[k]-{\bf C}_e{\bf x}_e[k]), \\
        {\bf x}_e[k+1] = {\bf A}_e{\bf x}_e[k]+&{\bf A}_{es}{\bf x}_{de}[k]+{\bf A}_f{\bf f}[k], \\
        {\bf x}_d[k+1] = {\bf A}_d&{\bf x}_d[k]+{\bf B}_d{\bf u}[k], \\
        {\bf x}_{de}[k+1] = {\bf A}_{fe}&{\bf x}_{de}[k]+{\bf B}_{fe}{\bf f}[k], \\
        {\bf y}[k] = {\bf C}_s{\bf z}&[k]+{\bf C}_e{\bf x}_e[k].
    \end{aligned}
\end{equation}
Здесь ${\bf z} \in E^{n_e}$ --- вектор состояния асимптотического наблюдателя. Настраиваемым элементом асимптотического наблюдателя (28), подлежащим выбору, является матрица ${\bf G}$ при невязках. Ее необходимо выбрать так, чтобы обеспечивалось выполнение равенства $\lim_{k\to\infty} ({\bf z}[k]-{\bf x}_s[k])={\bf 0}$, т. е. оценки наблюдателя должны сходиться к~${\bf x}_s$. При этом уравнение относительно вектора ошибки оценивания ${\bf e}={\bf x}_s-{\bf z}$ в~данном случае принимает стандартный вид: ${\bf e}[k+1] =({\bf A}_s-{\bf GC}_s){\bf e}[k]$. Следовательно, для поиска матрицы {\bf G} можно использовать известные методы, например модальный синтез [12].

\indent \textbf{5. Пример управления в~задаче нефтепереработки.} Рассмотрим пример синтеза закона управления применительно к~задаче нефтепереработки. Объектом управления здесь служит ректификационная колонна. В~процессе ее эксплуатации достаточно, чтобы контролируемые переменные химического процесса находились внутри заданных инженером диапазонов, обеспечивая тем самым требуемое качество выходных нефтепродуктов. При этом не ставится задача обеспечить их определенные значения.

Математическая модель объекта управления задается уравнениями

\begin{equation}
    \begin{aligned}
         y_1 = \frac{-0.03}{10s+1}e^{-2s}&u_2,\,\,\, y_2 = \frac{-0.03}{10s+1}e^{-6s}u_1, \\
         y_3 = \frac{0.05}{5s+1}&u_2,\,\,\, y_4 = \frac{20}{5s+1}u_3, \\
         y_5 = \frac{-2}{35s+1}&e^{-13s}u_3+\frac{-400}{8s+1}u_4, \\
         y_6 = \frac{0.03}{20s+1}e^{-8s}u_1+&\frac{0.15}{70s+1}e^{-10s}u_2+\frac{0.6}{25s+1}u_4.
    \end{aligned}
\end{equation}
Для данной модели имеем $m=6$, $n=4$, $l=1$. Постоянные времени и~запаздывания в~уравнениях (29) заданы в~минутах.
Контролируемые $y_1,\dots,y_6$  и~управляющие $u_1,\dots,u_4$ переменные являются специфическими величинами, характеризующими состояние действительного нефтехимического процесса, протекающего в~промышленной ректификационной колонне. Данные для примера предоставлены компанией ООО «Т-СОФТ» при проведении совместных исследований.

Исходные данные для абсолютных значений контролируемых и~управляющих переменных, необходимые для моделирования, представлены в~табл. 1 и~2. Отметим, что в~начальный момент времени значения переменных $\tilde y_1$, $\tilde y_5$, $\tilde y_6$ выходят за пределы заданного диапазона (3).


%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Таблица 1.} {\bf Исходные данные\\ для контролируемых переменных}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{ | c | c | c | c | }
            \hline
            Переменная & ${\bf y}_s$ & $\tilde{\bf y}_{\rm min}$ & $\tilde{\bf y}_{\rm max}$ \\ \hline
            $\tilde y_1$ & 8.1 & 0 & 8 \\
            $\tilde y_2$ & --1 & --2.5 & 4.1 \\
            $\tilde y_3$ & 2 & --6 & 6 \\
            $\tilde y_4$ & 1 & --3 & 3 \\
            $\tilde y_5$ & --3 & 0 & 3 \\
            $\tilde y_6$ & --1 & 0 & 10.15 \\
            \hline
        \end{tabular}

}
\end{center}\vspace{-7mm}
\end{table}
%\vskip 2mm



%\vskip 2mm
\begin{table}[h!]
\begin{center}
{\small

{\it Таблица 2.} {\bf Исходные данные\\ для управляющих переменных}%

}

\vskip 3mm

{\footnotesize

\begin{tabular}{ | c | c | c | c | c | c | }
            \hline
            Переменная & ${\bf u}_s$ & $\tilde{\bf u}_{\rm min}$ & $\tilde{\bf u}_{\rm max}$ & $\Delta\tilde{\bf u}_{\rm min}$ & $\Delta\tilde{\bf u}_{\rm max}$ \\ \hline
            $\tilde u_1$ & 0.4 & --10 & 10 & --0.5 & 0.5 \\
            $\tilde u_2$ & --5 & --20 & 20 & --0.5 & 0.5 \\
            $\tilde u_3$ & 0.5 & --1 & 1 & --0.05 & 0.05 \\
            $\tilde u_4$ & 0.2 & --1 & 1 & --0.05 & 0.05 \\
            \hline
        \end{tabular}

}
\end{center}\vspace{-3mm}
\end{table}
%\vskip 2mm




Выберем шаг дискретности $T_s=2$ мин. Построим дискретную модель вида (12), согласно приведенному подходу. Зададим горизонт прогноза $P=50$. Таким образом, временной интервал прогнозирования составляет 100 мин, а~размерность задачи оптимизации (26), решаемой на каждом такте пересчета управления, равна $N=P \cdot n + P = 50 \cdot 4 + 50 = 250$.

Выберем значения весового коэффициента и~весовой матрицы в~функционале (25): $\rho=1e5$, ${\bf Q}={\bf E}_{4 \times 4}$. На рис. 1 и~2, %
\begin{figure}[h!]
\centering{
\includegraphics[scale=0.65]{12/fig1}

\vskip .5mm
{\small{\it Рис. 1.} Переходные процессы по выходу $\tilde{\bf y}$ } \\

\vskip 0mm {\footnotesize {\it 1} --- без запаздывания; {\it 2} --- с~ запаздыванием; {\it 3} --- граница диапазона.} }
%\end{figure}
%
%\begin{figure}[h!]
\vskip 2mm\centering{
\includegraphics[scale=0.65]{12/fig2}

\vskip .5mm
{\small{\it Рис. 2.} Переходные процессы по входу $\tilde{\bf u}$ } \\

\vskip 0mm {\small (обозначения см. на рис. 1)} }
\end{figure}
на которых приведены результаты имитационного моделирования для MPC-регулятора как с~учетом запаздывания, так и~без него, видно, что построенный регулятор с~запаздыванием обеспечивает попадание контролируемых переменных в~заданный диапазон (3), причем значения переменных $y_4$, $y_5$ устанавливаются практически на границе диапазона. В~то же время MPC-регулятор без учета запаздывания не позволяет достичь цели управления за приемлемое время.







Интенсивность работы управления определяется весовым коэффициентом $\rho$ при штрафном слагаемом в~функционале качества (25). Чем меньше значение $\rho$, тем менее агрессивным является управляющее воздействие. Проведенные эксперименты с~меньшими значениями $\rho$ показали, что при этом также достигается цель управления, но за б$\acute{\text{о}}$льший промежуток времени.


\indent \textbf{6. Заключение.} Рассмотрена задача удержания контролируемых переменных динамического объекта в~заданном диапазоне. Предложен оптимизационный подход к~синтезу цифрового закона управления, основанный на использовании прогнозирующей модели. Особенность этого подхода --- возможность учета запаздывания по управлению и~возмущению, а~также ограничений на управляющие воздействия. Полученные результаты проиллюстрированы примером управления процессом переработки нефти в~ректификационной колонне. Показано, что построенный регулятор обеспечивает попадание внутрь и~удержание контролируемых переменных процесса в~заданном диапазоне с~учетом ограничений и~внешних возмущений. Выполнено сравнение полученных результатов моделирования с~данными для регулятора, в~котором не учитывается запаздывание. Проведенный анализ показал существенную эффективность учета запаздывания при синтезе закона управления. Планируемым дальнейшим развитием подхода является разработка методов адаптации к~текущим условиям функционирования, в~частности идентификация параметров модели объекта в~режиме реального времени.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{12/lit-ra}

%\newpage
\input{12/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~17.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %


%}
