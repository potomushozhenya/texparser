
%\begin{center}
%{\footnotesize
%\begin{tabular}{lcr}
%$\issueyear$   & ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА  &  Том\,13.\,\,Вып.\,$\issuenum$ \\
%\multicolumn{3}{c}{ПРИКЛАДНАЯ МАТЕМАТИКА.
%ИНФОРМАТИКА. ПРОЦЕССЫ УПРАВЛЕНИЯ}\\
%\end{tabular}
%\end{center}
%}
{\footnotesize \noindent$\issueyear$\mbox{~~~~~~~~~~}
ВЕСТНИК\,САНКТ-ПЕТЕРБУРГСКОГО\,УНИВЕРСИТЕТА
Т.\,13.\,\,Вып.\,$\issuenum$\linebreak %
\mbox{~~~~~~~~~~}ПРИКЛАДНАЯ МАТЕМАТИКА. ИНФОРМАТИКА. ПРОЦЕССЫ
УПРАВЛЕНИЯ %
}

%\ \\ \vskip 0.8mm\hrule \\ \hrule \\ \ \\

\vskip 0.5mm

\hline\vskip .5mm

\hline

\vspace{1.2cm} \noindent {\large ПРОЦЕССЫ УПРАВЛЕНИЯ}
\vspace{1.0cm}

\noindent{\footnotesize УДК 539.3}

\vskip4mm

\noindent{\it А.~Г.~Топаж$^1$, Е.~П.~Митрофанов$^2$}

\vskip3mm

\noindent{\bf АССИМИЛЯЦИЯ ДАННЫХ В~ИМИТАЦИОННОМ\\ МОДЕЛИРОВАНИИ
ЭКОЛОГИЧЕСКИХ ПРОЦЕССОВ МЕТОДОМ\\ МИНИМИЗАЦИИ КОРРЕКТИРУЮЩИХ
ВОЗМУЩЕНИЙ%$^{*}$
}

\efootnote{

\vspace{-3mm}\parindent=7mm


%{\copyright} Н. А. Валиотти, 2014

{\it Топаж Александр Григорьевич}  --- доктор технических наук;
alex.topaj@gmail.com

{\it Митрофанов Евгений Павлович}  --- аспирант; mjeka@bk.ru

\vskip 3.0mm

\textit{Topaj Alexander Grigorievich}  --- doctor of technical
sciences; alex.topaj@gmail.com

\textit{Mitrofanov Evgeniy Pavlovich}  --- postgraduate student;
mjeka@bk.ru

\vskip 3.0mm

%$^{*}$ Работа выполнена при финансовой поддержке РНФ (проект
%№~17-71-10069).
%
%\vskip 2.0mm

{\copyright} Санкт-Петербургский государственный университет,
\issueyear\\

}

\vskip3mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp07 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp07 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum09}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize


\noindent $^1$~ООО <<Бюро Гиперборея>>, Российская Федерация,

\noindent\hskip2.45mm 193312, Санкт-Петербург, ул. Подвойского, 40

\noindent $^2$~Агрофизический научно-исследовательский институт,
Российская Федерация,

\noindent\hskip2.45mm 195220, Санкт-Петербург, Гражданский пр., 14



\vskip4.0mm


\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}


\item Оперативная коррекция текущего вектора состояния
динамической модели данными прямых или косвенных измерений
в~режиме реального времени представляет собой известную задачу
теории автоматического управления и называется проблемой
ассимиляции или усвоения данных. Математические модели в~экологии
требуют специфических подходов к~этой проблеме по сравнению
с~традиционными методами, применяемыми в~гидрометеорологии.
Основное отличие состоит в~том, что в~этом случае наличествуют,
как правило, лишь редкие наблюдения, причем над ограниченным
числом косвенных характеристик. В~работе предлагается оригинальный
подход к~ассимиляции данных для задач подобного рода. Он
заключается в~том, что в~исходную систему вводится дополнительное
слагаемое, отражающее роль неучитываемых в~идеальной модели
случайных внешних воздействий. Далее находится такая форма этих
возмущений, которая минимизирует взвешенную сумму их интегральной
мощности и нормы отклонений наблюдаемых и~теоретических
характеристик в~точках измерения. При этом выбор весового
коэффициента позволяет отразить сравнительную степень доверия
теоретической модели или фактическим измерениям. Таким образом,
формальная постановка задачи записывается в~виде проблемы
оптимального управления. Приведены примеры применения
предложенного метода для нескольких простых моделей. В~задаче
о~равномерном движении материальной точки получено аналитическое
решение, дающее, тем не менее, нетривиальные результаты. Задача об
ассимиляции данных в~модели Лотки---Вольтерра решена численно.
Показано, что в~этом случае предложенный метод <<минимального
возмущения>> приводит к~наименее <<травматичнoй>> коррекции
эталонной модели по сравнению с~известными альтернативными
подходами~--- адаптивной идентификацией параметров или подгонкой
начального состояния. Библиогр. 7~назв. Ил.~2.

{\it Ключевые слова}: ассимиляция данных, минимизация
корректирующих возмущений, экология, имитационное моделирование.

\end{list}

}

%\vskip1.5mm
\newpage

\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}

\noindent{\it A.~G.~Topaj$^1$, E.~P.~Mitrofanov$^2$}

\vskip2mm \noindent{\bf ASSIMILATION OF DATA IN THE IMITATIVE
MODELING\\ OF ENVIRONMENTAL PROCESSES BY THE METHOD\\ OF
MINIMIZING CORRECTIVE PERTURBATIONS}

\vskip2.5mm


{\footnotesize

\noindent $^1$ Bureau Hyperborea, 40, Podvoisky ul., St.
Petersburg,

\vspace*{-1.5mm}\noindent\hskip2.45mm 193312, Russian Federation


\vspace*{-1.5mm}\noindent $^2$ Agrophysical Research Institute,
14, Grazhdanskiy pr., St. Petersburg,

\vspace*{-1.5mm}\noindent\hskip2.45mm 195220, Russian Federation



\vskip2.0mm


\item The on-line correction of the vector of a dynamic model state
variable by direct or indirect measurements is a well-known
problem of the theory of automatic control. It is called the
problem of data assimilation. Ecological models require specific
approaches to this problem in comparison to traditional methods
used in hydrometeorology. The main difference is that there are
only rare observations on a limited number of indirect
characteristics. The paper presents an original approach to data
assimilation for such cases. The main idea is inclusion an
additional term to the initial system, which describes the random
external influences that are not counted in the ideal model.
Further, one can find a form of these perturbations that minimizes
the weighted sum of their integrated power and the norm of
deviations of the observed and theoretical characteristics at
moments of measurement. Then the choice of weighting factor allows
us for comparative confidence to be reflected between the
theoretical model and actual measurements. Thus, the formal
statement of the problem is written down as a problem of optimal
control. Examples of application of the proposed method for
several simple models are given. In the problem of the uniform
motion of a material point, an analytical solution can be obtained
which, nonetheless, yields rather interesting results. The problem
of data assimilation for the Lotka---Volterra model has been
solved numerically. It is shown that the proposed method of
``minimal perturbation'' leads to the least ``traumatic''
correction of the ideal model in comparison with the available
alternative approaches; i.~e., adaptive parameter identification
or backdating adjustment of the initial state. Refs~7. Figs~2.

\textit{Keywords}: assimilation of data, minimization of
corrective disturbances, ecology, simulation modeling.


}

\end{list}


\vskip2mm

 { \bfseries  Введение.}
Динамическое имитационное моделирование и~компьютерный эксперимент
все глубже проникают в~практику научного исследования не~только
в~технических, но~и~в~естественных дисциплинах. При этом возникает
весьма непростой вопрос, касающийся взаимодействия результатов
численного и~данных натурного экспериментов. В~качестве примера
можно рассмотреть ситуацию с~динамическими моделями
в~агроэкологии, описывающими продукционный процесс культурных
растений на~сельскохозяйственном поле. За более чем 30-летнюю
историю этого направления качественный скачок претерпели не~только
компьютерная техника, но~и~технологические средства измерения.
С~появлением совершенно новых, дис\-тан\-цион\-ных и~даже
космических средств мониторинга оказалось, что многие
характеристики состояния системы <<почва---растение---атмосфера>>
сегодня допускают прямое оперативное измерение с~практически
произвольно задаваемым уровнем временного и~пространственного
разрешения. Причем для этого зачастую не~требуется никаких
специальных усилий или дорогостоящих измерений, достаточно иметь
доступ к~частично или полностью открытым, оперативно обновляющимся
базам данных дистанционного спутникового зондирования. Условно
говоря, листовой индекс, коэффициент проективного покрытия или
даже степень обеспеченности растений азотным питанием, прямо или
косвенно определяемые из~вегетационных оптических индексов,
в~принципе сегодня могут считаться такими же внешними входными
данными для модели, как метеорологические параметры~---
температура или осадки [1]. В~существующих моделях эти величины
вычисляются на~каждом шаге расчета, т.~е. представляют
собой\linebreak\noindent компоненты вектора внутренних переменных
состояния моделируемой системы. Таким образом, возникает
объективная проблема применения оперативно поступающих
экспериментальных данных для корректировки модели в~режиме
<<runtime>>, т.~е. непосредственно в~ходе расчета. Решение
указанного вопроса отнюдь не~так очевидно, как кажется на~первый
взгляд.

Так, в~последнее время активно используется подход, связанный
с~корректировкой величины листового индекса посева в~моделях
продуктивности сельскохозяйственных растений по~данным спутниковых
снимков дистанционного зондирования Земли~[2]. Не вызывает
сомнения, что листовой индекс действительно может быть более-менее
адекватно оценен по~тем или иным индексам спектрального анализа
изображения (NDVI и~т.~п.). Однако явная коррекция в~реальной
динамической модели агроэкосистемы только этого показателя для
обеспечения достоверности  прогнозных расчетов в~течение
оставшегося сезона вегетации совершенно недостаточна. Как правило,
листовой индекс является не~ключевой, а~вычисляемой переменной
состояния и~пересчитывается на~каждом шаге из~биомассы побега.
Тогда его коррекция на~текущем шаге позволит, возможно, лишь более
адекватно смоделировать фотосинтез на~следующем шаге, после чего
модель вновь вернется к~исходному состоянию. Если же
воспользоваться обратной зависимостью и~пересчитать по~листовому
индексу биомассу побега, то~возникает вопрос~--- а~что делать
с~неоднозначно связанными с~нею на~всех шагах расчета другими
динамическими переменными: биомассой корня, физиологическим
временем, влажностью почвы и~др.? Таким образом, примитивная
подмена модельного значения измеренным может сработать только для
очень простых малопараметрических моделей регрессионного
характера, но~вряд~ли допустима для комплексных динамических
моделей агроэкосистем.

Вообще говоря, вопрос оперативной коррекции текущего вектора
состояния динамической модели прямыми или косвенными измерениями
представляет собой известную задачу теории автоматического
управления и~называется проблемой ассимиляции или усвоения данных
[3]. Математическая теория ассимиляции данных получила наибольшее
развитие в~приложении к~ задачам синоптики~[4]. Безусловно,
динамическое моделирование в~экологии, в~частности моделирование
про\-дук\-цион\-но\-го процесса растений, имеет ряд специфических
особенностей по~сравнению с~прогнозом погоды. Прежде всего это
гораздо б\'{о}льший разброс в~семантике составляющих вектора
состояния моделируемого объекта. В~задачах метеорологического
прогнозирования большая размерность вектора состояния определяется
в первую очередь пространственным разрешением расчетной сетки,
а~набор отслеживаемых физических величин сравнительно невелик
(температура и~давление). В~то же время модель агроэкосистемы
может быть даже точечной (одномерной), однако число значимых
переменных состояния у~нее довольно велико (биомассы различных
органов растения, концентрации питательных веществ и~влаги в~почве
и растении и~т. д.). Далее, несмотря на~появление новых средств
измерения, с~математической точки зрения большинство экологических
моделей все еще представляют собой ненаблюдаемые системы
управления~---  прямой или косвенной оценке по~имеющимся
наблюдениям доступна лишь малая часть переменных состояния. И,
наконец, существенной особенностью является временная
разреженность поступления данных измерений по~сравнению с~шагом
модели. Если в~метеорологических приложениях уровень развития
информационного обеспечения современных моделей глобальной
циркуляции позволяет организовать поступление свежих сведений
оперативных измерений чуть ли не~на~каждом шаге, автоматизация
модельных расчетов в~экологии и~агроэкологии еще не~достигла
подобного совершенства. Таким образом, математические модели
в~экологии зачастую требуют специфических подходов к~оперативной
коррекции модели данными измерений. В~ряде работ рассматриваются
альтернативные методы осуществления этой процедуры в~практических
задачах мониторинга и~предсказания урожайности
сельскохозяйственных посевов с~использованием динамических моделей
продуктивности~[5]. В~статье предлагается оригинальный подход
к~ассимиляции данных, основанный на~методах решения вариационных
задач в~теории автоматического управления. Описываются примеры его
применения для двух очень простых моделей, проводится сравнение
с~известными решениями.



 { \bfseries  Постановка задачи ассимиляции данных.}
Рассмотрим постановку задачи ассимиляции данных в~общем виде. Есть
динамическая модель в~дискретном времени
  \begin{equation}\label{1}
  \mathbf{x}_{k+1} = f(\mathbf{x}_k, \mathbf{u}_k, \mathbf{w}_k)                                 \end{equation}
с~вектором состояния $\mathbf{x}$. С~помощью (1) осуществляется
рекурентный пересчет этого вектора в~реальном времени с~учетом
управления $\mathbf{u}$ и~неконтролируемых воздействий
$\mathbf{w}$. И в~какой-то момент времени $k = K$ нам приходит
некоторое измерение величины, зависящей от~$\mathbf{x}$, т.~е.
имеем вектор $\tilde{\mathbf{y}}_K$. При этом правило вычисления
$\mathbf{y}$ от~вектора состояния $\mathbf{x}$ задано априори:
    \begin{equation*}
  \mathbf{y}_k = \mathbf{y}(\mathbf{x}_k),                                     \end{equation*}
а размерность вектора $\mathbf{y}$ существенно меньше размерности
вектора $\mathbf{x}$, т. е., как правило, обратного однозначного
отображения $\mathbf{y}$ в~$\mathbf{x}$ не~существует. Ясно, что
в~реальности ожидаемое для идеального случая равенство
  \begin{equation*}
  \tilde{\mathbf{y}}_K = \mathbf{y}(\mathbf{x}_K)                                     \end{equation*}
не выполняется. Причин этого может быть несколько: ошибки
измерений, неверная интерпретация правила вычисления $\mathbf{y}$
от $\mathbf{x}$ или, наконец, неточность самой модели. Причем
источников такой неточности, в~свою очередь, может быть много~---
неверное задание начального состояния $\mathbf{x}_0$, неточности
во входных данных $\mathbf{u}_k, \mathbf{w}_k, k = 1, ..., K$,
неопределенность величин параметров модели или влияние вообще
неучтенных в~модели эффектов и~процессов. Однако модель такова,
какова она есть, и, несмотря на~текущее рассогласование с~данными
измерений, необходимо продолжать расчеты по~ней далее для моментов
времени $k = K+1, ..., N$, возможно каким-то образом
скорректировав текущий вектор состояния для лучшего удовлетворения
данных наблюдений. Заметим, что речь в~таком случае идет именно об
оперативной корректировке самого вектора состояния модели, а~не ее
параметров (адаптивная идентификация) или закона управления
(адаптивное управление). То есть сама модель остается неизменной,
а~мы просто подменяем текущую величину $\mathbf{x}_K$ на~некое
специальным образом скорректированное значение
$\tilde{\mathbf{x}}_K = \tilde{\mathbf{x}}(\tilde{\mathbf{x}}_K,
\mathbf{y}_K, \tilde{\mathbf{y}}_K)$ и~продолжаем расчет с~данного
состояния по~той же модели по~крайней мере до~получения очередного
измерения, требующего корректировки.

Проблема состоит в~том, каким должен быть выбран алгоритм
корректировки. Ясно, что он напрямую зависит от~того, какой
причиной исследователь объяс\-няет себе полученное
рассогласование. Если подозрение падает на~неверное задание
в~модели тех или иных постоянных параметров, требуются их
<<переидентификация>> и~пересчет всей предыдущей траектории
с~уточненными значениями. Этот подход очень близок проблеме
адаптивной параметрической идентификации. Предположение
о~неточности задания начальных условий влечет за~собой решение той
или иной обратной задачи для их модификации. Примеры использования
обоих подходов, равно как и~их разнообразные комбинации в~ моделях
природных и~биологических систем, изложены в~[5]. Ниже
рассматривается метод, основанный на~априорном предположении
о~том, что используемая модель {\it структурно} неполна для
адекватного описания имитируемого объекта.


  { \bfseries  Метод минимизации корректирующих возмущений.}
В качестве возможного теоретически обоснованного и~логически
непротиворечивого метода решения задачи оперативной коррекции
произвольной динамической модели предлагается следующий
принципиальный подход.

Запишем уравнение динамики поведения моделируемой системы в~виде
  \begin{equation}\label{2}
  \mathbf{x}_{k+1} = f(\mathbf{x}_k, \mathbf{u}_k, \mathbf{w}_k) + \mathbf{\xi}_k,                                  \end{equation}
который практически полностью совпадает с~исходной теоретической
моделью исследуемого объекта за~исключением добавления в~правую
часть вектора $\mathbf{\xi}_k$, отра\-жаю\-ще\-го интегральное
влияние неучитываемых в~опорной модели факторов и~эффектов
на~каждом шаге рекуррентного пересчета вектора состояния. При
этом, исходя из~физики процесса, некоторые из~составляющих вектора
$\mathbf{\xi}_k$ могут быть положены тождественно равными нулю
(тем самым мы берем на~себя смелость утверждать, что некоторые
уравнения, составляющие эволюционный оператор $f$, описывают
реальность абсолютно точно). Полагаем, что именно неучтенное
влияние этих неизвестных и~неопределенных факторов привело к~тому,
что очередные измерения оказались несогласованы с~ожидаемыми
величинами. Понятно, что количество вариантов возмущений, которые
могли бы привести к~полученному рассогласованию, огромно. Однако
мы склонны доверять рассматриваемой модели и~считаем, что в~общем
и~целом она адекватно описывает реальность. Тогда можно поставить
и в идеале решить следующую задачу: а~какими должны быть {\it
минимальные по~мощности} неучтенные и~неизвестные нам возмущения
$\mathbf{\xi}_k$, при которых траектория динамики системы может
породить вектор состояния в~момент $K$, полностью или в~большой
мере соответствующий проведенному в~этот момент измерению
$\tilde{\mathbf{y}}_K$? Разрешив такую задачу, т. е. найдя
подобные <<минимально обеспечивающие>> возмущения
$\mathbf{\xi}_k$, можно просто проинтегрировать измененную модель
(2) на~интервале времени от~0 до~$K$ и~получить некое теоретически
обоснованное состояние $\tilde{\mathbf{x}}_K$, которое естественно
принять в~качестве опорной точки дальнейшего расчета модели
в~режиме реального времени. Таким образом, формальная постановка
задачи может быть записана в~виде проблемы оптимального
управления:
\begin{equation*}
\tilde{\mathbf{x}}_K = \mathbf{x}_k(\mathbf{\xi}_k)   \mid k =
K,~~~ \mathbf{x}_{k+1} = f(\mathbf{x}_k, \mathbf{u}_k,
\mathbf{w}_k) + \mathbf{\xi} (k), \end{equation*}
\begin{equation}\label{3}
\mathbf{\xi} (k) = \arg\min_{\mathbf{\xi}} J(\mathbf{x},
\mathbf{\xi}) = \arg\min_{\mathbf{\xi}} ((1 - \gamma) \cdot
\parallel \mathbf{y}(\mathbf{x}_K) - \tilde{\mathbf{y}}_K
\parallel + \gamma \cdot \parallel \mathbf{\xi}_k \parallel ),
\end{equation} где  коэффициент $1-\gamma$ естественно
интерпретировать как относительный показатель доверия измерениям
по отношению к~модели. При $\gamma \to 0$ решение будем искать
в~классе возмущений, обеспечивающих точное совпадение модели
с~измерениями в~опорный момент времени, а~выбор конкретного
возмущения из~такого класса, согласно критерию малости
интегральной мощности, будет достигаться в~пределе, подобно тому,
как это происходит при регуляризации некорректных задач методом
сингулярного разложения по~малому параметру~[6].

{\bfseries Примеры применения метода.} Приведем примеры
использования предложенного подхода для двух моделей динамики
систем, записанных в непрерывном времени.

\textbf{\emph{Пример 1. Задача о~равномерном движении материальной
точки}}. Рас\-смат\-ри\-вает\-ся простейшая  модель движения
материальной точки в~предположении отсутствия внешних сил:
 \begin{equation} \begin{split}
      \dot{x}_1 = x_2,~   &  x_1 \mid_{t = 0} ~= 0, \\
      \dot{x}_2 = 0, ~      &  x_2 \mid_{t = 0} ~= V.
\end{split} \end{equation}

Закон движения, определяемый этой тривиальной моделью,
представляет собой равномерное прямолинейное перемещение точки
с~постоянной скоростью $V$, и~тогда естественно ожидать, что
в~момент времени $t = T$ координата точки будет равна $x_1 (T) = V
\cdot T$. Однако полученные измерения координаты, основанные,
например, на~данных телеметрии, показывают, что она составляет
величину $\tilde{X}$. При этом явные измерения скорости, т. е.
величины $x_2 (T)$, недоступны. Ставится задача оперативной
коррекции вектора состояния модели для производства дальнейших
расчетов в~реальном времени при $t > T$. Основной вопрос
заключается в~том, какое согласованное опорное значение в~момент
времени $T$ следует приписать переменной состояния $x_2$, если
переменная $x_1$ будет скорректирована из~условия полного доверия
измерениям, т. е. ей будет приписана величина $\tilde{X}$.
Рассмотрим решение такой задачи согласно предложенному алгоритму.
Запишем измененную модель с~учетом неопределенных внешних
возмущений. Ясно, что для описываемого случая нужно добавить
дополнительное слагаемое только во~второе уравнение системы (4),
так как первое уравнение представляет собой строгое тождество.
Добавка же аддитивной составляющей в~уравнение для ускорения
в~данном случае имеет прозрачную физическую аналогию~--- по~нашему
мнению, рассогласование результатов модели и~эксперимента было
вызвано действием неизвестной внешней силы, а~не, например,
неточностью задания начальных условий. Полагаем, что и~координата,
и скорость точки в~момент начала отсчета были измерены точно, и~им
можно доверять. Таким образом, для модели с~учетом возмущений
имеем
 \begin{equation}
\begin{split}
      \dot{x}_1 = x_2,~   &  x_1 \mid_{t = 0} ~= 0, \\
      \dot{x}_2 = u, ~      &  x_2 \mid_{t = 0} ~= V.
\end{split}
\end{equation}

В полном соответствии с~базовым принципом будем искать динамику
возмущения как решение вариационной задачи, т. е. из~условия
минимизации функционала
\begin{equation*}
J = (1 - \gamma) \cdot (x_1 (T) - \tilde{X})^2 + \gamma \cdot T^3
\cdot \int\limits_{0}^{T} u^2 (t) dt  \end{equation*} (здесь
множитель $T^3$ во~втором слагаемом функционала добавлен как
масштабный коэффициент для приведения обоих слагаемых к~одной
размерности). Поставленная задача синтеза оптимального управления
может быть решена аналитически с~по\-мощью метода максимума
Понтрягина.

Гамильтониан вариационной задачи записывается следующим образом:
\begin{equation*}
H = \lambda_1 \cdot x_2 + \lambda_2 \cdot u + \gamma \cdot T^3
\cdot u^2,   \end{equation*} откуда сразу вытекает выражение для
управления, доставляющего ему минимальное значение:
\begin{equation*}
u_{opt} = - \frac {\lambda_2} {2 \cdot \gamma \cdot T^3} .
\end{equation*}

Система дифференциальных уравнений для сопряженных переменных
при\-ни\-мает вид
 \begin{equation}\label{6}
\begin{split}
      \dot{\lambda}_1 = - \frac {\partial H} {\partial x_1}& = 0, \\
      \dot{\lambda}_2 = - \frac {\partial H} {\partial x_2}& = - \lambda_1
\end{split}
\end{equation}
c граничными условиями трансверсальности на~правом конце интервала
управления:
 \begin{equation}\label{7}
\begin{split}
      \lambda_1 (T) = 2 \cdot & (1-\gamma)  \cdot (x_1 (T) - \tilde{X}),  \\
    &  \lambda_2 (T) = 0.
\end{split}
\end{equation}

Решение системы уравнений для сопряженных переменных (6) и~(7)
тривиально, и~тогда получаем
 \begin{equation}\label{8}
\begin{split}
      \lambda_1 (t) = 2 \cdot (1 - \gamma) \cdot (x_1 (T) - \tilde{X}), \\
      \lambda_2 (t) = 2 \cdot (1 - \gamma) \cdot (x_1 (T) - \tilde{X}) \cdot (T - t), \\
      u(t) = - \frac {1 - \gamma} {\gamma \cdot T^3} \cdot (x_1 (T) - \tilde{X}) \cdot (T - t).
\end{split}
\end{equation}

Таким образом, оптимальный закон управления представляет собой
динамику возмущений в~виде силы, линейно убывающей от~времени
и~достигающей нуля в~точке получения измерений~$T$. Подставив
выражение для возмущения~(8) в~исходные уравнения для переменных
состояния~(5), можно аналитически разрешить систему, получив
выражения для динамики переменных состояния как явные функции
от~времени:
 \begin{equation}\label{9}
\begin{split}
      x_1 (t) = & \frac {1 - \gamma} {6 \cdot \gamma} \cdot (x_1 (T) - \tilde{X}) + V \cdot t - \frac {1 - \gamma} {2 \cdot \gamma} \cdot \frac {x_1 (T) - \tilde{X}} {T} \cdot t ~ - { } \\
                      & { } -~ \frac {1 - \gamma} {6 \cdot \gamma \cdot T^3} \cdot (x_1 (T) - \tilde{X}) \cdot (T - t)^3, \\
      x_2 (t) = &  V - \frac {1 - \gamma} {2 \cdot \gamma} \cdot \frac {x_1 (T) - \tilde{X}} {T} - \frac {1 - \gamma} {2 \cdot \gamma \cdot T^3} \cdot (x_1 (T) - \tilde{X}) \cdot (T - t)^2.
\end{split}
\end{equation}

Записав первое уравнение системы (9) для момента времени $t = T$,
разрешаем выведенное алгебраическое выражение относительно
неизвестной $x_1 (T)$:
\begin{equation*}
x_1 (T) = \frac {1 - \lambda} {2 \cdot (\gamma + 1)} \tilde{X} +
\frac {3 \cdot \gamma} {2 \cdot (\gamma +1)} \cdot V \cdot T.
\end{equation*}

Итак, <<оптимально скорректированная>> характеристика для
координаты представляет собой средневзвешенную величину
измеренного и~модельного значений, где веса определяются введенным
показателем $\gamma$. Для случая абсолютного доверия измерениям
$(\gamma = 0)$ она, естественно, оказывается равной $\tilde{X}$.

Наконец, аналогичным образом для скорректированного значения
скорости находим, что
\begin{equation*}
x_2 (T) = V - \frac {3} {2} \cdot \frac {1 - \lambda} {2 \cdot
(\gamma + 1)} \cdot \frac {V \cdot T - \tilde{X}} {T} = \frac {7
\cdot (\gamma - 1)} {2 \cdot (2 \cdot \gamma + 1)} \cdot V+ \frac
{3 \cdot (1- \gamma )} {2 \cdot (2 \cdot \gamma + 1)}   \cdot
\frac {\tilde{X}} {T} .   \end{equation*} Для случая полного
доверия измерениям $(\gamma = 0)$ окончательно имеем
\begin{equation*}
\tilde{x}_2 (T) = \frac {3} {2} \cdot \frac {\tilde{X}} {T} -
\frac {V} {2}.   \end{equation*}

Таким образом, наилучшим образом <<согласованное>> с~полученными
измере\-ния\-ми координаты значение скорости в~точке измерения
в~предположении о~минимальном отклонении реальной динамики системы
от <<эталонной>> модели на~всем промежутке интегрирования
оказывается достаточно просто вычисляемым из~начальной и~средней
скоростей движения. Численное исследование этого решения в~среде
имитационного моделирования системной динамики AnyLogic
показывает, что для рассматриваемого случая линейно-убывающая
от~времени функция возмущения действительно имеет минимальную
интегральную квадратичную норму по~сравнению с~другими
тестируемыми формами возмущений (разовый импульс, сила постоянной
интенсивности и~т. д.), обеспечивающими переход системы
из~заданных условий в~момент времени 0 в~точку с~измеренными
координатами в~момент времени $T$.

\textbf{\emph{Пример 2. Динамика двухвидового взаимодействия}}.
Запишем классическую систему уравнений Лотки---Вольтерра,
описывающую взаимодействие двух антагонистичных видов
(хозяин---паразит, хищник---жертва и~т.~д.):
 \begin{equation}\label{10}
\begin{split}
      \dot{x}_1 = (a_1 - b_1 \cdot x_2) \cdot x_1, \\
      \dot{x}_2 = (-a_2 + b_2 \cdot x_1) \cdot x_2,
\end{split}
\end{equation}
где $a_1$ и~$a_2$~--- суммарная приспособленность (коэффициент
размножения) первого и~второго видов; $b_1$ и~$b_2$~---
коэффициенты влияния межвидового взаимодействия на~их динамику.
Все параметры считаются положительными, так что знаки при
соот\-вет\-ст\-вую\-щих членах в~системе уравнений (10)
показывают, что в~отсутствие взаимодействующего вида численность
первой популяции имеет возрастающий характер, а~второй~---
убывающий. В~свою очередь, взаимодействие позитивно влияет
на~второй вид и~отрицательно на~первый.

В~рассматриваемом случае будем интерпретировать переменные
состояния $x_1$ и~$x_2$ как суммарную биомассу растительности
и~численность единственного вида растительноядных животных
в~обсуждаемом ареале. Тогда соответствующая задача ассимиляции
данных может быть поставлена следующим образом. Пусть известны
начальные значения переменных состояния. Тогда система уравнений
(10) может быть проинтегрирована численно, порождая, как известно,
при определенных значениях параметров временную динамику мощностей
популяций в~виде сдвинутых по~фазе друг относительно друга
периодических колебаний. В~момент времени $T$ с~достаточной
точностью становится известной фактическая биомасса растительности
$\tilde{x}_1$ (оцениваемая, например, при помощи анализа
космических снимков выбранной площади). В~то же время численность
животных прямому измерению не~поддается. Требуется, исходя
из~отклонения измеренной и~модельной величин $x_1$, оценить
поправку к модельной величине $x_2 (T)$, чтобы продолжить
интегрирование модели с~нового состояния. Применим к~поставленной
задаче предложенную выше методику, выбрав в~качестве
корректирующих малых возмущений, <<ломающих>> исходную модель,
неизвестные процессы миграции растительноядных животных за~пределы
рассматриваемой области. Тогда измененная система будет записана
в~виде
 \begin{equation}\label{11}
\begin{split}
      \dot{x}_1 = (a_1 - b_1 \cdot x_2) \cdot x_1, \\
      \dot{x}_2 = (-a_2 + b_2 \cdot x_1) \cdot x_2 + u,
\end{split}
\end{equation}
а вариационная постановка задачи ассимиляции данных будет
выглядеть следующим образом: найти такой закон изменения
во~времени  интенсивности миграционных процессов $u(t)$, который,
обладая минимальной интегральной нормой, обеспечивал бы
максимальную близость величин $\tilde{x}_1$ и~$x_1(T)$.

В принципе, поставленная задача может быть сформулирована в~общем
виде (3) как стандартная проблема оптимального управления. Однако,
в отличие от~рассмотренного примера 1, ее оказывается невозможно
разрешить аналитически, а~характер получаемых уравнений таков, что
даже нахождение численного решения для конкретных параметров может
вызвать значительные затруднения. Потому в~дальнейшем ограничимся
рассмотрением вырожденного случая полного доверия измерениям. При
этом критерий оптимальности вырождается в~требование минимизации
интегральной нормы управления
\begin{equation}\label{12}
J = \int\limits_{0}^{T} u^2 (t) dt,    \end{equation}
 а~к~стандартным начальным условиям динамической системы (11) добавляется добавочное условие на~конце интервала интегрирования для переменной $x_1$, т. е. совокупность всех граничных условий записывается как
\begin{equation}\label{13}
x_1 (0) = x_{10},~~x_2 (0) = x_{20},~~x_1 (T) = \tilde{x}_1.
\end{equation}

Гамильтониан вариационной задачи (11)--(13)
\begin{equation*}
H = \lambda_1 \cdot (a_1 - b_1 \cdot x_2) \cdot x_1 + \lambda_2
\cdot (-a_2 + b_2 \cdot x_1) \cdot x_2 + \lambda_2 \cdot u + u^2,
\end{equation*} откуда оптимальное управление выражается как
$u_{opt} = - \lambda_2 / 2$. Уравнения для сопряженных переменных
имеют вид
 \begin{equation}\label{14}
\begin{split}
      \dot{\lambda}_1 = - \lambda_1 \cdot (a_1 - b_1 \cdot x_2) - \lambda_2 \cdot b_2 \cdot x_2, \\
      \dot{\lambda}_2 = \lambda_1 \cdot b_1 \cdot x_1 - \lambda_2 \cdot (b_2 \cdot x_1 - a_2),
\end{split}
\end{equation}
а единственное дополнительное граничное условие трансверсальности
(соот\-вет\-ст\-вую\-щее уравнению для~$x_2$ со~свободным правым
концом)
\begin{equation}\label{15}
\lambda_2 (T) = 0.   \end{equation}

Соотношения (11) с~подставленным туда выражением для $u_{opt}$
и~(14) с~граничными условиями (13), (15) представляют собой
типичную краевую задачу для четырех переменных. Она может быть
решена численно методом <<пристрелки>>, а~именно итерационным
перебором неизвестных начальных значений для сопряженных
переменных, где на~каждом шаге осуществляются интегрирование
получившейся задачи Коши и~вычисление невязки значений на~правом
конце для заданных величин $x_1$ и~$\lambda_2$. В~результате сразу
имеем как явное выражение для закона управления, так
и~<<скорректированную>> динамику переменных состояния,
обеспечивающую точное соответствие измеренной величины $x_1$ ее
модельному значению в~момент измерения. Для проведения
соответствующих расчетов были построены модели как исходной
системы (10), так и~расширенной уравнениями для сопряженных
переменных динамической системы (11)--(15) в~среде имитационного
моделирования AnyLogic. При этом решение краевой задачи методом
<<пристрелки>> осуществлялось при помощи реализованной в~этой
среде специальной надстройки для параметрической идентификации
исследуемых моделей.\newpage

В качестве опорного набора параметров для исследования были
выбраны сле\-дую\-щие значения: $a_1 = 0.15;~ a_2 = 0.2;~ b_1 =
0.1;~ b_2 = 0.2;~ x_{10} = 2;~ x_{20} = 1;~ T = 50$. Ожидаемая
величина динамической переменной $x_1$ в~конце интеграла
моделирования для <<эталонной>> системы должна быть равной 0.585.
Измеренное значение, по которому осуществлялась коррекция модели,
полагалось равным $\tilde{x}_1 = 2$. Выборочные результаты решения
поставленной задачи ассимиляции данных методом минимизации
случайного возмущения приведены на~рис.~1, где представлены
динамика %
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{09/fig1}
\vskip 0mm \caption{Временной ход переменных состояния для <<эталонной>> }%\label{fig:image}
\centering \vspace{0mm} \small{и~<<скорректированной>> моделей
двухвидового взаимодействия ({\it A}) \\ \vskip .5mm и~динамика
минимального по~мощности корректирующего возмущения ({\it Б})}
\end{figure}%
переменных состояния для исходной (без учета миграции)
и~скорректированной (с~минимальной по~мощности миграцией) моделей,
а также временной ход сопряженной переменной $\lambda_2$
и~определяемый ею закон оптимального управления. Нетрудно
заметить, что в~рамках предложенного подхода действительно
оказывается возможным обеспечить достаточно существенное изменение
конечного значения измеряемой переменной малым по~норме
корректирующим управлением (имеющим в~данном случае смысл
неучитываемых процессов эмиграции и~иммиграции).







%\begin{figure}[h!]
%\center{\includegraphics[width=\linewidth]{1.pdf}}
%\caption{~~Временной ход переменных состояния для <<эталонной>>
%и~<<скорректированной>> моделей двухвидового взаимодействия ({\it
%A}) и~динамика минимального по~мощности корректирующего возмущения
%({\it Б})} \label{fig:image}
%\end{figure}



Следующим этапом исследования было сравнение различных методов
ассимиляции данных для рассматриваемой простейшей модели
двухвидового взаимодействия. В~частности, предложенный метод
минимизации корректирующего возмущения сравнивался
с~альтернативными известными подходами~--- адаптивной
идентификацией параметров и~коррекцией начального состояния.
В~первом случае равенство модельной и~фактической величин $x_1
(T)$ обеспечивается калибровкой того или иного по\-стоян\-но\-го
параметра исходной модели. Изучались все возможные случаи, т.~е.
параметризация производилась последовательно для каждого
из~параметров системы (10)~--- $a_1, a_2, b_1, b_2$. Во втором
случае <<попадание в~цель>> обусловливается выбором адекватных
начальных условий. Здесь, исходя из~семантики задачи, варьированию
подвергалась только величина $x_{20}$, поскольку именно
невозможность точного измерения численности популяции первичных
консументов служит в~рассматриваемом случае причиной неполной
наблюдаемости системы управления. Все вычисления также выполнены
в~соответствующих надстройках (экспериментах специального
характера) среды имитационного моделирования AnyLogic.

Результаты проведенного сравнения подходов в~терминах кривых роста
отдельно для условной биомассы растительности и~численности
растительноядных представлены на~рис.~2 %
(шкала по~вертикальной оси обрезана из~соображений выбора
адекватного масштаба для удобства восприятия). Нетрудно заметить,
что для\linebreak
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{09/fig2}
\vskip 1mm \caption{Кривые динамики переменных состояния $x_1$
({\it А})
и~$x_2$ ({\it Б}) }%\label{метка}
\centering \vspace{0mm} \small{для разных способов коррекции
модели}
\end{figure}%

\noindent рассматриваемого случая метод <<минимального
возмущения>> приводит к~наиболее <<щадящей>> коррекции модели.
Во-первых, соответствующие кривые динамики переменных состояния
оказываются наиболее близки к~<<эталонной>> модели, особенно
на~начальном периоде интегрирования. Во-вторых, отклонение
конечной величины ненаблюдаемой переменной $x_2 (T)$, которая
будет принята за~опорное начальное значение на~следующих этапах
расчета, также в~таком случае наименьшее среди всех вариантов.






%\begin{figure}[h!]
%\center{\includegraphics[width=\linewidth]{2.pdf}}
%\caption{~~Кривые динамики переменных состояния $x_1$ ({\it А})
%и~$x_2$ ({\it B}) для разных способов коррекции модели}
%\label{fig:image}
%\end{figure}

{ \bfseries  Заключение.} Предлагаемый метод ассимиляции данных
оперативных измерений в~экологическом моделировании, как
представляется, имеет ряд преимуществ по~сравнению с~имеющимися
алгоритмами. Это не~только наименее <<травматичный>> способ
коррекции эталонной модели~--- в~конце концов полученные при
исследовании примера 2 результаты могут оказаться нехарактерными
и~невоспроизводимыми для другого набора исходных параметров или
других динамических систем. Здесь, безусловно, открывается широкое
поле для дальнейших исследований. Но в~его пользу можно привести
и~соображения <<идеологического>> характера. В~частности, важными
позитивными особенностями рассматриваемого подхода являются
независимость и~полная изолированность расчетов для каждого нового
поступления данных опе\-ративных измерений. Действительно, для
каждого нового периода интегрирования между измерениями при
последовательном расчете модели заново решается задача минимизации
корректирующего возмущения в~пределах именно этого и~только этого
периода. Причем ни параметры модели, ни граничные значения
переменных со\-стоя\-ния во~временных точках получения измерений
не~меняются~--- общая траектория системы остается гладкой, в~то
время как, например, использование аналогичного подхода при
адаптивной идентификации либо приводит к~тому, что порождающая
модель имеет нестационарные, ступенчато меняющиеся от~времени
параметры, либо требует при поступлении новых данных полного
пересчета всей предыдущей траектории, в~том числе и~с~учетом всех
уже проведенных ранее измерений.

Конечно, предлагаемый метод гораздо более трудоемок, чем
формализованные и~стандартизованные подходы адаптивной
параметрической идентификации, фильтрации Калмана или решения
обратной задачи определения начального состояния. В~частности, он
содержит проблему синтеза оптимального управления минимальной
мощности, обеспечивающего максимальную степень соответствия
измерений модельным расчетам. Ясно, что для сложных, плохо
формализованных ими\-та\-цион\-ных моделей реальных природных
объектов о~нахождении аналитического решения здесь речь не~идет,
а~использование численных методов может потребовать значительных
вычислительных и~временных ресурсов. Однако мощности современных
компьютеров и~применение продвинутых средств автоматизации
компьютерного эксперимента с~динамическими имитационными моделями
[7] гарантируют практическую реа\-лизуемость подхода.  Огромное
значение приобретает выбор адекватной семантики и~формализации
корректирующих возмущений~--- иными словами, четкое выделение
автором модели ее потенциальных <<тонких и~чувствительных  мест>>,
в~которых формальное введение неучитываемого в~модели
произвольного внешнего фактора позволит максимально
<<ненарушающим>> способом осуществить оперативную корректировку
непосредственно в~процессе расчета. В~любом случае не~вызывает
сомнений, что проблема ассимиляции данных в экологическом
моделировании должна решаться не~дилетантски, а~на~серьезном
профессиональном уровне, т. е. с~привлечением современного
и~продвинутого математического аппарата.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\input{09/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{09/ref-s}

%%%%%N DOI в~ссылке!!!!!!!!!!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize





\vskip 3mm



\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %


\noindent Статья рекомендована к~печати проф. Л. А. Петросяном.

\vskip 1mm

\noindent Статья поступила в~редакцию 27 апреля 2017~г.

\vskip 1mm

\noindent Статья принята к~печати 8 июня 2017~г.

}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\vskip 5mm


%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak

%\vskip 3mm

%\textit{Буре Артем Владимирович}~--- аспирант; e-mail:
%bure.artem@gmail.com

%\vskip 2mm

%\emph{Bure Artem Vladimirovich}~--- post-graduate student; e-mail:
%bure.artem@gmail.com

%}
