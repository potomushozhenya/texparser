


\zagol{519.7}{Х.~Ван$^1$, П.~Ли$^1$, Ю.~Сюэ$^2$,
М.~В.~Коровкин$^2$}{ПОСТРОЕНИЕ МАРШРУТА С~ПОМОЩЬЮ \\ УЛУЧШЕННОГО
МЕТОДА ИЗОХРОН ПРИ МИНИМИЗАЦИИ
\\ ВРЕМЕНИ ПЛАВАНИЯ И С~УЧЕТОМ ПРОГНОЗА
ПОГОДЫ%$^{*}$
}{


\vspace{-3mm}\parindent=7mm


%{\copyright} А.~В.~Буре, 2014



\emph{Ван~Хунбо}  --- аспирант, доцент; wang\_hongbo@jlu.edu.cn

\emph{Ли~Пэнфэй}  --- магистр; pfli16@mails.jlu.edu.cn

\emph{Сюэ~Юаньюань}  --- аспирант; amocoi@163.com

\emph{Коровкин Максим Васильевич}  --- кандидат
физико-математических наук, доцент;\\ maxik@vrm.apmath.spbu.ru


\vskip 2.0mm


\emph{Wang~Hongbo}  --- postgraduate student, associate professor;
wang\_hongbo@jlu.edu.cn

\emph{Li~Pengfei} --- master; pfli16@mails.jlu.edu.cn

\emph{Xue~Yuanyuan}  --- postgraduate student; amocoi@163.com

\emph{Korovkin~Maxim~Vasilievich} --- PhD of physical and
mathematical sciences,  associate professor;
maxik@vrm.apmath.spbu.ru


\vskip 2.0mm


%$^{*}$ Работа выполнена при финансовой поддержке Российского фонда
%фундаментальных исследований (грант №~16-38-00789 мол\_а).

{\copyright} Санкт-Петербургский государственный университет,
\issueyear%

}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp07 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp07 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum06}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize



\noindent $^1$~Институт электронной науки и~техники, Цзилиньский
университет,

\noindent\hskip2.45mm  Китайская Народная Республика, 130012,
Цзилинь, Чанчунь, пр. Чаньцзинь, 2699

\noindent $^2$~Санкт-Петербургский государственный университет,
Российская Федерация,

\noindent\hskip2.45mm 199034, Санкт-Петербург, Университетская
наб., 7--9


\vskip1.8mm


\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}


\item Теория
оптимального управления является основой современной теории
управления. Ее развитие зависит от требований со стороны объекта
управления. С~развитием науки и технологий теория оптимального
управления стала широко применяться в~различных областях, например
в~задачах оптимального быстродействия, с~требованием минимальных
расходов ресурсов, в~задачах линейноквадратичного управления
и~т.~д. В~данной работе представлен вычислительный метод для
построения оптимального маршрута, обеспечивающего минимальное
время плавания с~использованием линий румба и~метода изохрон.
Первоначально строится математическая модель оптимального маршрута
и проводится дискретизация по времени для уравнений вычисления
местоположения судна. Затем маршрут разрезается по большому кругу
от начальной точки до конечной по определенным отрезкам времени,
в~результате чего создается набор линий румба. При этом каждая
изохронная линия соответствует своему отрезку румба. Далее по обе
стороны от~$N$~отрезков постоянного курса прокладываются
параллельные линии с~расстоянием $\varDelta D$, таким образом
создаются $2N$~субканалов. Для того чтобы оптимальное решение было
найдено как можно быстрее, рассмотрение движения судна
ограничивается в~пределах $2N \times \varDelta D$. Между тем
в~промежутках дискретного времени начальный курс судна остается
постоянным и~равным соответствующему направлению линии румба. При
выборе наилучших позиций судна в~каждом субканале определим одну
оптимальную изохрону. По достижении изохроной заданной окрестности
точки назначения $B$ судно направляется по линии румба
непосредственнно в~$B$. После расчета минимального времени
движения судна получим оптимальный маршрут рекурсивной
последовательностью. Кроме того, для расширения возможностей
обхода препятствий для улучшенного метода изохрон в~статье
предлагается алгоритм обхода препятствий на основе битовых карт,
который позволяет избегать опасных зон во время плавания. Наконец,
улучшенный метод изохрон применен для решения задачи построения
оптимального по времени маршрута при неблагоприятных погодных
условиях, таких как волнение и~ветер. По результатам моделирования
с~использованием среды MATLAB показано, что с~помощью этого
алгоритма можно построить не только оптимальный по времени, но
и~относительно короткий по расстоянию маршрут и одновременно
избежать опасных зон для обеспечения безопасности плавания.
Библиогр. 16 назв. Ил. 9.

{\it Ключевые слова}: улучшенный метод изохрон, метеорологическая
навигация, оптимизация маршрутов, алгоритм обхода препятствий.

\end{list}

}

\newpage
%\vskip4mm

\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}

\noindent{\it H. Wang$^1$, P. Li$^1$, Yu. Xue$^2$,
M.~V.~Korovkin$^2$}

\vskip2mm \noindent{\bf APPLICATION OF IMPROVED ISOCHRON METHOD\\
IN SHIP'S MINIMUM VOYAGE TIME WEATHER ROUTING}

\vskip2.5mm


{\footnotesize



\noindent $^1$ State Key Laboratory on Integrated Optoelectronics,


\noindent\hskip2.45mm College of Electronic Science and
Engineering, Jilin University,

\noindent\hskip2.45mm 2699, pr. Qianjindajie, Changchun, 130012,
Chinese Peoples Republic


\noindent $^2$ St.~Petersburg State University, 7--9,
Universitetskaya nab., St.~Petersburg,

\noindent\hskip2.45mm 199034, Russian Federation



\vskip2.5mm


\item Optimal control theory is the core of modern control
theory. The development of control theory comes from the
requirements of the control object. With the continuous progress
of social science and technology, optimal control theory is widely
used for such issues as the minimum time problem, the minimum
energy consumption problem, the linear quadratic index optimal
problem, and others. In this paper, a method of calculating the
minimum time route of the ship using rhumb lines combined with
isochrones is proposed. Firstly, a mathematical model of the
minimum time route is constructed and the ship motion equation is
discretized. Secondly, the distance between the starting point and
the end point is divided into several rhumb segments with equal
traveling time so that each isochrone corresponds to different
rhumb line. Then, $N$ parallel lines of equal spacing $\varDelta
D$ are arranged on both sides of each rhumb segment to form $2N$
sub-channels. Stipulate that the ship can only sail within the
interval of $2N \times \varDelta D$ and constrain the navigation
area in order to find the optimal solution faster. At each unit of
discrete time the course of the ship remains constant. Select the
optimal arrival points on each sub-lane interval in the same time
to form the local optimal isochrone. After calculating the minimum
time of the ship's voyage, the minimum time route is derived using
step-by-step recursion. In addition, in order to improve the
obstacle avoidance capability of the improved isochrone method,
the paper also proposes the algorithm based on a bitmap image in
order to avoid a danger zone which may be encountered in the
course of navigation, so as to ensure the safe navigation of the
ship at sea. Finally, the improved isochrone method is applied to
the problem of the minimum time route of the ship under
meteorological conditions. The simulation results in MATLAB show
that the algorithm can not only find the minimum time route from
the starting point to the end point and ensure the route is
relatively short, but also avoid dangerous areas encountered in
the course of navigation in time and assure safety of navigation.
Refs~16. Figs~9.

\textit{Keywords}: improved isochrone method,  meteorological
navigation, route optimization, algorithm of avoiding the danger
zone.


}

\end{list}


\vskip2mm

\textbf{1. Введение.} В~задачах построения маршрута безопасность
и~экономичность являются двумя важными факторами.
Метеорологическая информация об условиях плавания судна служит
основой для проложения оптимального маршрута при неблагоприятной
погоде. Маршрут будет оптимальным с~обеспечением безопасности
плавания, если будут выполнены определенные требования, такие как
минимальное время в~пути, минимальный расход топлива, минимальное
повреждение груза, повреждение самого судна или других судов
и~т.~д. В~настоящее время проложение кратчайшего по~времени
маршрута и~с~учетом данных прогноза погоды важно с~точки зрения
со\-кращения экономических затрат. Поэтому проведение исследований
по~оптимизации маршрута по~указанным критериям крайне актуально
в~метеорологической нави\-гации.

В последнее время представлены различные методы проложения
маршрутов трансокеанских судов, оптимальных по~критерию
минимального времени плавания. В~целом эти методы могут быть
разделены на~две категории: классические и~интеллектуальные.
Первые включают методы изохрон [1--3], вариационные [4--6]
и~методы динамического программирования [7, 8]; вторые~---
генетический алгоритм [9, 10],  муравьиный алгоритм [11]
и~графический метод в~трехмерном пространстве [12].

Метод изохрон, предложенный в~1957~г. [1], имеет целью построение
маршрута с~минимальным временем плавания с~учетом данных прогноза
погоды. Однако в~силу проблемы возникновения изохронных циклов,
связанной с~невыпуклостью профилей скорости судна в~зависимости
от~погодных условий, его применение не~допускает использования
современных вычислительных систем. Алгоритм построения маршрутов
на основе вариационного исчисления корректен в~плане математики,
но на~практике для его внедрения нужно решить еще много проблем.
Алгоритм динамического программирования имеет достаточную
эффективность и~гибкость для практического применения. Тем
не~менее известная проблема «проклятия размерности» не~допускает
рассматривать на~его основе практические задачи построения
маршрутов с~разумными вычислительными затратами при необходимости
постоянного пересчета решения с~поступлением уточненной информации
о погодных данных [13]. Новые интеллектуальные алгоритмы
построения маршрутов в~настоящее время находятся только в~стадии
разработки, и~возможности их внедрения еще предстоит проверить.

В сравнении с~вышеуказанными методами улучшенный метод изохрон,
описанный в~данной статье, допускает простую реализацию и~при этом
предъявляет небольшие требования к~вычислительным ресурсам. Хотя
метод изохрон и~является классическим, но~до~сих пор один
из~наиболее предпочтительных для выбора первоначального маршрута,
последующего его изменения и~автоматической навигации с~учетом
погодных условий.

В статье описан метод расчета оптимального по~критерию
минимального времени маршрута с~использованием изохронной линии
и~линий румба. Сначала проводится разделение (дискретизация)
маршрута по~дуге большого круга на~несколько участков с~постоянным
значением курсового угла (линия румба). Каждая изохронная линия
соответствует одному отрезку линии румба. Формально, в~непрерывном
случае изохроны представляют собой огибающие семейства линий,
определяемых конеч\-ными точками дуг постоянного направления,
имеющих начало на~изохроне, построен\-ной на~предыдущем этапе,
и~проходимых судном за~фиксированный промежуток времени. Для
обеспечения эффективной реализации осуществляется дискретизация
пространства. Строятся $ \textit{N} $ линий, параллельных отрезкам
постоянного направления маршрута большого круга с~шагом расстояния
$ \varDelta D $ по~обе стороны от~них. Таким образом, вдоль
исходного маршрута формируются $ 2N $ полос или субканалов. После
получения на~каждом отрезке дискретного времени оптимального
положения судна в~каждой полосе оно используется для порождения
дуг постоянного направления с~заданным шагом по~углу курса для
фиксированного промежутка времени, что позволяет сформировать
следующую изохронную линию. В~итоге определяются время плавания
и~оптимальный маршрут. Процесс реализации улучшенного метода
изохрон будет подробно приведен в~п.~2, в~том числе с~учетом
возможного прохождения генерируемого маршрута в~обход опасных зон.
Для этого приведены алгоритм обхода препятствий на~основе
растровых изображений, а~также результаты моделирования построения
оптимального по~времени маршрута с~учетом прогноза погоды.


\textbf{2. Применение усовершенствованного способа изохрон.}\\
\indent \textit{\textbf{2.1. Теоретические основы.}} Как показано
на рис.~1, для выбранных начальной и~конечной точек $A$ и~$ B $
разделим маршрут по~большому кругу между этими точками %
%
%
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig1}
\vskip 0mm \caption{Иллюстрация улучшенного метода изохрон
}\label{fig1}
\end{figure}
%
%
на~$ F $ отрезков. Начиная с~точки $A$, с~помощью метода изохрон
вычислим базовые точки, которые лежат на~первой изохронной линии.
Примем данные точки за~начальные для второго шага итерации.
В~отличие от~других методов улучшенный метод изохрон, приведенный
в~статье, для ограничения количества изохронных ли\-ний в~разумных
пределах фиксирует $N$ линий по~обе стороны от~отрезков
на~расстоя\-ниях с~шагом $ \varDelta\textit{D} $. Таким образом
получим $ 2N $ субканалов для ограничения области\linebreak
плавания. Объем вычислений и~точность связаны с~выбором значений $
\varDelta D $ и~$ N $. Каждая изохронная линия однозначно
соответствует основному отрезку. Далее проведем построение
маршрута методом изохрон на~каждом промежутке дискретного времени
$ {\varDelta}{t}_{i} $ и~вычислим для каждого участка маршрута
расстояние между локальной конечной точкой и~основным отрезком,
чтобы определить, какому субканалу принадлежит конечная точка.
Затем по~каждому субканалу расcчитаем расстояния между каждой
локальной конечной точкой и~конечной точкой по~большому кругу
и~выберем минимальное из~них значение, которое укажет оптимальную
точку в~каждом субканале. На~основе полученных результатов
аналогичным образом проведем следующий шаг, пока не~достигнем
окрестности конечной точки. Далее найдем минимальное время по
отрезкам и~просуммируем $ {\varDelta}{t}_{i} $ по~$ F $ отрезкам.
В~результате имеем минимальное время плавания и, опираясь
на~предыдущие шаги, восстановим оптимальный маршрут.


%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.6]{fig1.eps}
%        \caption{\small Иллюстрация улучшенного метода изохрон}
%        \label{fig1}
%    \end{center}
%\end{figure}

Для установления местоположения судна в~географической системе
координат проведем дискретизацию по~времени для уравнений
вычисления местоположения [14]:

\begin{equation}\label{keyLa}
\lambda_{f+1}(i,j) = \lambda_{f}(i)+\frac{\left(
\textit{V}_{(i,j)}\cdot\varDelta\textit{T}\cdot\sin(\theta_{(i,j)})\right)}
{Perj},
\end{equation}
\begin{equation}\label{keyPhi}
\varphi_{f+1}(i,j) = \varphi_{f}(i)+\frac{\left(
\textit{V}_{(i,j)}\cdot\varDelta\textit{T}\cdot\cos(\theta_{(i,j)})\right)}
{Perw}.
\end{equation}

%\begin{equation}
%\begin{aligned}
%&\dot {\bf {\nu}} = {\bf \tau} + {\bf d}(t), \\
%&\dot {\bf \eta} = {\bf R}(\bf \eta) {\bf \nu},
%\end{aligned}
%\end{equation}
\noindent В~(\ref{keyLa}) и~(\ref{keyPhi}) $ \lambda $, $ \varphi
$~--- долгота и~широта соответственно, с~помощью которых
опреде\-ляет\-ся положение движущегося судна; $ \lambda_{f}(i) $,
$ \varphi_{f}(i) $~--- долгота и~широта $ i $-й точки на $
\textit{f} $-й изо\-хронной линии, $ \textit{i}\in[1,2N] $, $
\textit{f}\in[1,F] $; $ \lambda_{f+1}(i,j) $, $ \varphi_{f+1}(i,j)
$~--- долгота и~широта\linebreak $j$-го ме\-сто\-по\-ло\-же\-ния
судна от~$i$-й точки на~$f$-й изохронной линии; $ \theta(i,j)
$~--- направление на~$j$-м участке маршрута от~$i$-й точки
на~$f$-й изохронной линии; $ V(i,j) $~--- скорость на~$j$-м
участке маршрута от $i$-й точки на~$f$-й изохронной линии,
зависящая от~внешних факторов, таких как ветер, волна и~т.~д.; $
\varDelta\textit{T} $~--- шаг дискретного времени;
%\newpage
\noindent $ Perw $~--- длина 1° меридиана (расстояние по~меридиану
между отстоящими друг от~друга на~1° параллелями). При
рассмотрении Земли как обычного шара длины всех меридианов равны
и~$ Perw \approx 111 $~км; $ Perj $~--- длина 1° параллели
(расстояние по~параллели между отстоящими друг от~друга на~1°
меридианами):
$$
\textit{Perj}=\textit{Perw}\cdot\cos\varphi.
$$

С использованием улучшенных правил выбора местоположения
изохронной линии на~участке области плавания из~множества
местоположений ($ \lambda_{f+1}(i,j), \varphi_{f+1}(i,j) $)
определим наилучшие точки в~каждом субканале и~получим $(f+1)$-ю
изохронную линию с~географическими координатами $ \lambda_{f+1}(i)
$ и~$ \varphi_{f+1}(i) $.

На проекции Меркатора для отрезков линий румба, являющихся прямыми
линиями, выполняется следующее уравнение:
$$
\lambda_{f+1}-\lambda_{f}=\tan\psi\cdot\left( \ln\left( \tan\left(
\frac{\pi}{4}+\frac{\varphi_{f+1}}{2}\right) \right) -\ln\left(
\tan\left( \frac{\pi}{4}+\frac{\varphi_{f}}{2}\right) \right)
\right),
$$
\noindent где $ \lambda_{f} $, $ \varphi_{f} $, $ \lambda_{f+1} $,
$ \varphi_{f+1} $~--- долгота и~широта начальной и~конечной точек
отрезка линии румба; $ \psi $~--- угол курса на~отрезке.

Таким образом, получим выражения для всех отрезков дискретизации
маршрута.

Под влиянием ветра и~волнения при неизменных оборотах гребного
винта и~мощности двигателя скорость судна уменьшается по~сравнению
с движением на~тихой воде и~при безветрии. Этот факт будем
называть естественным торможением, или естественной потерей
скорости. Для того чтобы установить фактическую скорость судна
во~время плавания, следует определить эту потерю. Можно
использовать следующую эмпирическую формулу [15]:
\begin{equation}\label{keyV}
V=V_{0}-(0.745h-0.257qh)(1.0-1.35\cdot10^{-6}DV_{0}),
\end{equation}
здесь $ V $~--- фактическая скорость судна (в узлах); $ V_{0}
$~--- скорость судна на~тихой воде (в узлах); $ h $~--- высота
волны (в м); $ q $~--- угол встречи с~волной (в град.); $ D $~---
водоизмещение (в т).

Формула (\ref{keyV}) применима для судов с~водоизмещением
5000--25\,000~т при скорости хода от~9 до~20~узлов и~высоте волны
не~более 5~м. Исследования показали, что в~случае, когда высота
волны не~превышает 5~м, погрешность определения скорости
составляет около $ \pm1 $~узла.

Кроме естественной потери скорости при сильном волнении и~ветре,
под воздействием волн могут возникать слемминг, заливание верхней
палубы и~оголение винта. Это может привести к~повреждениям
корпуса, винта и~снижению безопасности. Для того чтобы избежать
таких опасных явлений, следует ограничивать скорость судна. Будем
называть это искусственным торможением, или искусственной потерей
скорости. Определение допустимой максимальной скорости для
обеспечения безопасности плавания судов является важной задачей.
Существуют различные способы для расчета ограничения скорости,
например метод Льюиса, метод  Aэртсена, метод Хосоды [16] и~др.
Так, японский ученый Хосода провел экспериментальные исследования
для контейнеровоза. В~результате была получена формула для
вычисления ограничения скорости судна при волнении
\begin{equation}\label{keyVLim}
V_{\text{Limit}}=\exp\{0.13\cdot[\mu(q)-h]^{1.6}\}+r(q),
\end{equation}
в которой $ \mu(q)=12.0+1.4\cdot10^{-4}q^{2.3} $; $
r(q)=7.0+4.0\cdot10^{-4}q^{2.3} $; $ q $~--- угол встречи с~волной
(в град.); $ h $~--- высота волны (в~м).

В формуле (\ref{keyVLim}) хорошо видна связь между ограничением
скорости судна и~различными условиями воздействия волнения
на~судно. При построении маршрута с~минимальным временем
прохождения с~учетом волнового воздействия ограничим максимальную
скорость найденным по~(\ref{keyVLim}) значением на~участках
с~волнением.

\textit{\textbf{2.2. Описание алгоритма.}} Определение маршрута
с~минимальным временем прохождения с~использованием улучшенного
метода изохрон можно разделить на~следующие шаги.

$1.$ ~Пусть в~момент $t_{0}$ судно начинает двигаться от~начальной
точки \textit{A} в~соответствии с~углом курса

$$ \theta(i) =\theta_{0}(1)-(m+1-i)\cdot\varDelta C,~~~i\in[1,2m+1], $$

\noindent где $\theta_{0}(1)$~--- начальный курс по~дуге большого
круга для первой изохронной линии; $\varDelta C$~--- приращение
курса; $2m+1$~--- количество маршрутов.

Построим $2m+1$ лучей по~обе стороны маршрута под углом $\varDelta
C$.

Через промежуток времени $ \varDelta T $ соединим все точки
местоположения судна и~получим первую изохронную линию. С~помощью
уравнения движения судна можно определить географические
координаты каждой точки и~сохранить их во~множестве $ \left\lbrace
\lambda_{1}(i),\varphi_{1}(i)\right\rbrace $.

$ 2. $~Для каждой точки на~первой изохронной линии построим $ 2m+1
$ маршрутов с~начальным курсом
$$ \theta(i,j) =\theta_{0}(2)-(m+1-j)\cdot\varDelta C,~~i,j\in[1,2m+1],$$

\noindent где $ \theta_{0}(2) $~--- курс от~каждой точки на~первой
изохронной линии до~конечного пункта назначения по~большому кругу.
Через промежуток времени $ \varDelta T $ для каждого курса получим
пройденный путь $ L(i,j) $ и~географические координаты точек $
\left\lbrace \lambda(i,j),\varphi(i,j)\right\rbrace  $. Введем
переменную $ Dist $ для обозначения расстояния от~местоположения
судна до~основного маршрута (рис.~2); $ X_{1} $, $ X_{2} $~---
начальная и~конечная точки линии румба,\linebreak


\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig2}
\vskip 0mm \caption{Определение расстояния до~основного маршрута
}\label{fig2}
\end{figure}


\noindent $  X_{3} $~--- произвольная точка, в~которой  в~данный
момент находится судно. Используя формулы векторной алгебры,
определим значение $ Dist $:

$$
\cos\alpha =
\frac{\overrightarrow{X_{1}X_{3}}\cdot\overrightarrow{X_{1}X_{2}}}{\lvert\overrightarrow{X_{1}X_{3}}\rvert\cdot\lvert\overrightarrow{X_{1}X_{2}}\rvert},
$$
\begin{equation}\label{keyDist}
Dist = \lvert\overrightarrow{X_{1}X_{3}}\rvert\cdot\sin\alpha.
\end{equation}



%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=1]{fig2.eps}
%        \caption{\small Определение расстояния до~основного маршрута}
%        \label{fig2}
%    \end{center}
%\end{figure}


В соответствии с~формулой (\ref{keyDist}) установим $ Dist(i,j) $
для каждого местоположения судна по~лучам от~точек на~первой
изохронной линии и~уточним порядок  $ k $ в~$ 2N $ субканалах:
\begin{equation}\label{keyK}
k=N+1-\bigg\lceil \frac {Dist(i,j)}{\varDelta D}\bigg\rceil.
\end{equation}


Вычислим расстояния от~всех точек в~$ k $-м субканале до~точки
назначения, выберем из~них самую близкую и~создадим вторую
изохронную линию $ \left\lbrace
\lambda_{2}(k),\varphi_{2}(k)\right\rbrace ,~k\in[1,2N] $,
соблюдая условие $ \lvert Dist(i,j)\rvert\leq N\cdot\varDelta D, $
чтобы местоположение не~вышло из~зоны плавания:

$$
Num_{f}=(2m+1)\cdot(i-1)+j,
$$
здесь $ i $~--- порядок местоположения судна на~$(f-1) $-й
изохронной линии, $~ i\in[1,2m+1] ;$ $ Num_{f} $~--- номер $ j
$-го местоположения судна от~$ i $-й точки на~$(f-1) $-й
изохронной линии.

$ 3. $~Повторяя шаг 2, вычислим изохронные линии $ \left\lbrace
\lambda_{3}(k),\varphi_{3}(k)\right\rbrace  $, $ \left\lbrace
\lambda_{4}(k),\varphi_{4}(k)\right\rbrace  $, $ \dots $, $
\left\lbrace \lambda_{F}(k),\varphi_{F}(k)\right\rbrace  $, $
k\in[1,2N], $ во~времени $ t_{0}+3\varDelta T $,  $
t_{0}+4\varDelta T $,  $ \ldots $, $ t_{0}+F\varDelta T $.

$ 4. $~При достижении на~$ F $-м шаге точек на~изохроне, лежащих
в~заданной окрестности точки назначения $ B $, сформируем дугу
маршрута постоянного курса, соединяющую точку $ \left\lbrace
\lambda_{F}(K),\varphi_{F}(K)\right\rbrace  $ на~изохроне и~точку
$ B $. Найдем номер $ K_{F} $ и~точку  $ \left\lbrace
\lambda_{F}(K_{F}),\varphi_{F}(K_{F})\right\rbrace  $ на~$ F $-й
изохроне, обеспечивающую минимальное время прохождения последнего
отрезка пути. Таким образом раcсчитаем общее кратчайшее время
плавания:
$$
T_{\text{min}}= F\cdot\varDelta T+t_{\text{min}}(k).
$$


$ 5. $~В соответствии с~номерами $ Num_{f} $ сохраненных
местоположений на~каждой из~изохронных линий найдем номер $
K_{F-1} $ и~местоположение $\left\lbrace \lambda_{F-1} (K_{F-1})
\right.$, $\left.\varphi_{F-1} (K_{F-1})\right\rbrace $, которое
является местоположением, установленным на~предыдущем шаге  $
\left\lbrace \lambda_{F}(K_{F}), \varphi_{F}(K_{F})\right\rbrace
$. Вычисляя далее аналогичным образом, получим географические
координаты $ \left\lbrace
\lambda_{f}(K_{f}),\varphi_{f}(K_{f})\right\rbrace  $ на~$ f $-й
изохронной линии. В~результате сформируем маршрут с~кратчайшим
временем прохождения:

\noindent$ \left\lbrace B, \left\lbrace \lambda_{F}(K_{F}),
\varphi_{F}(K_{F})\right\rbrace , \ldots, \left\lbrace
\lambda_{f}(K_{f}), \varphi_{f}(K_{f})\right\rbrace , \ldots,
\left\lbrace \lambda_{1}(K_{1}),\varphi_{1}(K_{1})\right\rbrace ,
A\right\rbrace,~~ k\in[1,2N] $,


$$
K_{f}=\bigg\lceil \frac {Num_{f}}{2m+1}\bigg\rceil.
$$

\textit{\textbf{2.3. Алгоритм обхода препятствий на~основе
использования битовых карт.}} В~процессе построения необходимо
избегать пересечений маршрута с~опасными зонами. В~качестве
факторов, от~которых зависит их конфигурация, можно рассматривать
ветер, волнение и~другие воздействия с~параметрами, превышающими
значения, определенные для конкретных задач. В~данной работе
предложен способ обхода препятствий на~основе использования
битовых карт, удобный для применения совместно с~методом изохрон.

Информация об опасных областях вдоль маршрута плавания может быть
представлена в~виде битовой карты с~высоким разрешением,
наложенной на~всю рассматриваемую область плавания. Каждая ячейка
карты, лежащая в~опасной зоне, обозначается как «1», а~остальные
как «0». Это позволяет достаточно эффективно проверять
допустимость того или иного участка траектории, однако требует
предварительного построения растра для всей зоны плавания. Когда
судно перемещается к~следующей точке, нужно определить,
не~находится ли целевая точка в~опасной зоне. Если она попадает
в~опасную зону, то~требуется найти другую точку для замены. Выбор
точки для замены является ключевым вопросом.


\begin{wrapfigure}[20]{o}{40mm}
\centering \vspace*{-2mm}
\noindent\includegraphics[scale=0.75]{06/fig3} \vskip 1mm
\caption{Иллюстрация}\\ \label{fig3}
\vspace*{-.5mm}\centerline{\small обхода препятствий} \\
\vskip 0mm\centerline{\small на~основе использования}\\
\vskip 0mm\centerline{\small растровых изображений}\\
\end{wrapfigure}
Рассмотрим маршрут $ S-G $, как показано на~рис.~3. Точка $ S $
является предыдущей по~отношению к~точке $ G $, которая находится
в опасной зоне. Необходимо найти точку  $ G' $ на~отрезке  $ S-G
$, не~лежащую в~опасной зоне. Для того чтобы маршрут не~был сильно
изменен, выбранная точка должна быть недалеко от~точки $ G $.
Подробная схема алгоритма для выбора точки замены показана
на~рис.~4.

В алгоритме обхода препятствий дискретный интервал времени  $
\varDelta T $ делится на~$ P $ частей с~интервалом $ \varDelta T'
$. В~первом цикле продвигаемся в~течение времени  $ \varDelta T' $
по направлению $ S-G $, определяем координаты вновь достигнутой
точки, которую обозначим $ Q $. Далее выявляем, попадает ли эта
точка в~опасную зону. Если нет, то~продолжаем движение; если
да~--- то завершаем цикл, обозначив точку  $ G' $  за~$ Q $.

После нахождения точки $ G' $ во~втором цикле рассмотрим для нее
по обе стороны от~исходного курса  $ 2m $ дуг маршрута с~шагом $
\varDelta C $ по~курсу и~продолжим движение на~промежуток времени
$ (P-i)\cdot\varDelta T' $. Среди конечных точек полученных дуг
выберем ту, которая не~попадает ни в~одну из~запретных областей и
расстояние от~которой до~конечной точки маршрута будет
минимальным.  Обозначим ее как $ G'' $. Получим новый маршрут $
S-G'-G'' $ \linebreak

%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.8]{fig3.eps}
%        \caption{\small Иллюстрация обхода препятствий на~основе использования растровых изображений}
%        \label{fig3}
%    \end{center}
%\end{figure}



\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig4}
\vskip 0mm \caption{Схема алгоритма обхода препятствий
}\label{fig4}
\end{figure}


%\begin{figure}[h]
%    \begin{center}
%        \centering
%        \includegraphics[scale=0.8]{fig4.eps}
%        \caption{\small Схема алгоритма обхода препятствий}
%        \label{fig4}
%    \end{center}
%\end{figure}


\noindent для обхода препятствия вместо исходного  $ S-G $.
Следует отметить, что если все отрезки маршрута из~второго цикла,
порождаемые от~одной точки, попадают в~опасную зону (как точка
на~рис.~3), то~такой вариант маршрута исключается из~рассмотрения.

\textbf{3. Исходные данные для моделирования.} В~работе
использовались метеорологические данные, заданные на~координатной
сетке, представляющей собой граф со~множеством узлов $ N $
и~множеством ребер  $ M $. Пространственное разрешение
координатной сетки может быть  $ 0.25°\times0.25°, 0.5°\times0.5°,
1°\times1° $, $ 2°\times2° $ и~т.~д., при этом чем выше точность
пространственного разрешения, тем больше объем данных. Полученные
данные от~ресурса The European Centre for Medium-Range Weather
Forecasts (ECMWF) (см.~URL:
http://apps.ecmwf.int/datasets/data/interim-full-daily)
предоставляют информацию о~ветре, ветровом волнении и~зыби,
направлении бега волны, скорости и~направлении ветра.
В~соответствии с~заданной начальной точкой и~точкой назначения
область моделирования можно ограничить прямоугольником с~длиной
стороны $a$ и~шириной $b$. Нами для моделирования построения
маршрута с~минимальным временем прохождения был выбран следующий
район плавания:  от~$ 20 $ до~$ 60° $ северной широты, от~$ 80 $
до $ 0° $ западной долготы. Разрешение сеток составляло  $
1°\times1° $, соответственно получится 3321~узлов. Все узлы
пронумерованы, как показано на~рис.~5. Для каждого узла имеется
своя соответствующая информация о~погоде. Точки $ A $ и~$ B $
являются соответственно начальной и~конечной %\linebreak
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig5}
\vskip 2mm \caption{Нумерация узлов }\label{fig5}
\end{figure}
%\noindent
для построения маршрута. Широта и~долгота узлов сетки
по~соответствующему номеру определяются следующим образом:

$$
N=(\text{Length}+\lambda)\cdot \text{Width} +\varphi_{top}
-\varphi,
$$

$$
\lambda=\bigg\lfloor\frac
{N}{\text{Width}}\bigg\rfloor-\text{Length},
$$

$$
\varphi=\varphi_{top}-(N\%\text{Width}),
$$

\noindent где величины $ \text{Width}=41,~ \text{Length}=80,~
\varphi_{top}=61° $;   $ N $~--- номер узла сетки, $  \lambda $
и~$ \varphi $~--- географические координаты.


%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.5]{fig5.eps}
%        \caption{\small Нумерация узлов}
%        \label{fig5}
%    \end{center}
%\end{figure}

Во время плавания маршрут судна необязательно должен проходить
строго по~узлам сетки. В~таком случае данные о~погоде вычисляются
с помощью билинейного алгоритма интерполяции. Положим, что $
(\lambda+\omega,\varphi+\upsilon) $~--- положение судна
в~географических координатах точки, для которых $ \lambda $, $
\varphi $ являются целой частью значения координат с~плавающей
точкой; $ \omega, \upsilon $~--- дробная часть значения координат
с плавающей точкой в~интервале  $ [0,1) $. Тогда информацию
о~погоде для данной точки можно получить по~четырем узлам сетки $
\overrightarrow{\xi_{1}},  \overrightarrow{\xi_{2}},
\overrightarrow{\xi_{3}}, \overrightarrow{\xi_{4}} $ вокруг нее:

$$
\overrightarrow{\xi}=(1-\omega)(1-\upsilon)\overrightarrow{\xi_{1}}+(1-\omega)\upsilon\overrightarrow{\xi_{2}}+\omega(1-\upsilon)\overrightarrow{\xi_{3}}+\omega\upsilon\overrightarrow{\xi_{4}}.
$$

\textbf{4. Моделирование улучшенного метода изохрон
с~использованием погодных условий.} На~основе исследования
по~улучшенному методу изохрон была разработана программа для
проведения маршрута с~минимальным временем прохождения
и~осуществлено имитационное построение маршрута с~учетом погодных
условий. Для этого использована модель контейнеровоза, который
имеет следующие физические характеристики: водоизмещение~---
20~000~т, длина~--- 185.0~м, осадка с~полной загрузкой~--- 11.4~м,
скорость на~тихой воде~--- 15~узлов. Выявлены опасные зоны
с~высотой волны более 5.5~м или ветром со~скоростью более 16~м/с.

%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.5]{fig6.eps}
%        \caption{\small Опасные зоны на~пятом шаге построения маршрута}
%       \label{fig6}
%    \end{center}
%\end{figure}
%\begin{figure}[htbp]
%    \begin{center}
%       \includegraphics[scale=0.5]{fig7.eps}
%        \caption{\small Маршруты, полученные с~помощью модифицированного метода изохрон}
%       \label{fig7}
%   \end{center}
%\end{figure}


При моделировании оптимального маршрута с~учетом погодных условий
заданы географические координаты начальной $
[62°\text{W},44°\text{N}] $  и~конечной   $
[13°\text{W},28°\text{N}] $ точек маршрута. Расстояние между
начальной и~конечной точками по~большому кругу составляет 2523.40
морских миль. Проведено моделирование с~использованием метода
изохрон для построения маршрута по~критерию минимального времени
плавания. Предположим, что судно покидает начальную точку 7 марта
2016~г. Морские метеорологические данные обновляются с~интервалом
времени $ \varDelta T $. На~рис.~6 представлены\linebreak
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig6}
\vskip 0mm \caption{Опасные зоны на~пятом шаге построения маршрута
}\label{fig6}
\end{figure}
\noindent опасные зоны на~пятом шаге построения маршрута. Здесь
тeмным цветом~({\it 1}) обозначены области, в~которых скорость
ветра больше 16~м/с, серым цветом~({\it 2})~--- области, где
высота волны больше 5.5~м. В~некоторый момент времени маршрут
большого круга пройдет через опасную зону, в~свою очередь,
предлагаемый алгоритм позволяет своевременно избежать ее. Прибытие
в точку назначения выполнено 14 марта 2016~г. Все полученные
с~помощью модифицированного метода
изохрон маршруты показаны на~рис.~7. %
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig7}
\vskip 1mm \caption{Маршруты, полученные с~помощью
модифицированного метода изохрон }\label{fig7}
\end{figure}
Черная пунктирная линия представляет маршрут по большому кругу,
а~сплошная линия представляет собой выбранный из всех возможных
маршрут,\linebreak имеющий самое короткое время прохождения. Как
видно из~графика, маршрут, построенный с~помощью метода изохрон,
почти совпадает с~маршрутом по~большому кругу. Общая длина
маршрута составляет 2554.40~морских миль, что лишь на~31.00~милю
больше, чем по~большому кругу. Общее время плавания ~--- 165.87~ч,
средняя скорость~--- около 15.39~узлов.





В переменных погодных условиях сравнение скоростей и~высоты
волнения, встречающегося по~ходу движения судна, по~двум маршрутам
показано на~рис.~8 и~9 соответственно.
\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig8}
\vskip 2mm \caption{Иллюстрация сравнения скорости судна при
движении по~оптимальному }\label{fig8} \centering \vspace{0.5mm}
\small{маршруту $({\it 1})$, маршруту по~большому кругу $({\it
2})$ и~скорости на~тихой воде $({\it 3})$ }
\end{figure}



\begin{figure}[h!]
\centering
\includegraphics[scale=1]{06/fig9}
\vskip 2mm \caption{Иллюстрация сравнения высот волн,
соответствующих }\label{fig9} \centering \vspace{0.5mm}
\small{маршруту $({\it 1})$, маршруту по~большому кругу $({\it
2})$ \\ \vskip 1mm и~маршруту при ограничении по~условиям плавания
$({\it 3})$}
\end{figure}


%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.5]{fig8.eps}
%        \caption{\small Иллюстрация сравнения скорости судна при движении по~оптимиальному маршруту $(1)$, маршруту по~большому кругу $(2)$ и~скорости на~тихой воде$(3)$}
%        \label{fig8}
%    \end{center}
%\end{figure}
%
%\begin{figure}[htbp]
%    \begin{center}
%        \includegraphics[scale=0.5]{fig9.eps}
%        \caption{\small Иллюстрация сравнения высот волн, соответствующих оптимиальному маршруту $({\it 1})$, маршруту по~большому кругу $({\it 2})$ и~маршруту при ограничении по~условиям плавания $({\it 3})$}
%        \label{fig9}
%    \end{center}
%\end{figure}


Анализ результатов моделирования построения минимального
по~времени прохождения маршрута с~помощью улучшенного метода
изохрон позволяет сделать следующие выводы: при помощи алгоритма
с~использованием отрезков постоянного направления и~изохронной
линии для оптимизации маршрута по~минимальному времени можно
не~только провести маршрут с~кратчайшим временем прохождения,
но~и~оперативно изменить курс для исключения влияния плохих
погодных условий.


\textbf{5. Заключение.} Оптимальная маршрутизация судов с~учетом
погодных условий имеет большое практическое и~экономическое
значение для морского транспорта. Классический метод изохрон
требует, во-первых, больших вычислительных ресурсов и, во-вторых,
может приводить к~зацикливанию процедуры построения изохрон для
наилучшего маршрута. В~статье представлен улучшенный метод изохрон
и рассмотрено его применение к~решению проблемы маршрутизации
судна с~учетом погодных условий, а~также построены алгоритм
определения изохронных линий и~алгоритм обхода препятствий
(опасных зон). Для подтверждения эффективности метода проведено
моделирование. Показано, что применение улучшенного метода изохрон
с использованием учета динамически изменяющихся морских
метеорологических условий является эффективным инструментом для
построения относительно кратчайшего маршрута с~соблюдением
безопасности и~экономии времени.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{06/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{06/ref-s}

%%%%%N DOI в~ссылке!!!!!!!!!!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize




%\thispagestyle{empty}

\vskip 3mm

%\thispagestyle{empty}


\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %


\noindent Статья рекомендована к~печати проф. Е. И. Веремеем.

\vskip 1mm

\noindent Статья поступила в~редакцию 5 мая 2017~г.

\vskip 1mm

\noindent Статья принята к~печати 8 июня  2017~г.

}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\vskip 5mm


%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak

%\vskip 3mm

%\textit{Буре Артем Владимирович}~--- аспирант; e-mail:
%bure.artem@gmail.com

%\vskip 2mm

%\emph{Bure Artem Vladimirovich}~--- post-graduate student; e-mail:
%bure.artem@gmail.com

%}
