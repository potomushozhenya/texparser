


\zagol{519.7}{Х.~Ван$^1$, Е.\:И.~Веремей$^2$, Ю.~Сюэ$^2$}{МЕТОД
ГАРАНТИРУЮЩЕЙ ОПТИМИЗАЦИИ ДИНАМИКИ СУДНА, \\ ДВИЖУЩЕГОСЯ
В~УСЛОВИЯХ ВОЛНЕНИЯ}{



\vspace{-3mm}\parindent=7mm



%{\copyright} А.~В.~Буре, 2014

\emph{Ван~Хунбо} --- доцент; wang\_hongbo@jlu.edu.cn


\emph{Веремей Евгений Игоревич} --- доктор физико-математических
наук, профессор;\\ e\_veremey@mail.ru


\emph{Сюэ~Юаньюань} --- аспирант; amocoi@163.com





\vskip 1.5mm


\emph{Wang~Hongbo}  --- associate professor;
wang\_hongbo@jlu.edu.cn


\emph{Veremey~Evgeniy~Igorevich} --- doctor of physical and
mathematical sciences, professor;\\ e\_veremey@mail.ru


\emph{Xue~Yuanyuan}  --- postgraduate student; amocoi@163.com


\vskip 1.5mm



%$^{*}$ Работа выполнена при финансовой поддержке
%Санкт-Петербургского государственного университета (грант
%№~9.38.205.2014).

{\copyright} Санкт-Петербургский государственный университет,
\issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
%\fancyfoot[LO]{{\footnotesize\emph{\doivyp07 } }\hfill\thepage}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum02 } }\hfill\thepage}%
%\fancyfoot[RE]{\thepage\hfill{\footnotesize\emph{\doivyp07 } } }%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum02}}}%
%\fancyfoot[LO]{\hfill{\fontsize{10.5}{10.5}\selectfont \thepage}}%
%\fancyfoot[RE]{{\fontsize{10.5}{10.5}\selectfont \thepage}\hfill}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize


\noindent $^1$~Институт электронной науки и~техники, Цзилиньский
университет,

\noindent\hskip2.45mm Китайская Народная Республика, 130012,
Цзилинь, Чанчунь, пр. Чаньцзинь, 2699


\noindent $^2$~Санкт-Петербургский государственный университет,
Российская Федерация,

\noindent\hskip2.45mm 199034, Санкт-Петербург, Университетская
наб., 7--9





\vskip1.8mm


\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}


\item Интенсивное развитие мировой экономики и~соответствующей транспортной
инфраструктуры постоянно порождаeт массу проблем, которые,
в~первую очередь, связаны с~безопасностью движения транспортных
средств. В~частности, особую значимость имеют вопросы безопасности
движения судов в~условиях постоянно растущего морского трафика.
Глав\-ное внимание уделяется развитию методов и~разработке
расчетных алгоритмов синтеза многоцелевого управления в~морских
автопилотах, основное назначение которых состоит в~парировании
воздействий морского волнения для сохранения движения по~заданному
курсу. В~настоящее время используются различные подходы
к~проектированию автопилотов, опубликовано большое число научных
работ, однако исчерпывающим образом проб\-лема синтеза законов
управления для этих систем полностью не~решена. Прежде
всего\linebreak это связано с~их многоцелевым предназначением,
определяющим необходимость работы в~разных режимах движения
с~противоречивыми требованиями к~качеству динамических процессов.
В~данной статье предлагается использовать обратные связи
с~многоцелевой структурой при синтезе законов управления для
автопилотов и~вводится в~рассмотрение\linebreak формирующий фильтр
для возмущения, номинально представляемого гауссовским
ста\-цио\-нарным «белым шумом». В~итоге дается расчетный алгоритм,
базирующийся на~идео\-логии $H_\infty$-оптимизации, позволяющей
обеспечить гарантированное качество фильтрации для работы
автопилота при движении в~условиях морского волнения.
Использование таких алгоритмов проиллюстрировано на~примере,
результат которого по~построению оптимального регулятора является
гарантирующим, т.~е. при любом изменении частоты фактического
волнения и~при той же интенсивности работы рулей амплитуда
отклонений от~заданного курса будет не~больше указанной величины.
Практическая ценность работы состоит в~том, что полученные методы
исходно ориентированы на~решение содержательных задач с~учетом
возможностей непосредственного применения синтезируемых законов
управления на~борту судна в~ходе плавания. Особую роль играют
малые вычислительные затраты при реализации предлагаемых методов,
что поз\-во\-ляет повысить эффективность решения практических
задач в~рамках концепции многоцелевого синтеза законов управления
движением. Предложенный подход можно расширить, применяя его для
управления беспилотными и~другими морскими подвижными объектами.
Библиогр.~11 назв. Ил.~1.

{\it Ключевые слова}: метод гарантирующей оптимизации,
$H_\infty$-оптимизация, многоцелевая структура.

\end{list}

}

\vskip2mm

\begin{list}{}{\leftmargin=7mm \rightmargin=7mm \listparindent=5mm}

\noindent{\it Н.~Wang$^1$, E.\:I.~Veremey$^2$, Y.~Xue$^2$}

\vskip1.8mm \noindent{\bf A METHOD OF THE GUARANTEEING
OPTIMIZATION\\
FOR THE DYNAMICS OF SHIP MOVING IN WAVE}

\vskip1.8mm


{\footnotesize



\noindent $^1$ State Key Laboratory on Integrated Optoelectronics,

\noindent\hskip2.45mm College of Electronic Science and
Engineering, Jilin University, 2699,

\noindent\hskip2.45mm pr. Qianjindajie, Changchun, 130012, Chinese
Peoples Republic


\noindent $^2$ St.~Petersburg State University, 7--9,
Universitetskaya nab., St.~Petersburg,

\noindent\hskip2.45mm 199034, Russian Federation





\vskip3.0mm


\item With the further development of the world economy, the
corresponding transportation infrastructure has also brought about
many problems, which, foremost, are associated with the traffic
safety of vehicles. In particular, the issue of ship traffic
safety has become even more important as maritime traffic
continues to grow. The main attention in this article is given to
the development of methods and the design of computational
algorithms for the synthesis of multipurpose control in marine
autopilots, the main purpose of which is to counteract the effects
of sea waves in order to preserve the movement at a given course.
Currently, various approaches are used for the design of
autopilots, a large number of scientific papers have been
published, but the problem of the synthesis of control laws for
these systems has not been exhaustively resolved. First of all,
this is due to their multipurpose mission, which determines the
need for work in various driving regimes with conflicting
requirements for the quality of dynamic processes. In this paper,
we propose a new practically oriented method for the synthesis of
control laws for autopilots, which is based on feedbacks with a
multipurpose structure. However, these works of optimization
approach had assumed that the initial data includes a known
frequency spectrum of sea waves, the knowledge about which comes
in the course of identification, realized in the system of
adaptive autopilot reconfiguration. Naturally, such a
consideration of the actual conditions of navigation significantly
improves the quality of management processes. But adaptive
reconfiguration, for lots of reasons, cannot always be applied in
practice. For example, it may not allow enough time for the
system's operating conditions. To this end we have developed a
simple constructive method for calculating the transfer function
for a dynamic filter as part of the heading control law
implemented by a marine autopilot. This method is based on the
ideology $H_\infty$-optimization, which makes it possible to
ensure a guaranteed quality of filtration when moving in sea
waves. Unlike other widely used approaches, the indicated purpose
will be achieved by using the specialized multipurpose structure
of the control law. The approach has lot of advantages in
comparison with alternative options, namely flexibility
configuration in real conditions of navigation. The proposed
approach can be expanded by applying it to control marine unmanned
objects or floating offshore structures. Refs~11. Fig.~1.

\textit{Keywords}: method of guarantee optimization,
$H_\infty$-optimization, multi-purpose structure.


}

\end{list}


\vskip4mm

\textbf{Введение.} Бурное развитие мировой экономики
и~сопровождающей ее рост транспортной инфраструктуры постоянно
порождаeт множество проблем, связанных с~безопасностью движения
транспортных средств. Особую значимость имеют вопросы безопасности
движения судов в~условиях постоянно растущего морского трафика,
поскольку последствия аварий и~катастроф на~море обычно приводят
к~очень тяжелым последствиям. Одним из~наиболее широко
распространенных подходов к~обеспечению безопасности является
автоматизация судовождения, включая применение современных морских
автопилотов.

В настоящее время используются различные подходы к~проектированию
автопилотов (например, [1--3]), опубликовано большое число научных
исследований, однако исчерпывающим образом проблема синтеза
законов управления для таких систем полностью не~решена. В~первую
очередь это связано с~ их многоцелевым предназначением,
определяющим необходимость работы в~разных режимах движения
с~противоречивыми требованиями к~качеству динамических процессов.

В настоящей статье предлагается новый практически ориентированный
метод синтеза законов управления для автопилотов, который
базируется на~обратных связях с~многоцелевой структурой. В~его
основе лежит оптимизационный подход, обоснованный в~работах [4,
5]. Но в~них предполагается, что в~состав исходных данных входит
известный частотный спектр морского волнения, информация о~котором
поступает в~ходе идентификации, реализуемой в~системе адаптивной
перенастройки автопилота. Естественно, что такой учет реальных
условий плавания существенно улучшает качество процессов
управления. Однако, к~сожалению, адаптивная перенастройка, в~силу
ряда причин, далеко не~всегда может быть применена на~практике:
например, на~нее просто может не~хватить времени по~условиям
функционирования системы.

Альтернативный подход состоит в~формировании \emph{гарантирующего
управления}, которое обеспечивает определенные гарантии
по~качеству динамики независимо от~конкретного спектра волнения,
принадлежащего некоторому допустимому множеству. Этот подход
является пессимистическим и~дает худшее качество, чем при
адаптации, хотя обеспечивает высокую надежность и~не~требует
времени на~перенастройку при изменении условий плавания.

\textbf{Постановка задачи.} Математическая формализация
гарантирующего подхода для линейных систем естественно связана
с~их оптимизацией по~норме пространства $H_\infty$, аналитические
и численные методы которой интенсивно развиваются в~последние
десятилетия. Одним из~эффективных инструментов этого направления
служат спе\-циа\-ли\-зи\-ро\-ван\-ные приемы спектрального синтеза
линейных обратных связей, предложенных в~[6, 7].

Осуществим постановку задачи синтеза $H_\infty$-оптимального
автопилота для морского судна с~линейной математической моделью
\begin{equation}\label{eq1}
\begin{aligned}
&\mathbf{\dot{x}}=\mathbf{Ax}+\mathbf{b}\delta+\mathbf{h}d(t),\\
&y=\mathbf{cx}=\varphi.
\end{aligned}
\end{equation}

Пока пренебрегая инерционностью привода, будем формировать закон
управления, реализуемый автопилотом, в~виде
\begin{equation}\label{eq2}
    \delta=W_\delta(p)y,
\end{equation}
\noindent где $W_\delta=W_{\delta1}/W_{\delta2},~ W_{\delta1},
W_{\delta2}$ --- полиномы; $p=d/dt$.

Если функция $W_\delta$ известна, легко найти передаточные функции
\begin{equation}\label{eq3}
    P_y(s)=H(s)/\Delta_\delta(s),~~P_u(s)=H(s)W_\delta(s)/\Delta_\delta(s)
\end{equation}
\noindent замкнутой системы (1), (\ref{eq2}) по~курсу и~управлению
соответственно, в~(\ref{eq3}) полагаем, что
$\Delta_\delta(s)\equiv A(s)-B(s)W_\delta(s)$,
$A(s)=\det(\mathbf{E}s-\mathbf{A})$,
$B(s)=A(s)\mathbf{c}(\mathbf{E}s-\mathbf{A})^{-1}\mathbf{b}$,
$H(s)=A(s)\mathbf{c}(\mathbf{E}s-\mathbf{A})^{-1}\mathbf{h}$.

Будем считать, что возмущение $d(t)$, определяемое нерегулярным
волнением моря, является случайным стационарным процессом с~четной
дробно-рациональной спектральной плотностью мощности
\begin{equation}\label{eq4}
    S_d(\omega)=S_1(s)S_1(-s)|_{s=j\omega},~~S_1(s)=N(s)/T(s),
\end{equation}
\noindent полиномы $N$ и~$T$ являются гурвицевыми, $\deg N<\deg
T=n_f$.

Для формализации понятия качества процессов в~замкнутой системе
при действии указанного возмущения введем в~рассмотрение
функционал
\begin{equation}\label{eq5}
    J(W_\delta)=\|P_0(s,W_\delta)S_1(s)\|_\infty^2=\max\limits_{\omega\in[0,\infty)}|P_0(j\omega,W_\delta)S_1(j\omega)|^2
\end{equation}
\noindent c обобщенной передаточной функцией $F_0$, где
\begin{equation}\label{eq6}
    |P_0(j\omega)|^2=|P_y(j\omega)|^2+k^2|P_u(j\omega)|^2,~~k= \text{const.}
\end{equation}

Существо вопроса об $H_\infty$-оптимизации [6,~7] закона
управления состоит в~постановке и~решении минимаксной задачи [8]
\begin{equation}\label{eq7}
J(W_\delta)=\|P_0
S_1\|_\infty^2=\max\limits_{\omega\in[0,\infty)}|P_0(j\omega,W_\delta)S_1(j\omega)|^2\rightarrow
\min\limits_{W_\delta\in \Omega_\infty}
\end{equation}
\noindent на~допустимом множестве
$\Omega_\infty=\{W_\delta:P_0(s,W_\delta)\in RH_\infty\}$
передаточных функций регулятора (\ref{eq2}). Здесь $RH_\infty$~---
совокупность правильных дробно-рациональных функций с~гурвицевыми
знаменателями.

Для численного решения задачи (\ref{eq7}) в~принципе можно
привлечь широко известные «2-Риккатти»-подход [9] или технику LMI
[10]. Но, к~сожалению, это нельзя сделать непосредственно,
поскольку данная задача обладает рядом специфических особенностей,
существенно затрудняющих ее решение [11]. В~качестве альтернативы
будем применять спектральный подход, подробно рассмотренный
в~работе [11], использующий технику решения аппроксимационной
задачи Неванлинны---Пика [9].

Однако методика, предложенная в~[11], может быть существенно
упрощена для так называемых вырожденных ситуаций, что позволяет
использовать обратные связи с~МС-структурой [8].

Для применения этого подхода расширим вектор состояния в~(1),
вводя фор\-ми\-рую\-щий фильтр для возмущения. Соответственно
получим уравнения
\begin{equation}\label{eq8}
\begin{aligned}
\dot{\mathbf{x}}_e&=\mathbf{A}_e\mathbf{x}_e+\mathbf{b}_e\delta+\mathbf{h}_{e}d_e(t),\\
y&=\mathbf{c}_e\mathbf{x}_e=\varphi
\end{aligned}
\end{equation}
\noindent расширенного объекта управления, где использованы
обозначения
\begin{align*}
A_e=\left(
\begin{array}{c:c}
\mathbf{A}              &\mathbf{hc}_f\\ \hdashline
\mathbf{0}_{n_f\times 3}    &\mathbf{A}_f
\end{array}\right) ,~
~\mathbf{b}_e=\left(\begin{array}{c} \mathbf{b}\\ \hdashline
\mathbf{0}_{n_f \times 1}
\end{array}\right),~
~\mathbf{c}_e=\left(\begin{array}{c:c} \mathbf{c}
&\mathbf{0}_{1\times n_f}
\end{array}\right),~
~\mathbf{h}_e=\left(\begin{array}{c} \mathbf{0}_{3 \times 1}\\
\hdashline \mathbf{b}_f
\end{array}\right),
\end{align*}
\noindent причем
$\mathbf{c}_f(\mathbf{E}_{n_f}s-\mathbf{A}_f)^{-1}\mathbf{b}_f\equiv
S_1(s)$. Здесь  $d_e(t)$ --- возмущение, номинально представляемое
гауссовским стационарным «белым шумом».

Легко проверить [11], что задача (\ref{eq7}) эквивалентна задаче
\begin{equation}\label{eq9}
    I(\Phi)=\|P\|_\infty^2=\max\limits_{\omega\in[0,\infty)}|P(j\omega,\Phi)|^2\rightarrow \min\limits_{\Phi\in \Omega},
\end{equation}
\noindent в~которой $\Phi=(\alpha+\beta W_\delta)/(A_e-\beta_e
W_\delta)$ --- вспомогательная функция-параметр,  $\alpha$
и~$\beta$ являются любыми полиномами в~рамках гурвицевости
полинома $Q=A_e\beta+B_e\alpha$, допустимым множеством служит
совокупность
$\Omega=\{\Phi:W_\delta=(A_e\Phi-\alpha)/(B_e\Phi+\beta)\in
\Omega_\infty\}$.

При этом переменные $A_e=\det(\mathbf{E}_e s-\mathbf{A}_e)$,
$B_e=A_e\mathbf{c}_e(\mathbf{E}_e
s-\mathbf{A}_e)^{-1}\mathbf{b}_e,~H_e=$
$A_e\mathbf{c}_e(\mathbf{E}_e s -\mathbf{A}_e)^{-1}\mathbf{h}_e$,
$|P|^2=|P_{ye}|^2+k^2|P_{ue}|^2$, $P_{ye}=H_e/(A_e-B_e W_\delta)$,
$P_{ue}=H_e W_\delta/(A_e-$ $B_e W_\delta)$ представляют
расширенный объект управления в~замкнутой системе (\ref{eq2}),
(\ref{eq8}).

\textbf{Спектральный подход к~поиску решения.} В~работе [11]
показана справедливость следующих соотношений:
\begin{equation}\label{eq10}
\begin{aligned}
&I(\Phi)\leq\gamma^2,~~\gamma^2=J_a+\varepsilon,~~\varepsilon\geq
0,~~\omega_0=\arg\max\limits_
{\omega\in[0,\infty)}k^2/|G(j\omega)|^2,\\
&J_a=\max\limits_{\omega\in
[0,\infty)}k^2/|G(j\omega)|^2=k^2/|G(j\omega_0)|^2,
\end{aligned}
\end{equation}
\noindent где гурвицев полином $G(s)$ есть результат факторизации
\begin{equation}\label{eq11}
k^2A_e(s)A_e(-s)+B_e(s)B_e(-s)\equiv G(s)G(-s).
\end{equation}

В соответствии с~определением, введенным в~[11], считают, что
в~задаче (\ref{eq9}) имеет место вырожденная ситуация, если
существует такая функция-параметр $\Phi\in\Omega$, что
в~соотношениях (\ref{eq10}) выполняется равенство  $I(\Phi)=J_a$;
если же для любого  $\Phi\in\Omega$ имеет место неравенство
$I(\Phi)>J_a$, то~характер ситуации регулярный.

В статье [11] доказано, что необходимым и~достаточным условием
вырожденности служит соотношение
\begin{equation}\label{eq12}
q_m\ge0,
\end{equation}
\noindent в~котором $q_m$ --- минимальное собственное значение
матрицы Пика $\Pi=\{l_{ij}\}$,
\begin{equation}\label{eq13}
\begin{aligned}
&l_{ij}=(1-d_i \overline{d}_j)/(g_i+\overline{g}_j),~~i,j=\overline{1,n_e},~~n_e=n+n_f,\\
&d_i=-B_e(-g_i)/[A_e(g_i)R(g_i)].
\end{aligned}
\end{equation}
\noindent Здесь $g_i$ –- корни полинома $G(-s)$ (предполагается,
что все они простые), а~полином $R$ является гурвицевым
результатом факторизации
\begin{equation}\label{eq14}
    R(s)R(-s)\equiv J_a G(s)G(-s)-k^2 H_e(s)H_e(-s).
\end{equation}
Более того, если $q_m>0$, то~задача (\ref{eq9}) имеет
неединственное решение.

Соответственно в~вырожденной ситуации не~единственное решение
и~у~исходной задачи (\ref{eq7}), причем любое из~них $W_\delta \in
\Omega_\infty$ удовлетворяет следующим соотношениям:
\begin{subequations}
\begin{equation}\label{eq15a}
W_\delta(j\omega_0)=\mu_e,~~\mu_e=-B_e(-j\omega_0)/(k^2
A_e(-j\omega_0)),
\end{equation}
\begin{equation*}
\max\limits_{\omega\in [0,\infty)}|P_0(j\omega,W_\delta)|^2=J_a.
\tag{15б}
\end{equation*}
\end{subequations}

Отметим, что неединственность решения в~вырожденной ситуации дает
определенный выигрыш в~смысле возможности выбора желаемых
структурных и~динамических свойств оптимального регулятора.
В~частности, здесь может быть применена обратная связь
с~МС-структурой
\begin{equation}\label{eq16}
\begin{aligned}
&\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{b}\delta+\mathbf{g}(y-\mathbf{cz}),~\dot{\delta}=u,\\
&\xi=F(s)(y-\mathbf{cz}),~u=\mathbf{\mu\dot{z}}+vy+\xi,
\end{aligned}
\end{equation}
где $\mathbf{z}\in E^n$ --- вектор состояния наблюдателя; $\xi \in
E^1$ --- выходная переменная корректора; постоянные векторы
$\mathbf{g},\mu$, число $v$, а~также передаточная функция $F(s)$
корректора подлежат поиску в~процессе синтеза, исходя
из~требований по~динамике судна в~соответствующих режимах.

Как и~ранее, будем считать, что матрицы $\mathbf{g},\mu,v$
изначально заданы,  а~выбор передаточной функции $F(s)$
динамического корректора можно направить на~минимизацию
функционала (\ref{eq5}). При этом любая дробно-рациональная
функция $F(s)$, которая имеет гурвицев знаменатель и~обеспечивает
выполнение условий (\ref{eq15a}), (15б) для функции

\begin{equation}\label{eq17}
W_\delta=W_\delta(s,F)=W_\delta^1(s,F)/W_\delta^2(s,F),
\end{equation}
\begin{align*}
W_\delta^1(s,F)=\left|
\begin{array}{c:c}
\mathbf{E}s-\mathbf{A}+\mathbf{gc}                  &-\mathbf{b}\\
\hdashline \mu (\mathbf{A}-\mathbf{gc})-F(s)\mathbf{c} &-(s-\mu
\mathbf{b})
\end{array}\right|,
\end{align*}\newpage
\begin{align*}
W_\delta^2(s,F)=\left|
\begin{array}{c:c}
\mathbf{E}s-\mathbf{A}+\mathbf{gc}          &\mathbf{g}\\
\hdashline \mu (\mathbf{A}-\mathbf{gc})-F(s)\mathbf{c} &\mu
\mathbf{g}+v+F(s)
\end{array}\right|,
\end{align*}
делает регулятор (\ref{eq16}) решением задачи (\ref{eq7}).
Заметим, что в~дополнение к~условиям оптимальности (\ref{eq15a}),
(15б) можно ввести также равенство $F(0)=0$, обеспечивающее
астатизм.

В работах [7, 8] указана простейшая структура передаточной функции
$F=F(s,\mathbf{h})$, позволяющей одновременно обеспечить
выполнение требований устойчивости, астатизма и~оптимальности:
\begin{equation}\label{eq18}
    F(s,\mathbf{h})=M_1(s)/\Phi(s,\mathbf{h}),~~M_1(s)=q_1 s^2+q_0 s,~~\Phi(s,\mathbf{h})=s^2+h_1 s+h_2,
\end{equation}
\noindent где $\mathbf{h}=(h_1,h_2)\in E^2$. Действительно,
условие устойчивости имеет вид $h_1>0$, $h_2>0$, условие астатизма
при любом $\mathbf{h}$ очевидно.

Условия оптимальности (\ref{eq15a}), (15б) обеспечиваются
следующим образом. Прежде всего необходимо, чтобы были справедливы
равенства
\begin{equation}\label{eq19}
    F(j\omega_0,\mathbf{h})=\overline{m}=\overline{a}+j\overline{b},
\end{equation}
в которых $\overline{m}=\overline{a}+j\overline{b}$ ---
комплексное число, определяемое по~конечным формулам, приведенным
в~[7, 8].

Теперь зададим любой вектор $\mathbf{h}\in E^2$ в~области $h_1>0$,
$h_2>0$. Согласно (\ref{eq18}),\linebreak можем определить
комплексное значение $m$ полинома $M_1$ в~комплексной
точке\linebreak $s=j\omega_0$:
\begin{equation}\label{eq20}
M_1(j\omega_0)=\overline{m}\Phi(j\omega_0,\mathbf{h})/j\omega_0=m=a+jb,
\end{equation}
т.\:е. будем считать, что получены вещественные числа $a$ и~$b$.
Тогда из~условия $M_1(j\omega_0)=a+jb$ находим коэффициенты
полинома $M_1$
\begin{equation}\label{eq21}
    q_1=-a/\omega_0^2,~~q_0=b/\omega_0,
\end{equation}
выполняя тем самым условие (\ref{eq15a}).

И, наконец, для выполнения условия (15б) необходимо при учете
(\ref{eq21}) так выбрать вектор $\mathbf{h}\in E^2$ в~области
$h_1>0$, $h_2>0$, чтобы достигала своего \emph{нулевого
глобального минимума} вспомогательная функция
\begin{equation}\label{eq22}
I_e(\mathbf{h})=|\max\limits_{\omega\in
[0,\infty)}|P_0(j\omega,W_\delta(s,F(s,\mathbf{h})))|^2-J_a|.
\end{equation}

Естественно, что минимизация этой функции двух переменных может
быть осуществлена с~помощью любого численного метода, однако для
практической реализации целесообразнее применить поиск минимума
на~конечной сетке $\Omega_h^N\subset\{\mathbf{h}\in E^2:h_1>0,$
$h_2>0\}$.

Для построения такой сетки зададим, исходя из~соображений
неформального характера, максимальные значения $h_{1\max}>0$
и~$h_{2\max}>0$ коэффициентов полинома $\Phi(s,\mathbf{h})$,
а~также отрезки $[\varepsilon_1,h_{1\max}>0]$
и~$[\varepsilon_2,h_{2\max}>0]$, где $\varepsilon_1>0$
и~$\varepsilon_2>0$ --- малые числа. Каждый из~указанных отрезков
разделим на~$N$ одинаковых частей точками
$h_{1i},h_{2j},i,j=\overline{1,N}$. Тогда конечная сетка
представляется совокупностью пар
$\Omega_h^N=\{h_{1i},h_{2j}\},~i,j=\overline{1,N}$, а~минимизация
функции $I_e(\mathbf{h})$ сводится к~конечному перебору указанных
пар:
\begin{equation*}
I_e(\mathbf{h})\rightarrow\min\limits_{\mathbf{h}\in
\Omega_h^N}\Leftrightarrow
I_e(\{h_{1i},h_{2j}\})\rightarrow\min\limits_{i,j=\overline{1,N}}.
\end{equation*}\newpage

\textbf{Расчетный алгоритм синтеза.} Итогом рассмотрения данной
задачи является следующий расчетный алгоритм гарантирующей
оптимизации динамического фильт\-ра для работы автопилота при
движении в~условиях волнения.

1. По~исходным данным построить математическую модель (\ref{eq8})
расширенного объек\-та управления.

2. Выполнить вычисления по~формулам (\ref{eq10}), (\ref{eq11}).
В~результате сформировать полиномы $G(s)$ и~$G(-s)$, определить
корни $g_i,~i=\overline{1,n_e}$, найти частоту $\omega_0$
и~величину  $J_a$ пика частотной характеристики.

3.  Проверить выполнение условия вырожденности (\ref{eq12})
с~учетом (\ref{eq13}) и~(\ref{eq14}). Если это условие
не~выполнено, то~завершить действия в~рамках данного алгоритма
и~воспользоваться методом, предложенным в~работе [11].

4. По~конечным формулам, приведенным в~работах [7, 8], для
заданных элемен\-тов $\mathbf{g},\mu,v$ многоцелевой структуры
найти комплексное число $\overline{m}=F(j\omega_0)$
в~соотноше\-нии~(\ref{eq19}).

5. Задать максимальные значения $h_{1\max}>0$ и~$h_{2\max}>0$,
а~также малые числа $\varepsilon_1>0$, $\varepsilon_2>0$  и,
разбивая  отрезки $[\varepsilon_1,h_{1\max}]$
и~$[\varepsilon_2,h_{2\max}]$ на~$N$ равных частей, сформировать
конечную сетку $\Omega_n^N=\{h_{1i},h_{2j}\},~i,j=\overline{1,N}$.

6. Выбрать пару $\mathbf{h}=\{h_{1i},h_{2j}\}\in\Omega_h^N$ при
заданных величинах $i,j=\overline{1,N}$ и~ по\-строить полином
$\Phi(s,\mathbf{h})=s^2+h_{1i}s+h_{2j}$.

7. По~формуле (\ref{eq20}) рассчитать вещественные числа $a$
и~$b$, а~по~(\ref{eq21}) --- коэффициенты полинома
$M_1(s)=q_1s^2+q_0s$, получая передаточную функцию корректора
$F(s,\mathbf{h})=M_1(s)/\Phi(s,\mathbf{h})$.

8. По~формуле (\ref{eq17}) определить передаточную функцию
$W_\delta(s,F(s,\mathbf{h}))$ обратной связи (\ref{eq16}),
сформировать обобщенную передаточную функцию
$P_0(s,W_\delta(s,F(s,\mathbf{h})))$, а~также рассчитать значение
вспомогательной функции $I_e(\mathbf{h})$ по~выражению
(\ref{eq22}).

9. Повторить вычисления по~пп. 6--8 для всех значений
$i,j=\overline{1,N}$ и~найти такую точку
$\mathbf{h}_0\in\Omega_n^N$, для которой достигается нулевой
глобальный минимум функции $I_e(\mathbf{h})$. Если такой точки
на~конечной сетке $\Omega_h^N$ нет, то~вернуться к~п. 5
и~попытаться увеличить границы для коэффициентов $h_{1\max}$,
$h_{2\max}$ и~(или) увеличить величину $N$.

10. Полученная в~итоге точка $\mathbf{h}_0$ последовательно
определит оптимальную передаточную функцию $F(s,\mathbf{h}_0)$
динамического корректора, оптимальную передаточную функцию
$W_{\delta0}(s)=W_\delta(s,F(s,\mathbf{h}_0))$ обратной связи
(\ref{eq2}), а~также ее реализацию (\ref{eq16}) в~пространстве
состояний с~учетом инерционности привода.

З а~м е ч а~н и~е. Особо подчеркнем, что в~отличие от~других
алгоритмов здесь мы имеем не~приближенное, а~\emph{точное} решение
задачи (\ref{eq7}).

\textbf{Пример применения алгоритма.} Для иллюстрации применения
разработанного алгоритма рассмотрим практический пример синтеза
$H_\infty$-оптимального закона управления, реализуемого
автопилотом для транспортного морского судна с~водоизмещением
около 6000~т. Будем считать, что судно движется с~постоянной
скоростью хода 8~м/с в~условиях морского волнения с~интенсивностью
5~баллов по~шкале Бофорта.

Для режима стабилизации будем использовать математическую модель
(1), (\ref{eq15a}), (15б), матрицы которой имеют следующие
компоненты:
$a_{11}=-0.0454,~a_{12}=0.560,~a_{21}=0.0267,~a_{22}=-0.408,~b_1=-0.0132,~b_2=-0.00742,~h_1=-1.82,~h_2=-0.128$.

Спектральную плотность мощности волнения будем представлять
соотноше\-ниями (\ref{eq4}), где
$T(s)=20s^4+17.3s^3+11.9s^2+3.87s+1.08$, $N(s)=0.216s^3$. Назначим
весовой коэффициент $k=0.03$ в~тождестве (\ref{eq6}) для задания
функционала $J(W_\delta)$.

В результате вычислений по~п. 2 алгоритма получим
$$
G(s)=10^{-2}\cdot(3.00 s^7+5.35 s^6+5.13 s^5+3.12 s^4+1.33
s^3+0.37 s^2+0.0653 s+0.00372),
$$
$$
g_{1,2}=0.0955\pm 0.455 j,~~g_{3,4}=0.411\pm 0.272
j,~g_{5,6}=0.338\pm 0.369 j,~~g_{7}=0.0943,
$$
$$
\omega_0 =0.462,~~J_a=2.95\cdot 10^4.
$$

Для проверки условия вырожденности (\ref{eq12}), выполняя
факторизацию (\ref{eq14}), находим полином
\begin{equation*}
R(s)=10^{-4}\cdot(5.16s^7+8.42s^6+7.51s^5+4.34s^4+1.88s^3+0.568s^2+0.108s+0.00639).
\end{equation*}

В соответствии с~(\ref{eq13}) построим матрицу Пика
$\Pi=\{l_{ij}\}$ и~определим ее минимальное собственное число
$q_m=2.93\cdot10^{-4}>0$, т.\:е. имеем вырожденную ситуацию,
причем решение задачи (\ref{eq9}) не~единственное.

Далее, в~соответствии с~п. 4 алгоритма задаем элементы
$\mathbf{g},\mu,v$ обратной связи~(\ref{eq16}):
\begin{equation*}
\mathbf{g}=(0.0336\quad 0.00446\quad 0.0944)',~~\mu = (3.30\quad
39.8\quad 20.5),~~v = 1.22.
\end{equation*}

Для принятых исходных данных по~формулам, приведенным в~работах
[7, 8], находим число $\overline{m}=F(j\omega_0)=-11.6+0.381 j$.

Следующим шагом является п. 5 алгоритма, где формируется конечная
сетка $\Omega_h^N=\{h_{1i},h_{2j}\}$. Принимаем максимальные
значения $h_{1\max}=5$ и~$h_{2\max}=5$, задаем малые числа
$\varepsilon_1=\varepsilon_2=0.01$, а~также количество $N=200$
равноотстоящих узлов на~каждом отрезке $[\varepsilon_1,h_{1\max}]$
и $[\varepsilon_2,h_{2\max}]$.

Проведение вычислений по~п. 6--8 для всех значений
$i,j=\overline{1,N}$ приводит к~нахождению точки
$\mathbf{h}_0=(1.40\quad 0.490)\in \Omega_h^N$, для которой
достигается нулевой глобальный минимум функции $I_e(\mathbf{h})$.

Полученная в~итоге точка $\mathbf{h}_0$ определяет следующую
оптимальную передаточную функцию динамического корректора:
\begin{equation*}
    F(s,\mathbf{h_0})=(16.2s^2-16.0s)/(s^2+1.40s+0.490).
\end{equation*}

Итак, в~результате применения алгоритма сформирован
стабилизирующий $H_\infty$-оптимальный регулятор с~МС-структурой:
\begin{equation}\label{eq23}
\begin{aligned}
&\dot{\delta}=u,\\
&\dot{z}_1=-0.0454z_1+0.560z_2-0.0132\delta+0.0336(y-z_3),\\
&\dot{z}_2=0.0267z_1+0.408z_2-0.00742\delta+0.00446(y-z_3),\\
&\dot{z}_3=z_2+0.0944(y-z_3),\\
&\dot{p}_1=p_2+16.2(y-z_3),\\
&\dot{p}_2=-0.490p_1-1.40p_2-38.6(y-z_3),\\
&\dot{\xi}=p_2+16.2(y-z_3),\\
&u=3.30\dot{z}_1+39.8\dot{z}_2+20.5\dot{z}_3+1.22y+\xi.
\end{aligned}
\end{equation}

Полученный регулятор при движении замкнутой системы (1),
(\ref{eq23}) в~условиях регулярного 5-балльного волнения
с~частотой $\omega_0=0.462$ обеспечивает следующие амплитуды
отклонения от~курса и~колебаний рулей соответственно:
$A_y=0.75^\circ,A_\delta=21.2^\circ$. Этот результат по~построению
оптимального регулятора является \emph{гарантирующим}, т.\:е. при
любом изменении частоты фактического волнения и~при той же
интенсивности работы рулей амплитуда отклонений от~заданного курса
будет не~больше, чем указанная величина $A_y=0.75^\circ$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5fig
\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{02/fig1}

\vskip 2mm {\small Частотные характеристики оптимальных замкнутых
систем} }
\end{figure}

%\begin{figure}[h!]
%    \begin{center}
%        \includegraphics[scale=0.65]{pic13.eps}
%        Частотные характеристики оптимальных замкнутых систем
%        \label{fig1}
%    \end{center}
%\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

На рисунке представлен график частотной характеристики
$A_e(\omega)=|P_0(j\omega,$ $W_\delta(j\omega,$
$F(j\omega,\mathbf{h}_0)))|$ для системы, замкнутой оптимальным
регулятором (МС) (\ref{eq23}). Для сравнения (кривая {\it 2})
приведен график аналогичной частотной характеристики для
$H_\infty$-оптимального регулятора (Hinf) (кривая {\it 1}),
построенного по методике, описанной в~работе [11]. Поскольку оба
регулятора являются решениями задач (\ref{eq7}), (\ref{eq9}),
пиковые значения частотных характеристик совпадают.

\textbf{Заключение.} Основной целью данной статьи является
разработка простого конструктивного метода расчета передаточной
функции для динамического фильтра в~составе закона управления
курсом, реализуемого морским автопилотом. Этот метод базируется
на~идеологии  $H_\infty$-оптимизации, позволяющей обеспечить
гарантированное качество фильтрации при движении в~условиях
морского волнения.

В отличие от~широко применяемых подходов [1--3] указанная цель
достигается с~использованием специализированной многоцелевой
структуры закона управления. Данный подход обладает рядом
преимуществ по~сравнению с~альтернативными ва\-риан\-та\-ми, одним
из~которых служит гибкость в~настройке на~реальные условия
плавания. Такая гибкость обеспечивается возможностью выбора
способа динамической коррекции из~следующего набора вариантов:

1) если судно движется на~спокойной воде, можно полностью
отключить корректор, обеспечивая работу системы в~облегченном
режиме;

2) если движение происходит при наличии постоянных возмущений
(ветер, течения) без волнения, уместно применить простейший
вариант коррекции с~постоянной передаточной функцией, не~вводя
бесполезную дополнительную динамику;

3) при наличии морского волнения можно переключить корректор для
работы в~фильтрующем режиме, как описано в~данной статье, сохраняя
астатические свойства обратной связи.

Предложенный подход можно расширить, используя его для управления
морскими беспилотными объектами или плавучими оффшорными
структурами. Результаты исследований могут быть развиты с~учетом
транспортного запаздывания и~требуемых робастных свойств замкнутой
системы.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{02/lit-ra}

%%%%%N DOI в~ссылке!!!!!!!!!!

\input{02/ref-s}

%%%%%N DOI в~ссылке!!!!!!!!!!


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


{\footnotesize




%\thispagestyle{empty}

\vskip 3mm

%\thispagestyle{empty}


\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~13.~Вып.~\issuenum}}}%
%\lhead{} %верхний колонтитул слева
%%\rhead{} % верхний колонтитул справа
% для оформления нижнего колонтитула
\cfoot{} %
%\lfoot{} %
%\rfoot{\thepage} %


%\noindent Статья рекомендована к~печати проф. Л. А. Петросяном.

%\vskip 1mm

\noindent Статья поступила в~редакцию 10 октября 2017~г.

\vskip 1mm

\noindent Статья принята к~печати 12 октября 2017~г.

}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\vskip 5mm


%{\footnotesize

%\noindent К\,о\,н\,т\,а\,к\,т\,н\,а\,я\,
%и\,н\,ф\,о\,р\,м\,а\,ц\,и\,я \nopagebreak

%\vskip 3mm

%\textit{Буре Артем Владимирович}~--- аспирант; e-mail:
%bure.artem@gmail.com

%\vskip 2mm

%\emph{Bure Artem Vladimirovich}~--- post-graduate student; e-mail:
%bure.artem@gmail.com

%}
