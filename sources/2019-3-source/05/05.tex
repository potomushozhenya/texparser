
\noindent{\small УДК 519.178  \hfill {\footnotesize Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}\\
MSC 91B38

}

\vskip2mm

\noindent{\bf Математическая модель интегрированной цепочки поставок%$^{*}$%
 }

\vskip2.5mm

\noindent{\it В.~М.~Буре$\,^1$%
, В.~В.~Карелин$\,^1$%
, Л.~Н.~Полякова$\,^1$%
, А.~В.~Флегонтов$\,^{1,2}$%
%, И.~О. Фамилия%$\,^2$%
}

\efootnote{
%%
%\vspace{-3mm}\parindent=7mm
%%
%\vskip 0.1mm $^{*}$ Работа выполнена при
%финансовой поддержке Российского научного фонда (проект №
%?). (The work was jointly supported by a grant
%from the Russian Science Foundation (Project N ?))\par
%%
%%\vskip 2.0mm
%%
\indent{\copyright} Санкт-Петербургский государственный
университет, \issueyear%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum05 } }\hfill\thepage}%
\fancyfoot[RE]{\thepage\hfill{\footnotesize\rm{\doivyp/spbu10.\issueyear.\issuenum05}}}%
% для оформления нижнего колонтитула
\cfoot{} %

\vskip2mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

\noindent%
$^1$~%
Санкт-Петербургский государственный университет, Российская
Федерация,

\noindent%
\hskip2.45mm%
199034, Санкт-Петербург, Университетская~наб., 7--9

\noindent%
$^2$~%
Российский государственный педагогический университет имени
А.~И.~Герцена,

\noindent%
\hskip2.45mm%
Российская Федерация, 191186, Санкт-Петербург, наб. р. Мойки, 48

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\vskip3mm

{\small \noindent \textbf{Для цитирования:} \textit{Буре В.~М.,
Карелин В.~В., Полякова Л.~Н., Флегонтов А. В.} Математическая
модель интегрированной цепочки поставок~// Вестник
Санкт-Петербургского университета. Прикладная математика.
Информатика. Процессы управления. \issueyear. Т.~15.
Вып.~\issuenum.
С.~\pageref{p5}--\pageref{p5e}. %\\
\doivyp/\enskip%
\!\!\!spbu10.\issueyear.\issuenum05

\vskip3mm

{\leftskip=7mm\noindentУправление цепочкой поставок занимает очень
важное место в~деятельности любой фирмы в~условиях глобализации
экономики и~возрастании конкуренции на~рынке. Главная цель
управления цепочками поставок заключается в~координации работы
фирм-поставщиков сырья, фирмы-производителя и~торговой фирмы,
реализующей товар на~рынке. В~статье изучается непрерывная
математическая модель, описывающая взаи\-мо\-действие
перечисленных фирм в~условиях непостоянной скорости поставки сырья
некоторого вида.  Предполагается, что скорость поставки данного
сырья может принимать два возможных значения, выбор которых
определяется фирмой-производителем, при этом более высокая
скорость поставки сырья соответствует интенсивному ва\-риан\-ту
производства продукта, более медленная скорость~--- обычному.
Математическое моделирование проводится с~использованием
дифференциальных уравнений. Сформулирована оптимизационная задача,
которая заключается в~выборе момента времени переключения режима
поставки сырья
с~интенсивного варианта на~обычный с~целью максимизации дохода фирмы-производителя.\\[1mm]
\textit{Ключевые слова}: уровень запаса товара, многоуровневая
цепочка поставок, производство.

}

}

\vskip 4mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

 {\bf Введение.}
В~работе рассматривается математическая модель управления цепочкой
поставок, в~которой взаимодействуют две фирмы-поставщики сырья,
фирма-производитель и~торговая фирма, реализующая товар на~рынке.
Эти фирмы взаимодействуют между собой таким образом, чтобы
обеспечить производство и~реализацию на~рынке некоторого
производимого ими товара. Предполагается, что скорость поставки
сырья определенного вида может осуществляться в~двух вариантах:
интенсивном (с высокой скоростью) и~обычном (скорость поставки
сырья существенно ниже, чем в~первом варианте).  Выбор варианта
режима поставки сырья опре\-де\-ляет\-ся фирмой-производителем
в~целях максимизации своего дохода. Сырье от фирм-поставщиков
сырья доставляется непрерывно и~сразу направляется в~производство,
хранение сырья осуществляется на~складах фирм, поставляющих сырье.
Произведенный продукт сразу же отправляется в~торговую фирму, но
вследствие того, что скорость отгрузки товара может быть меньше,
чем скорость производства, возникает необходимость хранить
произведенный товар на~складе фирмы-производителя, а~это
представляет собой затратную, дорогостоящую процедуру.

Близкие по~постановке задачи описывались в~[1--5]. Главная
отличительная особенность данной работы заключается в~наличии двух
режимов поставки сырья определенного вида и~в~оптимизационной
задаче, заключающейся в~выборе момента переключения варианта
поставки сырья с~целью максимизации дохода фирмы-производителя.
Оптимизационные задачи, связанные с~деятельностью торговой фирмы,
рассматривались в~статьях [6--10].

%\footnote{Вестник СПбГУ. Прикладная математика. Информатика. Процессы управления. 2019. Т. 00. Вып. 0}

Цепочка поставок включает три вида фирм (рис. 1).

%\begin{figure}[h!]
%\centering{}\includegraphics[width=0.8\linewidth]{123}
%\caption{Цепочка поставок}
%\end{figure}
%\noindent


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{05/fig1}

\vskip 2mm {\small{\it Рис. 1.} Цепочка поставок} }
\end{figure}


{\bf Модель для поставщиков сырья.} Пусть $P_1 (t)$~--- скорость
поставки сырья типа 1 (возможны два варианта поставок:
интенсивный, обычный), равная
$$
P_1 (t)= \left\{
\begin{array}{l}
P_1^{(1)}, \quad t<T_1, \\[1mm]
P_1^{(2)}, \quad t \geq T_1.
\end{array}
\right.
$$
Будем считать, что $P_1^{(1)}>P_1^{(2)}$, $T_1$~--- момент
времени, который выбирается фирмой-производителем. Скорость
$P_1^{(1)}$ соответствует интенсивному варианту поставок, скорость
$P_1^{(2)}$~--- обычному.

Уравнения динамики запаса сырья типа 1 для фирмы-поставщика 1
представим следующим образом:

\begin{equation*}
 \begin{array}{l}
\frac{dI_1 (t)}{dt} = -P_1^{(1)}, \quad t<T_1, \\[1mm]
\frac{dI_1 (t)}{dt} = -P_1^{(2)}, \quad t \geq T_1,
\end{array}
%\right.
\end{equation*}
%
%
где $I_1 (t)$~--- уровень запаса сырья типа 1 на~складе
фирмы-поставщика 1 на~момент времени $t$.

Пусть $Q_1$~--- объем сырья типа 1 (известен), момент
$T_{m_1}$~--- окончание поставок сырья типа 1 (рис.~2). Тогда
получим, что
$$
I_1 (0)=Q_1,
$$
$$
I_1 (t)=Q_1-P_1^{(1)}, \qquad 0<t<T_1,
$$
$$
I_1 (T_1)=Q_1-P_1^{(1)}T_1.
$$


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{05/fig2}

\vskip 1mm {\small{\it Рис. 2.} Динамика уровня запаса товара типа
{1} на~складе поставщика {1} } \vspace*{2mm}}
\end{figure}

%\begin{figure}[h!]
%\centering{}\includegraphics[width=0.8\linewidth]{12}
%\caption{Динамика уровня запаса товара типа 1 на~складе поставщика
%1}
%\end{figure}

\noindentДля $t:T_1 \leq t \leq T_{m_1}$ находим, что
$$
I_1 (t)=Q_1-P_1^{(1)}T_1-P_1^{(2)}(t-T_1),
$$
следовательно,
$$
I_1 (T_{m_1})=0=Q_1-P_1^{(1)}T_1-P_1^{(2)}(T_{m_1}-T_1)
$$
и
$$
T_{m_1} = T_1 +\frac{Q_1-P_1^{(1)}T_1}{P_1^{(2)}}.
$$


Пусть $P_2$~--- скорость поставок сырья типа 2 (постоянная).
 %
Уравнение динамики запаса сырья типа 2 для фирмы-поставщика 2
будет иметь вид

\begin{equation*}\label{a2}
\frac{dI_2 (t)}{dt} = -P_2,
\end{equation*}
где $I_2 (t)$~--- уровень запаса сырья типа 2 на~складе
фирмы-поставщика 2 на~момент времени $t$.

Пусть $Q_2$~--- объем сырья типа 2 (известен), момент
$T_{m_2}$~--- окончание поставок сырья типа 2 (рис.~3). Отсюда
легко вычисляются следующие параметры:
$$
I_2 (0)= Q_2,
$$
$$
I_2 (t)=Q_2-P_2t, \qquad 0<t<T_{m_2},
$$
$$
I_2 (T_{m_2})=0.
$$

%\begin{figure}[h!]
%\centering{}\includegraphics[width=0.8\linewidth]{1}
%\caption{Динамика уровня запаса сырья типа 2 на~складе поставщика
%2}
%\end{figure}


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{05/fig3}

\vskip 2mm {\small{\it Рис. 3.} Динамика уровня запаса сырья типа
2 на~складе поставщика 2} }
\end{figure}


\noindentСледовательно,
$$
Q_2-P_2T_{m_2} = 0
$$
и
$$
T_{m_2} = \frac{Q_2}{P_2}.
$$

{\bf Затраты и~доходы поставщиков.} Для поставщика 1 затраты
состоят из: $C_1 Q_1$~--- покупки сырья типа 1,  где $C_1$~---
удельная стоимость сырья типа 1, и~расходов на~хранение сырья типа
1: $h_1\left(\int\limits_{0}^{T_1}
(Q_1-P_1^{(1)}t)dt+\int\limits_{T_1}^{T_{m_1}}[Q_1-P_1^{(1)}T_1-P_1^{(2)}(t-T_1)]
dt\right)$, где $h_1$~--- удельные расходы.

Затраты поставщика 2 состоят из:  покупки сырья типа 2 --- $C_2
Q_2$, где $C_2$~--- удельная стоимость сырья типа 2, и расходов
на~хранение сырья типа 2: $h_2 \int_{0}^{T_{m_2}} (Q_2-P_2t)dt$,
где  $h_2$~--- удельные расходы.


Обозначим доход поставщика 1  в~виде уравнения
$$
E_1 = (\omega
_1-C_1)Q_1-h_1\left(\int\limits_0^{T_1}(Q_1-P_1^{(1)}t)dt+\int\limits
_{T_1}^{T_{m_1}}[Q_1-P_1^{(1)}T_1-P_1^{(2)}(t-T_1)]dt\right),
$$
в котором $E_1$~--- общий доход, $\omega _1$~--- цена, по~которой
поставщик 1 продает единицу сырья производителю.



Доход поставщика 2 представим так:
$$
E_2 = (\omega _2-C_2)Q_2-h_2\int\limits _0^{T_{m_2}}(Q_2-P_2t)dt,
$$
здесь $E_2$~--- общий доход, $\omega _2$~--- цена, по~которой
поставщик 2 продает единицу сырья производителю.

Будем считать, что величины $Q_1$, $Q_2$, $T_1$, $P_1^{(1)}$,
$P_1^{(2)}$, $P_2$, $C_1$, $C_2$, $\omega _1$, $\omega _2$, $h_1$,
$h_2$ известны фирмам-поставщикам, величины $T_{m_1}$, $T_{m_2}$,
$I_1 (t)$, $I_2 (t)$, $E_1$, $E_2$ вычисляются в~рамках модели.
\noindent

{\bf  Модель для фирмы-производителя.} Предположим, что скорость
производства товара $P(t)$ определяется по выражению
$$
P(t)=\alpha _1 P_1 (t) + \alpha _2 P_2,
$$
где технологические коэффициенты $\alpha _1 \geq 0$, $\alpha _2
\geq 0$, $\alpha _1 + \alpha _2 \leq 1$~--- известные конс\-танты.

Рассчитываем  объем партии произведенного товара из~всего
закупленного сырья $D$ по~формуле
$$
D=\alpha _1 Q_1 + \alpha _2 Q_2.
$$
%
%
Тогда момент времени $T_p$~--- завершение производства всей партии
товара --- получим по~уравнению
\begin{equation}\label{1}
\int\limits_0^{T_p} P(t)dt= \alpha _1 Q_1 + \alpha _2 Q_2.
\end{equation}
Можно заметить, что

$$
\int\limits_0^{T_p} P(t)dt= \int\limits_0^{T_1} (\alpha _1
P_1^{(1)} + \alpha _2 P_2) dt + \int\limits_{T_1}^{T_p} (\alpha _1
P_1^{(2)} + \alpha _2 P_2) dt.
$$
Тогда из~(1) находим, что
$$
T_p = \frac{\alpha _1 Q_1 + \alpha _2 Q_2-T_1 \alpha _1
(P_1^{(1)}-P_1^{(2)})}{\alpha _1 P_1^{(2)} + \alpha _2 P_2}.
$$

Пусть $I_3 (t)$~--- текущий объем запаса производимого продукта
на~складе фирмы-производителя:
\begin{equation}\label{2}
\frac{dI_3 (t)}{dt} = P(t)-d_1,
\end{equation}
где $d_1$~--- скорость отгрузки товара в~торговую фирму, очевидно,
что $I_3 (0) =0$.

Уравнение (2) описывает динамику объема товара на~складе
фирмы-произ\-во\-ди\-те\-ля до момента времени $T_p$.

Опишем динамику после момента времени $T_p$  следующим образом:
\begin{equation}\label{3}
\frac{dI_3 (t)}{dt} =-d_1,
\end{equation}
здесь $T_p <t \leq T_r$, $T_r$~--- момент окончания отгрузки
товара в торговую фирму.

Очевидно, что
$$
I_3 (T_p) = \alpha _1 Q_1 + \alpha _2 Q_2-d_1 T_p
$$
представляет собой граничное условие для уравнения (3).

Решение уравнения (2) запиишем в~виде
$$
I_3 (t) = \int\limits_0^t (P(\tau)-d_1)d \tau, \qquad 0 \leq t
\leq T_p,
$$
решение уравнения (3) --- как
$$
I_3 (t) = I_3 (T_p)-d_1 (t-T_p), \qquad T_p <t \leq T_r.
$$
Так как $I_3 (T_r) = 0$, получим, что
$$
T_r = \frac{I_3 (T_r)+d_1 T_p}{d_1} = \frac{\alpha _1 Q_1 + \alpha
_2 Q_2}{d_1}.
$$

Окончательно, для представления $I_3 (t)$ на~интервале $0 \leq t
\leq T_p$ будем иметь следующее выражение:
$$
I_3 (t) = \int\limits_0^t (P(\tau)-d_1)d \tau = \left\{
\begin{array}{c}

\int\limits_0^t (P_1^{(1)}-d_1)d \tau = t(P_1^{(1)}-d_1), \qquad t \leq T_1, \\
\int\limits_0^{T_1} (P_1^{(1)}-d_1)d \tau + \int\limits_{T_1}^t (P_1^{(2)}-d_1)d \tau = \\
=t(P_1^{(2)}-d_1) + T_1 (P_1^{(1)}- P_1^{(2)}), \qquad T_1 < t
\leq T_p,
\end{array}
\right.
$$
%
а на~интервале $T_p < t \leq T_r$~--- такое:
%
$$
I_3 (t) = \int\limits_0^t (P(\tau)-d_1)d \tau =
\int\limits_0^{T_p} (P(\tau)-d_1)d \tau + \int\limits_{T_p}^t
(-d_1)d \tau = \alpha _1 Q_1 + \alpha _2 Q_2-d_1t.
$$

{\bf  Расходы и~доход фирмы-производителя.} Расходы
фирмы-производителя рассчитываются по~формуле
$$
s(\alpha _1 Q_1 + \alpha _2 Q_2)+h_3\left[\int\limits_0^{T_p} I_3
(t)dt+ \int\limits_{T_p}^{T_r} I_3 (t)dt\right]+ \omega _1 Q_1 +
\omega _2 Q_2,
$$
в которой $s$~--- себестоимость производства единицы товара,
$h_3$~--- удельные расходы хранения товара на~складе
фирмы-производителя. Доход фирмы-производителя определим следующим
образом:
$$
E_3 = \omega _3 (\alpha _1 Q_1 + \alpha _2 Q_2)-s(\alpha _1 Q_1 +
\alpha _2 Q_2)-h_3\left[\int\limits_0^{T_p} I_3 (t)dt+
\int\limits_{T_p}^{T_r} I_3 (t)dt\right]- \omega _1 Q_1 - \omega
_2 Q_2,
$$
где $E_3$~--- общий доход; $\omega _3$~--- цена единицы товара,
по~которой торговая фирма покупает произведенный товар
у~фирмы-производителя (оптовая закупочная цена).

{\bf  Модель торговой фирмы.} Пусть $I_4 (t)$~--- текущий запас
товара на~складе торговой фирмы. Тогда   опишем динамику $I_4 (t)$
до момента $T_r$ в~виде уравнения
%
\begin{equation*}
\frac{dI_4 (t)}{dt} = d_1-d_2,
\end{equation*}
в котором  $d_2$~--- скорость продажи (реализации) товара
в~торговой фирме, $0 \leq t \leq T_r$.

Очевидно, что $I_4 (0) = 0$. Тогда
$$
I_4 (t) = (d_1-d_2)t,
$$
следовательно,
$$
I_4 (T_r) = (d_1-d_2)T_r.
$$
%
Представим динамику $I_4 (t)$ после момента $T_r$ так:

\begin{equation}\label{4}
\frac{dI_4 (t)}{dt} =-d_2.
\end{equation}
В уравнении (4) $T_r \leq t \leq T_s$, где $T_s$~--- момент
завершения продажи товара (рис.~4).

%\begin{figure}[h!]
%\centering{}\includegraphics[width=0.8\linewidth]{4}
%\caption{Временная диаграмма}
%\end{figure}


\begin{figure}[h!]
\centering{
\includegraphics[scale=1]{05/fig4}

\vskip 2mm {\small{\it Рис. 4.} Временная диаграмма} }
\end{figure}




Очевидно, что $I_4 (t) = (d_1-d_2)T_r-d_2 (t-T_r)$, при $t > T_r$.
Так как $I_4 (T_s) = 0$, получаем, что
$$
d_2 (T_s-T_r) = (d_1-d_2)T_r, \qquad  T_s = \frac{d_1}{d_2} T_r.
$$

Из экономического смысла математической модели следует, что $d_1
\geq d_2$. В~принципе, возможна ситуация, когда $d_1 < d_2$,
в~этом случае продается еще не поставленный в~торговую фирму
товар.


Доход торговой фирмы рассчитаем следующим образом:
$$
E_4 = \omega _4 (\alpha _1 Q_1 + \alpha _2 Q_2)-\omega _3 (\alpha
_1 Q_1 + \alpha _2 Q_2)-h_4\left[\int\limits_0^{T_r} I_4 (t)dt+
\int\limits_{T_r}^{T_s} I_4 (t)dt\right],
$$
где $\omega _4$~--- розничная цена одной единицы товара; $h_4$~---
удельные расходы хранения товара на~складе торговой фирмы,
предполагается, что $d_1 > d_2$.



{\bf  Задача оптимизации.} Возможна следующая постановка
оптимизационной задачи. Момент времени $T_1$ выбирается
фирмой-производителем с~целью максимизации своего дохода
из~некоторого промежутка $[T_{1,{\rm min}},T_{1,{\rm max}}]$,
границы которого опре\-де\-ляют\-ся технологическими требованиями.

Тогда оптимизационный критерий будет иметь вид
$$
\max _{T_1 \in [T_{1,{\rm min}},T_{1,{\rm max}}]} E_3 , $$ где $$
  E_3 =  \omega _3 (\alpha _1 Q_1 + \alpha _2 Q_2)-s(\alpha _1 Q_1 + \alpha _2 Q_2)%~- $$ $$
-h_3\left[\int\limits_0^{T_p} I_3 (t)dt+ \int\limits_{T_p}^{T_r}
I_3 (t)dt \right]- \omega _1 Q_1 - \omega _2 Q_2.
$$

В рамках рассматриваемой постановки задачи максимизация дохода
фирмы-производителя эквивалентна задаче минимизации

\begin{equation*}\label{a9}
F= \min _{T_1 \in [T_{1,{\rm min}},T_{1,{\rm
max}}]}\left\{\int\limits_0^{T_p} I_3 (t)dt+
\int\limits_{T_p}^{T_r} I_3 (t)dt\right\}.
\end{equation*}
В этом случае необходимо ввести еще ограничение
на~продолжительность периода времени, когда фирма-производитель
перерабатывает сырье в~интенсивном режиме.

Подставляя в~оптимизационный критерий значения, вычисленные ранее
для $I_3 (t)$, получим критерий в~таком виде:

$$
\int\limits_0^{T_1} \int\limits_0^t (P_1^{(1)}-d_1)d \tau dt +
\int\limits_{T_1}^{T_p} \int\limits_0^{T_1} (P_1^{(1)}-d_1)d \tau
dt + \int\limits_{T_1}^{T_p} \int\limits_{T_1}^t (P_1^{(2)}-d_1)d
\tau dt~+
$$ $$
+~ \int\limits_{T_p}^{T_r} \int _0^{T_p} (P-d_1)d \tau dt -
\int\limits_{T_p}^{T_r}\int _{T_p}^t d_1 d \tau dt.
$$
В свою очередь, в~результате подстановки $T_p$ и~$T_r$ через
$T_1$, сведем к~квадратичной функции $ - \beta _1 T_1^2 + \beta _2
T_1 + \beta _3 $ искомую величину $T_1$. Отсюда и~определяем
минимум заданного функционала для значений $0 \leq T_1 \leq
T_p$.\pagebreak

{\bf Заключение.} В~статье рассмотрена проблема математического
моделирования интегрированной цепочки поставок, включающей
фирмы-поставщики сырья, фирму-производителя некоторой продукции
и~торговую фирму, реализующую данную продукцию на~рынке.
Математическая модель имеет непрерывный характер, для
математического моделирования применяются дифференциальные
уравнения. Сформулирована оптимизационная задача, в которой
поставка сырья переключается с~интенсивного режима производства
на~обычный.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\input{05/lit-ra}

%\newpage
\input{05/ref-s}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

{\footnotesize

%\thispagestyle{empty}
%
\vskip 3mm
%
\thispagestyle{empty} %очищаем стиль страницы
\thispagestyle{fancy} %включаем пользовательский стиль
\renewcommand{\headrulewidth}{0pt}%
\fancyhead[LO]{}%
\fancyhead[RE]{}%
\fancyfoot[LO]{\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}}
\hfill}%
\fancyfoot[RE]{\hfill\footnotesize{\rm{Вестник~СПбГУ.~Прикладная~математика.~Информатика...~\issueyear.~Т.~15.~Вып.~\issuenum}}}%
% для оформления нижнего колонтитула
\cfoot{} %
%
}
